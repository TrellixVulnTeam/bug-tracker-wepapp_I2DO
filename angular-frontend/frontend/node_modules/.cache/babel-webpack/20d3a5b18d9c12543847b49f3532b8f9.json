{"ast":null,"code":"/**\n * Dark Reader v4.9.39\n * https://darkreader.org/\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.DarkReader = {}));\n})(this, function (exports) {\n  'use strict';\n  /*! *****************************************************************************\r\n  Copyright (c) Microsoft Corporation.\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n  purpose with or without fee is hereby granted.\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n  PERFORMANCE OF THIS SOFTWARE.\r\n  ***************************************************************************** */\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __awaiter(thisArg, _arguments, P, generator) {\n    function adopt(value) {\n      return value instanceof P ? value : new P(function (resolve) {\n        resolve(value);\n      });\n    }\n\n    return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) {\n        try {\n          step(generator.next(value));\n        } catch (e) {\n          reject(e);\n        }\n      }\n\n      function rejected(value) {\n        try {\n          step(generator[\"throw\"](value));\n        } catch (e) {\n          reject(e);\n        }\n      }\n\n      function step(result) {\n        result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n      }\n\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n  }\n\n  function __generator(thisArg, body) {\n    var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n        f,\n        y,\n        t,\n        g;\n    return g = {\n      next: verb(0),\n      \"throw\": verb(1),\n      \"return\": verb(2)\n    }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n      return this;\n    }), g;\n\n    function verb(n) {\n      return function (v) {\n        return step([n, v]);\n      };\n    }\n\n    function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n\n      while (_) try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n\n      if (op[0] & 5) throw op[1];\n      return {\n        value: op[0] ? op[1] : void 0,\n        done: true\n      };\n    }\n  }\n\n  function __values(o) {\n    var s = typeof Symbol === \"function\" && Symbol.iterator,\n        m = s && o[s],\n        i = 0;\n    if (m) return m.call(o);\n    if (o && typeof o.length === \"number\") return {\n      next: function () {\n        if (o && i >= o.length) o = void 0;\n        return {\n          value: o && o[i++],\n          done: !o\n        };\n      }\n    };\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n  }\n\n  function __read(o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o),\n        r,\n        ar = [],\n        e;\n\n    try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    } catch (error) {\n      e = {\n        error: error\n      };\n    } finally {\n      try {\n        if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      } finally {\n        if (e) throw e.error;\n      }\n    }\n\n    return ar;\n  }\n\n  function __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n        if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n        ar[i] = from[i];\n      }\n    }\n    return to.concat(ar || from);\n  }\n\n  var MessageType = {\n    UI_GET_DATA: 'ui-get-data',\n    UI_GET_ACTIVE_TAB_INFO: 'ui-get-active-tab-info',\n    UI_SUBSCRIBE_TO_CHANGES: 'ui-subscribe-to-changes',\n    UI_UNSUBSCRIBE_FROM_CHANGES: 'ui-unsubscribe-from-changes',\n    UI_CHANGE_SETTINGS: 'ui-change-settings',\n    UI_SET_THEME: 'ui-set-theme',\n    UI_SET_SHORTCUT: 'ui-set-shortcut',\n    UI_TOGGLE_URL: 'ui-toggle-url',\n    UI_MARK_NEWS_AS_READ: 'ui-mark-news-as-read',\n    UI_LOAD_CONFIG: 'ui-load-config',\n    UI_APPLY_DEV_DYNAMIC_THEME_FIXES: 'ui-apply-dev-dynamic-theme-fixes',\n    UI_RESET_DEV_DYNAMIC_THEME_FIXES: 'ui-reset-dev-dynamic-theme-fixes',\n    UI_APPLY_DEV_INVERSION_FIXES: 'ui-apply-dev-inversion-fixes',\n    UI_RESET_DEV_INVERSION_FIXES: 'ui-reset-dev-inversion-fixes',\n    UI_APPLY_DEV_STATIC_THEMES: 'ui-apply-dev-static-themes',\n    UI_RESET_DEV_STATIC_THEMES: 'ui-reset-dev-static-themes',\n    UI_SAVE_FILE: 'ui-save-file',\n    UI_REQUEST_EXPORT_CSS: 'ui-request-export-css',\n    BG_CHANGES: 'bg-changes',\n    BG_ADD_CSS_FILTER: 'bg-add-css-filter',\n    BG_ADD_STATIC_THEME: 'bg-add-static-theme',\n    BG_ADD_SVG_FILTER: 'bg-add-svg-filter',\n    BG_ADD_DYNAMIC_THEME: 'bg-add-dynamic-theme',\n    BG_EXPORT_CSS: 'bg-export-css',\n    BG_UNSUPPORTED_SENDER: 'bg-unsupported-sender',\n    BG_CLEAN_UP: 'bg-clean-up',\n    BG_RELOAD: 'bg-reload',\n    BG_FETCH_RESPONSE: 'bg-fetch-response',\n    BG_UI_UPDATE: 'bg-ui-update',\n    BG_CSS_UPDATE: 'bg-css-update',\n    CS_COLOR_SCHEME_CHANGE: 'cs-color-scheme-change',\n    CS_FRAME_CONNECT: 'cs-frame-connect',\n    CS_FRAME_FORGET: 'cs-frame-forget',\n    CS_FRAME_FREEZE: 'cs-frame-freeze',\n    CS_FRAME_RESUME: 'cs-frame-resume',\n    CS_EXPORT_CSS_RESPONSE: 'cs-export-css-response',\n    CS_FETCH: 'cs-fetch'\n  };\n  var userAgent = typeof navigator === 'undefined' ? 'some useragent' : navigator.userAgent.toLowerCase();\n  var platform = typeof navigator === 'undefined' ? 'some platform' : navigator.platform.toLowerCase();\n  var isChromium = userAgent.includes('chrome') || userAgent.includes('chromium');\n  var isThunderbird = userAgent.includes('thunderbird');\n  var isFirefox = userAgent.includes('firefox') || isThunderbird;\n  userAgent.includes('vivaldi');\n  userAgent.includes('yabrowser');\n  userAgent.includes('opr') || userAgent.includes('opera');\n  userAgent.includes('edg');\n  var isSafari = userAgent.includes('safari') && !isChromium;\n  var isWindows = platform.startsWith('win');\n  var isMacOS = platform.startsWith('mac');\n  userAgent.includes('mobile');\n  var isShadowDomSupported = typeof ShadowRoot === 'function';\n  var isMatchMediaChangeEventListenerSupported = typeof MediaQueryList === 'function' && typeof MediaQueryList.prototype.addEventListener === 'function';\n\n  (function () {\n    var m = userAgent.match(/chrom[e|ium]\\/([^ ]+)/);\n\n    if (m && m[1]) {\n      return m[1];\n    }\n\n    return '';\n  })();\n\n  var isDefinedSelectorSupported = function () {\n    try {\n      document.querySelector(':defined');\n      return true;\n    } catch (err) {\n      return false;\n    }\n  }();\n\n  globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.getManifest && globalThis.chrome.runtime.getManifest().manifest_version === 3;\n\n  function getOKResponse(url, mimeType, origin) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, fetch(url, {\n              cache: 'force-cache',\n              credentials: 'omit',\n              referrer: origin\n            })];\n\n          case 1:\n            response = _a.sent();\n\n            if (isFirefox && mimeType === 'text/css' && url.startsWith('moz-extension://') && url.endsWith('.css')) {\n              return [2, response];\n            }\n\n            if (mimeType && !response.headers.get('Content-Type').startsWith(mimeType)) {\n              throw new Error(\"Mime type mismatch when loading \" + url);\n            }\n\n            if (!response.ok) {\n              throw new Error(\"Unable to load \" + url + \" \" + response.status + \" \" + response.statusText);\n            }\n\n            return [2, response];\n        }\n      });\n    });\n  }\n\n  function loadAsDataURL(url, mimeType) {\n    return __awaiter(this, void 0, void 0, function () {\n      var response;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, getOKResponse(url, mimeType)];\n\n          case 1:\n            response = _a.sent();\n            return [4, readResponseAsDataURL(response)];\n\n          case 2:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function readResponseAsDataURL(response) {\n    return __awaiter(this, void 0, void 0, function () {\n      var blob, dataURL;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, response.blob()];\n\n          case 1:\n            blob = _a.sent();\n            return [4, new Promise(function (resolve) {\n              var reader = new FileReader();\n\n              reader.onloadend = function () {\n                return resolve(reader.result);\n              };\n\n              reader.readAsDataURL(blob);\n            })];\n\n          case 2:\n            dataURL = _a.sent();\n            return [2, dataURL];\n        }\n      });\n    });\n  }\n\n  var throwCORSError = function (url) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, Promise.reject(new Error(['Embedded Dark Reader cannot access a cross-origin resource', url, 'Overview your URLs and CORS policies or use', '`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.', 'See if using `DarkReader.setFetchMethod(window.fetch)`', 'before `DarkReader.enable()` works.'].join(' ')))];\n      });\n    });\n  };\n\n  var fetcher = throwCORSError;\n\n  function setFetchMethod$1(fetch) {\n    if (fetch) {\n      fetcher = fetch;\n    } else {\n      fetcher = throwCORSError;\n    }\n  }\n\n  function callFetchMethod(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, fetcher(url)];\n\n          case 1:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  if (!window.chrome) {\n    window.chrome = {};\n  }\n\n  if (!chrome.runtime) {\n    chrome.runtime = {};\n  }\n\n  var messageListeners = new Set();\n\n  function sendMessage() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var id_1, _a, url, responseType, response, text_1, error_1;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!(args[0] && args[0].type === MessageType.CS_FETCH)) return [3, 8];\n            id_1 = args[0].id;\n            _b.label = 1;\n\n          case 1:\n            _b.trys.push([1, 7,, 8]);\n\n            _a = args[0].data, url = _a.url, responseType = _a.responseType;\n            return [4, callFetchMethod(url)];\n\n          case 2:\n            response = _b.sent();\n            if (!(responseType === 'data-url')) return [3, 4];\n            return [4, readResponseAsDataURL(response)];\n\n          case 3:\n            text_1 = _b.sent();\n            return [3, 6];\n\n          case 4:\n            return [4, response.text()];\n\n          case 5:\n            text_1 = _b.sent();\n            _b.label = 6;\n\n          case 6:\n            messageListeners.forEach(function (cb) {\n              return cb({\n                type: MessageType.BG_FETCH_RESPONSE,\n                data: text_1,\n                error: null,\n                id: id_1\n              });\n            });\n            return [3, 8];\n\n          case 7:\n            error_1 = _b.sent();\n            console.error(error_1);\n            messageListeners.forEach(function (cb) {\n              return cb({\n                type: MessageType.BG_FETCH_RESPONSE,\n                data: null,\n                error: error_1,\n                id: id_1\n              });\n            });\n            return [3, 8];\n\n          case 8:\n            return [2];\n        }\n      });\n    });\n  }\n\n  function addMessageListener(callback) {\n    messageListeners.add(callback);\n  }\n\n  if (typeof chrome.runtime.sendMessage === 'function') {\n    var nativeSendMessage_1 = chrome.runtime.sendMessage;\n\n    chrome.runtime.sendMessage = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      sendMessage.apply(void 0, __spreadArray([], __read(args)));\n      nativeSendMessage_1.apply(chrome.runtime, args);\n    };\n  } else {\n    chrome.runtime.sendMessage = sendMessage;\n  }\n\n  if (!chrome.runtime.onMessage) {\n    chrome.runtime.onMessage = {};\n  }\n\n  if (typeof chrome.runtime.onMessage.addListener === 'function') {\n    var nativeAddListener_1 = chrome.runtime.onMessage.addListener;\n\n    chrome.runtime.onMessage.addListener = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      addMessageListener.apply(void 0, __spreadArray([], __read(args)));\n      nativeAddListener_1.apply(chrome.runtime.onMessage, args);\n    };\n  } else {\n    chrome.runtime.onMessage.addListener = addMessageListener;\n  }\n\n  var ThemeEngines = {\n    cssFilter: 'cssFilter',\n    svgFilter: 'svgFilter',\n    staticTheme: 'staticTheme',\n    dynamicTheme: 'dynamicTheme'\n  };\n  var DEFAULT_COLORS = {\n    darkScheme: {\n      background: '#181a1b',\n      text: '#e8e6e3'\n    },\n    lightScheme: {\n      background: '#dcdad7',\n      text: '#181a1b'\n    }\n  };\n  var DEFAULT_THEME = {\n    mode: 1,\n    brightness: 100,\n    contrast: 100,\n    grayscale: 0,\n    sepia: 0,\n    useFont: false,\n    fontFamily: isMacOS ? 'Helvetica Neue' : isWindows ? 'Segoe UI' : 'Open Sans',\n    textStroke: 0,\n    engine: ThemeEngines.dynamicTheme,\n    stylesheet: '',\n    darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\n    darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\n    lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\n    lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\n    scrollbarColor: isMacOS ? '' : 'auto',\n    selectionColor: 'auto',\n    styleSystemControls: true\n  };\n\n  function isArrayLike(items) {\n    return items.length != null;\n  }\n\n  function forEach(items, iterator) {\n    var e_1, _a;\n\n    if (isArrayLike(items)) {\n      for (var i = 0, len = items.length; i < len; i++) {\n        iterator(items[i]);\n      }\n    } else {\n      try {\n        for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n          var item = items_1_1.value;\n          iterator(item);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n  }\n\n  function push(array, addition) {\n    forEach(addition, function (a) {\n      return array.push(a);\n    });\n  }\n\n  function toArray(items) {\n    var results = [];\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      results.push(items[i]);\n    }\n\n    return results;\n  }\n\n  function logInfo() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n  }\n\n  function logWarn() {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n  }\n\n  function throttle(callback) {\n    var pending = false;\n    var frameId = null;\n    var lastArgs;\n\n    var throttled = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      lastArgs = args;\n\n      if (frameId) {\n        pending = true;\n      } else {\n        callback.apply(void 0, __spreadArray([], __read(lastArgs)));\n        frameId = requestAnimationFrame(function () {\n          frameId = null;\n\n          if (pending) {\n            callback.apply(void 0, __spreadArray([], __read(lastArgs)));\n            pending = false;\n          }\n        });\n      }\n    };\n\n    var cancel = function () {\n      cancelAnimationFrame(frameId);\n      pending = false;\n      frameId = null;\n    };\n\n    return Object.assign(throttled, {\n      cancel: cancel\n    });\n  }\n\n  function createAsyncTasksQueue() {\n    var tasks = [];\n    var frameId = null;\n\n    function runTasks() {\n      var task;\n\n      while (task = tasks.shift()) {\n        task();\n      }\n\n      frameId = null;\n    }\n\n    function add(task) {\n      tasks.push(task);\n\n      if (!frameId) {\n        frameId = requestAnimationFrame(runTasks);\n      }\n    }\n\n    function cancel() {\n      tasks.splice(0);\n      cancelAnimationFrame(frameId);\n      frameId = null;\n    }\n\n    return {\n      add: add,\n      cancel: cancel\n    };\n  }\n\n  function getDuration(time) {\n    var duration = 0;\n\n    if (time.seconds) {\n      duration += time.seconds * 1000;\n    }\n\n    if (time.minutes) {\n      duration += time.minutes * 60 * 1000;\n    }\n\n    if (time.hours) {\n      duration += time.hours * 60 * 60 * 1000;\n    }\n\n    if (time.days) {\n      duration += time.days * 24 * 60 * 60 * 1000;\n    }\n\n    return duration;\n  }\n\n  function removeNode(node) {\n    node && node.parentNode && node.parentNode.removeChild(node);\n  }\n\n  function watchForNodePosition(node, mode, onRestore) {\n    if (onRestore === void 0) {\n      onRestore = Function.prototype;\n    }\n\n    var MAX_ATTEMPTS_COUNT = 10;\n    var RETRY_TIMEOUT = getDuration({\n      seconds: 2\n    });\n    var ATTEMPTS_INTERVAL = getDuration({\n      seconds: 10\n    });\n    var prevSibling = node.previousSibling;\n    var parent = node.parentNode;\n\n    if (!parent) {\n      throw new Error('Unable to watch for node position: parent element not found');\n    }\n\n    if (mode === 'prev-sibling' && !prevSibling) {\n      throw new Error('Unable to watch for node position: there is no previous sibling');\n    }\n\n    var attempts = 0;\n    var start = null;\n    var timeoutId = null;\n    var restore = throttle(function () {\n      if (timeoutId) {\n        return;\n      }\n\n      attempts++;\n      var now = Date.now();\n\n      if (start == null) {\n        start = now;\n      } else if (attempts >= MAX_ATTEMPTS_COUNT) {\n        if (now - start < ATTEMPTS_INTERVAL) {\n          logWarn(\"Node position watcher paused: retry in \" + RETRY_TIMEOUT + \"ms\", node, prevSibling);\n          timeoutId = setTimeout(function () {\n            start = null;\n            attempts = 0;\n            timeoutId = null;\n            restore();\n          }, RETRY_TIMEOUT);\n          return;\n        }\n\n        start = now;\n        attempts = 1;\n      }\n\n      if (mode === 'parent') {\n        if (prevSibling && prevSibling.parentNode !== parent) {\n          logWarn('Unable to restore node position: sibling parent changed', node, prevSibling, parent);\n          stop();\n          return;\n        }\n      }\n\n      if (mode === 'prev-sibling') {\n        if (prevSibling.parentNode == null) {\n          logWarn('Unable to restore node position: sibling was removed', node, prevSibling, parent);\n          stop();\n          return;\n        }\n\n        if (prevSibling.parentNode !== parent) {\n          logWarn('Style was moved to another parent', node, prevSibling, parent);\n          updateParent(prevSibling.parentNode);\n        }\n      }\n\n      logWarn('Restoring node position', node, prevSibling, parent);\n      parent.insertBefore(node, prevSibling ? prevSibling.nextSibling : parent.firstChild);\n      observer.takeRecords();\n      onRestore && onRestore();\n    });\n    var observer = new MutationObserver(function () {\n      if (mode === 'parent' && node.parentNode !== parent || mode === 'prev-sibling' && node.previousSibling !== prevSibling) {\n        restore();\n      }\n    });\n\n    var run = function () {\n      observer.observe(parent, {\n        childList: true\n      });\n    };\n\n    var stop = function () {\n      clearTimeout(timeoutId);\n      observer.disconnect();\n      restore.cancel();\n    };\n\n    var skip = function () {\n      observer.takeRecords();\n    };\n\n    var updateParent = function (parentNode) {\n      parent = parentNode;\n      stop();\n      run();\n    };\n\n    run();\n    return {\n      run: run,\n      stop: stop,\n      skip: skip\n    };\n  }\n\n  function iterateShadowHosts(root, iterator) {\n    if (root == null) {\n      return;\n    }\n\n    var walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {\n      acceptNode: function (node) {\n        return node.shadowRoot == null ? NodeFilter.FILTER_SKIP : NodeFilter.FILTER_ACCEPT;\n      }\n    });\n\n    for (var node = root.shadowRoot ? walker.currentNode : walker.nextNode(); node != null; node = walker.nextNode()) {\n      iterator(node);\n      iterateShadowHosts(node.shadowRoot, iterator);\n    }\n  }\n\n  function isDOMReady() {\n    return document.readyState === 'complete' || document.readyState === 'interactive';\n  }\n\n  var readyStateListeners = new Set();\n\n  function addDOMReadyListener(listener) {\n    readyStateListeners.add(listener);\n  }\n\n  function removeDOMReadyListener(listener) {\n    readyStateListeners.delete(listener);\n  }\n\n  function isReadyStateComplete() {\n    return document.readyState === 'complete';\n  }\n\n  var readyStateCompleteListeners = new Set();\n\n  function addReadyStateCompleteListener(listener) {\n    readyStateCompleteListeners.add(listener);\n  }\n\n  function cleanReadyStateCompleteListeners() {\n    readyStateCompleteListeners.clear();\n  }\n\n  if (!isDOMReady()) {\n    var onReadyStateChange_1 = function () {\n      if (isDOMReady()) {\n        readyStateListeners.forEach(function (listener) {\n          return listener();\n        });\n        readyStateListeners.clear();\n\n        if (isReadyStateComplete()) {\n          document.removeEventListener('readystatechange', onReadyStateChange_1);\n          readyStateCompleteListeners.forEach(function (listener) {\n            return listener();\n          });\n          readyStateCompleteListeners.clear();\n        }\n      }\n    };\n\n    document.addEventListener('readystatechange', onReadyStateChange_1);\n  }\n\n  var HUGE_MUTATIONS_COUNT = 1000;\n\n  function isHugeMutation(mutations) {\n    if (mutations.length > HUGE_MUTATIONS_COUNT) {\n      return true;\n    }\n\n    var addedNodesCount = 0;\n\n    for (var i = 0; i < mutations.length; i++) {\n      addedNodesCount += mutations[i].addedNodes.length;\n\n      if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function getElementsTreeOperations(mutations) {\n    var additions = new Set();\n    var deletions = new Set();\n    var moves = new Set();\n    mutations.forEach(function (m) {\n      forEach(m.addedNodes, function (n) {\n        if (n instanceof Element && n.isConnected) {\n          additions.add(n);\n        }\n      });\n      forEach(m.removedNodes, function (n) {\n        if (n instanceof Element) {\n          if (n.isConnected) {\n            moves.add(n);\n          } else {\n            deletions.add(n);\n          }\n        }\n      });\n    });\n    moves.forEach(function (n) {\n      return additions.delete(n);\n    });\n    var duplicateAdditions = [];\n    var duplicateDeletions = [];\n    additions.forEach(function (node) {\n      if (additions.has(node.parentElement)) {\n        duplicateAdditions.push(node);\n      }\n    });\n    deletions.forEach(function (node) {\n      if (deletions.has(node.parentElement)) {\n        duplicateDeletions.push(node);\n      }\n    });\n    duplicateAdditions.forEach(function (node) {\n      return additions.delete(node);\n    });\n    duplicateDeletions.forEach(function (node) {\n      return deletions.delete(node);\n    });\n    return {\n      additions: additions,\n      moves: moves,\n      deletions: deletions\n    };\n  }\n\n  var optimizedTreeObservers = new Map();\n  var optimizedTreeCallbacks = new WeakMap();\n\n  function createOptimizedTreeObserver(root, callbacks) {\n    var observer;\n    var observerCallbacks;\n    var domReadyListener;\n\n    if (optimizedTreeObservers.has(root)) {\n      observer = optimizedTreeObservers.get(root);\n      observerCallbacks = optimizedTreeCallbacks.get(observer);\n    } else {\n      var hadHugeMutationsBefore_1 = false;\n      var subscribedForReadyState_1 = false;\n      observer = new MutationObserver(function (mutations) {\n        if (isHugeMutation(mutations)) {\n          if (!hadHugeMutationsBefore_1 || isDOMReady()) {\n            observerCallbacks.forEach(function (_a) {\n              var onHugeMutations = _a.onHugeMutations;\n              return onHugeMutations(root);\n            });\n          } else if (!subscribedForReadyState_1) {\n            domReadyListener = function () {\n              return observerCallbacks.forEach(function (_a) {\n                var onHugeMutations = _a.onHugeMutations;\n                return onHugeMutations(root);\n              });\n            };\n\n            addDOMReadyListener(domReadyListener);\n            subscribedForReadyState_1 = true;\n          }\n\n          hadHugeMutationsBefore_1 = true;\n        } else {\n          var elementsOperations_1 = getElementsTreeOperations(mutations);\n          observerCallbacks.forEach(function (_a) {\n            var onMinorMutations = _a.onMinorMutations;\n            return onMinorMutations(elementsOperations_1);\n          });\n        }\n      });\n      observer.observe(root, {\n        childList: true,\n        subtree: true\n      });\n      optimizedTreeObservers.set(root, observer);\n      observerCallbacks = new Set();\n      optimizedTreeCallbacks.set(observer, observerCallbacks);\n    }\n\n    observerCallbacks.add(callbacks);\n    return {\n      disconnect: function () {\n        observerCallbacks.delete(callbacks);\n\n        if (domReadyListener) {\n          removeDOMReadyListener(domReadyListener);\n        }\n\n        if (observerCallbacks.size === 0) {\n          observer.disconnect();\n          optimizedTreeCallbacks.delete(observer);\n          optimizedTreeObservers.delete(root);\n        }\n      }\n    };\n  }\n\n  var anchor;\n  var parsedURLCache = new Map();\n\n  function fixBaseURL($url) {\n    if (!anchor) {\n      anchor = document.createElement('a');\n    }\n\n    anchor.href = $url;\n    return anchor.href;\n  }\n\n  function parseURL($url, $base) {\n    if ($base === void 0) {\n      $base = null;\n    }\n\n    var key = \"\" + $url + ($base ? \";\" + $base : '');\n\n    if (parsedURLCache.has(key)) {\n      return parsedURLCache.get(key);\n    }\n\n    if ($base) {\n      var parsedURL_1 = new URL($url, fixBaseURL($base));\n      parsedURLCache.set(key, parsedURL_1);\n      return parsedURL_1;\n    }\n\n    var parsedURL = new URL(fixBaseURL($url));\n    parsedURLCache.set($url, parsedURL);\n    return parsedURL;\n  }\n\n  function getAbsoluteURL($base, $relative) {\n    if ($relative.match(/^data\\\\?\\:/)) {\n      return $relative;\n    }\n\n    if (/^\\/\\//.test($relative)) {\n      return \"\" + location.protocol + $relative;\n    }\n\n    var b = parseURL($base);\n    var a = parseURL($relative, b.href);\n    return a.href;\n  }\n\n  function iterateCSSRules(rules, iterate, onMediaRuleError) {\n    forEach(rules, function (rule) {\n      if (rule.selectorText) {\n        iterate(rule);\n      } else if (rule.href) {\n        try {\n          iterateCSSRules(rule.styleSheet.cssRules, iterate, onMediaRuleError);\n        } catch (err) {\n          logInfo(\"Found a non-loaded link.\");\n          onMediaRuleError && onMediaRuleError();\n        }\n      } else if (rule.media) {\n        var media = Array.from(rule.media);\n        var isScreenOrAll = media.some(function (m) {\n          return m.startsWith('screen') || m.startsWith('all');\n        });\n        var isPrintOrSpeech = media.some(function (m) {\n          return m.startsWith('print') || m.startsWith('speech');\n        });\n\n        if (isScreenOrAll || !isPrintOrSpeech) {\n          iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\n        }\n      } else if (rule.conditionText) {\n        if (CSS.supports(rule.conditionText)) {\n          iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\n        }\n      } else {\n        logWarn(\"CSSRule type not supported\", rule);\n      }\n    });\n  }\n\n  var shorthandVarDependantProperties = ['background', 'border', 'border-color', 'border-bottom', 'border-left', 'border-right', 'border-top', 'outline', 'outline-color'];\n  var shorthandVarDepPropRegexps = isSafari ? shorthandVarDependantProperties.map(function (prop) {\n    var regexp = new RegExp(prop + \":\\\\s*(.*?)\\\\s*;\");\n    return [prop, regexp];\n  }) : null;\n\n  function iterateCSSDeclarations(style, iterate) {\n    forEach(style, function (property) {\n      var value = style.getPropertyValue(property).trim();\n\n      if (!value) {\n        return;\n      }\n\n      iterate(property, value);\n    });\n    var cssText = style.cssText;\n\n    if (cssText.includes('var(')) {\n      if (isSafari) {\n        shorthandVarDepPropRegexps.forEach(function (_a) {\n          var _b = __read(_a, 2),\n              prop = _b[0],\n              regexp = _b[1];\n\n          var match = cssText.match(regexp);\n\n          if (match && match[1]) {\n            var val = match[1].trim();\n            iterate(prop, val);\n          }\n        });\n      } else {\n        shorthandVarDependantProperties.forEach(function (prop) {\n          var val = style.getPropertyValue(prop);\n\n          if (val && val.includes('var(')) {\n            iterate(prop, val);\n          }\n        });\n      }\n    }\n  }\n\n  var cssURLRegex = /url\\((('.+?')|(\".+?\")|([^\\)]*?))\\)/g;\n  var cssImportRegex = /@import\\s*(url\\()?(('.+?')|(\".+?\")|([^\\)]*?))\\)?;?/g;\n\n  function getCSSURLValue(cssURL) {\n    return cssURL.replace(/^url\\((.*)\\)$/, '$1').trim().replace(/^\"(.*)\"$/, '$1').replace(/^'(.*)'$/, '$1');\n  }\n\n  function getCSSBaseBath(url) {\n    var cssURL = parseURL(url);\n    return \"\" + cssURL.origin + cssURL.pathname.replace(/\\?.*$/, '').replace(/(\\/)([^\\/]+)$/i, '$1');\n  }\n\n  function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\n    return $css.replace(cssURLRegex, function (match) {\n      var pathValue = getCSSURLValue(match);\n      return \"url(\\\"\" + getAbsoluteURL(cssBasePath, pathValue) + \"\\\")\";\n    });\n  }\n\n  var cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\n\n  function removeCSSComments($css) {\n    return $css.replace(cssCommentsRegex, '');\n  }\n\n  var fontFaceRegex = /@font-face\\s*{[^}]*}/g;\n\n  function replaceCSSFontFace($css) {\n    return $css.replace(fontFaceRegex, '');\n  }\n\n  function hslToRGB(_a) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        _b = _a.a,\n        a = _b === void 0 ? 1 : _b;\n\n    if (s === 0) {\n      var _c = __read([l, l, l].map(function (x) {\n        return Math.round(x * 255);\n      }), 3),\n          r_1 = _c[0],\n          b_1 = _c[1],\n          g_1 = _c[2];\n\n      return {\n        r: r_1,\n        g: g_1,\n        b: b_1,\n        a: a\n      };\n    }\n\n    var c = (1 - Math.abs(2 * l - 1)) * s;\n    var x = c * (1 - Math.abs(h / 60 % 2 - 1));\n    var m = l - c / 2;\n\n    var _d = __read((h < 60 ? [c, x, 0] : h < 120 ? [x, c, 0] : h < 180 ? [0, c, x] : h < 240 ? [0, x, c] : h < 300 ? [x, 0, c] : [c, 0, x]).map(function (n) {\n      return Math.round((n + m) * 255);\n    }), 3),\n        r = _d[0],\n        g = _d[1],\n        b = _d[2];\n\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a\n    };\n  }\n\n  function rgbToHSL(_a) {\n    var r255 = _a.r,\n        g255 = _a.g,\n        b255 = _a.b,\n        _b = _a.a,\n        a = _b === void 0 ? 1 : _b;\n    var r = r255 / 255;\n    var g = g255 / 255;\n    var b = b255 / 255;\n    var max = Math.max(r, g, b);\n    var min = Math.min(r, g, b);\n    var c = max - min;\n    var l = (max + min) / 2;\n\n    if (c === 0) {\n      return {\n        h: 0,\n        s: 0,\n        l: l,\n        a: a\n      };\n    }\n\n    var h = (max === r ? (g - b) / c % 6 : max === g ? (b - r) / c + 2 : (r - g) / c + 4) * 60;\n\n    if (h < 0) {\n      h += 360;\n    }\n\n    var s = c / (1 - Math.abs(2 * l - 1));\n    return {\n      h: h,\n      s: s,\n      l: l,\n      a: a\n    };\n  }\n\n  function toFixed(n, digits) {\n    if (digits === void 0) {\n      digits = 0;\n    }\n\n    var fixed = n.toFixed(digits);\n\n    if (digits === 0) {\n      return fixed;\n    }\n\n    var dot = fixed.indexOf('.');\n\n    if (dot >= 0) {\n      var zerosMatch = fixed.match(/0+$/);\n\n      if (zerosMatch) {\n        if (zerosMatch.index === dot + 1) {\n          return fixed.substring(0, dot);\n        }\n\n        return fixed.substring(0, zerosMatch.index);\n      }\n    }\n\n    return fixed;\n  }\n\n  function rgbToString(rgb) {\n    var r = rgb.r,\n        g = rgb.g,\n        b = rgb.b,\n        a = rgb.a;\n\n    if (a != null && a < 1) {\n      return \"rgba(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \", \" + toFixed(a, 2) + \")\";\n    }\n\n    return \"rgb(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \")\";\n  }\n\n  function rgbToHexString(_a) {\n    var r = _a.r,\n        g = _a.g,\n        b = _a.b,\n        a = _a.a;\n    return \"#\" + (a != null && a < 1 ? [r, g, b, Math.round(a * 255)] : [r, g, b]).map(function (x) {\n      return \"\" + (x < 16 ? '0' : '') + x.toString(16);\n    }).join('');\n  }\n\n  function hslToString(hsl) {\n    var h = hsl.h,\n        s = hsl.s,\n        l = hsl.l,\n        a = hsl.a;\n\n    if (a != null && a < 1) {\n      return \"hsla(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%, \" + toFixed(a, 2) + \")\";\n    }\n\n    return \"hsl(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%)\";\n  }\n\n  var rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\n  var hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\n  var hexMatch = /^#[0-9a-f]+$/i;\n\n  function parse($color) {\n    var c = $color.trim().toLowerCase();\n\n    if (c.match(rgbMatch)) {\n      return parseRGB(c);\n    }\n\n    if (c.match(hslMatch)) {\n      return parseHSL(c);\n    }\n\n    if (c.match(hexMatch)) {\n      return parseHex(c);\n    }\n\n    if (knownColors.has(c)) {\n      return getColorByName(c);\n    }\n\n    if (systemColors.has(c)) {\n      return getSystemColor(c);\n    }\n\n    if ($color === 'transparent') {\n      return {\n        r: 0,\n        g: 0,\n        b: 0,\n        a: 0\n      };\n    }\n\n    throw new Error(\"Unable to parse \" + $color);\n  }\n\n  function getNumbers($color) {\n    var numbers = [];\n    var prevPos = 0;\n    var isMining = false;\n    var startIndex = $color.indexOf('(');\n    $color = $color.substring(startIndex + 1, $color.length - 1);\n\n    for (var i = 0; i < $color.length; i++) {\n      var c = $color[i];\n\n      if (c >= '0' && c <= '9' || c === '.' || c === '+' || c === '-') {\n        isMining = true;\n      } else if (isMining && (c === ' ' || c === ',')) {\n        numbers.push($color.substring(prevPos, i));\n        isMining = false;\n        prevPos = i + 1;\n      } else if (!isMining) {\n        prevPos = i + 1;\n      }\n    }\n\n    if (isMining) {\n      numbers.push($color.substring(prevPos, $color.length));\n    }\n\n    return numbers;\n  }\n\n  function getNumbersFromString(str, range, units) {\n    var raw = getNumbers(str);\n    var unitsList = Object.entries(units);\n    var numbers = raw.map(function (r) {\n      return r.trim();\n    }).map(function (r, i) {\n      var n;\n      var unit = unitsList.find(function (_a) {\n        var _b = __read(_a, 1),\n            u = _b[0];\n\n        return r.endsWith(u);\n      });\n\n      if (unit) {\n        n = parseFloat(r.substring(0, r.length - unit[0].length)) / unit[1] * range[i];\n      } else {\n        n = parseFloat(r);\n      }\n\n      if (range[i] > 1) {\n        return Math.round(n);\n      }\n\n      return n;\n    });\n    return numbers;\n  }\n\n  var rgbRange = [255, 255, 255, 1];\n  var rgbUnits = {\n    '%': 100\n  };\n\n  function parseRGB($rgb) {\n    var _a = __read(getNumbersFromString($rgb, rgbRange, rgbUnits), 4),\n        r = _a[0],\n        g = _a[1],\n        b = _a[2],\n        _b = _a[3],\n        a = _b === void 0 ? 1 : _b;\n\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a\n    };\n  }\n\n  var hslRange = [360, 1, 1, 1];\n  var hslUnits = {\n    '%': 100,\n    'deg': 360,\n    'rad': 2 * Math.PI,\n    'turn': 1\n  };\n\n  function parseHSL($hsl) {\n    var _a = __read(getNumbersFromString($hsl, hslRange, hslUnits), 4),\n        h = _a[0],\n        s = _a[1],\n        l = _a[2],\n        _b = _a[3],\n        a = _b === void 0 ? 1 : _b;\n\n    return hslToRGB({\n      h: h,\n      s: s,\n      l: l,\n      a: a\n    });\n  }\n\n  function parseHex($hex) {\n    var h = $hex.substring(1);\n\n    switch (h.length) {\n      case 3:\n      case 4:\n        {\n          var _a = __read([0, 1, 2].map(function (i) {\n            return parseInt(\"\" + h[i] + h[i], 16);\n          }), 3),\n              r = _a[0],\n              g = _a[1],\n              b = _a[2];\n\n          var a = h.length === 3 ? 1 : parseInt(\"\" + h[3] + h[3], 16) / 255;\n          return {\n            r: r,\n            g: g,\n            b: b,\n            a: a\n          };\n        }\n\n      case 6:\n      case 8:\n        {\n          var _b = __read([0, 2, 4].map(function (i) {\n            return parseInt(h.substring(i, i + 2), 16);\n          }), 3),\n              r = _b[0],\n              g = _b[1],\n              b = _b[2];\n\n          var a = h.length === 6 ? 1 : parseInt(h.substring(6, 8), 16) / 255;\n          return {\n            r: r,\n            g: g,\n            b: b,\n            a: a\n          };\n        }\n    }\n\n    throw new Error(\"Unable to parse \" + $hex);\n  }\n\n  function getColorByName($color) {\n    var n = knownColors.get($color);\n    return {\n      r: n >> 16 & 255,\n      g: n >> 8 & 255,\n      b: n >> 0 & 255,\n      a: 1\n    };\n  }\n\n  function getSystemColor($color) {\n    var n = systemColors.get($color);\n    return {\n      r: n >> 16 & 255,\n      g: n >> 8 & 255,\n      b: n >> 0 & 255,\n      a: 1\n    };\n  }\n\n  var knownColors = new Map(Object.entries({\n    aliceblue: 0xf0f8ff,\n    antiquewhite: 0xfaebd7,\n    aqua: 0x00ffff,\n    aquamarine: 0x7fffd4,\n    azure: 0xf0ffff,\n    beige: 0xf5f5dc,\n    bisque: 0xffe4c4,\n    black: 0x000000,\n    blanchedalmond: 0xffebcd,\n    blue: 0x0000ff,\n    blueviolet: 0x8a2be2,\n    brown: 0xa52a2a,\n    burlywood: 0xdeb887,\n    cadetblue: 0x5f9ea0,\n    chartreuse: 0x7fff00,\n    chocolate: 0xd2691e,\n    coral: 0xff7f50,\n    cornflowerblue: 0x6495ed,\n    cornsilk: 0xfff8dc,\n    crimson: 0xdc143c,\n    cyan: 0x00ffff,\n    darkblue: 0x00008b,\n    darkcyan: 0x008b8b,\n    darkgoldenrod: 0xb8860b,\n    darkgray: 0xa9a9a9,\n    darkgrey: 0xa9a9a9,\n    darkgreen: 0x006400,\n    darkkhaki: 0xbdb76b,\n    darkmagenta: 0x8b008b,\n    darkolivegreen: 0x556b2f,\n    darkorange: 0xff8c00,\n    darkorchid: 0x9932cc,\n    darkred: 0x8b0000,\n    darksalmon: 0xe9967a,\n    darkseagreen: 0x8fbc8f,\n    darkslateblue: 0x483d8b,\n    darkslategray: 0x2f4f4f,\n    darkslategrey: 0x2f4f4f,\n    darkturquoise: 0x00ced1,\n    darkviolet: 0x9400d3,\n    deeppink: 0xff1493,\n    deepskyblue: 0x00bfff,\n    dimgray: 0x696969,\n    dimgrey: 0x696969,\n    dodgerblue: 0x1e90ff,\n    firebrick: 0xb22222,\n    floralwhite: 0xfffaf0,\n    forestgreen: 0x228b22,\n    fuchsia: 0xff00ff,\n    gainsboro: 0xdcdcdc,\n    ghostwhite: 0xf8f8ff,\n    gold: 0xffd700,\n    goldenrod: 0xdaa520,\n    gray: 0x808080,\n    grey: 0x808080,\n    green: 0x008000,\n    greenyellow: 0xadff2f,\n    honeydew: 0xf0fff0,\n    hotpink: 0xff69b4,\n    indianred: 0xcd5c5c,\n    indigo: 0x4b0082,\n    ivory: 0xfffff0,\n    khaki: 0xf0e68c,\n    lavender: 0xe6e6fa,\n    lavenderblush: 0xfff0f5,\n    lawngreen: 0x7cfc00,\n    lemonchiffon: 0xfffacd,\n    lightblue: 0xadd8e6,\n    lightcoral: 0xf08080,\n    lightcyan: 0xe0ffff,\n    lightgoldenrodyellow: 0xfafad2,\n    lightgray: 0xd3d3d3,\n    lightgrey: 0xd3d3d3,\n    lightgreen: 0x90ee90,\n    lightpink: 0xffb6c1,\n    lightsalmon: 0xffa07a,\n    lightseagreen: 0x20b2aa,\n    lightskyblue: 0x87cefa,\n    lightslategray: 0x778899,\n    lightslategrey: 0x778899,\n    lightsteelblue: 0xb0c4de,\n    lightyellow: 0xffffe0,\n    lime: 0x00ff00,\n    limegreen: 0x32cd32,\n    linen: 0xfaf0e6,\n    magenta: 0xff00ff,\n    maroon: 0x800000,\n    mediumaquamarine: 0x66cdaa,\n    mediumblue: 0x0000cd,\n    mediumorchid: 0xba55d3,\n    mediumpurple: 0x9370db,\n    mediumseagreen: 0x3cb371,\n    mediumslateblue: 0x7b68ee,\n    mediumspringgreen: 0x00fa9a,\n    mediumturquoise: 0x48d1cc,\n    mediumvioletred: 0xc71585,\n    midnightblue: 0x191970,\n    mintcream: 0xf5fffa,\n    mistyrose: 0xffe4e1,\n    moccasin: 0xffe4b5,\n    navajowhite: 0xffdead,\n    navy: 0x000080,\n    oldlace: 0xfdf5e6,\n    olive: 0x808000,\n    olivedrab: 0x6b8e23,\n    orange: 0xffa500,\n    orangered: 0xff4500,\n    orchid: 0xda70d6,\n    palegoldenrod: 0xeee8aa,\n    palegreen: 0x98fb98,\n    paleturquoise: 0xafeeee,\n    palevioletred: 0xdb7093,\n    papayawhip: 0xffefd5,\n    peachpuff: 0xffdab9,\n    peru: 0xcd853f,\n    pink: 0xffc0cb,\n    plum: 0xdda0dd,\n    powderblue: 0xb0e0e6,\n    purple: 0x800080,\n    rebeccapurple: 0x663399,\n    red: 0xff0000,\n    rosybrown: 0xbc8f8f,\n    royalblue: 0x4169e1,\n    saddlebrown: 0x8b4513,\n    salmon: 0xfa8072,\n    sandybrown: 0xf4a460,\n    seagreen: 0x2e8b57,\n    seashell: 0xfff5ee,\n    sienna: 0xa0522d,\n    silver: 0xc0c0c0,\n    skyblue: 0x87ceeb,\n    slateblue: 0x6a5acd,\n    slategray: 0x708090,\n    slategrey: 0x708090,\n    snow: 0xfffafa,\n    springgreen: 0x00ff7f,\n    steelblue: 0x4682b4,\n    tan: 0xd2b48c,\n    teal: 0x008080,\n    thistle: 0xd8bfd8,\n    tomato: 0xff6347,\n    turquoise: 0x40e0d0,\n    violet: 0xee82ee,\n    wheat: 0xf5deb3,\n    white: 0xffffff,\n    whitesmoke: 0xf5f5f5,\n    yellow: 0xffff00,\n    yellowgreen: 0x9acd32\n  }));\n  var systemColors = new Map(Object.entries({\n    ActiveBorder: 0x3b99fc,\n    ActiveCaption: 0x000000,\n    AppWorkspace: 0xaaaaaa,\n    Background: 0x6363ce,\n    ButtonFace: 0xffffff,\n    ButtonHighlight: 0xe9e9e9,\n    ButtonShadow: 0x9fa09f,\n    ButtonText: 0x000000,\n    CaptionText: 0x000000,\n    GrayText: 0x7f7f7f,\n    Highlight: 0xb2d7ff,\n    HighlightText: 0x000000,\n    InactiveBorder: 0xffffff,\n    InactiveCaption: 0xffffff,\n    InactiveCaptionText: 0x000000,\n    InfoBackground: 0xfbfcc5,\n    InfoText: 0x000000,\n    Menu: 0xf6f6f6,\n    MenuText: 0xffffff,\n    Scrollbar: 0xaaaaaa,\n    ThreeDDarkShadow: 0x000000,\n    ThreeDFace: 0xc0c0c0,\n    ThreeDHighlight: 0xffffff,\n    ThreeDLightShadow: 0xffffff,\n    ThreeDShadow: 0x000000,\n    Window: 0xececec,\n    WindowFrame: 0xaaaaaa,\n    WindowText: 0x000000,\n    '-webkit-focus-ring-color': 0xe59700\n  }).map(function (_a) {\n    var _b = __read(_a, 2),\n        key = _b[0],\n        value = _b[1];\n\n    return [key.toLowerCase(), value];\n  }));\n\n  function scale(x, inLow, inHigh, outLow, outHigh) {\n    return (x - inLow) * (outHigh - outLow) / (inHigh - inLow) + outLow;\n  }\n\n  function clamp(x, min, max) {\n    return Math.min(max, Math.max(min, x));\n  }\n\n  function multiplyMatrices(m1, m2) {\n    var result = [];\n\n    for (var i = 0, len = m1.length; i < len; i++) {\n      result[i] = [];\n\n      for (var j = 0, len2 = m2[0].length; j < len2; j++) {\n        var sum = 0;\n\n        for (var k = 0, len3 = m1[0].length; k < len3; k++) {\n          sum += m1[i][k] * m2[k][j];\n        }\n\n        result[i][j] = sum;\n      }\n    }\n\n    return result;\n  }\n\n  function getMatches(regex, input, group) {\n    if (group === void 0) {\n      group = 0;\n    }\n\n    var matches = [];\n    var m;\n\n    while (m = regex.exec(input)) {\n      matches.push(m[group]);\n    }\n\n    return matches;\n  }\n\n  function formatCSS(text) {\n    function trimLeft(text) {\n      return text.replace(/^\\s+/, '');\n    }\n\n    function getIndent(depth) {\n      if (depth === 0) {\n        return '';\n      }\n\n      return ' '.repeat(4 * depth);\n    }\n\n    if (text.length < 50000) {\n      var emptyRuleRegexp = /[^{}]+{\\s*}/;\n\n      while (emptyRuleRegexp.test(text)) {\n        text = text.replace(emptyRuleRegexp, '');\n      }\n    }\n\n    var css = text.replace(/\\s{2,}/g, ' ').replace(/\\{/g, '{\\n').replace(/\\}/g, '\\n}\\n').replace(/\\;(?![^\\(|\\\"]*(\\)|\\\"))/g, ';\\n').replace(/\\,(?![^\\(|\\\"]*(\\)|\\\"))/g, ',\\n').replace(/\\n\\s*\\n/g, '\\n').split('\\n');\n    var depth = 0;\n    var formatted = [];\n\n    for (var x = 0, len = css.length; x < len; x++) {\n      var line = css[x] + \"\\n\";\n\n      if (line.includes('{')) {\n        formatted.push(getIndent(depth++) + trimLeft(line));\n      } else if (line.includes('\\}')) {\n        formatted.push(getIndent(--depth) + trimLeft(line));\n      } else {\n        formatted.push(getIndent(depth) + trimLeft(line));\n      }\n    }\n\n    return formatted.join('').trim();\n  }\n\n  function getParenthesesRange(input, searchStartIndex) {\n    if (searchStartIndex === void 0) {\n      searchStartIndex = 0;\n    }\n\n    var length = input.length;\n    var depth = 0;\n    var firstOpenIndex = -1;\n\n    for (var i = searchStartIndex; i < length; i++) {\n      if (depth === 0) {\n        var openIndex = input.indexOf('(', i);\n\n        if (openIndex < 0) {\n          break;\n        }\n\n        firstOpenIndex = openIndex;\n        depth++;\n        i = openIndex;\n      } else {\n        var closingIndex = input.indexOf(')', i);\n\n        if (closingIndex < 0) {\n          break;\n        }\n\n        var openIndex = input.indexOf('(', i);\n\n        if (openIndex < 0 || closingIndex < openIndex) {\n          depth--;\n\n          if (depth === 0) {\n            return {\n              start: firstOpenIndex,\n              end: closingIndex + 1\n            };\n          }\n\n          i = closingIndex;\n        } else {\n          depth++;\n          i = openIndex;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  function createFilterMatrix(config) {\n    var m = Matrix.identity();\n\n    if (config.sepia !== 0) {\n      m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\n    }\n\n    if (config.grayscale !== 0) {\n      m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\n    }\n\n    if (config.contrast !== 100) {\n      m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\n    }\n\n    if (config.brightness !== 100) {\n      m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\n    }\n\n    if (config.mode === 1) {\n      m = multiplyMatrices(m, Matrix.invertNHue());\n    }\n\n    return m;\n  }\n\n  function applyColorMatrix(_a, matrix) {\n    var _b = __read(_a, 3),\n        r = _b[0],\n        g = _b[1],\n        b = _b[2];\n\n    var rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\n    var result = multiplyMatrices(matrix, rgb);\n    return [0, 1, 2].map(function (i) {\n      return clamp(Math.round(result[i][0] * 255), 0, 255);\n    });\n  }\n\n  var Matrix = {\n    identity: function () {\n      return [[1, 0, 0, 0, 0], [0, 1, 0, 0, 0], [0, 0, 1, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    invertNHue: function () {\n      return [[0.333, -0.667, -0.667, 0, 1], [-0.667, 0.333, -0.667, 0, 1], [-0.667, -0.667, 0.333, 0, 1], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    brightness: function (v) {\n      return [[v, 0, 0, 0, 0], [0, v, 0, 0, 0], [0, 0, v, 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    contrast: function (v) {\n      var t = (1 - v) / 2;\n      return [[v, 0, 0, 0, t], [0, v, 0, 0, t], [0, 0, v, 0, t], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    sepia: function (v) {\n      return [[0.393 + 0.607 * (1 - v), 0.769 - 0.769 * (1 - v), 0.189 - 0.189 * (1 - v), 0, 0], [0.349 - 0.349 * (1 - v), 0.686 + 0.314 * (1 - v), 0.168 - 0.168 * (1 - v), 0, 0], [0.272 - 0.272 * (1 - v), 0.534 - 0.534 * (1 - v), 0.131 + 0.869 * (1 - v), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    },\n    grayscale: function (v) {\n      return [[0.2126 + 0.7874 * (1 - v), 0.7152 - 0.7152 * (1 - v), 0.0722 - 0.0722 * (1 - v), 0, 0], [0.2126 - 0.2126 * (1 - v), 0.7152 + 0.2848 * (1 - v), 0.0722 - 0.0722 * (1 - v), 0, 0], [0.2126 - 0.2126 * (1 - v), 0.7152 - 0.7152 * (1 - v), 0.0722 + 0.9278 * (1 - v), 0, 0], [0, 0, 0, 1, 0], [0, 0, 0, 0, 1]];\n    }\n  };\n\n  function getBgPole(theme) {\n    var isDarkScheme = theme.mode === 1;\n    var prop = isDarkScheme ? 'darkSchemeBackgroundColor' : 'lightSchemeBackgroundColor';\n    return theme[prop];\n  }\n\n  function getFgPole(theme) {\n    var isDarkScheme = theme.mode === 1;\n    var prop = isDarkScheme ? 'darkSchemeTextColor' : 'lightSchemeTextColor';\n    return theme[prop];\n  }\n\n  var colorModificationCache = new Map();\n  var colorParseCache$1 = new Map();\n\n  function parseToHSLWithCache(color) {\n    if (colorParseCache$1.has(color)) {\n      return colorParseCache$1.get(color);\n    }\n\n    var rgb = parse(color);\n    var hsl = rgbToHSL(rgb);\n    colorParseCache$1.set(color, hsl);\n    return hsl;\n  }\n\n  function clearColorModificationCache() {\n    colorModificationCache.clear();\n    colorParseCache$1.clear();\n  }\n\n  var rgbCacheKeys = ['r', 'g', 'b', 'a'];\n  var themeCacheKeys$1 = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\n\n  function getCacheId(rgb, theme) {\n    var resultId = '';\n    rgbCacheKeys.forEach(function (key) {\n      resultId += rgb[key] + \";\";\n    });\n    themeCacheKeys$1.forEach(function (key) {\n      resultId += theme[key] + \";\";\n    });\n    return resultId;\n  }\n\n  function modifyColorWithCache(rgb, theme, modifyHSL, poleColor, anotherPoleColor) {\n    var fnCache;\n\n    if (colorModificationCache.has(modifyHSL)) {\n      fnCache = colorModificationCache.get(modifyHSL);\n    } else {\n      fnCache = new Map();\n      colorModificationCache.set(modifyHSL, fnCache);\n    }\n\n    var id = getCacheId(rgb, theme);\n\n    if (fnCache.has(id)) {\n      return fnCache.get(id);\n    }\n\n    var hsl = rgbToHSL(rgb);\n    var pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\n    var anotherPole = anotherPoleColor == null ? null : parseToHSLWithCache(anotherPoleColor);\n    var modified = modifyHSL(hsl, pole, anotherPole);\n\n    var _a = hslToRGB(modified),\n        r = _a.r,\n        g = _a.g,\n        b = _a.b,\n        a = _a.a;\n\n    var matrix = createFilterMatrix(theme);\n\n    var _b = __read(applyColorMatrix([r, g, b], matrix), 3),\n        rf = _b[0],\n        gf = _b[1],\n        bf = _b[2];\n\n    var color = a === 1 ? rgbToHexString({\n      r: rf,\n      g: gf,\n      b: bf\n    }) : rgbToString({\n      r: rf,\n      g: gf,\n      b: bf,\n      a: a\n    });\n    fnCache.set(id, color);\n    return color;\n  }\n\n  function noopHSL(hsl) {\n    return hsl;\n  }\n\n  function modifyColor(rgb, theme) {\n    return modifyColorWithCache(rgb, theme, noopHSL);\n  }\n\n  function modifyLightSchemeColor(rgb, theme) {\n    var poleBg = getBgPole(theme);\n    var poleFg = getFgPole(theme);\n    return modifyColorWithCache(rgb, theme, modifyLightModeHSL, poleFg, poleBg);\n  }\n\n  function modifyLightModeHSL(_a, poleFg, poleBg) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isNeutral;\n\n    if (isDark) {\n      isNeutral = l < 0.2 || s < 0.12;\n    } else {\n      var isBlue = h > 200 && h < 280;\n      isNeutral = s < 0.24 || l > 0.8 && isBlue;\n    }\n\n    var hx = h;\n    var sx = l;\n\n    if (isNeutral) {\n      if (isDark) {\n        hx = poleFg.h;\n        sx = poleFg.s;\n      } else {\n        hx = poleBg.h;\n        sx = poleBg.s;\n      }\n    }\n\n    var lx = scale(l, 0, 1, poleFg.l, poleBg.l);\n    return {\n      h: hx,\n      s: sx,\n      l: lx,\n      a: a\n    };\n  }\n\n  var MAX_BG_LIGHTNESS = 0.4;\n\n  function modifyBgHSL(_a, pole) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isBlue = h > 200 && h < 280;\n    var isNeutral = s < 0.12 || l > 0.8 && isBlue;\n\n    if (isDark) {\n      var lx_1 = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\n\n      if (isNeutral) {\n        var hx_1 = pole.h;\n        var sx = pole.s;\n        return {\n          h: hx_1,\n          s: sx,\n          l: lx_1,\n          a: a\n        };\n      }\n\n      return {\n        h: h,\n        s: s,\n        l: lx_1,\n        a: a\n      };\n    }\n\n    var lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\n\n    if (isNeutral) {\n      var hx_2 = pole.h;\n      var sx = pole.s;\n      return {\n        h: hx_2,\n        s: sx,\n        l: lx,\n        a: a\n      };\n    }\n\n    var hx = h;\n    var isYellow = h > 60 && h < 180;\n\n    if (isYellow) {\n      var isCloserToGreen = h > 120;\n\n      if (isCloserToGreen) {\n        hx = scale(h, 120, 180, 135, 180);\n      } else {\n        hx = scale(h, 60, 120, 60, 105);\n      }\n    }\n\n    return {\n      h: hx,\n      s: s,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyBackgroundColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var pole = getBgPole(theme);\n    return modifyColorWithCache(rgb, __assign(__assign({}, theme), {\n      mode: 0\n    }), modifyBgHSL, pole);\n  }\n\n  var MIN_FG_LIGHTNESS = 0.55;\n\n  function modifyBlueFgHue(hue) {\n    return scale(hue, 205, 245, 205, 220);\n  }\n\n  function modifyFgHSL(_a, pole) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isLight = l > 0.5;\n    var isNeutral = l < 0.2 || s < 0.24;\n    var isBlue = !isNeutral && h > 205 && h < 245;\n\n    if (isLight) {\n      var lx_2 = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\n\n      if (isNeutral) {\n        var hx_3 = pole.h;\n        var sx = pole.s;\n        return {\n          h: hx_3,\n          s: sx,\n          l: lx_2,\n          a: a\n        };\n      }\n\n      var hx_4 = h;\n\n      if (isBlue) {\n        hx_4 = modifyBlueFgHue(h);\n      }\n\n      return {\n        h: hx_4,\n        s: s,\n        l: lx_2,\n        a: a\n      };\n    }\n\n    if (isNeutral) {\n      var hx_5 = pole.h;\n      var sx = pole.s;\n      var lx_3 = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\n      return {\n        h: hx_5,\n        s: sx,\n        l: lx_3,\n        a: a\n      };\n    }\n\n    var hx = h;\n    var lx;\n\n    if (isBlue) {\n      hx = modifyBlueFgHue(h);\n      lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\n    } else {\n      lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\n    }\n\n    return {\n      h: hx,\n      s: s,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyForegroundColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var pole = getFgPole(theme);\n    return modifyColorWithCache(rgb, __assign(__assign({}, theme), {\n      mode: 0\n    }), modifyFgHSL, pole);\n  }\n\n  function modifyBorderHSL(_a, poleFg, poleBg) {\n    var h = _a.h,\n        s = _a.s,\n        l = _a.l,\n        a = _a.a;\n    var isDark = l < 0.5;\n    var isNeutral = l < 0.2 || s < 0.24;\n    var hx = h;\n    var sx = s;\n\n    if (isNeutral) {\n      if (isDark) {\n        hx = poleFg.h;\n        sx = poleFg.s;\n      } else {\n        hx = poleBg.h;\n        sx = poleBg.s;\n      }\n    }\n\n    var lx = scale(l, 0, 1, 0.5, 0.2);\n    return {\n      h: hx,\n      s: sx,\n      l: lx,\n      a: a\n    };\n  }\n\n  function modifyBorderColor(rgb, theme) {\n    if (theme.mode === 0) {\n      return modifyLightSchemeColor(rgb, theme);\n    }\n\n    var poleFg = getFgPole(theme);\n    var poleBg = getBgPole(theme);\n    return modifyColorWithCache(rgb, __assign(__assign({}, theme), {\n      mode: 0\n    }), modifyBorderHSL, poleFg, poleBg);\n  }\n\n  function modifyShadowColor(rgb, filter) {\n    return modifyBackgroundColor(rgb, filter);\n  }\n\n  function modifyGradientColor(rgb, filter) {\n    return modifyBackgroundColor(rgb, filter);\n  }\n\n  function createTextStyle(config) {\n    var lines = [];\n    lines.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*=\"vjs-\"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*=\"mu-\"], .glyphicon, .icon) {');\n\n    if (config.useFont && config.fontFamily) {\n      lines.push(\"  font-family: \" + config.fontFamily + \" !important;\");\n    }\n\n    if (config.textStroke > 0) {\n      lines.push(\"  -webkit-text-stroke: \" + config.textStroke + \"px !important;\");\n      lines.push(\"  text-stroke: \" + config.textStroke + \"px !important;\");\n    }\n\n    lines.push('}');\n    return lines.join('\\n');\n  }\n\n  var FilterMode;\n\n  (function (FilterMode) {\n    FilterMode[FilterMode[\"light\"] = 0] = \"light\";\n    FilterMode[FilterMode[\"dark\"] = 1] = \"dark\";\n  })(FilterMode || (FilterMode = {}));\n\n  function getCSSFilterValue(config) {\n    var filters = [];\n\n    if (config.mode === FilterMode.dark) {\n      filters.push('invert(100%) hue-rotate(180deg)');\n    }\n\n    if (config.brightness !== 100) {\n      filters.push(\"brightness(\" + config.brightness + \"%)\");\n    }\n\n    if (config.contrast !== 100) {\n      filters.push(\"contrast(\" + config.contrast + \"%)\");\n    }\n\n    if (config.grayscale !== 0) {\n      filters.push(\"grayscale(\" + config.grayscale + \"%)\");\n    }\n\n    if (config.sepia !== 0) {\n      filters.push(\"sepia(\" + config.sepia + \"%)\");\n    }\n\n    if (filters.length === 0) {\n      return null;\n    }\n\n    return filters.join(' ');\n  }\n\n  function toSVGMatrix(matrix) {\n    return matrix.slice(0, 4).map(function (m) {\n      return m.map(function (m) {\n        return m.toFixed(3);\n      }).join(' ');\n    }).join(' ');\n  }\n\n  function getSVGFilterMatrixValue(config) {\n    return toSVGMatrix(createFilterMatrix(config));\n  }\n\n  var counter = 0;\n  var resolvers$1 = new Map();\n  var rejectors = new Map();\n\n  function bgFetch(request) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var id = ++counter;\n          resolvers$1.set(id, resolve);\n          rejectors.set(id, reject);\n          chrome.runtime.sendMessage({\n            type: MessageType.CS_FETCH,\n            data: request,\n            id: id\n          });\n        })];\n      });\n    });\n  }\n\n  chrome.runtime.onMessage.addListener(function (_a) {\n    var type = _a.type,\n        data = _a.data,\n        error = _a.error,\n        id = _a.id;\n\n    if (type === MessageType.BG_FETCH_RESPONSE) {\n      var resolve = resolvers$1.get(id);\n      var reject = rejectors.get(id);\n      resolvers$1.delete(id);\n      rejectors.delete(id);\n\n      if (error) {\n        reject && reject(error);\n      } else {\n        resolve && resolve(data);\n      }\n    }\n  });\n\n  var AsyncQueue = function () {\n    function AsyncQueue() {\n      this.queue = [];\n      this.timerId = null;\n      this.frameDuration = 1000 / 60;\n    }\n\n    AsyncQueue.prototype.addToQueue = function (entry) {\n      this.queue.push(entry);\n      this.startQueue();\n    };\n\n    AsyncQueue.prototype.stopQueue = function () {\n      if (this.timerId !== null) {\n        cancelAnimationFrame(this.timerId);\n        this.timerId = null;\n      }\n\n      this.queue = [];\n    };\n\n    AsyncQueue.prototype.startQueue = function () {\n      var _this = this;\n\n      if (this.timerId) {\n        return;\n      }\n\n      this.timerId = requestAnimationFrame(function () {\n        _this.timerId = null;\n        var start = Date.now();\n        var cb;\n\n        while (cb = _this.queue.shift()) {\n          cb();\n\n          if (Date.now() - start >= _this.frameDuration) {\n            _this.startQueue();\n\n            break;\n          }\n        }\n      });\n    };\n\n    return AsyncQueue;\n  }();\n\n  var imageManager = new AsyncQueue();\n\n  function getImageDetails(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var dataURL, error_1, image_1, error_2;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  if (!url.startsWith('data:')) return [3, 1];\n                  dataURL = url;\n                  return [3, 4];\n\n                case 1:\n                  _a.trys.push([1, 3,, 4]);\n\n                  return [4, getImageDataURL(url)];\n\n                case 2:\n                  dataURL = _a.sent();\n                  return [3, 4];\n\n                case 3:\n                  error_1 = _a.sent();\n                  reject(error_1);\n                  return [3, 4];\n\n                case 4:\n                  _a.trys.push([4, 6,, 7]);\n\n                  return [4, urlToImage(dataURL)];\n\n                case 5:\n                  image_1 = _a.sent();\n                  imageManager.addToQueue(function () {\n                    resolve(__assign({\n                      src: url,\n                      dataURL: dataURL,\n                      width: image_1.naturalWidth,\n                      height: image_1.naturalHeight\n                    }, analyzeImage(image_1)));\n                  });\n                  return [3, 7];\n\n                case 6:\n                  error_2 = _a.sent();\n                  reject(error_2);\n                  return [3, 7];\n\n                case 7:\n                  return [2];\n              }\n            });\n          });\n        })];\n      });\n    });\n  }\n\n  function getImageDataURL(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      var parsedURL;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            parsedURL = new URL(url);\n            if (!(parsedURL.origin === location.origin)) return [3, 2];\n            return [4, loadAsDataURL(url)];\n\n          case 1:\n            return [2, _a.sent()];\n\n          case 2:\n            return [4, bgFetch({\n              url: url,\n              responseType: 'data-url'\n            })];\n\n          case 3:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function urlToImage(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var image = new Image();\n\n          image.onload = function () {\n            return resolve(image);\n          };\n\n          image.onerror = function () {\n            return reject(\"Unable to load image \" + url);\n          };\n\n          image.src = url;\n        })];\n      });\n    });\n  }\n\n  var MAX_ANALIZE_PIXELS_COUNT = 32 * 32;\n  var canvas;\n  var context;\n\n  function createCanvas() {\n    var maxWidth = MAX_ANALIZE_PIXELS_COUNT;\n    var maxHeight = MAX_ANALIZE_PIXELS_COUNT;\n    canvas = document.createElement('canvas');\n    canvas.width = maxWidth;\n    canvas.height = maxHeight;\n    context = canvas.getContext('2d');\n    context.imageSmoothingEnabled = false;\n  }\n\n  function removeCanvas() {\n    canvas = null;\n    context = null;\n  }\n\n  var MAX_IMAGE_SIZE = 5 * 1024 * 1024;\n\n  function analyzeImage(image) {\n    if (!canvas) {\n      createCanvas();\n    }\n\n    var naturalWidth = image.naturalWidth,\n        naturalHeight = image.naturalHeight;\n\n    if (naturalHeight === 0 || naturalWidth === 0) {\n      logWarn(\"logWarn(Image is empty \" + image.currentSrc + \")\");\n      return null;\n    }\n\n    var size = naturalWidth * naturalHeight * 4;\n\n    if (size > MAX_IMAGE_SIZE) {\n      logInfo('Skipped large image analyzing(Larger than 5mb in memory)');\n      return {\n        isDark: false,\n        isLight: false,\n        isTransparent: false,\n        isLarge: false,\n        isTooLarge: true\n      };\n    }\n\n    var naturalPixelsCount = naturalWidth * naturalHeight;\n    var k = Math.min(1, Math.sqrt(MAX_ANALIZE_PIXELS_COUNT / naturalPixelsCount));\n    var width = Math.ceil(naturalWidth * k);\n    var height = Math.ceil(naturalHeight * k);\n    context.clearRect(0, 0, width, height);\n    context.drawImage(image, 0, 0, naturalWidth, naturalHeight, 0, 0, width, height);\n    var imageData = context.getImageData(0, 0, width, height);\n    var d = imageData.data;\n    var TRANSPARENT_ALPHA_THRESHOLD = 0.05;\n    var DARK_LIGHTNESS_THRESHOLD = 0.4;\n    var LIGHT_LIGHTNESS_THRESHOLD = 0.7;\n    var transparentPixelsCount = 0;\n    var darkPixelsCount = 0;\n    var lightPixelsCount = 0;\n    var i, x, y;\n    var r, g, b, a;\n    var l;\n\n    for (y = 0; y < height; y++) {\n      for (x = 0; x < width; x++) {\n        i = 4 * (y * width + x);\n        r = d[i + 0] / 255;\n        g = d[i + 1] / 255;\n        b = d[i + 2] / 255;\n        a = d[i + 3] / 255;\n\n        if (a < TRANSPARENT_ALPHA_THRESHOLD) {\n          transparentPixelsCount++;\n        } else {\n          l = 0.2126 * r + 0.7152 * g + 0.0722 * b;\n\n          if (l < DARK_LIGHTNESS_THRESHOLD) {\n            darkPixelsCount++;\n          }\n\n          if (l > LIGHT_LIGHTNESS_THRESHOLD) {\n            lightPixelsCount++;\n          }\n        }\n      }\n    }\n\n    var totalPixelsCount = width * height;\n    var opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\n    var DARK_IMAGE_THRESHOLD = 0.7;\n    var LIGHT_IMAGE_THRESHOLD = 0.7;\n    var TRANSPARENT_IMAGE_THRESHOLD = 0.1;\n    var LARGE_IMAGE_PIXELS_COUNT = 800 * 600;\n    return {\n      isDark: darkPixelsCount / opaquePixelsCount >= DARK_IMAGE_THRESHOLD,\n      isLight: lightPixelsCount / opaquePixelsCount >= LIGHT_IMAGE_THRESHOLD,\n      isTransparent: transparentPixelsCount / totalPixelsCount >= TRANSPARENT_IMAGE_THRESHOLD,\n      isLarge: naturalPixelsCount >= LARGE_IMAGE_PIXELS_COUNT,\n      isTooLarge: false\n    };\n  }\n\n  function getFilteredImageDataURL(_a, theme) {\n    var dataURL = _a.dataURL,\n        width = _a.width,\n        height = _a.height;\n    var matrix = getSVGFilterMatrixValue(theme);\n    var svg = [\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\">\", '<defs>', '<filter id=\"darkreader-image-filter\">', \"<feColorMatrix type=\\\"matrix\\\" values=\\\"\" + matrix + \"\\\" />\", '</filter>', '</defs>', \"<image width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\" filter=\\\"url(#darkreader-image-filter)\\\" xlink:href=\\\"\" + dataURL + \"\\\" />\", '</svg>'].join('');\n    return \"data:image/svg+xml;base64,\" + btoa(svg);\n  }\n\n  function cleanImageProcessingCache() {\n    imageManager && imageManager.stopQueue();\n    removeCanvas();\n  }\n\n  function getPriority(ruleStyle, property) {\n    return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\n  }\n\n  function getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageSelectors, isCancelled) {\n    if (property.startsWith('--')) {\n      var modifier = getVariableModifier(variablesStore, property, value, rule, ignoreImageSelectors, isCancelled);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (value.includes('var(')) {\n      var modifier = getVariableDependantModifier(variablesStore, property, value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property.includes('color') && property !== '-webkit-print-color-adjust' || property === 'fill' || property === 'stroke' || property === 'stop-color') {\n      var modifier = getColorModifier(property, value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property === 'background-image' || property === 'list-style-image') {\n      var modifier = getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    } else if (property.includes('shadow')) {\n      var modifier = getShadowModifier(value);\n\n      if (modifier) {\n        return {\n          property: property,\n          value: modifier,\n          important: getPriority(rule.style, property),\n          sourceValue: value\n        };\n      }\n    }\n\n    return null;\n  }\n\n  function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\n    var lines = [];\n\n    if (!isIFrame) {\n      lines.push('html {');\n      lines.push(\"    background-color: \" + modifyBackgroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, theme) + \" !important;\");\n      lines.push('}');\n    }\n\n    lines.push(\"\" + (isIFrame ? '' : 'html, body, ') + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 255,\n      g: 255,\n      b: 255\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push(\"html, body, \" + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 76,\n      g: 76,\n      b: 76\n    }, theme) + \";\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('a {');\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 64,\n      b: 255\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('table {');\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 128,\n      g: 128,\n      b: 128\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('::placeholder {');\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 169,\n      g: 169,\n      b: 169\n    }, theme) + \";\");\n    lines.push('}');\n    lines.push('input:-webkit-autofill,');\n    lines.push('textarea:-webkit-autofill,');\n    lines.push('select:-webkit-autofill {');\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 250,\n      g: 255,\n      b: 189\n    }, theme) + \" !important;\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, theme) + \" !important;\");\n    lines.push('}');\n\n    if (theme.scrollbarColor) {\n      lines.push(getModifiedScrollbarStyle(theme));\n    }\n\n    if (theme.selectionColor) {\n      lines.push(getModifiedSelectionStyle(theme));\n    }\n\n    return lines.join('\\n');\n  }\n\n  function getSelectionColor(theme) {\n    var backgroundColorSelection;\n    var foregroundColorSelection;\n\n    if (theme.selectionColor === 'auto') {\n      backgroundColorSelection = modifyBackgroundColor({\n        r: 0,\n        g: 96,\n        b: 212\n      }, __assign(__assign({}, theme), {\n        grayscale: 0\n      }));\n      foregroundColorSelection = modifyForegroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, __assign(__assign({}, theme), {\n        grayscale: 0\n      }));\n    } else {\n      var rgb = parse(theme.selectionColor);\n      var hsl = rgbToHSL(rgb);\n      backgroundColorSelection = theme.selectionColor;\n\n      if (hsl.l < 0.5) {\n        foregroundColorSelection = '#FFF';\n      } else {\n        foregroundColorSelection = '#000';\n      }\n    }\n\n    return {\n      backgroundColorSelection: backgroundColorSelection,\n      foregroundColorSelection: foregroundColorSelection\n    };\n  }\n\n  function getModifiedSelectionStyle(theme) {\n    var lines = [];\n    var modifiedSelectionColor = getSelectionColor(theme);\n    var backgroundColorSelection = modifiedSelectionColor.backgroundColorSelection;\n    var foregroundColorSelection = modifiedSelectionColor.foregroundColorSelection;\n    ['::selection', '::-moz-selection'].forEach(function (selection) {\n      lines.push(selection + \" {\");\n      lines.push(\"    background-color: \" + backgroundColorSelection + \" !important;\");\n      lines.push(\"    color: \" + foregroundColorSelection + \" !important;\");\n      lines.push('}');\n    });\n    return lines.join('\\n');\n  }\n\n  function getModifiedScrollbarStyle(theme) {\n    var lines = [];\n    var colorTrack;\n    var colorIcons;\n    var colorThumb;\n    var colorThumbHover;\n    var colorThumbActive;\n    var colorCorner;\n\n    if (theme.scrollbarColor === 'auto') {\n      colorTrack = modifyBackgroundColor({\n        r: 241,\n        g: 241,\n        b: 241\n      }, theme);\n      colorIcons = modifyForegroundColor({\n        r: 96,\n        g: 96,\n        b: 96\n      }, theme);\n      colorThumb = modifyBackgroundColor({\n        r: 176,\n        g: 176,\n        b: 176\n      }, theme);\n      colorThumbHover = modifyBackgroundColor({\n        r: 144,\n        g: 144,\n        b: 144\n      }, theme);\n      colorThumbActive = modifyBackgroundColor({\n        r: 96,\n        g: 96,\n        b: 96\n      }, theme);\n      colorCorner = modifyBackgroundColor({\n        r: 255,\n        g: 255,\n        b: 255\n      }, theme);\n    } else {\n      var rgb = parse(theme.scrollbarColor);\n      var hsl_1 = rgbToHSL(rgb);\n      var isLight = hsl_1.l > 0.5;\n\n      var lighten = function (lighter) {\n        return __assign(__assign({}, hsl_1), {\n          l: clamp(hsl_1.l + lighter, 0, 1)\n        });\n      };\n\n      var darken = function (darker) {\n        return __assign(__assign({}, hsl_1), {\n          l: clamp(hsl_1.l - darker, 0, 1)\n        });\n      };\n\n      colorTrack = hslToString(darken(0.4));\n      colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\n      colorThumb = hslToString(hsl_1);\n      colorThumbHover = hslToString(lighten(0.1));\n      colorThumbActive = hslToString(lighten(0.2));\n    }\n\n    lines.push('::-webkit-scrollbar {');\n    lines.push(\"    background-color: \" + colorTrack + \";\");\n    lines.push(\"    color: \" + colorIcons + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb {');\n    lines.push(\"    background-color: \" + colorThumb + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb:hover {');\n    lines.push(\"    background-color: \" + colorThumbHover + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-thumb:active {');\n    lines.push(\"    background-color: \" + colorThumbActive + \";\");\n    lines.push('}');\n    lines.push('::-webkit-scrollbar-corner {');\n    lines.push(\"    background-color: \" + colorCorner + \";\");\n    lines.push('}');\n\n    if (isFirefox) {\n      lines.push('* {');\n      lines.push(\"    scrollbar-color: \" + colorThumb + \" \" + colorTrack + \";\");\n      lines.push('}');\n    }\n\n    return lines.join('\\n');\n  }\n\n  function getModifiedFallbackStyle(filter, _a) {\n    var strict = _a.strict;\n    var lines = [];\n    lines.push(\"html, body, \" + (strict ? 'body :not(iframe)' : 'body > :not(iframe)') + \" {\");\n    lines.push(\"    background-color: \" + modifyBackgroundColor({\n      r: 255,\n      g: 255,\n      b: 255\n    }, filter) + \" !important;\");\n    lines.push(\"    border-color: \" + modifyBorderColor({\n      r: 64,\n      g: 64,\n      b: 64\n    }, filter) + \" !important;\");\n    lines.push(\"    color: \" + modifyForegroundColor({\n      r: 0,\n      g: 0,\n      b: 0\n    }, filter) + \" !important;\");\n    lines.push('}');\n    return lines.join('\\n');\n  }\n\n  var unparsableColors = new Set(['inherit', 'transparent', 'initial', 'currentcolor', 'none', 'unset']);\n  var colorParseCache = new Map();\n\n  function parseColorWithCache($color) {\n    $color = $color.trim();\n\n    if (colorParseCache.has($color)) {\n      return colorParseCache.get($color);\n    }\n\n    var color = parse($color);\n    colorParseCache.set($color, color);\n    return color;\n  }\n\n  function tryParseColor($color) {\n    try {\n      return parseColorWithCache($color);\n    } catch (err) {\n      return null;\n    }\n  }\n\n  function getColorModifier(prop, value) {\n    if (unparsableColors.has(value.toLowerCase())) {\n      return value;\n    }\n\n    try {\n      var rgb_1 = parseColorWithCache(value);\n\n      if (prop.includes('background')) {\n        return function (filter) {\n          return modifyBackgroundColor(rgb_1, filter);\n        };\n      }\n\n      if (prop.includes('border') || prop.includes('outline')) {\n        return function (filter) {\n          return modifyBorderColor(rgb_1, filter);\n        };\n      }\n\n      return function (filter) {\n        return modifyForegroundColor(rgb_1, filter);\n      };\n    } catch (err) {\n      logWarn('Color parse error', err);\n      return null;\n    }\n  }\n\n  var gradientRegex = /[\\-a-z]+gradient\\(([^\\(\\)]*(\\(([^\\(\\)]*(\\(.*?\\)))*[^\\(\\)]*\\))){0,15}[^\\(\\)]*\\)/g;\n  var imageDetailsCache = new Map();\n  var awaitingForImageLoading = new Map();\n\n  function shouldIgnoreImage(selectorText, selectors) {\n    if (!selectorText || selectors.length === 0) {\n      return false;\n    }\n\n    if (selectors.some(function (s) {\n      return s === '*';\n    })) {\n      return true;\n    }\n\n    var ruleSelectors = selectorText.split(/,\\s*/g);\n\n    var _loop_1 = function (i) {\n      var ignoredSelector = selectors[i];\n\n      if (ruleSelectors.some(function (s) {\n        return s === ignoredSelector;\n      })) {\n        return {\n          value: true\n        };\n      }\n    };\n\n    for (var i = 0; i < selectors.length; i++) {\n      var state_1 = _loop_1(i);\n\n      if (typeof state_1 === \"object\") return state_1.value;\n    }\n\n    return false;\n  }\n\n  function getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled) {\n    var _this = this;\n\n    try {\n      var gradients = getMatches(gradientRegex, value);\n      var urls = getMatches(cssURLRegex, value);\n\n      if (urls.length === 0 && gradients.length === 0) {\n        return value;\n      }\n\n      var getIndices = function (matches) {\n        var index = 0;\n        return matches.map(function (match) {\n          var valueIndex = value.indexOf(match, index);\n          index = valueIndex + match.length;\n          return {\n            match: match,\n            index: valueIndex\n          };\n        });\n      };\n\n      var matches_1 = getIndices(urls).map(function (i) {\n        return __assign({\n          type: 'url'\n        }, i);\n      }).concat(getIndices(gradients).map(function (i) {\n        return __assign({\n          type: 'gradient'\n        }, i);\n      })).sort(function (a, b) {\n        return a.index - b.index;\n      });\n\n      var getGradientModifier_1 = function (gradient) {\n        var match = gradient.match(/^(.*-gradient)\\((.*)\\)$/);\n        var type = match[1];\n        var content = match[2];\n        var partsRegex = /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?[^\\(\\),]*),?/g;\n        var colorStopRegex = /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\n        var parts = getMatches(partsRegex, content, 1).map(function (part) {\n          part = part.trim();\n          var rgb = tryParseColor(part);\n\n          if (rgb) {\n            return function (filter) {\n              return modifyGradientColor(rgb, filter);\n            };\n          }\n\n          var space = part.lastIndexOf(' ');\n          rgb = tryParseColor(part.substring(0, space));\n\n          if (rgb) {\n            return function (filter) {\n              return modifyGradientColor(rgb, filter) + \" \" + part.substring(space + 1);\n            };\n          }\n\n          var colorStopMatch = part.match(colorStopRegex);\n\n          if (colorStopMatch) {\n            rgb = tryParseColor(colorStopMatch[3]);\n\n            if (rgb) {\n              return function (filter) {\n                return colorStopMatch[1] + \"(\" + (colorStopMatch[2] ? colorStopMatch[2] + \", \" : '') + modifyGradientColor(rgb, filter) + \")\";\n              };\n            }\n          }\n\n          return function () {\n            return part;\n          };\n        });\n        return function (filter) {\n          return type + \"(\" + parts.map(function (modify) {\n            return modify(filter);\n          }).join(', ') + \")\";\n        };\n      };\n\n      var getURLModifier_1 = function (urlValue) {\n        var _a;\n\n        if (shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)) {\n          return null;\n        }\n\n        var url = getCSSURLValue(urlValue);\n        var parentStyleSheet = rule.parentStyleSheet;\n        var baseURL = parentStyleSheet && parentStyleSheet.href ? getCSSBaseBath(parentStyleSheet.href) : ((_a = parentStyleSheet.ownerNode) === null || _a === void 0 ? void 0 : _a.baseURI) || location.origin;\n        url = getAbsoluteURL(baseURL, url);\n        var absoluteValue = \"url(\\\"\" + url + \"\\\")\";\n        return function (filter) {\n          return __awaiter(_this, void 0, void 0, function () {\n            var imageDetails, awaiters_1, err_1, bgImageValue;\n            return __generator(this, function (_a) {\n              switch (_a.label) {\n                case 0:\n                  if (!imageDetailsCache.has(url)) return [3, 1];\n                  imageDetails = imageDetailsCache.get(url);\n                  return [3, 7];\n\n                case 1:\n                  _a.trys.push([1, 6,, 7]);\n\n                  if (!awaitingForImageLoading.has(url)) return [3, 3];\n                  awaiters_1 = awaitingForImageLoading.get(url);\n                  return [4, new Promise(function (resolve) {\n                    return awaiters_1.push(resolve);\n                  })];\n\n                case 2:\n                  imageDetails = _a.sent();\n\n                  if (!imageDetails) {\n                    return [2, null];\n                  }\n\n                  return [3, 5];\n\n                case 3:\n                  awaitingForImageLoading.set(url, []);\n                  return [4, getImageDetails(url)];\n\n                case 4:\n                  imageDetails = _a.sent();\n                  imageDetailsCache.set(url, imageDetails);\n                  awaitingForImageLoading.get(url).forEach(function (resolve) {\n                    return resolve(imageDetails);\n                  });\n                  awaitingForImageLoading.delete(url);\n                  _a.label = 5;\n\n                case 5:\n                  if (isCancelled()) {\n                    return [2, null];\n                  }\n\n                  return [3, 7];\n\n                case 6:\n                  err_1 = _a.sent();\n                  logWarn(err_1);\n\n                  if (awaitingForImageLoading.has(url)) {\n                    awaitingForImageLoading.get(url).forEach(function (resolve) {\n                      return resolve(null);\n                    });\n                    awaitingForImageLoading.delete(url);\n                  }\n\n                  return [2, absoluteValue];\n\n                case 7:\n                  bgImageValue = getBgImageValue_1(imageDetails, filter) || absoluteValue;\n                  return [2, bgImageValue];\n              }\n            });\n          });\n        };\n      };\n\n      var getBgImageValue_1 = function (imageDetails, filter) {\n        var isDark = imageDetails.isDark,\n            isLight = imageDetails.isLight,\n            isTransparent = imageDetails.isTransparent,\n            isLarge = imageDetails.isLarge,\n            isTooLarge = imageDetails.isTooLarge,\n            width = imageDetails.width;\n        var result;\n\n        if (isTooLarge) {\n          result = \"url(\\\"\" + imageDetails.src + \"\\\")\";\n        } else if (isDark && isTransparent && filter.mode === 1 && !isLarge && width > 2) {\n          logInfo(\"Inverting dark image \" + imageDetails.src);\n          var inverted = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), {\n            sepia: clamp(filter.sepia + 10, 0, 100)\n          }));\n          result = \"url(\\\"\" + inverted + \"\\\")\";\n        } else if (isLight && !isTransparent && filter.mode === 1) {\n          if (isLarge) {\n            result = 'none';\n          } else {\n            logInfo(\"Dimming light image \" + imageDetails.src);\n            var dimmed = getFilteredImageDataURL(imageDetails, filter);\n            result = \"url(\\\"\" + dimmed + \"\\\")\";\n          }\n        } else if (filter.mode === 0 && isLight && !isLarge) {\n          logInfo(\"Applying filter to image \" + imageDetails.src);\n          var filtered = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), {\n            brightness: clamp(filter.brightness - 10, 5, 200),\n            sepia: clamp(filter.sepia + 10, 0, 100)\n          }));\n          result = \"url(\\\"\" + filtered + \"\\\")\";\n        } else {\n          result = null;\n        }\n\n        return result;\n      };\n\n      var modifiers_1 = [];\n      var index_1 = 0;\n      matches_1.forEach(function (_a, i) {\n        var match = _a.match,\n            type = _a.type,\n            matchStart = _a.index;\n        var prefixStart = index_1;\n        var matchEnd = matchStart + match.length;\n        index_1 = matchEnd;\n        modifiers_1.push(function () {\n          return value.substring(prefixStart, matchStart);\n        });\n        modifiers_1.push(type === 'url' ? getURLModifier_1(match) : getGradientModifier_1(match));\n\n        if (i === matches_1.length - 1) {\n          modifiers_1.push(function () {\n            return value.substring(matchEnd);\n          });\n        }\n      });\n      return function (filter) {\n        var results = modifiers_1.filter(Boolean).map(function (modify) {\n          return modify(filter);\n        });\n\n        if (results.some(function (r) {\n          return r instanceof Promise;\n        })) {\n          return Promise.all(results).then(function (asyncResults) {\n            return asyncResults.join('');\n          });\n        }\n\n        return results.join('');\n      };\n    } catch (err) {\n      logWarn(\"Unable to parse gradient \" + value, err);\n      return null;\n    }\n  }\n\n  function getShadowModifier(value) {\n    try {\n      var index_2 = 0;\n      var colorMatches_1 = getMatches(/(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/ig, value, 2);\n      var modifiers_2 = colorMatches_1.map(function (match, i) {\n        var prefixIndex = index_2;\n        var matchIndex = value.indexOf(match, index_2);\n        var matchEnd = matchIndex + match.length;\n        index_2 = matchEnd;\n        var rgb = tryParseColor(match);\n\n        if (!rgb) {\n          return function () {\n            return value.substring(prefixIndex, matchEnd);\n          };\n        }\n\n        return function (filter) {\n          return \"\" + value.substring(prefixIndex, matchIndex) + modifyShadowColor(rgb, filter) + (i === colorMatches_1.length - 1 ? value.substring(matchEnd) : '');\n        };\n      });\n      return function (filter) {\n        return modifiers_2.map(function (modify) {\n          return modify(filter);\n        }).join('');\n      };\n    } catch (err) {\n      logWarn(\"Unable to parse shadow \" + value, err);\n      return null;\n    }\n  }\n\n  function getVariableModifier(variablesStore, prop, value, rule, ignoredImgSelectors, isCancelled) {\n    return variablesStore.getModifierForVariable({\n      varName: prop,\n      sourceValue: value,\n      rule: rule,\n      ignoredImgSelectors: ignoredImgSelectors,\n      isCancelled: isCancelled\n    });\n  }\n\n  function getVariableDependantModifier(variablesStore, prop, value) {\n    return variablesStore.getModifierForVarDependant(prop, value);\n  }\n\n  function cleanModificationCache() {\n    colorParseCache.clear();\n    clearColorModificationCache();\n    imageDetailsCache.clear();\n    cleanImageProcessingCache();\n    awaitingForImageLoading.clear();\n  }\n\n  var VAR_TYPE_BGCOLOR = 1 << 0;\n  var VAR_TYPE_TEXTCOLOR = 1 << 1;\n  var VAR_TYPE_BORDERCOLOR = 1 << 2;\n  var VAR_TYPE_BGIMG = 1 << 3;\n\n  var VariablesStore = function () {\n    function VariablesStore() {\n      this.varTypes = new Map();\n      this.rulesQueue = [];\n      this.definedVars = new Set();\n      this.varRefs = new Map();\n      this.unknownColorVars = new Set();\n      this.unknownBgVars = new Set();\n      this.undefinedVars = new Set();\n      this.initialVarTypes = new Map();\n      this.changedTypeVars = new Set();\n      this.typeChangeSubscriptions = new Map();\n      this.unstableVarValues = new Map();\n    }\n\n    VariablesStore.prototype.clear = function () {\n      this.varTypes.clear();\n      this.rulesQueue.splice(0);\n      this.definedVars.clear();\n      this.varRefs.clear();\n      this.unknownColorVars.clear();\n      this.unknownBgVars.clear();\n      this.undefinedVars.clear();\n      this.initialVarTypes.clear();\n      this.changedTypeVars.clear();\n      this.typeChangeSubscriptions.clear();\n      this.unstableVarValues.clear();\n    };\n\n    VariablesStore.prototype.isVarType = function (varName, typeNum) {\n      return this.varTypes.has(varName) && (this.varTypes.get(varName) & typeNum) > 0;\n    };\n\n    VariablesStore.prototype.addRulesForMatching = function (rules) {\n      this.rulesQueue.push(rules);\n    };\n\n    VariablesStore.prototype.matchVariablesAndDependants = function () {\n      var _this = this;\n\n      this.changedTypeVars.clear();\n      this.initialVarTypes = new Map(this.varTypes);\n      this.collectRootVariables();\n      this.collectVariablesAndVarDep(this.rulesQueue);\n      this.rulesQueue.splice(0);\n      this.collectRootVarDependants();\n      this.varRefs.forEach(function (refs, v) {\n        refs.forEach(function (r) {\n          if (_this.varTypes.has(v)) {\n            _this.resolveVariableType(r, _this.varTypes.get(v));\n          }\n        });\n      });\n      this.unknownColorVars.forEach(function (v) {\n        if (_this.unknownBgVars.has(v)) {\n          _this.unknownColorVars.delete(v);\n\n          _this.unknownBgVars.delete(v);\n\n          _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\n        } else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR)) {\n          _this.unknownColorVars.delete(v);\n        } else {\n          _this.undefinedVars.add(v);\n        }\n      });\n      this.unknownBgVars.forEach(function (v) {\n        var hasColor = _this.findVarRef(v, function (ref) {\n          return _this.unknownColorVars.has(ref) || _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR);\n        }) != null;\n\n        if (hasColor) {\n          _this.itarateVarRefs(v, function (ref) {\n            _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\n          });\n        } else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\n          _this.unknownBgVars.delete(v);\n        } else {\n          _this.undefinedVars.add(v);\n        }\n      });\n      this.changedTypeVars.forEach(function (varName) {\n        if (_this.typeChangeSubscriptions.has(varName)) {\n          _this.typeChangeSubscriptions.get(varName).forEach(function (callback) {\n            callback();\n          });\n        }\n      });\n      this.changedTypeVars.clear();\n    };\n\n    VariablesStore.prototype.getModifierForVariable = function (options) {\n      var _this = this;\n\n      return function (theme) {\n        var varName = options.varName,\n            sourceValue = options.sourceValue,\n            rule = options.rule,\n            ignoredImgSelectors = options.ignoredImgSelectors,\n            isCancelled = options.isCancelled;\n\n        var getDeclarations = function () {\n          var declarations = [];\n\n          var addModifiedValue = function (typeNum, varNameWrapper, colorModifier) {\n            if (!_this.isVarType(varName, typeNum)) {\n              return;\n            }\n\n            var property = varNameWrapper(varName);\n            var modifiedValue;\n\n            if (isVarDependant(sourceValue)) {\n              if (isConstructedColorVar(sourceValue)) {\n                var value = insertVarValues(sourceValue, _this.unstableVarValues);\n\n                if (!value) {\n                  value = typeNum === VAR_TYPE_BGCOLOR ? '#ffffff' : '#000000';\n                }\n\n                modifiedValue = colorModifier(value, theme);\n              } else {\n                modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) {\n                  return varNameWrapper(v);\n                }, function (fallback) {\n                  return colorModifier(fallback, theme);\n                });\n              }\n            } else {\n              modifiedValue = colorModifier(sourceValue, theme);\n            }\n\n            declarations.push({\n              property: property,\n              value: modifiedValue\n            });\n          };\n\n          addModifiedValue(VAR_TYPE_BGCOLOR, wrapBgColorVariableName, tryModifyBgColor);\n          addModifiedValue(VAR_TYPE_TEXTCOLOR, wrapTextColorVariableName, tryModifyTextColor);\n          addModifiedValue(VAR_TYPE_BORDERCOLOR, wrapBorderColorVariableName, tryModifyBorderColor);\n\n          if (_this.isVarType(varName, VAR_TYPE_BGIMG)) {\n            var property = wrapBgImgVariableName(varName);\n            var modifiedValue = sourceValue;\n\n            if (isVarDependant(sourceValue)) {\n              modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) {\n                return wrapBgColorVariableName(v);\n              }, function (fallback) {\n                return tryModifyBgColor(fallback, theme);\n              });\n            }\n\n            var bgModifier = getBgImageModifier(modifiedValue, rule, ignoredImgSelectors, isCancelled);\n            modifiedValue = typeof bgModifier === 'function' ? bgModifier(theme) : bgModifier;\n            declarations.push({\n              property: property,\n              value: modifiedValue\n            });\n          }\n\n          return declarations;\n        };\n\n        var callbacks = new Set();\n\n        var addListener = function (onTypeChange) {\n          var callback = function () {\n            var decs = getDeclarations();\n            onTypeChange(decs);\n          };\n\n          callbacks.add(callback);\n\n          _this.subscribeForVarTypeChange(varName, callback);\n        };\n\n        var removeListeners = function () {\n          callbacks.forEach(function (callback) {\n            _this.unsubscribeFromVariableTypeChanges(varName, callback);\n          });\n        };\n\n        return {\n          declarations: getDeclarations(),\n          onTypeChange: {\n            addListener: addListener,\n            removeListeners: removeListeners\n          }\n        };\n      };\n    };\n\n    VariablesStore.prototype.getModifierForVarDependant = function (property, sourceValue) {\n      var _this = this;\n\n      if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\n        var isBg_1 = property.startsWith('background');\n        var isText_1 = property === 'color' || property === 'caret-color';\n        return function (theme) {\n          var value = insertVarValues(sourceValue, _this.unstableVarValues);\n\n          if (!value) {\n            value = isBg_1 ? '#ffffff' : '#000000';\n          }\n\n          var modifier = isBg_1 ? tryModifyBgColor : isText_1 ? tryModifyTextColor : tryModifyBorderColor;\n          return modifier(value, theme);\n        };\n      }\n\n      if (property === 'background-color') {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapBgColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyBgColor(fallback, theme);\n          });\n        };\n      }\n\n      if (property === 'color' || property === 'caret-color') {\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapTextColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyTextColor(fallback, theme);\n          });\n        };\n      }\n\n      if (property === 'background' || property === 'background-image' || property === 'box-shadow') {\n        return function (theme) {\n          var unknownVars = new Set();\n\n          var modify = function () {\n            var variableReplaced = replaceCSSVariablesNames(sourceValue, function (v) {\n              if (_this.isVarType(v, VAR_TYPE_BGCOLOR)) {\n                return wrapBgColorVariableName(v);\n              }\n\n              if (_this.isVarType(v, VAR_TYPE_BGIMG)) {\n                return wrapBgImgVariableName(v);\n              }\n\n              unknownVars.add(v);\n              return v;\n            }, function (fallback) {\n              return tryModifyBgColor(fallback, theme);\n            });\n\n            if (property === 'box-shadow') {\n              var shadowModifier = getShadowModifier(variableReplaced);\n              return shadowModifier(theme) || variableReplaced;\n            }\n\n            return variableReplaced;\n          };\n\n          var modified = modify();\n\n          if (unknownVars.size > 0) {\n            return new Promise(function (resolve) {\n              var firstUnknownVar = unknownVars.values().next().value;\n\n              var callback = function () {\n                _this.unsubscribeFromVariableTypeChanges(firstUnknownVar, callback);\n\n                var newValue = modify();\n                resolve(newValue);\n              };\n\n              _this.subscribeForVarTypeChange(firstUnknownVar, callback);\n            });\n          }\n\n          return modified;\n        };\n      }\n\n      if (property.startsWith('border') || property.startsWith('outline')) {\n        if (sourceValue.endsWith(')')) {\n          var colorTypeMatch = sourceValue.match(/((rgb|hsl)a?)\\(/);\n\n          if (colorTypeMatch) {\n            var index_1 = colorTypeMatch.index;\n            return function (theme) {\n              var value = insertVarValues(sourceValue, _this.unstableVarValues);\n\n              if (!value) {\n                return sourceValue;\n              }\n\n              var beginning = sourceValue.substring(0, index_1);\n              var color = sourceValue.substring(index_1, sourceValue.length);\n              var inserted = insertVarValues(color, _this.unstableVarValues);\n              var modified = tryModifyBorderColor(inserted, theme);\n              return \"\" + beginning + modified;\n            };\n          }\n        }\n\n        return function (theme) {\n          return replaceCSSVariablesNames(sourceValue, function (v) {\n            return wrapBorderColorVariableName(v);\n          }, function (fallback) {\n            return tryModifyTextColor(fallback, theme);\n          });\n        };\n      }\n\n      return null;\n    };\n\n    VariablesStore.prototype.subscribeForVarTypeChange = function (varName, callback) {\n      if (!this.typeChangeSubscriptions.has(varName)) {\n        this.typeChangeSubscriptions.set(varName, new Set());\n      }\n\n      var rootStore = this.typeChangeSubscriptions.get(varName);\n\n      if (!rootStore.has(callback)) {\n        rootStore.add(callback);\n      }\n    };\n\n    VariablesStore.prototype.unsubscribeFromVariableTypeChanges = function (varName, callback) {\n      if (this.typeChangeSubscriptions.has(varName)) {\n        this.typeChangeSubscriptions.get(varName).delete(callback);\n      }\n    };\n\n    VariablesStore.prototype.collectVariablesAndVarDep = function (ruleList) {\n      var _this = this;\n\n      ruleList.forEach(function (rules) {\n        iterateCSSRules(rules, function (rule) {\n          rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\n            if (isVariable(property)) {\n              _this.inspectVariable(property, value);\n            }\n\n            if (isVarDependant(value)) {\n              _this.inspectVarDependant(property, value);\n            }\n          });\n        });\n      });\n    };\n\n    VariablesStore.prototype.collectRootVariables = function () {\n      var _this = this;\n\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVariable(property)) {\n          _this.inspectVariable(property, value);\n        }\n      });\n    };\n\n    VariablesStore.prototype.inspectVariable = function (varName, value) {\n      this.unstableVarValues.set(varName, value);\n\n      if (isVarDependant(value) && isConstructedColorVar(value)) {\n        this.unknownColorVars.add(varName);\n        this.definedVars.add(varName);\n      }\n\n      if (this.definedVars.has(varName)) {\n        return;\n      }\n\n      this.definedVars.add(varName);\n      var color = tryParseColor(value);\n\n      if (color) {\n        this.unknownColorVars.add(varName);\n      } else if (value.includes('url(') || value.includes('linear-gradient(') || value.includes('radial-gradient(')) {\n        this.resolveVariableType(varName, VAR_TYPE_BGIMG);\n      }\n    };\n\n    VariablesStore.prototype.resolveVariableType = function (varName, typeNum) {\n      var initialType = this.initialVarTypes.get(varName) || 0;\n      var currentType = this.varTypes.get(varName) || 0;\n      var newType = currentType | typeNum;\n      this.varTypes.set(varName, newType);\n\n      if (newType !== initialType || this.undefinedVars.has(varName)) {\n        this.changedTypeVars.add(varName);\n        this.undefinedVars.delete(varName);\n      }\n\n      this.unknownColorVars.delete(varName);\n      this.unknownBgVars.delete(varName);\n    };\n\n    VariablesStore.prototype.collectRootVarDependants = function () {\n      var _this = this;\n\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVarDependant(value)) {\n          _this.inspectVarDependant(property, value);\n        }\n      });\n    };\n\n    VariablesStore.prototype.inspectVarDependant = function (property, value) {\n      var _this = this;\n\n      if (isVariable(property)) {\n        this.iterateVarDeps(value, function (ref) {\n          if (!_this.varRefs.has(property)) {\n            _this.varRefs.set(property, new Set());\n          }\n\n          _this.varRefs.get(property).add(ref);\n        });\n      } else if (property === 'background-color' || property === 'box-shadow') {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\n        });\n      } else if (property === 'color' || property === 'caret-color') {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR);\n        });\n      } else if (property.startsWith('border') || property.startsWith('outline')) {\n        this.iterateVarDeps(value, function (v) {\n          return _this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR);\n        });\n      } else if (property === 'background' || property === 'background-image') {\n        this.iterateVarDeps(value, function (v) {\n          if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\n            return;\n          }\n\n          var isBgColor = _this.findVarRef(v, function (ref) {\n            return _this.unknownColorVars.has(ref) || _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR);\n          }) != null;\n\n          _this.itarateVarRefs(v, function (ref) {\n            if (isBgColor) {\n              _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\n            } else {\n              _this.unknownBgVars.add(ref);\n            }\n          });\n        });\n      }\n    };\n\n    VariablesStore.prototype.iterateVarDeps = function (value, iterator) {\n      var varDeps = new Set();\n      iterateVarDependencies(value, function (v) {\n        return varDeps.add(v);\n      });\n      varDeps.forEach(function (v) {\n        return iterator(v);\n      });\n    };\n\n    VariablesStore.prototype.findVarRef = function (varName, iterator, stack) {\n      var e_1, _a;\n\n      if (stack === void 0) {\n        stack = new Set();\n      }\n\n      if (stack.has(varName)) {\n        return null;\n      }\n\n      stack.add(varName);\n      var result = iterator(varName);\n\n      if (result) {\n        return varName;\n      }\n\n      var refs = this.varRefs.get(varName);\n\n      if (!refs || refs.size === 0) {\n        return null;\n      }\n\n      try {\n        for (var refs_1 = __values(refs), refs_1_1 = refs_1.next(); !refs_1_1.done; refs_1_1 = refs_1.next()) {\n          var ref = refs_1_1.value;\n          var found = this.findVarRef(ref, iterator, stack);\n\n          if (found) {\n            return found;\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (refs_1_1 && !refs_1_1.done && (_a = refs_1.return)) _a.call(refs_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return null;\n    };\n\n    VariablesStore.prototype.itarateVarRefs = function (varName, iterator) {\n      this.findVarRef(varName, function (ref) {\n        iterator(ref);\n        return false;\n      });\n    };\n\n    VariablesStore.prototype.setOnRootVariableChange = function (callback) {\n      this.onRootVariableDefined = callback;\n    };\n\n    VariablesStore.prototype.putRootVars = function (styleElement, theme) {\n      var e_2, _a;\n\n      var _this = this;\n\n      var sheet = styleElement.sheet;\n\n      if (sheet.cssRules.length > 0) {\n        sheet.deleteRule(0);\n      }\n\n      var declarations = new Map();\n      iterateCSSDeclarations(document.documentElement.style, function (property, value) {\n        if (isVariable(property)) {\n          if (_this.isVarType(property, VAR_TYPE_BGCOLOR)) {\n            declarations.set(wrapBgColorVariableName(property), tryModifyBgColor(value, theme));\n          }\n\n          if (_this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\n            declarations.set(wrapTextColorVariableName(property), tryModifyTextColor(value, theme));\n          }\n\n          if (_this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\n            declarations.set(wrapBorderColorVariableName(property), tryModifyBorderColor(value, theme));\n          }\n\n          _this.subscribeForVarTypeChange(property, _this.onRootVariableDefined);\n        }\n      });\n      var cssLines = [];\n      cssLines.push(':root {');\n\n      try {\n        for (var declarations_1 = __values(declarations), declarations_1_1 = declarations_1.next(); !declarations_1_1.done; declarations_1_1 = declarations_1.next()) {\n          var _b = __read(declarations_1_1.value, 2),\n              property = _b[0],\n              value = _b[1];\n\n          cssLines.push(\"    \" + property + \": \" + value + \";\");\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (declarations_1_1 && !declarations_1_1.done && (_a = declarations_1.return)) _a.call(declarations_1);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n\n      cssLines.push('}');\n      var cssText = cssLines.join('\\n');\n      sheet.insertRule(cssText);\n    };\n\n    return VariablesStore;\n  }();\n\n  var variablesStore = new VariablesStore();\n\n  function getVariableRange(input, searchStart) {\n    if (searchStart === void 0) {\n      searchStart = 0;\n    }\n\n    var start = input.indexOf('var(', searchStart);\n\n    if (start >= 0) {\n      var range = getParenthesesRange(input, start + 3);\n\n      if (range) {\n        return {\n          start: start,\n          end: range.end\n        };\n      }\n\n      return null;\n    }\n  }\n\n  function getVariablesMatches(input) {\n    var ranges = [];\n    var i = 0;\n    var range;\n\n    while (range = getVariableRange(input, i)) {\n      var start = range.start,\n          end = range.end;\n      ranges.push({\n        start: start,\n        end: end,\n        value: input.substring(start, end)\n      });\n      i = range.end + 1;\n    }\n\n    return ranges;\n  }\n\n  function replaceVariablesMatches(input, replacer) {\n    var matches = getVariablesMatches(input);\n    var matchesCount = matches.length;\n\n    if (matchesCount === 0) {\n      return input;\n    }\n\n    var inputLength = input.length;\n    var replacements = matches.map(function (m) {\n      return replacer(m.value);\n    });\n    var parts = [];\n    parts.push(input.substring(0, matches[0].start));\n\n    for (var i = 0; i < matchesCount; i++) {\n      parts.push(replacements[i]);\n      var start = matches[i].end;\n      var end = i < matchesCount - 1 ? matches[i + 1].start : inputLength;\n      parts.push(input.substring(start, end));\n    }\n\n    return parts.join('');\n  }\n\n  function getVariableNameAndFallback(match) {\n    var commaIndex = match.indexOf(',');\n    var name;\n    var fallback;\n\n    if (commaIndex >= 0) {\n      name = match.substring(4, commaIndex).trim();\n      fallback = match.substring(commaIndex + 1, match.length - 1).trim();\n    } else {\n      name = match.substring(4, match.length - 1).trim();\n      fallback = '';\n    }\n\n    return {\n      name: name,\n      fallback: fallback\n    };\n  }\n\n  function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\n    var matchReplacer = function (match) {\n      var _a = getVariableNameAndFallback(match),\n          name = _a.name,\n          fallback = _a.fallback;\n\n      var newName = nameReplacer(name);\n\n      if (!fallback) {\n        return \"var(\" + newName + \")\";\n      }\n\n      var newFallback;\n\n      if (isVarDependant(fallback)) {\n        newFallback = replaceCSSVariablesNames(fallback, nameReplacer, fallbackReplacer);\n      } else if (fallbackReplacer) {\n        newFallback = fallbackReplacer(fallback);\n      } else {\n        newFallback = fallback;\n      }\n\n      return \"var(\" + newName + \", \" + newFallback + \")\";\n    };\n\n    return replaceVariablesMatches(value, matchReplacer);\n  }\n\n  function iterateVarDependencies(value, iterator) {\n    replaceCSSVariablesNames(value, function (varName) {\n      iterator(varName);\n      return varName;\n    });\n  }\n\n  function wrapBgColorVariableName(name) {\n    return \"--darkreader-bg\" + name;\n  }\n\n  function wrapTextColorVariableName(name) {\n    return \"--darkreader-text\" + name;\n  }\n\n  function wrapBorderColorVariableName(name) {\n    return \"--darkreader-border\" + name;\n  }\n\n  function wrapBgImgVariableName(name) {\n    return \"--darkreader-bgimg\" + name;\n  }\n\n  function isVariable(property) {\n    return property.startsWith('--');\n  }\n\n  function isVarDependant(value) {\n    return value.includes('var(');\n  }\n\n  function isConstructedColorVar(value) {\n    return value.match(/^\\s*(rgb|hsl)a?\\(/);\n  }\n\n  function tryModifyBgColor(color, theme) {\n    var rgb = tryParseColor(color);\n    return rgb ? modifyBackgroundColor(rgb, theme) : color;\n  }\n\n  function tryModifyTextColor(color, theme) {\n    var rgb = tryParseColor(color);\n    return rgb ? modifyForegroundColor(rgb, theme) : color;\n  }\n\n  function tryModifyBorderColor(color, theme) {\n    var rgb = tryParseColor(color);\n    return rgb ? modifyBorderColor(rgb, theme) : color;\n  }\n\n  function insertVarValues(source, varValues, stack) {\n    if (stack === void 0) {\n      stack = new Set();\n    }\n\n    var containsUnresolvedVar = false;\n\n    var matchReplacer = function (match) {\n      var _a = getVariableNameAndFallback(match),\n          name = _a.name,\n          fallback = _a.fallback;\n\n      if (stack.has(name)) {\n        containsUnresolvedVar = true;\n        return null;\n      }\n\n      stack.add(name);\n      var varValue = varValues.get(name) || fallback;\n      var inserted = null;\n\n      if (varValue) {\n        if (isVarDependant(varValue)) {\n          inserted = insertVarValues(varValue, varValues, stack);\n        } else {\n          inserted = varValue;\n        }\n      }\n\n      if (!inserted) {\n        containsUnresolvedVar = true;\n        return null;\n      }\n\n      return inserted;\n    };\n\n    var replaced = replaceVariablesMatches(source, matchReplacer);\n\n    if (containsUnresolvedVar) {\n      return null;\n    }\n\n    return replaced;\n  }\n\n  var overrides = {\n    'background-color': {\n      customProp: '--darkreader-inline-bgcolor',\n      cssProp: 'background-color',\n      dataAttr: 'data-darkreader-inline-bgcolor'\n    },\n    'background-image': {\n      customProp: '--darkreader-inline-bgimage',\n      cssProp: 'background-image',\n      dataAttr: 'data-darkreader-inline-bgimage'\n    },\n    'border-color': {\n      customProp: '--darkreader-inline-border',\n      cssProp: 'border-color',\n      dataAttr: 'data-darkreader-inline-border'\n    },\n    'border-bottom-color': {\n      customProp: '--darkreader-inline-border-bottom',\n      cssProp: 'border-bottom-color',\n      dataAttr: 'data-darkreader-inline-border-bottom'\n    },\n    'border-left-color': {\n      customProp: '--darkreader-inline-border-left',\n      cssProp: 'border-left-color',\n      dataAttr: 'data-darkreader-inline-border-left'\n    },\n    'border-right-color': {\n      customProp: '--darkreader-inline-border-right',\n      cssProp: 'border-right-color',\n      dataAttr: 'data-darkreader-inline-border-right'\n    },\n    'border-top-color': {\n      customProp: '--darkreader-inline-border-top',\n      cssProp: 'border-top-color',\n      dataAttr: 'data-darkreader-inline-border-top'\n    },\n    'box-shadow': {\n      customProp: '--darkreader-inline-boxshadow',\n      cssProp: 'box-shadow',\n      dataAttr: 'data-darkreader-inline-boxshadow'\n    },\n    'color': {\n      customProp: '--darkreader-inline-color',\n      cssProp: 'color',\n      dataAttr: 'data-darkreader-inline-color'\n    },\n    'fill': {\n      customProp: '--darkreader-inline-fill',\n      cssProp: 'fill',\n      dataAttr: 'data-darkreader-inline-fill'\n    },\n    'stroke': {\n      customProp: '--darkreader-inline-stroke',\n      cssProp: 'stroke',\n      dataAttr: 'data-darkreader-inline-stroke'\n    },\n    'outline-color': {\n      customProp: '--darkreader-inline-outline',\n      cssProp: 'outline-color',\n      dataAttr: 'data-darkreader-inline-outline'\n    },\n    'stop-color': {\n      customProp: '--darkreader-inline-stopcolor',\n      cssProp: 'stop-color',\n      dataAttr: 'data-darkreader-inline-stopcolor'\n    }\n  };\n  var overridesList = Object.values(overrides);\n  var normalizedPropList = {};\n  overridesList.forEach(function (_a) {\n    var cssProp = _a.cssProp,\n        customProp = _a.customProp;\n    return normalizedPropList[customProp] = cssProp;\n  });\n  var INLINE_STYLE_ATTRS = ['style', 'fill', 'stop-color', 'stroke', 'bgcolor', 'color'];\n  var INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(function (attr) {\n    return \"[\" + attr + \"]\";\n  }).join(', ');\n\n  function getInlineOverrideStyle() {\n    return overridesList.map(function (_a) {\n      var dataAttr = _a.dataAttr,\n          customProp = _a.customProp,\n          cssProp = _a.cssProp;\n      return [\"[\" + dataAttr + \"] {\", \"  \" + cssProp + \": var(\" + customProp + \") !important;\", '}'].join('\\n');\n    }).join('\\n');\n  }\n\n  function getInlineStyleElements(root) {\n    var results = [];\n\n    if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\n      results.push(root);\n    }\n\n    if (root instanceof Element || isShadowDomSupported && root instanceof ShadowRoot || root instanceof Document) {\n      push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\n    }\n\n    return results;\n  }\n\n  var treeObservers = new Map();\n  var attrObservers = new Map();\n\n  function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\n    deepWatchForInlineStyles(document, elementStyleDidChange, shadowRootDiscovered);\n    iterateShadowHosts(document.documentElement, function (host) {\n      deepWatchForInlineStyles(host.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\n    });\n  }\n\n  function deepWatchForInlineStyles(root, elementStyleDidChange, shadowRootDiscovered) {\n    if (treeObservers.has(root)) {\n      treeObservers.get(root).disconnect();\n      attrObservers.get(root).disconnect();\n    }\n\n    var discoveredNodes = new WeakSet();\n\n    function discoverNodes(node) {\n      getInlineStyleElements(node).forEach(function (el) {\n        if (discoveredNodes.has(el)) {\n          return;\n        }\n\n        discoveredNodes.add(el);\n        elementStyleDidChange(el);\n      });\n      iterateShadowHosts(node, function (n) {\n        if (discoveredNodes.has(node)) {\n          return;\n        }\n\n        discoveredNodes.add(node);\n        shadowRootDiscovered(n.shadowRoot);\n        deepWatchForInlineStyles(n.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\n      });\n    }\n\n    var treeObserver = createOptimizedTreeObserver(root, {\n      onMinorMutations: function (_a) {\n        var additions = _a.additions;\n        additions.forEach(function (added) {\n          return discoverNodes(added);\n        });\n      },\n      onHugeMutations: function () {\n        discoverNodes(root);\n      }\n    });\n    treeObservers.set(root, treeObserver);\n    var attemptCount = 0;\n    var start = null;\n    var ATTEMPTS_INTERVAL = getDuration({\n      seconds: 10\n    });\n    var RETRY_TIMEOUT = getDuration({\n      seconds: 2\n    });\n    var MAX_ATTEMPTS_COUNT = 50;\n    var cache = [];\n    var timeoutId = null;\n    var handleAttributeMutations = throttle(function (mutations) {\n      mutations.forEach(function (m) {\n        if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\n          elementStyleDidChange(m.target);\n        }\n      });\n    });\n    var attrObserver = new MutationObserver(function (mutations) {\n      if (timeoutId) {\n        cache.push.apply(cache, __spreadArray([], __read(mutations)));\n        return;\n      }\n\n      attemptCount++;\n      var now = Date.now();\n\n      if (start == null) {\n        start = now;\n      } else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\n        if (now - start < ATTEMPTS_INTERVAL) {\n          timeoutId = setTimeout(function () {\n            start = null;\n            attemptCount = 0;\n            timeoutId = null;\n            var attributeCache = cache;\n            cache = [];\n            handleAttributeMutations(attributeCache);\n          }, RETRY_TIMEOUT);\n          cache.push.apply(cache, __spreadArray([], __read(mutations)));\n          return;\n        }\n\n        start = now;\n        attemptCount = 1;\n      }\n\n      handleAttributeMutations(mutations);\n    });\n    attrObserver.observe(root, {\n      attributes: true,\n      attributeFilter: INLINE_STYLE_ATTRS.concat(overridesList.map(function (_a) {\n        var dataAttr = _a.dataAttr;\n        return dataAttr;\n      })),\n      subtree: true\n    });\n    attrObservers.set(root, attrObserver);\n  }\n\n  function stopWatchingForInlineStyles() {\n    treeObservers.forEach(function (o) {\n      return o.disconnect();\n    });\n    attrObservers.forEach(function (o) {\n      return o.disconnect();\n    });\n    treeObservers.clear();\n    attrObservers.clear();\n  }\n\n  var inlineStyleCache = new WeakMap();\n  var filterProps = ['brightness', 'contrast', 'grayscale', 'sepia', 'mode'];\n\n  function getInlineStyleCacheKey(el, theme) {\n    return INLINE_STYLE_ATTRS.map(function (attr) {\n      return attr + \"=\\\"\" + el.getAttribute(attr) + \"\\\"\";\n    }).concat(filterProps.map(function (prop) {\n      return prop + \"=\\\"\" + theme[prop] + \"\\\"\";\n    })).join(' ');\n  }\n\n  function shouldIgnoreInlineStyle(element, selectors) {\n    for (var i = 0, len = selectors.length; i < len; i++) {\n      var ingnoredSelector = selectors[i];\n\n      if (element.matches(ingnoredSelector)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function overrideInlineStyle(element, theme, ignoreInlineSelectors, ignoreImageSelectors) {\n    var cacheKey = getInlineStyleCacheKey(element, theme);\n\n    if (cacheKey === inlineStyleCache.get(element)) {\n      return;\n    }\n\n    var unsetProps = new Set(Object.keys(overrides));\n\n    function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\n      var _a = overrides[targetCSSProp],\n          customProp = _a.customProp,\n          dataAttr = _a.dataAttr;\n      var mod = getModifiableCSSDeclaration(modifierCSSProp, cssVal, {}, variablesStore, ignoreImageSelectors, null);\n\n      if (!mod) {\n        return;\n      }\n\n      var value = mod.value;\n\n      if (typeof value === 'function') {\n        value = value(theme);\n      }\n\n      element.style.setProperty(customProp, value);\n\n      if (!element.hasAttribute(dataAttr)) {\n        element.setAttribute(dataAttr, '');\n      }\n\n      unsetProps.delete(targetCSSProp);\n    }\n\n    if (ignoreInlineSelectors.length > 0) {\n      if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\n        unsetProps.forEach(function (cssProp) {\n          element.removeAttribute(overrides[cssProp].dataAttr);\n        });\n        return;\n      }\n    }\n\n    if (element.hasAttribute('bgcolor')) {\n      var value = element.getAttribute('bgcolor');\n\n      if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\n        value = \"#\" + value;\n      }\n\n      setCustomProp('background-color', 'background-color', value);\n    }\n\n    if (element.hasAttribute('color') && element.rel !== 'mask-icon') {\n      var value = element.getAttribute('color');\n\n      if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\n        value = \"#\" + value;\n      }\n\n      setCustomProp('color', 'color', value);\n    }\n\n    if (element instanceof SVGElement) {\n      if (element.hasAttribute('fill')) {\n        var SMALL_SVG_LIMIT_1 = 32;\n        var value_1 = element.getAttribute('fill');\n\n        if (value_1 !== 'none') {\n          if (!(element instanceof SVGTextElement)) {\n            var handleSVGElement = function () {\n              var _a = element.getBoundingClientRect(),\n                  width = _a.width,\n                  height = _a.height;\n\n              var isBg = width > SMALL_SVG_LIMIT_1 || height > SMALL_SVG_LIMIT_1;\n              setCustomProp('fill', isBg ? 'background-color' : 'color', value_1);\n            };\n\n            if (isReadyStateComplete()) {\n              handleSVGElement();\n            } else {\n              addReadyStateCompleteListener(handleSVGElement);\n            }\n          } else {\n            setCustomProp('fill', 'color', value_1);\n          }\n        }\n      }\n\n      if (element.hasAttribute('stop-color')) {\n        setCustomProp('stop-color', 'background-color', element.getAttribute('stop-color'));\n      }\n    }\n\n    if (element.hasAttribute('stroke')) {\n      var value = element.getAttribute('stroke');\n      setCustomProp('stroke', element instanceof SVGLineElement || element instanceof SVGTextElement ? 'border-color' : 'color', value);\n    }\n\n    element.style && iterateCSSDeclarations(element.style, function (property, value) {\n      if (property === 'background-image' && value.includes('url')) {\n        return;\n      }\n\n      if (overrides.hasOwnProperty(property)) {\n        setCustomProp(property, property, value);\n      } else {\n        var overridenProp = normalizedPropList[property];\n\n        if (overridenProp && !element.style.getPropertyValue(overridenProp) && !element.hasAttribute(overridenProp)) {\n          element.style.setProperty(property, '');\n        }\n      }\n    });\n\n    if (element.style && element instanceof SVGTextElement && element.style.fill) {\n      setCustomProp('fill', 'color', element.style.getPropertyValue('fill'));\n    }\n\n    forEach(unsetProps, function (cssProp) {\n      element.removeAttribute(overrides[cssProp].dataAttr);\n    });\n    inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\n  }\n\n  var metaThemeColorName = 'theme-color';\n  var metaThemeColorSelector = \"meta[name=\\\"\" + metaThemeColorName + \"\\\"]\";\n  var srcMetaThemeColor = null;\n  var observer = null;\n\n  function changeMetaThemeColor(meta, theme) {\n    srcMetaThemeColor = srcMetaThemeColor || meta.content;\n\n    try {\n      var color = parse(srcMetaThemeColor);\n      meta.content = modifyBackgroundColor(color, theme);\n    } catch (err) {\n      logWarn(err);\n    }\n  }\n\n  function changeMetaThemeColorWhenAvailable(theme) {\n    var meta = document.querySelector(metaThemeColorSelector);\n\n    if (meta) {\n      changeMetaThemeColor(meta, theme);\n    } else {\n      if (observer) {\n        observer.disconnect();\n      }\n\n      observer = new MutationObserver(function (mutations) {\n        loop: for (var i = 0; i < mutations.length; i++) {\n          var addedNodes = mutations[i].addedNodes;\n\n          for (var j = 0; j < addedNodes.length; j++) {\n            var node = addedNodes[j];\n\n            if (node instanceof HTMLMetaElement && node.name === metaThemeColorName) {\n              observer.disconnect();\n              observer = null;\n              changeMetaThemeColor(node, theme);\n              break loop;\n            }\n          }\n        }\n      });\n      observer.observe(document.head, {\n        childList: true\n      });\n    }\n  }\n\n  function restoreMetaThemeColor() {\n    if (observer) {\n      observer.disconnect();\n      observer = null;\n    }\n\n    var meta = document.querySelector(metaThemeColorSelector);\n\n    if (meta && srcMetaThemeColor) {\n      meta.content = srcMetaThemeColor;\n    }\n  }\n\n  var themeCacheKeys = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\n\n  function getThemeKey(theme) {\n    return themeCacheKeys.map(function (p) {\n      return p + \":\" + theme[p];\n    }).join(';');\n  }\n\n  var asyncQueue = createAsyncTasksQueue();\n\n  function createStyleSheetModifier() {\n    var renderId = 0;\n    var rulesTextCache = new Set();\n    var rulesModCache = new Map();\n    var varTypeChangeCleaners = new Set();\n    var prevFilterKey = null;\n    var hasNonLoadedLink = false;\n    var wasRebuilt = false;\n\n    function shouldRebuildStyle() {\n      return hasNonLoadedLink && !wasRebuilt;\n    }\n\n    function modifySheet(options) {\n      var rules = options.sourceCSSRules;\n      var theme = options.theme,\n          ignoreImageAnalysis = options.ignoreImageAnalysis,\n          force = options.force,\n          prepareSheet = options.prepareSheet,\n          isAsyncCancelled = options.isAsyncCancelled;\n      var rulesChanged = rulesModCache.size === 0;\n      var notFoundCacheKeys = new Set(rulesModCache.keys());\n      var themeKey = getThemeKey(theme);\n      var themeChanged = themeKey !== prevFilterKey;\n\n      if (hasNonLoadedLink) {\n        wasRebuilt = true;\n      }\n\n      var modRules = [];\n      iterateCSSRules(rules, function (rule) {\n        var cssText = rule.cssText;\n        var textDiffersFromPrev = false;\n        notFoundCacheKeys.delete(cssText);\n\n        if (rule.parentRule instanceof CSSMediaRule) {\n          cssText += \";\" + rule.parentRule.media.mediaText;\n        }\n\n        if (!rulesTextCache.has(cssText)) {\n          rulesTextCache.add(cssText);\n          textDiffersFromPrev = true;\n        }\n\n        if (textDiffersFromPrev) {\n          rulesChanged = true;\n        } else {\n          modRules.push(rulesModCache.get(cssText));\n          return;\n        }\n\n        var modDecs = [];\n        rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\n          var mod = getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageAnalysis, isAsyncCancelled);\n\n          if (mod) {\n            modDecs.push(mod);\n          }\n        });\n        var modRule = null;\n\n        if (modDecs.length > 0) {\n          var parentRule = rule.parentRule;\n          modRule = {\n            selector: rule.selectorText,\n            declarations: modDecs,\n            parentRule: parentRule\n          };\n          modRules.push(modRule);\n        }\n\n        rulesModCache.set(cssText, modRule);\n      }, function () {\n        hasNonLoadedLink = true;\n      });\n      notFoundCacheKeys.forEach(function (key) {\n        rulesTextCache.delete(key);\n        rulesModCache.delete(key);\n      });\n      prevFilterKey = themeKey;\n\n      if (!force && !rulesChanged && !themeChanged) {\n        return;\n      }\n\n      renderId++;\n\n      function setRule(target, index, rule) {\n        var selector = rule.selector,\n            declarations = rule.declarations;\n\n        var getDeclarationText = function (dec) {\n          var property = dec.property,\n              value = dec.value,\n              important = dec.important,\n              sourceValue = dec.sourceValue;\n          return property + \": \" + (value == null ? sourceValue : value) + (important ? ' !important' : '') + \";\";\n        };\n\n        var ruleText = selector + \" { \" + declarations.map(getDeclarationText).join(' ') + \" }\";\n        target.insertRule(ruleText, index);\n      }\n\n      var asyncDeclarations = new Map();\n      var varDeclarations = new Map();\n      var asyncDeclarationCounter = 0;\n      var varDeclarationCounter = 0;\n      var rootReadyGroup = {\n        rule: null,\n        rules: [],\n        isGroup: true\n      };\n      var groupRefs = new WeakMap();\n\n      function getGroup(rule) {\n        if (rule == null) {\n          return rootReadyGroup;\n        }\n\n        if (groupRefs.has(rule)) {\n          return groupRefs.get(rule);\n        }\n\n        var group = {\n          rule: rule,\n          rules: [],\n          isGroup: true\n        };\n        groupRefs.set(rule, group);\n        var parentGroup = getGroup(rule.parentRule);\n        parentGroup.rules.push(group);\n        return group;\n      }\n\n      varTypeChangeCleaners.forEach(function (clear) {\n        return clear();\n      });\n      varTypeChangeCleaners.clear();\n      modRules.filter(function (r) {\n        return r;\n      }).forEach(function (_a) {\n        var selector = _a.selector,\n            declarations = _a.declarations,\n            parentRule = _a.parentRule;\n        var group = getGroup(parentRule);\n        var readyStyleRule = {\n          selector: selector,\n          declarations: [],\n          isGroup: false\n        };\n        var readyDeclarations = readyStyleRule.declarations;\n        group.rules.push(readyStyleRule);\n\n        function handleAsyncDeclaration(property, modified, important, sourceValue) {\n          var asyncKey = ++asyncDeclarationCounter;\n          var asyncDeclaration = {\n            property: property,\n            value: null,\n            important: important,\n            asyncKey: asyncKey,\n            sourceValue: sourceValue\n          };\n          readyDeclarations.push(asyncDeclaration);\n          var currentRenderId = renderId;\n          modified.then(function (asyncValue) {\n            if (!asyncValue || isAsyncCancelled() || currentRenderId !== renderId) {\n              return;\n            }\n\n            asyncDeclaration.value = asyncValue;\n            asyncQueue.add(function () {\n              if (isAsyncCancelled() || currentRenderId !== renderId) {\n                return;\n              }\n\n              rebuildAsyncRule(asyncKey);\n            });\n          });\n        }\n\n        function handleVarDeclarations(property, modified, important, sourceValue) {\n          var _a = modified,\n              varDecs = _a.declarations,\n              onTypeChange = _a.onTypeChange;\n          var varKey = ++varDeclarationCounter;\n          var currentRenderId = renderId;\n          var initialIndex = readyDeclarations.length;\n          var oldDecs = [];\n\n          if (varDecs.length === 0) {\n            var tempDec = {\n              property: property,\n              value: sourceValue,\n              important: important,\n              sourceValue: sourceValue,\n              varKey: varKey\n            };\n            readyDeclarations.push(tempDec);\n            oldDecs = [tempDec];\n          }\n\n          varDecs.forEach(function (mod) {\n            if (mod.value instanceof Promise) {\n              handleAsyncDeclaration(mod.property, mod.value, important, sourceValue);\n            } else {\n              var readyDec = {\n                property: mod.property,\n                value: mod.value,\n                important: important,\n                sourceValue: sourceValue,\n                varKey: varKey\n              };\n              readyDeclarations.push(readyDec);\n              oldDecs.push(readyDec);\n            }\n          });\n          onTypeChange.addListener(function (newDecs) {\n            if (isAsyncCancelled() || currentRenderId !== renderId) {\n              return;\n            }\n\n            var readyVarDecs = newDecs.map(function (mod) {\n              return {\n                property: mod.property,\n                value: mod.value,\n                important: important,\n                sourceValue: sourceValue,\n                varKey: varKey\n              };\n            });\n            var index = readyDeclarations.indexOf(oldDecs[0], initialIndex);\n            readyDeclarations.splice.apply(readyDeclarations, __spreadArray([index, oldDecs.length], __read(readyVarDecs)));\n            oldDecs = readyVarDecs;\n            rebuildVarRule(varKey);\n          });\n          varTypeChangeCleaners.add(function () {\n            return onTypeChange.removeListeners();\n          });\n        }\n\n        declarations.forEach(function (_a) {\n          var property = _a.property,\n              value = _a.value,\n              important = _a.important,\n              sourceValue = _a.sourceValue;\n\n          if (typeof value === 'function') {\n            var modified = value(theme);\n\n            if (modified instanceof Promise) {\n              handleAsyncDeclaration(property, modified, important, sourceValue);\n            } else if (property.startsWith('--')) {\n              handleVarDeclarations(property, modified, important, sourceValue);\n            } else {\n              readyDeclarations.push({\n                property: property,\n                value: modified,\n                important: important,\n                sourceValue: sourceValue\n              });\n            }\n          } else {\n            readyDeclarations.push({\n              property: property,\n              value: value,\n              important: important,\n              sourceValue: sourceValue\n            });\n          }\n        });\n      });\n      var sheet = prepareSheet();\n\n      function buildStyleSheet() {\n        function createTarget(group, parent) {\n          var rule = group.rule;\n\n          if (rule instanceof CSSMediaRule) {\n            var media = rule.media;\n            var index = parent.cssRules.length;\n            parent.insertRule(\"@media \" + media.mediaText + \" {}\", index);\n            return parent.cssRules[index];\n          }\n\n          return parent;\n        }\n\n        function iterateReadyRules(group, target, styleIterator) {\n          group.rules.forEach(function (r) {\n            if (r.isGroup) {\n              var t = createTarget(r, target);\n              iterateReadyRules(r, t, styleIterator);\n            } else {\n              styleIterator(r, target);\n            }\n          });\n        }\n\n        iterateReadyRules(rootReadyGroup, sheet, function (rule, target) {\n          var index = target.cssRules.length;\n          rule.declarations.forEach(function (_a) {\n            var asyncKey = _a.asyncKey,\n                varKey = _a.varKey;\n\n            if (asyncKey != null) {\n              asyncDeclarations.set(asyncKey, {\n                rule: rule,\n                target: target,\n                index: index\n              });\n            }\n\n            if (varKey != null) {\n              varDeclarations.set(varKey, {\n                rule: rule,\n                target: target,\n                index: index\n              });\n            }\n          });\n          setRule(target, index, rule);\n        });\n      }\n\n      function rebuildAsyncRule(key) {\n        var _a = asyncDeclarations.get(key),\n            rule = _a.rule,\n            target = _a.target,\n            index = _a.index;\n\n        target.deleteRule(index);\n        setRule(target, index, rule);\n        asyncDeclarations.delete(key);\n      }\n\n      function rebuildVarRule(key) {\n        var _a = varDeclarations.get(key),\n            rule = _a.rule,\n            target = _a.target,\n            index = _a.index;\n\n        target.deleteRule(index);\n        setRule(target, index, rule);\n      }\n\n      buildStyleSheet();\n    }\n\n    return {\n      modifySheet: modifySheet,\n      shouldRebuildStyle: shouldRebuildStyle\n    };\n  }\n\n  var STYLE_SELECTOR = 'style, link[rel*=\"stylesheet\" i]:not([disabled])';\n\n  function shouldManageStyle(element) {\n    return (element instanceof HTMLStyleElement || element instanceof SVGStyleElement || element instanceof HTMLLinkElement && element.rel && element.rel.toLowerCase().includes('stylesheet') && !element.disabled) && !element.classList.contains('darkreader') && element.media.toLowerCase() !== 'print' && !element.classList.contains('stylus');\n  }\n\n  function getManageableStyles(node, results, deep) {\n    if (results === void 0) {\n      results = [];\n    }\n\n    if (deep === void 0) {\n      deep = true;\n    }\n\n    if (shouldManageStyle(node)) {\n      results.push(node);\n    } else if (node instanceof Element || isShadowDomSupported && node instanceof ShadowRoot || node === document) {\n      forEach(node.querySelectorAll(STYLE_SELECTOR), function (style) {\n        return getManageableStyles(style, results, false);\n      });\n\n      if (deep) {\n        iterateShadowHosts(node, function (host) {\n          return getManageableStyles(host.shadowRoot, results, false);\n        });\n      }\n    }\n\n    return results;\n  }\n\n  var syncStyleSet = new WeakSet();\n  var corsStyleSet = new WeakSet();\n  var canOptimizeUsingProxy$1 = false;\n  document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\n    canOptimizeUsingProxy$1 = true;\n  });\n  var loadingLinkCounter = 0;\n  var rejectorsForLoadingLinks = new Map();\n\n  function cleanLoadingLinks() {\n    rejectorsForLoadingLinks.clear();\n  }\n\n  function manageStyle(element, _a) {\n    var update = _a.update,\n        loadingStart = _a.loadingStart,\n        loadingEnd = _a.loadingEnd;\n    var prevStyles = [];\n    var next = element;\n\n    while ((next = next.nextElementSibling) && next.matches('.darkreader')) {\n      prevStyles.push(next);\n    }\n\n    var corsCopy = prevStyles.find(function (el) {\n      return el.matches('.darkreader--cors') && !corsStyleSet.has(el);\n    }) || null;\n    var syncStyle = prevStyles.find(function (el) {\n      return el.matches('.darkreader--sync') && !syncStyleSet.has(el);\n    }) || null;\n    var corsCopyPositionWatcher = null;\n    var syncStylePositionWatcher = null;\n    var cancelAsyncOperations = false;\n    var isOverrideEmpty = true;\n    var sheetModifier = createStyleSheetModifier();\n    var observer = new MutationObserver(function () {\n      update();\n    });\n    var observerOptions = {\n      attributes: true,\n      childList: true,\n      subtree: true,\n      characterData: true\n    };\n\n    function containsCSSImport() {\n      return element instanceof HTMLStyleElement && element.textContent.trim().match(cssImportRegex);\n    }\n\n    function hasCrossOriginImports(cssRules) {\n      var result = false;\n\n      if (cssRules) {\n        var rule = void 0;\n\n        cssRulesLoop: for (var i = 0, len = cssRules.length; i < len; i++) {\n          rule = cssRules[i];\n\n          if (rule.href) {\n            if (rule.href.startsWith('http') && !rule.href.startsWith(location.origin)) {\n              result = true;\n              break cssRulesLoop;\n            }\n          }\n        }\n      }\n\n      return result;\n    }\n\n    function getRulesSync() {\n      if (corsCopy) {\n        return corsCopy.sheet.cssRules;\n      }\n\n      if (containsCSSImport()) {\n        return null;\n      }\n\n      var cssRules = safeGetSheetRules();\n\n      if (hasCrossOriginImports(cssRules)) {\n        return null;\n      }\n\n      return cssRules;\n    }\n\n    function insertStyle() {\n      if (corsCopy) {\n        if (element.nextSibling !== corsCopy) {\n          element.parentNode.insertBefore(corsCopy, element.nextSibling);\n        }\n\n        if (corsCopy.nextSibling !== syncStyle) {\n          element.parentNode.insertBefore(syncStyle, corsCopy.nextSibling);\n        }\n      } else if (element.nextSibling !== syncStyle) {\n        element.parentNode.insertBefore(syncStyle, element.nextSibling);\n      }\n    }\n\n    function createSyncStyle() {\n      syncStyle = element instanceof SVGStyleElement ? document.createElementNS('http://www.w3.org/2000/svg', 'style') : document.createElement('style');\n      syncStyle.classList.add('darkreader');\n      syncStyle.classList.add('darkreader--sync');\n      syncStyle.media = 'screen';\n\n      if (!isChromium && element.title) {\n        syncStyle.title = element.title;\n      }\n\n      syncStyleSet.add(syncStyle);\n    }\n\n    var isLoadingRules = false;\n    var wasLoadingError = false;\n    var loadingLinkId = ++loadingLinkCounter;\n\n    function getRulesAsync() {\n      return __awaiter(this, void 0, void 0, function () {\n        var cssText, cssBasePath, _a, cssRules, accessError, err_1, crossOriginImport, fullCSSText, err_2;\n\n        var _b;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              if (!(element instanceof HTMLLinkElement)) return [3, 7];\n              _a = __read(getRulesOrError(), 2), cssRules = _a[0], accessError = _a[1];\n\n              if (accessError) {\n                logWarn(accessError);\n              }\n\n              if (!(!cssRules && !accessError && !isSafari || isSafari && !element.sheet || isStillLoadingError(accessError))) return [3, 5];\n              _c.label = 1;\n\n            case 1:\n              _c.trys.push([1, 3,, 4]);\n\n              logInfo(\"Linkelement \" + loadingLinkId + \" is not loaded yet and thus will be await for\", element);\n              return [4, linkLoading(element, loadingLinkId)];\n\n            case 2:\n              _c.sent();\n\n              return [3, 4];\n\n            case 3:\n              err_1 = _c.sent();\n              logWarn(err_1);\n              wasLoadingError = true;\n              return [3, 4];\n\n            case 4:\n              if (cancelAsyncOperations) {\n                return [2, null];\n              }\n\n              _b = __read(getRulesOrError(), 2), cssRules = _b[0], accessError = _b[1];\n\n              if (accessError) {\n                logWarn(accessError);\n              }\n\n              _c.label = 5;\n\n            case 5:\n              crossOriginImport = hasCrossOriginImports(cssRules);\n\n              if (cssRules != null && !crossOriginImport) {\n                return [2, cssRules];\n              }\n\n              return [4, loadText(element.href)];\n\n            case 6:\n              cssText = _c.sent();\n              cssBasePath = getCSSBaseBath(element.href);\n\n              if (cancelAsyncOperations) {\n                return [2, null];\n              }\n\n              return [3, 8];\n\n            case 7:\n              if (containsCSSImport()) {\n                cssText = element.textContent.trim();\n                cssBasePath = getCSSBaseBath(location.href);\n              } else {\n                return [2, null];\n              }\n\n              _c.label = 8;\n\n            case 8:\n              if (!cssText) return [3, 13];\n              _c.label = 9;\n\n            case 9:\n              _c.trys.push([9, 11,, 12]);\n\n              return [4, replaceCSSImports(cssText, cssBasePath)];\n\n            case 10:\n              fullCSSText = _c.sent();\n              corsCopy = createCORSCopy(element, fullCSSText);\n              return [3, 12];\n\n            case 11:\n              err_2 = _c.sent();\n              logWarn(err_2);\n              return [3, 12];\n\n            case 12:\n              if (corsCopy) {\n                corsCopyPositionWatcher = watchForNodePosition(corsCopy, 'prev-sibling');\n                return [2, corsCopy.sheet.cssRules];\n              }\n\n              _c.label = 13;\n\n            case 13:\n              return [2, null];\n          }\n        });\n      });\n    }\n\n    function details() {\n      var rules = getRulesSync();\n\n      if (!rules) {\n        if (isLoadingRules || wasLoadingError) {\n          return null;\n        }\n\n        isLoadingRules = true;\n        loadingStart();\n        getRulesAsync().then(function (results) {\n          isLoadingRules = false;\n          loadingEnd();\n\n          if (results) {\n            update();\n          }\n        }).catch(function (err) {\n          logWarn(err);\n          isLoadingRules = false;\n          loadingEnd();\n        });\n        return null;\n      }\n\n      return {\n        rules: rules\n      };\n    }\n\n    var forceRenderStyle = false;\n\n    function render(theme, ignoreImageAnalysis) {\n      var rules = getRulesSync();\n\n      if (!rules) {\n        return;\n      }\n\n      cancelAsyncOperations = false;\n\n      function prepareOverridesSheet() {\n        if (!syncStyle) {\n          createSyncStyle();\n        }\n\n        syncStylePositionWatcher && syncStylePositionWatcher.stop();\n        insertStyle();\n\n        if (syncStyle.sheet == null) {\n          syncStyle.textContent = '';\n        }\n\n        var sheet = syncStyle.sheet;\n\n        for (var i = sheet.cssRules.length - 1; i >= 0; i--) {\n          sheet.deleteRule(i);\n        }\n\n        if (syncStylePositionWatcher) {\n          syncStylePositionWatcher.run();\n        } else {\n          syncStylePositionWatcher = watchForNodePosition(syncStyle, 'prev-sibling', function () {\n            forceRenderStyle = true;\n            buildOverrides();\n          });\n        }\n\n        return syncStyle.sheet;\n      }\n\n      function buildOverrides() {\n        var force = forceRenderStyle;\n        forceRenderStyle = false;\n        sheetModifier.modifySheet({\n          prepareSheet: prepareOverridesSheet,\n          sourceCSSRules: rules,\n          theme: theme,\n          ignoreImageAnalysis: ignoreImageAnalysis,\n          force: force,\n          isAsyncCancelled: function () {\n            return cancelAsyncOperations;\n          }\n        });\n        isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\n\n        if (sheetModifier.shouldRebuildStyle()) {\n          addReadyStateCompleteListener(function () {\n            return update();\n          });\n        }\n      }\n\n      buildOverrides();\n    }\n\n    function getRulesOrError() {\n      try {\n        if (element.sheet == null) {\n          return [null, null];\n        }\n\n        return [element.sheet.cssRules, null];\n      } catch (err) {\n        return [null, err];\n      }\n    }\n\n    function isStillLoadingError(error) {\n      return error && error.message && error.message.includes('loading');\n    }\n\n    function safeGetSheetRules() {\n      var _a = __read(getRulesOrError(), 2),\n          cssRules = _a[0],\n          err = _a[1];\n\n      if (err) {\n        logWarn(err);\n        return null;\n      }\n\n      return cssRules;\n    }\n\n    function watchForSheetChanges() {\n      watchForSheetChangesUsingProxy();\n\n      if (!isThunderbird && !(canOptimizeUsingProxy$1 && element.sheet)) {\n        watchForSheetChangesUsingRAF();\n      }\n    }\n\n    var rulesChangeKey = null;\n    var rulesCheckFrameId = null;\n\n    function getRulesChangeKey() {\n      var rules = safeGetSheetRules();\n      return rules ? rules.length : null;\n    }\n\n    function didRulesKeyChange() {\n      return getRulesChangeKey() !== rulesChangeKey;\n    }\n\n    function watchForSheetChangesUsingRAF() {\n      rulesChangeKey = getRulesChangeKey();\n      stopWatchingForSheetChangesUsingRAF();\n\n      var checkForUpdate = function () {\n        if (didRulesKeyChange()) {\n          rulesChangeKey = getRulesChangeKey();\n          update();\n        }\n\n        if (canOptimizeUsingProxy$1 && element.sheet) {\n          stopWatchingForSheetChangesUsingRAF();\n          return;\n        }\n\n        rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\n      };\n\n      checkForUpdate();\n    }\n\n    function stopWatchingForSheetChangesUsingRAF() {\n      cancelAnimationFrame(rulesCheckFrameId);\n    }\n\n    var areSheetChangesPending = false;\n\n    function onSheetChange() {\n      canOptimizeUsingProxy$1 = true;\n      stopWatchingForSheetChangesUsingRAF();\n\n      if (areSheetChangesPending) {\n        return;\n      }\n\n      function handleSheetChanges() {\n        areSheetChangesPending = false;\n\n        if (cancelAsyncOperations) {\n          return;\n        }\n\n        update();\n      }\n\n      areSheetChangesPending = true;\n\n      if (typeof queueMicrotask === 'function') {\n        queueMicrotask(handleSheetChanges);\n      } else {\n        requestAnimationFrame(handleSheetChanges);\n      }\n    }\n\n    function watchForSheetChangesUsingProxy() {\n      element.addEventListener('__darkreader__updateSheet', onSheetChange);\n    }\n\n    function stopWatchingForSheetChangesUsingProxy() {\n      element.removeEventListener('__darkreader__updateSheet', onSheetChange);\n    }\n\n    function stopWatchingForSheetChanges() {\n      stopWatchingForSheetChangesUsingProxy();\n      stopWatchingForSheetChangesUsingRAF();\n    }\n\n    function pause() {\n      observer.disconnect();\n      cancelAsyncOperations = true;\n      corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\n      syncStylePositionWatcher && syncStylePositionWatcher.stop();\n      stopWatchingForSheetChanges();\n    }\n\n    function destroy() {\n      pause();\n      removeNode(corsCopy);\n      removeNode(syncStyle);\n      loadingEnd();\n\n      if (rejectorsForLoadingLinks.has(loadingLinkId)) {\n        var reject = rejectorsForLoadingLinks.get(loadingLinkId);\n        rejectorsForLoadingLinks.delete(loadingLinkId);\n        reject && reject();\n      }\n    }\n\n    function watch() {\n      observer.observe(element, observerOptions);\n\n      if (element instanceof HTMLStyleElement) {\n        watchForSheetChanges();\n      }\n    }\n\n    var maxMoveCount = 10;\n    var moveCount = 0;\n\n    function restore() {\n      if (!syncStyle) {\n        return;\n      }\n\n      moveCount++;\n\n      if (moveCount > maxMoveCount) {\n        logWarn('Style sheet was moved multiple times', element);\n        return;\n      }\n\n      logWarn('Restore style', syncStyle, element);\n      insertStyle();\n      corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\n      syncStylePositionWatcher && syncStylePositionWatcher.skip();\n\n      if (!isOverrideEmpty) {\n        forceRenderStyle = true;\n        update();\n      }\n    }\n\n    return {\n      details: details,\n      render: render,\n      pause: pause,\n      destroy: destroy,\n      watch: watch,\n      restore: restore\n    };\n  }\n\n  function linkLoading(link, loadingId) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve, reject) {\n          var cleanUp = function () {\n            link.removeEventListener('load', onLoad);\n            link.removeEventListener('error', onError);\n            rejectorsForLoadingLinks.delete(loadingId);\n          };\n\n          var onLoad = function () {\n            cleanUp();\n            logInfo(\"Linkelement \" + loadingId + \" has been loaded\");\n            resolve();\n          };\n\n          var onError = function () {\n            cleanUp();\n            reject(\"Linkelement \" + loadingId + \" couldn't be loaded. \" + link.href);\n          };\n\n          rejectorsForLoadingLinks.set(loadingId, function () {\n            cleanUp();\n            reject();\n          });\n          link.addEventListener('load', onLoad);\n          link.addEventListener('error', onError);\n\n          if (!link.href) {\n            onError();\n          }\n        })];\n      });\n    });\n  }\n\n  function getCSSImportURL(importDeclaration) {\n    return getCSSURLValue(importDeclaration.substring(7).trim().replace(/;$/, ''));\n  }\n\n  function loadText(url) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!url.startsWith('data:')) return [3, 3];\n            return [4, fetch(url)];\n\n          case 1:\n            return [4, _a.sent().text()];\n\n          case 2:\n            return [2, _a.sent()];\n\n          case 3:\n            return [4, bgFetch({\n              url: url,\n              responseType: 'text',\n              mimeType: 'text/css',\n              origin: window.location.origin\n            })];\n\n          case 4:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  function replaceCSSImports(cssText, basePath, cache) {\n    if (cache === void 0) {\n      cache = new Map();\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      var importMatches, importMatches_1, importMatches_1_1, match, importURL, absoluteURL, importedCSS, err_3, e_1_1;\n\n      var e_1, _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            cssText = removeCSSComments(cssText);\n            cssText = replaceCSSFontFace(cssText);\n            cssText = replaceCSSRelativeURLsWithAbsolute(cssText, basePath);\n            importMatches = getMatches(cssImportRegex, cssText);\n            _b.label = 1;\n\n          case 1:\n            _b.trys.push([1, 10, 11, 12]);\n\n            importMatches_1 = __values(importMatches), importMatches_1_1 = importMatches_1.next();\n            _b.label = 2;\n\n          case 2:\n            if (!!importMatches_1_1.done) return [3, 9];\n            match = importMatches_1_1.value;\n            importURL = getCSSImportURL(match);\n            absoluteURL = getAbsoluteURL(basePath, importURL);\n            importedCSS = void 0;\n            if (!cache.has(absoluteURL)) return [3, 3];\n            importedCSS = cache.get(absoluteURL);\n            return [3, 7];\n\n          case 3:\n            _b.trys.push([3, 6,, 7]);\n\n            return [4, loadText(absoluteURL)];\n\n          case 4:\n            importedCSS = _b.sent();\n            cache.set(absoluteURL, importedCSS);\n            return [4, replaceCSSImports(importedCSS, getCSSBaseBath(absoluteURL), cache)];\n\n          case 5:\n            importedCSS = _b.sent();\n            return [3, 7];\n\n          case 6:\n            err_3 = _b.sent();\n            logWarn(err_3);\n            importedCSS = '';\n            return [3, 7];\n\n          case 7:\n            cssText = cssText.split(match).join(importedCSS);\n            _b.label = 8;\n\n          case 8:\n            importMatches_1_1 = importMatches_1.next();\n            return [3, 2];\n\n          case 9:\n            return [3, 12];\n\n          case 10:\n            e_1_1 = _b.sent();\n            e_1 = {\n              error: e_1_1\n            };\n            return [3, 12];\n\n          case 11:\n            try {\n              if (importMatches_1_1 && !importMatches_1_1.done && (_a = importMatches_1.return)) _a.call(importMatches_1);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n\n            return [7];\n\n          case 12:\n            cssText = cssText.trim();\n            return [2, cssText];\n        }\n      });\n    });\n  }\n\n  function createCORSCopy(srcElement, cssText) {\n    if (!cssText) {\n      return null;\n    }\n\n    var cors = document.createElement('style');\n    cors.classList.add('darkreader');\n    cors.classList.add('darkreader--cors');\n    cors.media = 'screen';\n    cors.textContent = cssText;\n    srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\n    cors.sheet.disabled = true;\n    corsStyleSet.add(cors);\n    return cors;\n  }\n\n  var observers = [];\n  var observedRoots;\n  var undefinedGroups = new Map();\n  var elementsDefinitionCallback;\n\n  function collectUndefinedElements(root) {\n    if (!isDefinedSelectorSupported) {\n      return;\n    }\n\n    forEach(root.querySelectorAll(':not(:defined)'), function (el) {\n      var tag = el.tagName.toLowerCase();\n\n      if (!tag.includes('-')) {\n        var extendedTag = el.getAttribute('is');\n\n        if (extendedTag) {\n          tag = extendedTag;\n        } else {\n          return;\n        }\n      }\n\n      if (!undefinedGroups.has(tag)) {\n        undefinedGroups.set(tag, new Set());\n        customElementsWhenDefined(tag).then(function () {\n          if (elementsDefinitionCallback) {\n            var elements = undefinedGroups.get(tag);\n            undefinedGroups.delete(tag);\n            elementsDefinitionCallback(Array.from(elements));\n          }\n        });\n      }\n\n      undefinedGroups.get(tag).add(el);\n    });\n  }\n\n  var canOptimizeUsingProxy = false;\n  document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\n    canOptimizeUsingProxy = true;\n  });\n  var resolvers = new Map();\n\n  function handleIsDefined(e) {\n    canOptimizeUsingProxy = true;\n\n    if (resolvers.has(e.detail.tag)) {\n      var resolve = resolvers.get(e.detail.tag);\n      resolve();\n    }\n  }\n\n  function customElementsWhenDefined(tag) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2, new Promise(function (resolve) {\n          if (window.customElements && typeof customElements.whenDefined === 'function') {\n            customElements.whenDefined(tag).then(resolve);\n          } else if (canOptimizeUsingProxy) {\n            resolvers.set(tag, resolve);\n            document.dispatchEvent(new CustomEvent('__darkreader__addUndefinedResolver', {\n              detail: {\n                tag: tag\n              }\n            }));\n          } else {\n            var checkIfDefined_1 = function () {\n              var elements = undefinedGroups.get(tag);\n\n              if (elements && elements.size > 0) {\n                if (elements.values().next().value.matches(':defined')) {\n                  resolve();\n                } else {\n                  requestAnimationFrame(checkIfDefined_1);\n                }\n              }\n            };\n\n            requestAnimationFrame(checkIfDefined_1);\n          }\n        })];\n      });\n    });\n  }\n\n  function watchWhenCustomElementsDefined(callback) {\n    elementsDefinitionCallback = callback;\n  }\n\n  function unsubscribeFromDefineCustomElements() {\n    elementsDefinitionCallback = null;\n    undefinedGroups.clear();\n    document.removeEventListener('__darkreader__isDefined', handleIsDefined);\n  }\n\n  function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\n    stopWatchingForStyleChanges();\n    var prevStyles = new Set(currentStyles);\n    var prevStyleSiblings = new WeakMap();\n    var nextStyleSiblings = new WeakMap();\n\n    function saveStylePosition(style) {\n      prevStyleSiblings.set(style, style.previousElementSibling);\n      nextStyleSiblings.set(style, style.nextElementSibling);\n    }\n\n    function forgetStylePosition(style) {\n      prevStyleSiblings.delete(style);\n      nextStyleSiblings.delete(style);\n    }\n\n    function didStylePositionChange(style) {\n      return style.previousElementSibling !== prevStyleSiblings.get(style) || style.nextElementSibling !== nextStyleSiblings.get(style);\n    }\n\n    currentStyles.forEach(saveStylePosition);\n\n    function handleStyleOperations(operations) {\n      var createdStyles = operations.createdStyles,\n          removedStyles = operations.removedStyles,\n          movedStyles = operations.movedStyles;\n      createdStyles.forEach(function (s) {\n        return saveStylePosition(s);\n      });\n      movedStyles.forEach(function (s) {\n        return saveStylePosition(s);\n      });\n      removedStyles.forEach(function (s) {\n        return forgetStylePosition(s);\n      });\n      createdStyles.forEach(function (s) {\n        return prevStyles.add(s);\n      });\n      removedStyles.forEach(function (s) {\n        return prevStyles.delete(s);\n      });\n\n      if (createdStyles.size + removedStyles.size + movedStyles.size > 0) {\n        update({\n          created: Array.from(createdStyles),\n          removed: Array.from(removedStyles),\n          moved: Array.from(movedStyles),\n          updated: []\n        });\n      }\n    }\n\n    function handleMinorTreeMutations(_a) {\n      var additions = _a.additions,\n          moves = _a.moves,\n          deletions = _a.deletions;\n      var createdStyles = new Set();\n      var removedStyles = new Set();\n      var movedStyles = new Set();\n      additions.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return createdStyles.add(style);\n        });\n      });\n      deletions.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return removedStyles.add(style);\n        });\n      });\n      moves.forEach(function (node) {\n        return getManageableStyles(node).forEach(function (style) {\n          return movedStyles.add(style);\n        });\n      });\n      handleStyleOperations({\n        createdStyles: createdStyles,\n        removedStyles: removedStyles,\n        movedStyles: movedStyles\n      });\n      additions.forEach(function (n) {\n        iterateShadowHosts(n, subscribeForShadowRootChanges);\n        collectUndefinedElements(n);\n      });\n    }\n\n    function handleHugeTreeMutations(root) {\n      var styles = new Set(getManageableStyles(root));\n      var createdStyles = new Set();\n      var removedStyles = new Set();\n      var movedStyles = new Set();\n      styles.forEach(function (s) {\n        if (!prevStyles.has(s)) {\n          createdStyles.add(s);\n        }\n      });\n      prevStyles.forEach(function (s) {\n        if (!styles.has(s)) {\n          removedStyles.add(s);\n        }\n      });\n      styles.forEach(function (s) {\n        if (!createdStyles.has(s) && !removedStyles.has(s) && didStylePositionChange(s)) {\n          movedStyles.add(s);\n        }\n      });\n      handleStyleOperations({\n        createdStyles: createdStyles,\n        removedStyles: removedStyles,\n        movedStyles: movedStyles\n      });\n      iterateShadowHosts(root, subscribeForShadowRootChanges);\n      collectUndefinedElements(root);\n    }\n\n    function handleAttributeMutations(mutations) {\n      var updatedStyles = new Set();\n      var removedStyles = new Set();\n      mutations.forEach(function (m) {\n        var target = m.target;\n\n        if (target.isConnected) {\n          if (shouldManageStyle(target)) {\n            updatedStyles.add(target);\n          } else if (target instanceof HTMLLinkElement && target.disabled) {\n            removedStyles.add(target);\n          }\n        }\n      });\n\n      if (updatedStyles.size + removedStyles.size > 0) {\n        update({\n          updated: Array.from(updatedStyles),\n          created: [],\n          removed: Array.from(removedStyles),\n          moved: []\n        });\n      }\n    }\n\n    function observe(root) {\n      var treeObserver = createOptimizedTreeObserver(root, {\n        onMinorMutations: handleMinorTreeMutations,\n        onHugeMutations: handleHugeTreeMutations\n      });\n      var attrObserver = new MutationObserver(handleAttributeMutations);\n      attrObserver.observe(root, {\n        attributes: true,\n        attributeFilter: ['rel', 'disabled', 'media'],\n        subtree: true\n      });\n      observers.push(treeObserver, attrObserver);\n      observedRoots.add(root);\n    }\n\n    function subscribeForShadowRootChanges(node) {\n      var shadowRoot = node.shadowRoot;\n\n      if (shadowRoot == null || observedRoots.has(shadowRoot)) {\n        return;\n      }\n\n      observe(shadowRoot);\n      shadowRootDiscovered(shadowRoot);\n    }\n\n    observe(document);\n    iterateShadowHosts(document.documentElement, subscribeForShadowRootChanges);\n    watchWhenCustomElementsDefined(function (hosts) {\n      var newStyles = [];\n      hosts.forEach(function (host) {\n        return push(newStyles, getManageableStyles(host.shadowRoot));\n      });\n      update({\n        created: newStyles,\n        updated: [],\n        removed: [],\n        moved: []\n      });\n      hosts.forEach(function (host) {\n        var shadowRoot = host.shadowRoot;\n\n        if (shadowRoot == null) {\n          return;\n        }\n\n        subscribeForShadowRootChanges(host);\n        iterateShadowHosts(shadowRoot, subscribeForShadowRootChanges);\n        collectUndefinedElements(shadowRoot);\n      });\n    });\n    document.addEventListener('__darkreader__isDefined', handleIsDefined);\n    collectUndefinedElements(document);\n  }\n\n  function resetObservers() {\n    observers.forEach(function (o) {\n      return o.disconnect();\n    });\n    observers.splice(0, observers.length);\n    observedRoots = new WeakSet();\n  }\n\n  function stopWatchingForStyleChanges() {\n    resetObservers();\n    unsubscribeFromDefineCustomElements();\n  }\n\n  function hexify(number) {\n    return (number < 16 ? '0' : '') + number.toString(16);\n  }\n\n  function generateUID() {\n    if ('randomUUID' in crypto) {\n      var uuid = crypto.randomUUID();\n      return uuid.substring(0, 8) + uuid.substring(9, 13) + uuid.substring(14, 18) + uuid.substring(19, 23) + uuid.substring(24);\n    }\n\n    return Array.from(crypto.getRandomValues(new Uint8Array(16))).map(function (x) {\n      return hexify(x);\n    }).join('');\n  }\n\n  var adoptedStyleOverrides = new WeakMap();\n  var overrideList = new WeakSet();\n\n  function createAdoptedStyleSheetOverride(node) {\n    var cancelAsyncOperations = false;\n\n    function injectSheet(sheet, override) {\n      var newSheets = __spreadArray([], __read(node.adoptedStyleSheets));\n\n      var sheetIndex = newSheets.indexOf(sheet);\n      var existingIndex = newSheets.indexOf(override);\n\n      if (sheetIndex === existingIndex - 1) {\n        return;\n      }\n\n      if (existingIndex >= 0) {\n        newSheets.splice(existingIndex, 1);\n      }\n\n      newSheets.splice(sheetIndex + 1, 0, override);\n      node.adoptedStyleSheets = newSheets;\n    }\n\n    function destroy() {\n      cancelAsyncOperations = true;\n\n      var newSheets = __spreadArray([], __read(node.adoptedStyleSheets));\n\n      node.adoptedStyleSheets.forEach(function (adoptedStyleSheet) {\n        if (overrideList.has(adoptedStyleSheet)) {\n          var existingIndex = newSheets.indexOf(adoptedStyleSheet);\n\n          if (existingIndex >= 0) {\n            newSheets.splice(existingIndex, 1);\n          }\n\n          adoptedStyleOverrides.delete(adoptedStyleSheet);\n          overrideList.delete(adoptedStyleSheet);\n        }\n      });\n      node.adoptedStyleSheets = newSheets;\n    }\n\n    function render(theme, ignoreImageAnalysis) {\n      node.adoptedStyleSheets.forEach(function (sheet) {\n        if (overrideList.has(sheet)) {\n          return;\n        }\n\n        var rules = sheet.rules;\n        var override = new CSSStyleSheet();\n\n        function prepareOverridesSheet() {\n          for (var i = override.cssRules.length - 1; i >= 0; i--) {\n            override.deleteRule(i);\n          }\n\n          injectSheet(sheet, override);\n          adoptedStyleOverrides.set(sheet, override);\n          overrideList.add(override);\n          return override;\n        }\n\n        var sheetModifier = createStyleSheetModifier();\n        sheetModifier.modifySheet({\n          prepareSheet: prepareOverridesSheet,\n          sourceCSSRules: rules,\n          theme: theme,\n          ignoreImageAnalysis: ignoreImageAnalysis,\n          force: false,\n          isAsyncCancelled: function () {\n            return cancelAsyncOperations;\n          }\n        });\n      });\n    }\n\n    return {\n      render: render,\n      destroy: destroy\n    };\n  }\n\n  function injectProxy() {\n    document.dispatchEvent(new CustomEvent('__darkreader__inlineScriptsAllowed'));\n    var addRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'addRule');\n    var insertRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'insertRule');\n    var deleteRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'deleteRule');\n    var removeRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'removeRule');\n    var documentStyleSheetsDescriptor = Object.getOwnPropertyDescriptor(Document.prototype, 'styleSheets');\n    var shouldWrapHTMLElement = location.hostname.endsWith('baidu.com');\n    var getElementsByTagNameDescriptor = shouldWrapHTMLElement ? Object.getOwnPropertyDescriptor(Element.prototype, 'getElementsByTagName') : null;\n\n    var cleanUp = function () {\n      Object.defineProperty(CSSStyleSheet.prototype, 'addRule', addRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', insertRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', deleteRuleDescriptor);\n      Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', removeRuleDescriptor);\n      document.removeEventListener('__darkreader__cleanUp', cleanUp);\n      document.removeEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\n      Object.defineProperty(Document.prototype, 'styleSheets', documentStyleSheetsDescriptor);\n\n      if (shouldWrapHTMLElement) {\n        Object.defineProperty(Element.prototype, 'getElementsByTagName', getElementsByTagNameDescriptor);\n      }\n    };\n\n    var addUndefinedResolver = function (e) {\n      customElements.whenDefined(e.detail.tag).then(function () {\n        document.dispatchEvent(new CustomEvent('__darkreader__isDefined', {\n          detail: {\n            tag: e.detail.tag\n          }\n        }));\n      });\n    };\n\n    document.addEventListener('__darkreader__cleanUp', cleanUp);\n    document.addEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\n    var updateSheetEvent = new Event('__darkreader__updateSheet');\n\n    function proxyAddRule(selector, style, index) {\n      addRuleDescriptor.value.call(this, selector, style, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n\n      return -1;\n    }\n\n    function proxyInsertRule(rule, index) {\n      var returnValue = insertRuleDescriptor.value.call(this, rule, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n\n      return returnValue;\n    }\n\n    function proxyDeleteRule(index) {\n      deleteRuleDescriptor.value.call(this, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n    }\n\n    function proxyRemoveRule(index) {\n      removeRuleDescriptor.value.call(this, index);\n\n      if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\n        this.ownerNode.dispatchEvent(updateSheetEvent);\n      }\n    }\n\n    function proxyDocumentStyleSheets() {\n      var docSheets = documentStyleSheetsDescriptor.get.call(this);\n\n      var filtered = __spreadArray([], __read(docSheets)).filter(function (styleSheet) {\n        return !styleSheet.ownerNode.classList.contains('darkreader');\n      });\n\n      return Object.setPrototypeOf(filtered, StyleSheetList.prototype);\n    }\n\n    function proxyGetElementsByTagName(tagName) {\n      var _this = this;\n\n      var getCurrentElementValue = function () {\n        var elements = getElementsByTagNameDescriptor.value.call(_this, tagName);\n\n        if (tagName === 'style') {\n          elements = Object.setPrototypeOf(__spreadArray([], __read(elements)).filter(function (element) {\n            return !element.classList.contains('darkreader');\n          }), NodeList.prototype);\n        }\n\n        return elements;\n      };\n\n      var elements = getCurrentElementValue();\n      var NodeListBehavior = {\n        get: function (_, property) {\n          return getCurrentElementValue()[property];\n        }\n      };\n      elements = new Proxy(elements, NodeListBehavior);\n      return elements;\n    }\n\n    Object.defineProperty(CSSStyleSheet.prototype, 'addRule', Object.assign({}, addRuleDescriptor, {\n      value: proxyAddRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', Object.assign({}, insertRuleDescriptor, {\n      value: proxyInsertRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', Object.assign({}, deleteRuleDescriptor, {\n      value: proxyDeleteRule\n    }));\n    Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', Object.assign({}, removeRuleDescriptor, {\n      value: proxyRemoveRule\n    }));\n    Object.defineProperty(Document.prototype, 'styleSheets', Object.assign({}, documentStyleSheetsDescriptor, {\n      get: proxyDocumentStyleSheets\n    }));\n\n    if (shouldWrapHTMLElement) {\n      Object.defineProperty(Element.prototype, 'getElementsByTagName', Object.assign({}, getElementsByTagNameDescriptor, {\n        value: proxyGetElementsByTagName\n      }));\n    }\n  }\n\n  var INSTANCE_ID = generateUID();\n  var styleManagers = new Map();\n  var adoptedStyleManagers = [];\n  var filter = null;\n  var fixes = null;\n  var isIFrame$1 = null;\n  var ignoredImageAnalysisSelectors = null;\n  var ignoredInlineSelectors = null;\n\n  function createOrUpdateStyle(className, root) {\n    if (root === void 0) {\n      root = document.head || document;\n    }\n\n    var element = root.querySelector(\".\" + className);\n\n    if (!element) {\n      element = document.createElement('style');\n      element.classList.add('darkreader');\n      element.classList.add(className);\n      element.media = 'screen';\n      element.textContent = '';\n    }\n\n    return element;\n  }\n\n  function createOrUpdateScript(className, root) {\n    if (root === void 0) {\n      root = document.head || document;\n    }\n\n    var element = root.querySelector(\".\" + className);\n\n    if (!element) {\n      element = document.createElement('script');\n      element.classList.add('darkreader');\n      element.classList.add(className);\n    }\n\n    return element;\n  }\n\n  var nodePositionWatchers = new Map();\n\n  function setupNodePositionWatcher(node, alias) {\n    nodePositionWatchers.has(alias) && nodePositionWatchers.get(alias).stop();\n    nodePositionWatchers.set(alias, watchForNodePosition(node, 'parent'));\n  }\n\n  function stopStylePositionWatchers() {\n    forEach(nodePositionWatchers.values(), function (watcher) {\n      return watcher.stop();\n    });\n    nodePositionWatchers.clear();\n  }\n\n  function createStaticStyleOverrides() {\n    var fallbackStyle = createOrUpdateStyle('darkreader--fallback', document);\n    fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n      strict: true\n    });\n    document.head.insertBefore(fallbackStyle, document.head.firstChild);\n    setupNodePositionWatcher(fallbackStyle, 'fallback');\n    var userAgentStyle = createOrUpdateStyle('darkreader--user-agent');\n    userAgentStyle.textContent = getModifiedUserAgentStyle(filter, isIFrame$1, filter.styleSystemControls);\n    document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\n    setupNodePositionWatcher(userAgentStyle, 'user-agent');\n    var textStyle = createOrUpdateStyle('darkreader--text');\n\n    if (filter.useFont || filter.textStroke > 0) {\n      textStyle.textContent = createTextStyle(filter);\n    } else {\n      textStyle.textContent = '';\n    }\n\n    document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\n    setupNodePositionWatcher(textStyle, 'text');\n    var invertStyle = createOrUpdateStyle('darkreader--invert');\n\n    if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\n      invertStyle.textContent = [fixes.invert.join(', ') + \" {\", \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), {\n        contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100)\n      })) + \" !important;\", '}'].join('\\n');\n    } else {\n      invertStyle.textContent = '';\n    }\n\n    document.head.insertBefore(invertStyle, textStyle.nextSibling);\n    setupNodePositionWatcher(invertStyle, 'invert');\n    var inlineStyle = createOrUpdateStyle('darkreader--inline');\n    inlineStyle.textContent = getInlineOverrideStyle();\n    document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\n    setupNodePositionWatcher(inlineStyle, 'inline');\n    var overrideStyle = createOrUpdateStyle('darkreader--override');\n    overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\n    document.head.appendChild(overrideStyle);\n    setupNodePositionWatcher(overrideStyle, 'override');\n    var variableStyle = createOrUpdateStyle('darkreader--variables');\n    var selectionColors = getSelectionColor(filter);\n    var darkSchemeBackgroundColor = filter.darkSchemeBackgroundColor,\n        darkSchemeTextColor = filter.darkSchemeTextColor,\n        lightSchemeBackgroundColor = filter.lightSchemeBackgroundColor,\n        lightSchemeTextColor = filter.lightSchemeTextColor,\n        mode = filter.mode;\n    var schemeBackgroundColor = mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\n    var schemeTextColor = mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\n    schemeBackgroundColor = modifyBackgroundColor(parse(schemeBackgroundColor), filter);\n    schemeTextColor = modifyForegroundColor(parse(schemeTextColor), filter);\n    variableStyle.textContent = [\":root {\", \"   --darkreader-neutral-background: \" + schemeBackgroundColor + \";\", \"   --darkreader-neutral-text: \" + schemeTextColor + \";\", \"   --darkreader-selection-background: \" + selectionColors.backgroundColorSelection + \";\", \"   --darkreader-selection-text: \" + selectionColors.foregroundColorSelection + \";\", \"}\"].join('\\n');\n    document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\n    setupNodePositionWatcher(variableStyle, 'variables');\n    var rootVarsStyle = createOrUpdateStyle('darkreader--root-vars');\n    document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\n    var proxyScript = createOrUpdateScript('darkreader--proxy');\n    proxyScript.append(\"(\" + injectProxy + \")()\");\n    document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\n    proxyScript.remove();\n  }\n\n  var shadowRootsWithOverrides = new Set();\n\n  function createShadowStaticStyleOverrides(root) {\n    var inlineStyle = createOrUpdateStyle('darkreader--inline', root);\n    inlineStyle.textContent = getInlineOverrideStyle();\n    root.insertBefore(inlineStyle, root.firstChild);\n    var overrideStyle = createOrUpdateStyle('darkreader--override', root);\n    overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\n    root.insertBefore(overrideStyle, inlineStyle.nextSibling);\n    var invertStyle = createOrUpdateStyle('darkreader--invert', root);\n\n    if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\n      invertStyle.textContent = [fixes.invert.join(', ') + \" {\", \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), {\n        contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100)\n      })) + \" !important;\", '}'].join('\\n');\n    } else {\n      invertStyle.textContent = '';\n    }\n\n    root.insertBefore(invertStyle, overrideStyle.nextSibling);\n    shadowRootsWithOverrides.add(root);\n  }\n\n  function replaceCSSTemplates($cssText) {\n    return $cssText.replace(/\\${(.+?)}/g, function (_, $color) {\n      var color = tryParseColor($color);\n\n      if (color) {\n        return modifyColor(color, filter);\n      }\n\n      logWarn(\"Couldn't parse CSSTemplate's color.\");\n      return $color;\n    });\n  }\n\n  function cleanFallbackStyle() {\n    var fallback = document.querySelector('.darkreader--fallback');\n\n    if (fallback) {\n      fallback.textContent = '';\n    }\n  }\n\n  function createDynamicStyleOverrides() {\n    cancelRendering();\n    var allStyles = getManageableStyles(document);\n    var newManagers = allStyles.filter(function (style) {\n      return !styleManagers.has(style);\n    }).map(function (style) {\n      return createManager(style);\n    });\n    newManagers.map(function (manager) {\n      return manager.details();\n    }).filter(function (detail) {\n      return detail && detail.rules.length > 0;\n    }).forEach(function (detail) {\n      variablesStore.addRulesForMatching(detail.rules);\n    });\n    variablesStore.matchVariablesAndDependants();\n    variablesStore.setOnRootVariableChange(function () {\n      variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n    });\n    variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n    styleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n\n    if (loadingStyles.size === 0) {\n      cleanFallbackStyle();\n    }\n\n    newManagers.forEach(function (manager) {\n      return manager.watch();\n    });\n    var inlineStyleElements = toArray(document.querySelectorAll(INLINE_STYLE_SELECTOR));\n    iterateShadowHosts(document.documentElement, function (host) {\n      createShadowStaticStyleOverrides(host.shadowRoot);\n      var elements = host.shadowRoot.querySelectorAll(INLINE_STYLE_SELECTOR);\n\n      if (elements.length > 0) {\n        push(inlineStyleElements, elements);\n      }\n    });\n    inlineStyleElements.forEach(function (el) {\n      return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n    });\n    handleAdoptedStyleSheets(document);\n  }\n\n  var loadingStylesCounter = 0;\n  var loadingStyles = new Set();\n\n  function createManager(element) {\n    var loadingStyleId = ++loadingStylesCounter;\n    logInfo(\"New manager for element, with loadingStyleID \" + loadingStyleId, element);\n\n    function loadingStart() {\n      if (!isDOMReady() || !didDocumentShowUp) {\n        loadingStyles.add(loadingStyleId);\n        logInfo(\"Current amount of styles loading: \" + loadingStyles.size);\n        var fallbackStyle = document.querySelector('.darkreader--fallback');\n\n        if (!fallbackStyle.textContent) {\n          fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n            strict: false\n          });\n        }\n      }\n    }\n\n    function loadingEnd() {\n      loadingStyles.delete(loadingStyleId);\n      logInfo(\"Removed loadingStyle \" + loadingStyleId + \", now awaiting: \" + loadingStyles.size);\n      logInfo(\"To-do to be loaded\", loadingStyles);\n\n      if (loadingStyles.size === 0 && isDOMReady()) {\n        cleanFallbackStyle();\n      }\n    }\n\n    function update() {\n      var details = manager.details();\n\n      if (!details) {\n        return;\n      }\n\n      variablesStore.addRulesForMatching(details.rules);\n      variablesStore.matchVariablesAndDependants();\n      manager.render(filter, ignoredImageAnalysisSelectors);\n    }\n\n    var manager = manageStyle(element, {\n      update: update,\n      loadingStart: loadingStart,\n      loadingEnd: loadingEnd\n    });\n    styleManagers.set(element, manager);\n    return manager;\n  }\n\n  function removeManager(element) {\n    var manager = styleManagers.get(element);\n\n    if (manager) {\n      manager.destroy();\n      styleManagers.delete(element);\n    }\n  }\n\n  var throttledRenderAllStyles = throttle(function (callback) {\n    styleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n    adoptedStyleManagers.forEach(function (manager) {\n      return manager.render(filter, ignoredImageAnalysisSelectors);\n    });\n    callback && callback();\n  });\n\n  var cancelRendering = function () {\n    throttledRenderAllStyles.cancel();\n  };\n\n  function onDOMReady() {\n    if (loadingStyles.size === 0) {\n      cleanFallbackStyle();\n      return;\n    }\n\n    logWarn(\"DOM is ready, but still have styles being loaded.\", loadingStyles);\n  }\n\n  var documentVisibilityListener = null;\n  var didDocumentShowUp = !document.hidden;\n\n  function watchForDocumentVisibility(callback) {\n    var alreadyWatching = Boolean(documentVisibilityListener);\n\n    documentVisibilityListener = function () {\n      if (!document.hidden) {\n        stopWatchingForDocumentVisibility();\n        callback();\n        didDocumentShowUp = true;\n      }\n    };\n\n    if (!alreadyWatching) {\n      document.addEventListener('visibilitychange', documentVisibilityListener);\n    }\n  }\n\n  function stopWatchingForDocumentVisibility() {\n    document.removeEventListener('visibilitychange', documentVisibilityListener);\n    documentVisibilityListener = null;\n  }\n\n  function createThemeAndWatchForUpdates() {\n    createStaticStyleOverrides();\n\n    function runDynamicStyle() {\n      createDynamicStyleOverrides();\n      watchForUpdates();\n    }\n\n    if (document.hidden) {\n      watchForDocumentVisibility(runDynamicStyle);\n    } else {\n      runDynamicStyle();\n    }\n\n    changeMetaThemeColorWhenAvailable(filter);\n  }\n\n  function handleAdoptedStyleSheets(node) {\n    if (Array.isArray(node.adoptedStyleSheets)) {\n      if (node.adoptedStyleSheets.length > 0) {\n        var newManger = createAdoptedStyleSheetOverride(node);\n        adoptedStyleManagers.push(newManger);\n        newManger.render(filter, ignoredImageAnalysisSelectors);\n      }\n    }\n  }\n\n  function watchForUpdates() {\n    var managedStyles = Array.from(styleManagers.keys());\n    watchForStyleChanges(managedStyles, function (_a) {\n      var created = _a.created,\n          updated = _a.updated,\n          removed = _a.removed,\n          moved = _a.moved;\n      var stylesToRemove = removed;\n      var stylesToManage = created.concat(updated).concat(moved).filter(function (style) {\n        return !styleManagers.has(style);\n      });\n      var stylesToRestore = moved.filter(function (style) {\n        return styleManagers.has(style);\n      });\n      logInfo(\"Styles to be removed:\", stylesToRemove);\n      stylesToRemove.forEach(function (style) {\n        return removeManager(style);\n      });\n      var newManagers = stylesToManage.map(function (style) {\n        return createManager(style);\n      });\n      newManagers.map(function (manager) {\n        return manager.details();\n      }).filter(function (detail) {\n        return detail && detail.rules.length > 0;\n      }).forEach(function (detail) {\n        variablesStore.addRulesForMatching(detail.rules);\n      });\n      variablesStore.matchVariablesAndDependants();\n      newManagers.forEach(function (manager) {\n        return manager.render(filter, ignoredImageAnalysisSelectors);\n      });\n      newManagers.forEach(function (manager) {\n        return manager.watch();\n      });\n      stylesToRestore.forEach(function (style) {\n        return styleManagers.get(style).restore();\n      });\n    }, function (shadowRoot) {\n      createShadowStaticStyleOverrides(shadowRoot);\n      handleAdoptedStyleSheets(shadowRoot);\n    });\n    watchForInlineStyles(function (element) {\n      overrideInlineStyle(element, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n\n      if (element === document.documentElement) {\n        var styleAttr = element.getAttribute('style');\n\n        if (styleAttr.includes('--')) {\n          variablesStore.matchVariablesAndDependants();\n          variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\n        }\n      }\n    }, function (root) {\n      createShadowStaticStyleOverrides(root);\n      var inlineStyleElements = root.querySelectorAll(INLINE_STYLE_SELECTOR);\n\n      if (inlineStyleElements.length > 0) {\n        forEach(inlineStyleElements, function (el) {\n          return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\n        });\n      }\n    });\n    addDOMReadyListener(onDOMReady);\n  }\n\n  function stopWatchingForUpdates() {\n    styleManagers.forEach(function (manager) {\n      return manager.pause();\n    });\n    stopStylePositionWatchers();\n    stopWatchingForStyleChanges();\n    stopWatchingForInlineStyles();\n    removeDOMReadyListener(onDOMReady);\n    cleanReadyStateCompleteListeners();\n  }\n\n  function createDarkReaderInstanceMarker() {\n    var metaElement = document.createElement('meta');\n    metaElement.name = 'darkreader';\n    metaElement.content = INSTANCE_ID;\n    document.head.appendChild(metaElement);\n  }\n\n  function isAnotherDarkReaderInstanceActive() {\n    var meta = document.querySelector('meta[name=\"darkreader\"]');\n\n    if (meta) {\n      if (meta.content !== INSTANCE_ID) {\n        return true;\n      }\n\n      return false;\n    }\n\n    createDarkReaderInstanceMarker();\n    return false;\n  }\n\n  function createOrUpdateDynamicTheme(filterConfig, dynamicThemeFixes, iframe) {\n    filter = filterConfig;\n    fixes = dynamicThemeFixes;\n\n    if (fixes) {\n      ignoredImageAnalysisSelectors = Array.isArray(fixes.ignoreImageAnalysis) ? fixes.ignoreImageAnalysis : [];\n      ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle) ? fixes.ignoreInlineStyle : [];\n    } else {\n      ignoredImageAnalysisSelectors = [];\n      ignoredInlineSelectors = [];\n    }\n\n    isIFrame$1 = iframe;\n\n    if (document.head) {\n      if (isAnotherDarkReaderInstanceActive()) {\n        return;\n      }\n\n      document.documentElement.setAttribute('data-darkreader-mode', 'dynamic');\n      document.documentElement.setAttribute('data-darkreader-scheme', filter.mode ? 'dark' : 'dimmed');\n      createThemeAndWatchForUpdates();\n    } else {\n      if (!isFirefox) {\n        var fallbackStyle = createOrUpdateStyle('darkreader--fallback');\n        document.documentElement.appendChild(fallbackStyle);\n        fallbackStyle.textContent = getModifiedFallbackStyle(filter, {\n          strict: true\n        });\n      }\n\n      var headObserver_1 = new MutationObserver(function () {\n        if (document.head) {\n          headObserver_1.disconnect();\n\n          if (isAnotherDarkReaderInstanceActive()) {\n            removeDynamicTheme();\n            return;\n          }\n\n          createThemeAndWatchForUpdates();\n        }\n      });\n      headObserver_1.observe(document, {\n        childList: true,\n        subtree: true\n      });\n    }\n  }\n\n  function removeProxy() {\n    document.dispatchEvent(new CustomEvent('__darkreader__cleanUp'));\n    removeNode(document.head.querySelector('.darkreader--proxy'));\n  }\n\n  function removeDynamicTheme() {\n    document.documentElement.removeAttribute(\"data-darkreader-mode\");\n    document.documentElement.removeAttribute(\"data-darkreader-scheme\");\n    cleanDynamicThemeCache();\n    removeNode(document.querySelector('.darkreader--fallback'));\n\n    if (document.head) {\n      restoreMetaThemeColor();\n      removeNode(document.head.querySelector('.darkreader--user-agent'));\n      removeNode(document.head.querySelector('.darkreader--text'));\n      removeNode(document.head.querySelector('.darkreader--invert'));\n      removeNode(document.head.querySelector('.darkreader--inline'));\n      removeNode(document.head.querySelector('.darkreader--override'));\n      removeNode(document.head.querySelector('.darkreader--variables'));\n      removeNode(document.head.querySelector('.darkreader--root-vars'));\n      removeNode(document.head.querySelector('meta[name=\"darkreader\"]'));\n      removeProxy();\n    }\n\n    shadowRootsWithOverrides.forEach(function (root) {\n      removeNode(root.querySelector('.darkreader--inline'));\n      removeNode(root.querySelector('.darkreader--override'));\n    });\n    shadowRootsWithOverrides.clear();\n    forEach(styleManagers.keys(), function (el) {\n      return removeManager(el);\n    });\n    loadingStyles.clear();\n    cleanLoadingLinks();\n    forEach(document.querySelectorAll('.darkreader'), removeNode);\n    adoptedStyleManagers.forEach(function (manager) {\n      manager.destroy();\n    });\n    adoptedStyleManagers.splice(0);\n  }\n\n  function cleanDynamicThemeCache() {\n    variablesStore.clear();\n    parsedURLCache.clear();\n    stopWatchingForDocumentVisibility();\n    cancelRendering();\n    stopWatchingForUpdates();\n    cleanModificationCache();\n  }\n\n  var blobRegex = /url\\(\\\"(blob\\:.*?)\\\"\\)/g;\n\n  function replaceBlobs(text) {\n    return __awaiter(this, void 0, void 0, function () {\n      var promises, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            promises = [];\n            getMatches(blobRegex, text, 1).forEach(function (url) {\n              var promise = loadAsDataURL(url);\n              promises.push(promise);\n            });\n            return [4, Promise.all(promises)];\n\n          case 1:\n            data = _a.sent();\n            return [2, text.replace(blobRegex, function () {\n              return \"url(\\\"\" + data.shift() + \"\\\")\";\n            })];\n        }\n      });\n    });\n  }\n\n  var banner = \"/*\\n                        _______\\n                       /       \\\\\\n                      .==.    .==.\\n                     ((  ))==((  ))\\n                    / \\\"==\\\"    \\\"==\\\"\\\\\\n                   /____|| || ||___\\\\\\n       ________     ____    ________  ___    ___\\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\\n                https://darkreader.org\\n*/\\n\\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/master/LICENSE */\\n\";\n\n  function collectCSS() {\n    return __awaiter(this, void 0, void 0, function () {\n      function addStaticCSS(selector, comment) {\n        var staticStyle = document.querySelector(selector);\n\n        if (staticStyle && staticStyle.textContent) {\n          css.push(\"/* \" + comment + \" */\");\n          css.push(staticStyle.textContent);\n          css.push('');\n        }\n      }\n\n      var css, modifiedCSS, formattedCSS, _a, _b;\n\n      return __generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            css = [banner];\n            addStaticCSS('.darkreader--fallback', 'Fallback Style');\n            addStaticCSS('.darkreader--user-agent', 'User-Agent Style');\n            addStaticCSS('.darkreader--text', 'Text Style');\n            addStaticCSS('.darkreader--invert', 'Invert Style');\n            addStaticCSS('.darkreader--variables', 'Variables Style');\n            modifiedCSS = [];\n            document.querySelectorAll('.darkreader--sync').forEach(function (element) {\n              forEach(element.sheet.cssRules, function (rule) {\n                rule && rule.cssText && modifiedCSS.push(rule.cssText);\n              });\n            });\n            if (!modifiedCSS.length) return [3, 2];\n            formattedCSS = formatCSS(modifiedCSS.join('\\n'));\n            css.push('/* Modified CSS */');\n            _b = (_a = css).push;\n            return [4, replaceBlobs(formattedCSS)];\n\n          case 1:\n            _b.apply(_a, [_c.sent()]);\n\n            css.push('');\n            _c.label = 2;\n\n          case 2:\n            addStaticCSS('.darkreader--override', 'Override Style');\n            return [2, css.join('\\n')];\n        }\n      });\n    });\n  }\n\n  var isDarkReaderEnabled = false;\n\n  var isIFrame = function () {\n    try {\n      return window.self !== window.top;\n    } catch (err) {\n      console.warn(err);\n      return true;\n    }\n  }();\n\n  function enable(themeOptions, fixes) {\n    if (themeOptions === void 0) {\n      themeOptions = {};\n    }\n\n    if (fixes === void 0) {\n      fixes = null;\n    }\n\n    var theme = __assign(__assign({}, DEFAULT_THEME), themeOptions);\n\n    if (theme.engine !== ThemeEngines.dynamicTheme) {\n      throw new Error('Theme engine is not supported.');\n    }\n\n    createOrUpdateDynamicTheme(theme, fixes, isIFrame);\n    isDarkReaderEnabled = true;\n  }\n\n  function isEnabled() {\n    return isDarkReaderEnabled;\n  }\n\n  function disable() {\n    removeDynamicTheme();\n    isDarkReaderEnabled = false;\n  }\n\n  var darkScheme = matchMedia('(prefers-color-scheme: dark)');\n  var store = {\n    themeOptions: null,\n    fixes: null\n  };\n\n  function handleColorScheme() {\n    if (darkScheme.matches) {\n      enable(store.themeOptions, store.fixes);\n    } else {\n      disable();\n    }\n  }\n\n  function auto(themeOptions, fixes) {\n    if (themeOptions === void 0) {\n      themeOptions = {};\n    }\n\n    if (fixes === void 0) {\n      fixes = null;\n    }\n\n    if (themeOptions) {\n      store = {\n        themeOptions: themeOptions,\n        fixes: fixes\n      };\n      handleColorScheme();\n\n      if (isMatchMediaChangeEventListenerSupported) {\n        darkScheme.addEventListener('change', handleColorScheme);\n      } else {\n        darkScheme.addListener(handleColorScheme);\n      }\n    } else {\n      if (isMatchMediaChangeEventListenerSupported) {\n        darkScheme.removeEventListener('change', handleColorScheme);\n      } else {\n        darkScheme.removeListener(handleColorScheme);\n      }\n\n      disable();\n    }\n  }\n\n  function exportGeneratedCSS() {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, collectCSS()];\n\n          case 1:\n            return [2, _a.sent()];\n        }\n      });\n    });\n  }\n\n  var setFetchMethod = setFetchMethod$1;\n  exports.auto = auto;\n  exports.disable = disable;\n  exports.enable = enable;\n  exports.exportGeneratedCSS = exportGeneratedCSS;\n  exports.isEnabled = isEnabled;\n  exports.setFetchMethod = setFetchMethod;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["/home/geri/Documents/angular-frontend/frontend/node_modules/darkreader/darkreader.js"],"names":["global","factory","exports","module","define","amd","globalThis","self","DarkReader","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","__generator","body","_","label","sent","trys","ops","f","y","g","verb","Symbol","iterator","v","op","TypeError","pop","push","__values","o","m","__read","r","ar","error","__spreadArray","to","from","pack","l","Array","slice","concat","MessageType","UI_GET_DATA","UI_GET_ACTIVE_TAB_INFO","UI_SUBSCRIBE_TO_CHANGES","UI_UNSUBSCRIBE_FROM_CHANGES","UI_CHANGE_SETTINGS","UI_SET_THEME","UI_SET_SHORTCUT","UI_TOGGLE_URL","UI_MARK_NEWS_AS_READ","UI_LOAD_CONFIG","UI_APPLY_DEV_DYNAMIC_THEME_FIXES","UI_RESET_DEV_DYNAMIC_THEME_FIXES","UI_APPLY_DEV_INVERSION_FIXES","UI_RESET_DEV_INVERSION_FIXES","UI_APPLY_DEV_STATIC_THEMES","UI_RESET_DEV_STATIC_THEMES","UI_SAVE_FILE","UI_REQUEST_EXPORT_CSS","BG_CHANGES","BG_ADD_CSS_FILTER","BG_ADD_STATIC_THEME","BG_ADD_SVG_FILTER","BG_ADD_DYNAMIC_THEME","BG_EXPORT_CSS","BG_UNSUPPORTED_SENDER","BG_CLEAN_UP","BG_RELOAD","BG_FETCH_RESPONSE","BG_UI_UPDATE","BG_CSS_UPDATE","CS_COLOR_SCHEME_CHANGE","CS_FRAME_CONNECT","CS_FRAME_FORGET","CS_FRAME_FREEZE","CS_FRAME_RESUME","CS_EXPORT_CSS_RESPONSE","CS_FETCH","userAgent","navigator","toLowerCase","platform","isChromium","includes","isThunderbird","isFirefox","isSafari","isWindows","startsWith","isMacOS","isShadowDomSupported","ShadowRoot","isMatchMediaChangeEventListenerSupported","MediaQueryList","addEventListener","match","isDefinedSelectorSupported","document","querySelector","err","chrome","runtime","getManifest","manifest_version","getOKResponse","url","mimeType","origin","response","_a","fetch","cache","credentials","referrer","endsWith","headers","get","Error","ok","status","statusText","loadAsDataURL","readResponseAsDataURL","blob","dataURL","reader","FileReader","onloadend","readAsDataURL","throwCORSError","join","fetcher","setFetchMethod$1","callFetchMethod","window","messageListeners","Set","sendMessage","args","_i","id_1","responseType","text_1","error_1","_b","type","id","data","text","forEach","cb","console","addMessageListener","callback","add","nativeSendMessage_1","onMessage","addListener","nativeAddListener_1","ThemeEngines","cssFilter","svgFilter","staticTheme","dynamicTheme","DEFAULT_COLORS","darkScheme","background","lightScheme","DEFAULT_THEME","mode","brightness","contrast","grayscale","sepia","useFont","fontFamily","textStroke","engine","stylesheet","darkSchemeBackgroundColor","darkSchemeTextColor","lightSchemeBackgroundColor","lightSchemeTextColor","scrollbarColor","selectionColor","styleSystemControls","isArrayLike","items","e_1","len","items_1","items_1_1","item","e_1_1","return","array","addition","a","toArray","results","logInfo","logWarn","throttle","pending","frameId","lastArgs","throttled","requestAnimationFrame","cancel","cancelAnimationFrame","createAsyncTasksQueue","tasks","runTasks","task","shift","splice","getDuration","time","duration","seconds","minutes","hours","days","removeNode","node","parentNode","removeChild","watchForNodePosition","onRestore","Function","MAX_ATTEMPTS_COUNT","RETRY_TIMEOUT","ATTEMPTS_INTERVAL","prevSibling","previousSibling","parent","attempts","start","timeoutId","restore","now","Date","setTimeout","stop","updateParent","insertBefore","nextSibling","firstChild","observer","takeRecords","MutationObserver","run","observe","childList","clearTimeout","disconnect","skip","iterateShadowHosts","root","walker","createTreeWalker","NodeFilter","SHOW_ELEMENT","acceptNode","shadowRoot","FILTER_SKIP","FILTER_ACCEPT","currentNode","nextNode","isDOMReady","readyState","readyStateListeners","addDOMReadyListener","listener","removeDOMReadyListener","delete","isReadyStateComplete","readyStateCompleteListeners","addReadyStateCompleteListener","cleanReadyStateCompleteListeners","clear","onReadyStateChange_1","removeEventListener","HUGE_MUTATIONS_COUNT","isHugeMutation","mutations","addedNodesCount","addedNodes","getElementsTreeOperations","additions","deletions","moves","Element","isConnected","removedNodes","duplicateAdditions","duplicateDeletions","has","parentElement","optimizedTreeObservers","Map","optimizedTreeCallbacks","WeakMap","createOptimizedTreeObserver","callbacks","observerCallbacks","domReadyListener","hadHugeMutationsBefore_1","subscribedForReadyState_1","onHugeMutations","elementsOperations_1","onMinorMutations","subtree","set","size","anchor","parsedURLCache","fixBaseURL","$url","createElement","href","parseURL","$base","key","parsedURL_1","URL","parsedURL","getAbsoluteURL","$relative","test","location","protocol","b","iterateCSSRules","rules","iterate","onMediaRuleError","rule","selectorText","styleSheet","cssRules","media","isScreenOrAll","some","isPrintOrSpeech","conditionText","CSS","supports","shorthandVarDependantProperties","shorthandVarDepPropRegexps","map","prop","regexp","RegExp","iterateCSSDeclarations","style","property","getPropertyValue","trim","cssText","val","cssURLRegex","cssImportRegex","getCSSURLValue","cssURL","replace","getCSSBaseBath","pathname","replaceCSSRelativeURLsWithAbsolute","$css","cssBasePath","pathValue","cssCommentsRegex","removeCSSComments","fontFaceRegex","replaceCSSFontFace","hslToRGB","h","_c","x","Math","round","r_1","b_1","g_1","c","abs","_d","rgbToHSL","r255","g255","b255","max","min","toFixed","digits","fixed","dot","indexOf","zerosMatch","index","substring","rgbToString","rgb","rgbToHexString","toString","hslToString","hsl","rgbMatch","hslMatch","hexMatch","parse","$color","parseRGB","parseHSL","parseHex","knownColors","getColorByName","systemColors","getSystemColor","getNumbers","numbers","prevPos","isMining","startIndex","getNumbersFromString","str","range","units","raw","unitsList","entries","unit","find","u","parseFloat","rgbRange","rgbUnits","$rgb","hslRange","hslUnits","PI","$hsl","$hex","parseInt","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","ActiveBorder","ActiveCaption","AppWorkspace","Background","ButtonFace","ButtonHighlight","ButtonShadow","ButtonText","CaptionText","GrayText","Highlight","HighlightText","InactiveBorder","InactiveCaption","InactiveCaptionText","InfoBackground","InfoText","Menu","MenuText","Scrollbar","ThreeDDarkShadow","ThreeDFace","ThreeDHighlight","ThreeDLightShadow","ThreeDShadow","Window","WindowFrame","WindowText","scale","inLow","inHigh","outLow","outHigh","clamp","multiplyMatrices","m1","m2","j","len2","sum","k","len3","getMatches","regex","input","group","matches","exec","formatCSS","trimLeft","getIndent","depth","repeat","emptyRuleRegexp","css","split","formatted","line","getParenthesesRange","searchStartIndex","firstOpenIndex","openIndex","closingIndex","end","createFilterMatrix","config","Matrix","identity","invertNHue","applyColorMatrix","matrix","getBgPole","theme","isDarkScheme","getFgPole","colorModificationCache","colorParseCache$1","parseToHSLWithCache","color","clearColorModificationCache","rgbCacheKeys","themeCacheKeys$1","getCacheId","resultId","modifyColorWithCache","modifyHSL","poleColor","anotherPoleColor","fnCache","pole","anotherPole","modified","rf","gf","bf","noopHSL","modifyColor","modifyLightSchemeColor","poleBg","poleFg","modifyLightModeHSL","isDark","isNeutral","isBlue","hx","sx","lx","MAX_BG_LIGHTNESS","modifyBgHSL","lx_1","hx_1","hx_2","isYellow","isCloserToGreen","modifyBackgroundColor","MIN_FG_LIGHTNESS","modifyBlueFgHue","hue","modifyFgHSL","isLight","lx_2","hx_3","hx_4","hx_5","lx_3","modifyForegroundColor","modifyBorderHSL","modifyBorderColor","modifyShadowColor","filter","modifyGradientColor","createTextStyle","lines","FilterMode","getCSSFilterValue","filters","dark","toSVGMatrix","getSVGFilterMatrixValue","counter","resolvers$1","rejectors","bgFetch","request","AsyncQueue","queue","timerId","frameDuration","addToQueue","entry","startQueue","stopQueue","_this","imageManager","getImageDetails","image_1","error_2","getImageDataURL","urlToImage","src","width","naturalWidth","height","naturalHeight","analyzeImage","image","Image","onload","onerror","MAX_ANALIZE_PIXELS_COUNT","canvas","context","createCanvas","maxWidth","maxHeight","getContext","imageSmoothingEnabled","removeCanvas","MAX_IMAGE_SIZE","currentSrc","isTransparent","isLarge","isTooLarge","naturalPixelsCount","sqrt","ceil","clearRect","drawImage","imageData","getImageData","d","TRANSPARENT_ALPHA_THRESHOLD","DARK_LIGHTNESS_THRESHOLD","LIGHT_LIGHTNESS_THRESHOLD","transparentPixelsCount","darkPixelsCount","lightPixelsCount","totalPixelsCount","opaquePixelsCount","DARK_IMAGE_THRESHOLD","LIGHT_IMAGE_THRESHOLD","TRANSPARENT_IMAGE_THRESHOLD","LARGE_IMAGE_PIXELS_COUNT","getFilteredImageDataURL","svg","btoa","cleanImageProcessingCache","getPriority","ruleStyle","Boolean","getPropertyPriority","getModifiableCSSDeclaration","variablesStore","ignoreImageSelectors","isCancelled","modifier","getVariableModifier","important","sourceValue","getVariableDependantModifier","getColorModifier","getBgImageModifier","getShadowModifier","getModifiedUserAgentStyle","isIFrame","getModifiedScrollbarStyle","getModifiedSelectionStyle","getSelectionColor","backgroundColorSelection","foregroundColorSelection","modifiedSelectionColor","selection","colorTrack","colorIcons","colorThumb","colorThumbHover","colorThumbActive","colorCorner","hsl_1","lighten","lighter","darken","darker","getModifiedFallbackStyle","strict","unparsableColors","colorParseCache","parseColorWithCache","tryParseColor","rgb_1","gradientRegex","imageDetailsCache","awaitingForImageLoading","shouldIgnoreImage","selectors","ruleSelectors","_loop_1","ignoredSelector","state_1","gradients","urls","getIndices","valueIndex","matches_1","sort","getGradientModifier_1","gradient","content","partsRegex","colorStopRegex","parts","part","space","lastIndexOf","colorStopMatch","modify","getURLModifier_1","urlValue","parentStyleSheet","baseURL","ownerNode","baseURI","absoluteValue","imageDetails","awaiters_1","err_1","bgImageValue","getBgImageValue_1","inverted","dimmed","filtered","modifiers_1","index_1","matchStart","prefixStart","matchEnd","all","asyncResults","index_2","colorMatches_1","modifiers_2","prefixIndex","matchIndex","ignoredImgSelectors","getModifierForVariable","varName","getModifierForVarDependant","cleanModificationCache","VAR_TYPE_BGCOLOR","VAR_TYPE_TEXTCOLOR","VAR_TYPE_BORDERCOLOR","VAR_TYPE_BGIMG","VariablesStore","varTypes","rulesQueue","definedVars","varRefs","unknownColorVars","unknownBgVars","undefinedVars","initialVarTypes","changedTypeVars","typeChangeSubscriptions","unstableVarValues","isVarType","typeNum","addRulesForMatching","matchVariablesAndDependants","collectRootVariables","collectVariablesAndVarDep","collectRootVarDependants","refs","resolveVariableType","hasColor","findVarRef","ref","itarateVarRefs","options","getDeclarations","declarations","addModifiedValue","varNameWrapper","colorModifier","modifiedValue","isVarDependant","isConstructedColorVar","insertVarValues","replaceCSSVariablesNames","fallback","wrapBgColorVariableName","tryModifyBgColor","wrapTextColorVariableName","tryModifyTextColor","wrapBorderColorVariableName","tryModifyBorderColor","wrapBgImgVariableName","bgModifier","onTypeChange","decs","subscribeForVarTypeChange","removeListeners","unsubscribeFromVariableTypeChanges","isBg_1","isText_1","unknownVars","variableReplaced","shadowModifier","firstUnknownVar","values","newValue","colorTypeMatch","beginning","inserted","rootStore","ruleList","isVariable","inspectVariable","inspectVarDependant","documentElement","initialType","currentType","newType","iterateVarDeps","isBgColor","varDeps","iterateVarDependencies","stack","refs_1","refs_1_1","found","setOnRootVariableChange","onRootVariableDefined","putRootVars","styleElement","e_2","sheet","deleteRule","cssLines","declarations_1","declarations_1_1","e_2_1","insertRule","getVariableRange","searchStart","getVariablesMatches","ranges","replaceVariablesMatches","replacer","matchesCount","inputLength","replacements","getVariableNameAndFallback","commaIndex","name","nameReplacer","fallbackReplacer","matchReplacer","newName","newFallback","source","varValues","containsUnresolvedVar","varValue","replaced","overrides","customProp","cssProp","dataAttr","overridesList","normalizedPropList","INLINE_STYLE_ATTRS","INLINE_STYLE_SELECTOR","attr","getInlineOverrideStyle","getInlineStyleElements","Document","querySelectorAll","treeObservers","attrObservers","watchForInlineStyles","elementStyleDidChange","shadowRootDiscovered","deepWatchForInlineStyles","host","discoveredNodes","WeakSet","discoverNodes","el","treeObserver","added","attemptCount","handleAttributeMutations","attributeName","target","attrObserver","attributeCache","attributes","attributeFilter","stopWatchingForInlineStyles","inlineStyleCache","filterProps","getInlineStyleCacheKey","getAttribute","shouldIgnoreInlineStyle","element","ingnoredSelector","overrideInlineStyle","ignoreInlineSelectors","cacheKey","unsetProps","keys","setCustomProp","targetCSSProp","modifierCSSProp","cssVal","mod","setProperty","hasAttribute","setAttribute","removeAttribute","rel","SVGElement","SMALL_SVG_LIMIT_1","value_1","SVGTextElement","handleSVGElement","getBoundingClientRect","isBg","SVGLineElement","overridenProp","fill","metaThemeColorName","metaThemeColorSelector","srcMetaThemeColor","changeMetaThemeColor","meta","changeMetaThemeColorWhenAvailable","loop","HTMLMetaElement","head","restoreMetaThemeColor","themeCacheKeys","getThemeKey","asyncQueue","createStyleSheetModifier","renderId","rulesTextCache","rulesModCache","varTypeChangeCleaners","prevFilterKey","hasNonLoadedLink","wasRebuilt","shouldRebuildStyle","modifySheet","sourceCSSRules","ignoreImageAnalysis","force","prepareSheet","isAsyncCancelled","rulesChanged","notFoundCacheKeys","themeKey","themeChanged","modRules","textDiffersFromPrev","parentRule","CSSMediaRule","mediaText","modDecs","modRule","selector","setRule","getDeclarationText","dec","ruleText","asyncDeclarations","varDeclarations","asyncDeclarationCounter","varDeclarationCounter","rootReadyGroup","isGroup","groupRefs","getGroup","parentGroup","readyStyleRule","readyDeclarations","handleAsyncDeclaration","asyncKey","asyncDeclaration","currentRenderId","asyncValue","rebuildAsyncRule","handleVarDeclarations","varDecs","varKey","initialIndex","oldDecs","tempDec","readyDec","newDecs","readyVarDecs","rebuildVarRule","buildStyleSheet","createTarget","iterateReadyRules","styleIterator","STYLE_SELECTOR","shouldManageStyle","HTMLStyleElement","SVGStyleElement","HTMLLinkElement","disabled","classList","contains","getManageableStyles","deep","syncStyleSet","corsStyleSet","canOptimizeUsingProxy$1","loadingLinkCounter","rejectorsForLoadingLinks","cleanLoadingLinks","manageStyle","update","loadingStart","loadingEnd","prevStyles","nextElementSibling","corsCopy","syncStyle","corsCopyPositionWatcher","syncStylePositionWatcher","cancelAsyncOperations","isOverrideEmpty","sheetModifier","observerOptions","characterData","containsCSSImport","textContent","hasCrossOriginImports","cssRulesLoop","getRulesSync","safeGetSheetRules","insertStyle","createSyncStyle","createElementNS","title","isLoadingRules","wasLoadingError","loadingLinkId","getRulesAsync","accessError","crossOriginImport","fullCSSText","err_2","getRulesOrError","isStillLoadingError","linkLoading","loadText","replaceCSSImports","createCORSCopy","details","catch","forceRenderStyle","render","prepareOverridesSheet","buildOverrides","message","watchForSheetChanges","watchForSheetChangesUsingProxy","watchForSheetChangesUsingRAF","rulesChangeKey","rulesCheckFrameId","getRulesChangeKey","didRulesKeyChange","stopWatchingForSheetChangesUsingRAF","checkForUpdate","areSheetChangesPending","onSheetChange","handleSheetChanges","queueMicrotask","stopWatchingForSheetChangesUsingProxy","stopWatchingForSheetChanges","pause","destroy","watch","maxMoveCount","moveCount","link","loadingId","cleanUp","onLoad","onError","getCSSImportURL","importDeclaration","basePath","importMatches","importMatches_1","importMatches_1_1","importURL","absoluteURL","importedCSS","err_3","srcElement","cors","observers","observedRoots","undefinedGroups","elementsDefinitionCallback","collectUndefinedElements","tag","tagName","extendedTag","customElementsWhenDefined","elements","canOptimizeUsingProxy","resolvers","handleIsDefined","detail","customElements","whenDefined","dispatchEvent","CustomEvent","checkIfDefined_1","watchWhenCustomElementsDefined","unsubscribeFromDefineCustomElements","watchForStyleChanges","currentStyles","stopWatchingForStyleChanges","prevStyleSiblings","nextStyleSiblings","saveStylePosition","previousElementSibling","forgetStylePosition","didStylePositionChange","handleStyleOperations","operations","createdStyles","removedStyles","movedStyles","created","removed","moved","updated","handleMinorTreeMutations","subscribeForShadowRootChanges","handleHugeTreeMutations","styles","updatedStyles","hosts","newStyles","resetObservers","hexify","number","generateUID","crypto","uuid","randomUUID","getRandomValues","Uint8Array","adoptedStyleOverrides","overrideList","createAdoptedStyleSheetOverride","injectSheet","override","newSheets","adoptedStyleSheets","sheetIndex","existingIndex","adoptedStyleSheet","CSSStyleSheet","injectProxy","addRuleDescriptor","getOwnPropertyDescriptor","insertRuleDescriptor","deleteRuleDescriptor","removeRuleDescriptor","documentStyleSheetsDescriptor","shouldWrapHTMLElement","hostname","getElementsByTagNameDescriptor","defineProperty","addUndefinedResolver","updateSheetEvent","Event","proxyAddRule","proxyInsertRule","returnValue","proxyDeleteRule","proxyRemoveRule","proxyDocumentStyleSheets","docSheets","setPrototypeOf","StyleSheetList","proxyGetElementsByTagName","getCurrentElementValue","NodeList","NodeListBehavior","Proxy","INSTANCE_ID","styleManagers","adoptedStyleManagers","fixes","isIFrame$1","ignoredImageAnalysisSelectors","ignoredInlineSelectors","createOrUpdateStyle","className","createOrUpdateScript","nodePositionWatchers","setupNodePositionWatcher","alias","stopStylePositionWatchers","watcher","createStaticStyleOverrides","fallbackStyle","userAgentStyle","textStyle","invertStyle","isArray","invert","inlineStyle","overrideStyle","replaceCSSTemplates","appendChild","variableStyle","selectionColors","schemeBackgroundColor","schemeTextColor","rootVarsStyle","proxyScript","append","remove","shadowRootsWithOverrides","createShadowStaticStyleOverrides","$cssText","cleanFallbackStyle","createDynamicStyleOverrides","cancelRendering","allStyles","newManagers","createManager","manager","loadingStyles","inlineStyleElements","handleAdoptedStyleSheets","loadingStylesCounter","loadingStyleId","didDocumentShowUp","removeManager","throttledRenderAllStyles","onDOMReady","documentVisibilityListener","hidden","watchForDocumentVisibility","alreadyWatching","stopWatchingForDocumentVisibility","createThemeAndWatchForUpdates","runDynamicStyle","watchForUpdates","newManger","managedStyles","stylesToRemove","stylesToManage","stylesToRestore","styleAttr","stopWatchingForUpdates","createDarkReaderInstanceMarker","metaElement","isAnotherDarkReaderInstanceActive","createOrUpdateDynamicTheme","filterConfig","dynamicThemeFixes","iframe","ignoreInlineStyle","headObserver_1","removeDynamicTheme","removeProxy","cleanDynamicThemeCache","blobRegex","replaceBlobs","promises","promise","banner","collectCSS","addStaticCSS","comment","staticStyle","modifiedCSS","formattedCSS","isDarkReaderEnabled","top","warn","enable","themeOptions","isEnabled","disable","matchMedia","store","handleColorScheme","auto","removeListener","exportGeneratedCSS","setFetchMethod"],"mappings":"AAAA;AACA;AACA;AACA;AAEC,WAAUA,MAAV,EAAkBC,OAAlB,EAA2B;AACxB,SAAOC,OAAP,KAAmB,QAAnB,IAA+B,OAAOC,MAAP,KAAkB,WAAjD,GAA+DF,OAAO,CAACC,OAAD,CAAtE,GACA,OAAOE,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACC,GAAvC,GAA6CD,MAAM,CAAC,CAAC,SAAD,CAAD,EAAcH,OAAd,CAAnD,IACCD,MAAM,GAAG,OAAOM,UAAP,KAAsB,WAAtB,GAAoCA,UAApC,GAAiDN,MAAM,IAAIO,IAApE,EAA0EN,OAAO,CAACD,MAAM,CAACQ,UAAP,GAAoB,EAArB,CADlF,CADA;AAGH,CAJA,EAIC,IAJD,EAIQ,UAAUN,OAAV,EAAmB;AAAE;AAE1B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAII,MAAIO,QAAQ,GAAG,YAAW;AACtBA,IAAAA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,SAASF,QAAT,CAAkBG,CAAlB,EAAqB;AAC7C,WAAK,IAAIC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAcC,CAAC,GAAGC,SAAS,CAACC,MAAjC,EAAyCH,CAAC,GAAGC,CAA7C,EAAgDD,CAAC,EAAjD,EAAqD;AACjDD,QAAAA,CAAC,GAAGG,SAAS,CAACF,CAAD,CAAb;;AACA,aAAK,IAAII,CAAT,IAAcL,CAAd,EAAiB,IAAIH,MAAM,CAACS,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EAAgDN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AACpE;;AACD,aAAON,CAAP;AACH,KAND;;AAOA,WAAOH,QAAQ,CAACa,KAAT,CAAe,IAAf,EAAqBN,SAArB,CAAP;AACH,GATD;;AAWA,WAASO,SAAT,CAAmBC,OAAnB,EAA4BC,UAA5B,EAAwCC,CAAxC,EAA2CC,SAA3C,EAAsD;AAClD,aAASC,KAAT,CAAeC,KAAf,EAAsB;AAAE,aAAOA,KAAK,YAAYH,CAAjB,GAAqBG,KAArB,GAA6B,IAAIH,CAAJ,CAAM,UAAUI,OAAV,EAAmB;AAAEA,QAAAA,OAAO,CAACD,KAAD,CAAP;AAAiB,OAA5C,CAApC;AAAoF;;AAC5G,WAAO,KAAKH,CAAC,KAAKA,CAAC,GAAGK,OAAT,CAAN,EAAyB,UAAUD,OAAV,EAAmBE,MAAnB,EAA2B;AACvD,eAASC,SAAT,CAAmBJ,KAAnB,EAA0B;AAAE,YAAI;AAAEK,UAAAA,IAAI,CAACP,SAAS,CAACQ,IAAV,CAAeN,KAAf,CAAD,CAAJ;AAA8B,SAApC,CAAqC,OAAOO,CAAP,EAAU;AAAEJ,UAAAA,MAAM,CAACI,CAAD,CAAN;AAAY;AAAE;;AAC3F,eAASC,QAAT,CAAkBR,KAAlB,EAAyB;AAAE,YAAI;AAAEK,UAAAA,IAAI,CAACP,SAAS,CAAC,OAAD,CAAT,CAAmBE,KAAnB,CAAD,CAAJ;AAAkC,SAAxC,CAAyC,OAAOO,CAAP,EAAU;AAAEJ,UAAAA,MAAM,CAACI,CAAD,CAAN;AAAY;AAAE;;AAC9F,eAASF,IAAT,CAAcI,MAAd,EAAsB;AAAEA,QAAAA,MAAM,CAACC,IAAP,GAAcT,OAAO,CAACQ,MAAM,CAACT,KAAR,CAArB,GAAsCD,KAAK,CAACU,MAAM,CAACT,KAAR,CAAL,CAAoBW,IAApB,CAAyBP,SAAzB,EAAoCI,QAApC,CAAtC;AAAsF;;AAC9GH,MAAAA,IAAI,CAAC,CAACP,SAAS,GAAGA,SAAS,CAACL,KAAV,CAAgBE,OAAhB,EAAyBC,UAAU,IAAI,EAAvC,CAAb,EAAyDU,IAAzD,EAAD,CAAJ;AACH,KALM,CAAP;AAMH;;AAED,WAASM,WAAT,CAAqBjB,OAArB,EAA8BkB,IAA9B,EAAoC;AAChC,QAAIC,CAAC,GAAG;AAAEC,MAAAA,KAAK,EAAE,CAAT;AAAYC,MAAAA,IAAI,EAAE,YAAW;AAAE,YAAIjC,CAAC,CAAC,CAAD,CAAD,GAAO,CAAX,EAAc,MAAMA,CAAC,CAAC,CAAD,CAAP;AAAY,eAAOA,CAAC,CAAC,CAAD,CAAR;AAAc,OAAvE;AAAyEkC,MAAAA,IAAI,EAAE,EAA/E;AAAmFC,MAAAA,GAAG,EAAE;AAAxF,KAAR;AAAA,QAAsGC,CAAtG;AAAA,QAAyGC,CAAzG;AAAA,QAA4GrC,CAA5G;AAAA,QAA+GsC,CAA/G;AACA,WAAOA,CAAC,GAAG;AAAEf,MAAAA,IAAI,EAAEgB,IAAI,CAAC,CAAD,CAAZ;AAAiB,eAASA,IAAI,CAAC,CAAD,CAA9B;AAAmC,gBAAUA,IAAI,CAAC,CAAD;AAAjD,KAAJ,EAA4D,OAAOC,MAAP,KAAkB,UAAlB,KAAiCF,CAAC,CAACE,MAAM,CAACC,QAAR,CAAD,GAAqB,YAAW;AAAE,aAAO,IAAP;AAAc,KAAjF,CAA5D,EAAgJH,CAAvJ;;AACA,aAASC,IAAT,CAAcpC,CAAd,EAAiB;AAAE,aAAO,UAAUuC,CAAV,EAAa;AAAE,eAAOpB,IAAI,CAAC,CAACnB,CAAD,EAAIuC,CAAJ,CAAD,CAAX;AAAsB,OAA5C;AAA+C;;AAClE,aAASpB,IAAT,CAAcqB,EAAd,EAAkB;AACd,UAAIP,CAAJ,EAAO,MAAM,IAAIQ,SAAJ,CAAc,iCAAd,CAAN;;AACP,aAAOb,CAAP,EAAU,IAAI;AACV,YAAIK,CAAC,GAAG,CAAJ,EAAOC,CAAC,KAAKrC,CAAC,GAAG2C,EAAE,CAAC,CAAD,CAAF,GAAQ,CAAR,GAAYN,CAAC,CAAC,QAAD,CAAb,GAA0BM,EAAE,CAAC,CAAD,CAAF,GAAQN,CAAC,CAAC,OAAD,CAAD,KAAe,CAACrC,CAAC,GAAGqC,CAAC,CAAC,QAAD,CAAN,KAAqBrC,CAAC,CAACS,IAAF,CAAO4B,CAAP,CAArB,EAAgC,CAA/C,CAAR,GAA4DA,CAAC,CAACd,IAAjG,CAAD,IAA2G,CAAC,CAACvB,CAAC,GAAGA,CAAC,CAACS,IAAF,CAAO4B,CAAP,EAAUM,EAAE,CAAC,CAAD,CAAZ,CAAL,EAAuBhB,IAA9I,EAAoJ,OAAO3B,CAAP;AACpJ,YAAIqC,CAAC,GAAG,CAAJ,EAAOrC,CAAX,EAAc2C,EAAE,GAAG,CAACA,EAAE,CAAC,CAAD,CAAF,GAAQ,CAAT,EAAY3C,CAAC,CAACiB,KAAd,CAAL;;AACd,gBAAQ0B,EAAE,CAAC,CAAD,CAAV;AACI,eAAK,CAAL;AAAQ,eAAK,CAAL;AAAQ3C,YAAAA,CAAC,GAAG2C,EAAJ;AAAQ;;AACxB,eAAK,CAAL;AAAQZ,YAAAA,CAAC,CAACC,KAAF;AAAW,mBAAO;AAAEf,cAAAA,KAAK,EAAE0B,EAAE,CAAC,CAAD,CAAX;AAAgBhB,cAAAA,IAAI,EAAE;AAAtB,aAAP;;AACnB,eAAK,CAAL;AAAQI,YAAAA,CAAC,CAACC,KAAF;AAAWK,YAAAA,CAAC,GAAGM,EAAE,CAAC,CAAD,CAAN;AAAWA,YAAAA,EAAE,GAAG,CAAC,CAAD,CAAL;AAAU;;AACxC,eAAK,CAAL;AAAQA,YAAAA,EAAE,GAAGZ,CAAC,CAACI,GAAF,CAAMU,GAAN,EAAL;;AAAkBd,YAAAA,CAAC,CAACG,IAAF,CAAOW,GAAP;;AAAc;;AACxC;AACI,gBAAI,EAAE7C,CAAC,GAAG+B,CAAC,CAACG,IAAN,EAAYlC,CAAC,GAAGA,CAAC,CAACK,MAAF,GAAW,CAAX,IAAgBL,CAAC,CAACA,CAAC,CAACK,MAAF,GAAW,CAAZ,CAAnC,MAAuDsC,EAAE,CAAC,CAAD,CAAF,KAAU,CAAV,IAAeA,EAAE,CAAC,CAAD,CAAF,KAAU,CAAhF,CAAJ,EAAwF;AAAEZ,cAAAA,CAAC,GAAG,CAAJ;AAAO;AAAW;;AAC5G,gBAAIY,EAAE,CAAC,CAAD,CAAF,KAAU,CAAV,KAAgB,CAAC3C,CAAD,IAAO2C,EAAE,CAAC,CAAD,CAAF,GAAQ3C,CAAC,CAAC,CAAD,CAAT,IAAgB2C,EAAE,CAAC,CAAD,CAAF,GAAQ3C,CAAC,CAAC,CAAD,CAAhD,CAAJ,EAA2D;AAAE+B,cAAAA,CAAC,CAACC,KAAF,GAAUW,EAAE,CAAC,CAAD,CAAZ;AAAiB;AAAQ;;AACtF,gBAAIA,EAAE,CAAC,CAAD,CAAF,KAAU,CAAV,IAAeZ,CAAC,CAACC,KAAF,GAAUhC,CAAC,CAAC,CAAD,CAA9B,EAAmC;AAAE+B,cAAAA,CAAC,CAACC,KAAF,GAAUhC,CAAC,CAAC,CAAD,CAAX;AAAgBA,cAAAA,CAAC,GAAG2C,EAAJ;AAAQ;AAAQ;;AACrE,gBAAI3C,CAAC,IAAI+B,CAAC,CAACC,KAAF,GAAUhC,CAAC,CAAC,CAAD,CAApB,EAAyB;AAAE+B,cAAAA,CAAC,CAACC,KAAF,GAAUhC,CAAC,CAAC,CAAD,CAAX;;AAAgB+B,cAAAA,CAAC,CAACI,GAAF,CAAMW,IAAN,CAAWH,EAAX;;AAAgB;AAAQ;;AACnE,gBAAI3C,CAAC,CAAC,CAAD,CAAL,EAAU+B,CAAC,CAACI,GAAF,CAAMU,GAAN;;AACVd,YAAAA,CAAC,CAACG,IAAF,CAAOW,GAAP;;AAAc;AAXtB;;AAaAF,QAAAA,EAAE,GAAGb,IAAI,CAACrB,IAAL,CAAUG,OAAV,EAAmBmB,CAAnB,CAAL;AACH,OAjBS,CAiBR,OAAOP,CAAP,EAAU;AAAEmB,QAAAA,EAAE,GAAG,CAAC,CAAD,EAAInB,CAAJ,CAAL;AAAaa,QAAAA,CAAC,GAAG,CAAJ;AAAQ,OAjBzB,SAiBkC;AAAED,QAAAA,CAAC,GAAGpC,CAAC,GAAG,CAAR;AAAY;;AAC1D,UAAI2C,EAAE,CAAC,CAAD,CAAF,GAAQ,CAAZ,EAAe,MAAMA,EAAE,CAAC,CAAD,CAAR;AAAa,aAAO;AAAE1B,QAAAA,KAAK,EAAE0B,EAAE,CAAC,CAAD,CAAF,GAAQA,EAAE,CAAC,CAAD,CAAV,GAAgB,KAAK,CAA9B;AAAiChB,QAAAA,IAAI,EAAE;AAAvC,OAAP;AAC/B;AACJ;;AAED,WAASoB,QAAT,CAAkBC,CAAlB,EAAqB;AACjB,QAAI/C,CAAC,GAAG,OAAOuC,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACC,QAA/C;AAAA,QAAyDQ,CAAC,GAAGhD,CAAC,IAAI+C,CAAC,CAAC/C,CAAD,CAAnE;AAAA,QAAwEC,CAAC,GAAG,CAA5E;AACA,QAAI+C,CAAJ,EAAO,OAAOA,CAAC,CAACxC,IAAF,CAAOuC,CAAP,CAAP;AACP,QAAIA,CAAC,IAAI,OAAOA,CAAC,CAAC3C,MAAT,KAAoB,QAA7B,EAAuC,OAAO;AAC1CkB,MAAAA,IAAI,EAAE,YAAY;AACd,YAAIyB,CAAC,IAAI9C,CAAC,IAAI8C,CAAC,CAAC3C,MAAhB,EAAwB2C,CAAC,GAAG,KAAK,CAAT;AACxB,eAAO;AAAE/B,UAAAA,KAAK,EAAE+B,CAAC,IAAIA,CAAC,CAAC9C,CAAC,EAAF,CAAf;AAAsByB,UAAAA,IAAI,EAAE,CAACqB;AAA7B,SAAP;AACH;AAJyC,KAAP;AAMvC,UAAM,IAAIJ,SAAJ,CAAc3C,CAAC,GAAG,yBAAH,GAA+B,iCAA9C,CAAN;AACH;;AAED,WAASiD,MAAT,CAAgBF,CAAhB,EAAmB7C,CAAnB,EAAsB;AAClB,QAAI8C,CAAC,GAAG,OAAOT,MAAP,KAAkB,UAAlB,IAAgCQ,CAAC,CAACR,MAAM,CAACC,QAAR,CAAzC;AACA,QAAI,CAACQ,CAAL,EAAQ,OAAOD,CAAP;AACR,QAAI9C,CAAC,GAAG+C,CAAC,CAACxC,IAAF,CAAOuC,CAAP,CAAR;AAAA,QAAmBG,CAAnB;AAAA,QAAsBC,EAAE,GAAG,EAA3B;AAAA,QAA+B5B,CAA/B;;AACA,QAAI;AACA,aAAO,CAACrB,CAAC,KAAK,KAAK,CAAX,IAAgBA,CAAC,KAAK,CAAvB,KAA6B,CAAC,CAACgD,CAAC,GAAGjD,CAAC,CAACqB,IAAF,EAAL,EAAeI,IAApD,EAA0DyB,EAAE,CAACN,IAAH,CAAQK,CAAC,CAAClC,KAAV;AAC7D,KAFD,CAGA,OAAOoC,KAAP,EAAc;AAAE7B,MAAAA,CAAC,GAAG;AAAE6B,QAAAA,KAAK,EAAEA;AAAT,OAAJ;AAAuB,KAHvC,SAIQ;AACJ,UAAI;AACA,YAAIF,CAAC,IAAI,CAACA,CAAC,CAACxB,IAAR,KAAiBsB,CAAC,GAAG/C,CAAC,CAAC,QAAD,CAAtB,CAAJ,EAAuC+C,CAAC,CAACxC,IAAF,CAAOP,CAAP;AAC1C,OAFD,SAGQ;AAAE,YAAIsB,CAAJ,EAAO,MAAMA,CAAC,CAAC6B,KAAR;AAAgB;AACpC;;AACD,WAAOD,EAAP;AACH;;AAED,WAASE,aAAT,CAAuBC,EAAvB,EAA2BC,IAA3B,EAAiCC,IAAjC,EAAuC;AACnC,QAAIA,IAAI,IAAIrD,SAAS,CAACC,MAAV,KAAqB,CAAjC,EAAoC,KAAK,IAAIH,CAAC,GAAG,CAAR,EAAWwD,CAAC,GAAGF,IAAI,CAACnD,MAApB,EAA4B+C,EAAjC,EAAqClD,CAAC,GAAGwD,CAAzC,EAA4CxD,CAAC,EAA7C,EAAiD;AACjF,UAAIkD,EAAE,IAAI,EAAElD,CAAC,IAAIsD,IAAP,CAAV,EAAwB;AACpB,YAAI,CAACJ,EAAL,EAASA,EAAE,GAAGO,KAAK,CAACpD,SAAN,CAAgBqD,KAAhB,CAAsBnD,IAAtB,CAA2B+C,IAA3B,EAAiC,CAAjC,EAAoCtD,CAApC,CAAL;AACTkD,QAAAA,EAAE,CAAClD,CAAD,CAAF,GAAQsD,IAAI,CAACtD,CAAD,CAAZ;AACH;AACJ;AACD,WAAOqD,EAAE,CAACM,MAAH,CAAUT,EAAE,IAAII,IAAhB,CAAP;AACH;;AAED,MAAIM,WAAW,GAAG;AACdC,IAAAA,WAAW,EAAE,aADC;AAEdC,IAAAA,sBAAsB,EAAE,wBAFV;AAGdC,IAAAA,uBAAuB,EAAE,yBAHX;AAIdC,IAAAA,2BAA2B,EAAE,6BAJf;AAKdC,IAAAA,kBAAkB,EAAE,oBALN;AAMdC,IAAAA,YAAY,EAAE,cANA;AAOdC,IAAAA,eAAe,EAAE,iBAPH;AAQdC,IAAAA,aAAa,EAAE,eARD;AASdC,IAAAA,oBAAoB,EAAE,sBATR;AAUdC,IAAAA,cAAc,EAAE,gBAVF;AAWdC,IAAAA,gCAAgC,EAAE,kCAXpB;AAYdC,IAAAA,gCAAgC,EAAE,kCAZpB;AAadC,IAAAA,4BAA4B,EAAE,8BAbhB;AAcdC,IAAAA,4BAA4B,EAAE,8BAdhB;AAedC,IAAAA,0BAA0B,EAAE,4BAfd;AAgBdC,IAAAA,0BAA0B,EAAE,4BAhBd;AAiBdC,IAAAA,YAAY,EAAE,cAjBA;AAkBdC,IAAAA,qBAAqB,EAAE,uBAlBT;AAmBdC,IAAAA,UAAU,EAAE,YAnBE;AAoBdC,IAAAA,iBAAiB,EAAE,mBApBL;AAqBdC,IAAAA,mBAAmB,EAAE,qBArBP;AAsBdC,IAAAA,iBAAiB,EAAE,mBAtBL;AAuBdC,IAAAA,oBAAoB,EAAE,sBAvBR;AAwBdC,IAAAA,aAAa,EAAE,eAxBD;AAyBdC,IAAAA,qBAAqB,EAAE,uBAzBT;AA0BdC,IAAAA,WAAW,EAAE,aA1BC;AA2BdC,IAAAA,SAAS,EAAE,WA3BG;AA4BdC,IAAAA,iBAAiB,EAAE,mBA5BL;AA6BdC,IAAAA,YAAY,EAAE,cA7BA;AA8BdC,IAAAA,aAAa,EAAE,eA9BD;AA+BdC,IAAAA,sBAAsB,EAAE,wBA/BV;AAgCdC,IAAAA,gBAAgB,EAAE,kBAhCJ;AAiCdC,IAAAA,eAAe,EAAE,iBAjCH;AAkCdC,IAAAA,eAAe,EAAE,iBAlCH;AAmCdC,IAAAA,eAAe,EAAE,iBAnCH;AAoCdC,IAAAA,sBAAsB,EAAE,wBApCV;AAqCdC,IAAAA,QAAQ,EAAE;AArCI,GAAlB;AAwCA,MAAIC,SAAS,GAAG,OAAOC,SAAP,KAAqB,WAArB,GAAmC,gBAAnC,GAAsDA,SAAS,CAACD,SAAV,CAAoBE,WAApB,EAAtE;AACA,MAAIC,QAAQ,GAAG,OAAOF,SAAP,KAAqB,WAArB,GAAmC,eAAnC,GAAqDA,SAAS,CAACE,QAAV,CAAmBD,WAAnB,EAApE;AACA,MAAIE,UAAU,GAAGJ,SAAS,CAACK,QAAV,CAAmB,QAAnB,KAAgCL,SAAS,CAACK,QAAV,CAAmB,UAAnB,CAAjD;AACA,MAAIC,aAAa,GAAGN,SAAS,CAACK,QAAV,CAAmB,aAAnB,CAApB;AACA,MAAIE,SAAS,GAAGP,SAAS,CAACK,QAAV,CAAmB,SAAnB,KAAiCC,aAAjD;AACAN,EAAAA,SAAS,CAACK,QAAV,CAAmB,SAAnB;AACAL,EAAAA,SAAS,CAACK,QAAV,CAAmB,WAAnB;AACAL,EAAAA,SAAS,CAACK,QAAV,CAAmB,KAAnB,KAA6BL,SAAS,CAACK,QAAV,CAAmB,OAAnB,CAA7B;AACAL,EAAAA,SAAS,CAACK,QAAV,CAAmB,KAAnB;AACA,MAAIG,QAAQ,GAAGR,SAAS,CAACK,QAAV,CAAmB,QAAnB,KAAgC,CAACD,UAAhD;AACA,MAAIK,SAAS,GAAGN,QAAQ,CAACO,UAAT,CAAoB,KAApB,CAAhB;AACA,MAAIC,OAAO,GAAGR,QAAQ,CAACO,UAAT,CAAoB,KAApB,CAAd;AACAV,EAAAA,SAAS,CAACK,QAAV,CAAmB,QAAnB;AACA,MAAIO,oBAAoB,GAAG,OAAOC,UAAP,KAAsB,UAAjD;AACA,MAAIC,wCAAwC,GAAI,OAAOC,cAAP,KAA0B,UAA1B,IAC5C,OAAOA,cAAc,CAAC5G,SAAf,CAAyB6G,gBAAhC,KAAqD,UADzD;;AAEA,GAAE,YAAY;AACV,QAAInE,CAAC,GAAGmD,SAAS,CAACiB,KAAV,CAAgB,uBAAhB,CAAR;;AACA,QAAIpE,CAAC,IAAIA,CAAC,CAAC,CAAD,CAAV,EAAe;AACX,aAAOA,CAAC,CAAC,CAAD,CAAR;AACH;;AACD,WAAO,EAAP;AACH,GAND;;AAOA,MAAIqE,0BAA0B,GAAI,YAAY;AAC1C,QAAI;AACAC,MAAAA,QAAQ,CAACC,aAAT,CAAuB,UAAvB;AACA,aAAO,IAAP;AACH,KAHD,CAIA,OAAOC,GAAP,EAAY;AACR,aAAO,KAAP;AACH;AACJ,GARgC,EAAjC;;AASA/H,EAAAA,UAAU,CAACgI,MAAX,IAAqBhI,UAAU,CAACgI,MAAX,CAAkBC,OAAvC,IAAkDjI,UAAU,CAACgI,MAAX,CAAkBC,OAAlB,CAA0BC,WAA5E,IAA2FlI,UAAU,CAACgI,MAAX,CAAkBC,OAAlB,CAA0BC,WAA1B,GAAwCC,gBAAxC,KAA6D,CAAxJ;;AAEA,WAASC,aAAT,CAAuBC,GAAvB,EAA4BC,QAA5B,EAAsCC,MAAtC,EAA8C;AAC1C,WAAOtH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAIuH,QAAJ;AACA,aAAOrG,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIoG,KAAK,CAACL,GAAD,EAAM;AACtBM,cAAAA,KAAK,EAAE,aADe;AAEtBC,cAAAA,WAAW,EAAE,MAFS;AAGtBC,cAAAA,QAAQ,EAAEN;AAHY,aAAN,CAAT,CAAP;;AAKR,eAAK,CAAL;AACIC,YAAAA,QAAQ,GAAGC,EAAE,CAAClG,IAAH,EAAX;;AACA,gBAAI0E,SAAS,IAAIqB,QAAQ,KAAK,UAA1B,IAAwCD,GAAG,CAACjB,UAAJ,CAAe,kBAAf,CAAxC,IAA8EiB,GAAG,CAACS,QAAJ,CAAa,MAAb,CAAlF,EAAwG;AACpG,qBAAO,CAAC,CAAD,EAAIN,QAAJ,CAAP;AACH;;AACD,gBAAIF,QAAQ,IAAI,CAACE,QAAQ,CAACO,OAAT,CAAiBC,GAAjB,CAAqB,cAArB,EAAqC5B,UAArC,CAAgDkB,QAAhD,CAAjB,EAA4E;AACxE,oBAAM,IAAIW,KAAJ,CAAU,qCAAqCZ,GAA/C,CAAN;AACH;;AACD,gBAAI,CAACG,QAAQ,CAACU,EAAd,EAAkB;AACd,oBAAM,IAAID,KAAJ,CAAU,oBAAoBZ,GAApB,GAA0B,GAA1B,GAAgCG,QAAQ,CAACW,MAAzC,GAAkD,GAAlD,GAAwDX,QAAQ,CAACY,UAA3E,CAAN;AACH;;AACD,mBAAO,CAAC,CAAD,EAAIZ,QAAJ,CAAP;AAjBR;AAmBH,OApBiB,CAAlB;AAqBH,KAvBe,CAAhB;AAwBH;;AACD,WAASa,aAAT,CAAuBhB,GAAvB,EAA4BC,QAA5B,EAAsC;AAClC,WAAOrH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAIuH,QAAJ;AACA,aAAOrG,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAI8F,aAAa,CAACC,GAAD,EAAMC,QAAN,CAAjB,CAAP;;AACR,eAAK,CAAL;AACIE,YAAAA,QAAQ,GAAGC,EAAE,CAAClG,IAAH,EAAX;AACA,mBAAO,CAAC,CAAD,EAAI+G,qBAAqB,CAACd,QAAD,CAAzB,CAAP;;AACJ,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIC,EAAE,CAAClG,IAAH,EAAJ,CAAP;AALZ;AAOH,OARiB,CAAlB;AASH,KAXe,CAAhB;AAYH;;AACD,WAAS+G,qBAAT,CAA+Bd,QAA/B,EAAyC;AACrC,WAAOvH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAIsI,IAAJ,EAAUC,OAAV;AACA,aAAOrH,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIkG,QAAQ,CAACe,IAAT,EAAJ,CAAP;;AACR,eAAK,CAAL;AACIA,YAAAA,IAAI,GAAGd,EAAE,CAAClG,IAAH,EAAP;AACA,mBAAO,CAAC,CAAD,EAAK,IAAId,OAAJ,CAAY,UAAUD,OAAV,EAAmB;AACnC,kBAAIiI,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACAD,cAAAA,MAAM,CAACE,SAAP,GAAmB,YAAY;AAAE,uBAAOnI,OAAO,CAACiI,MAAM,CAACzH,MAAR,CAAd;AAAgC,eAAjE;;AACAyH,cAAAA,MAAM,CAACG,aAAP,CAAqBL,IAArB;AACH,aAJO,CAAL,CAAP;;AAKJ,eAAK,CAAL;AACIC,YAAAA,OAAO,GAAGf,EAAE,CAAClG,IAAH,EAAV;AACA,mBAAO,CAAC,CAAD,EAAIiH,OAAJ,CAAP;AAXR;AAaH,OAdiB,CAAlB;AAeH,KAjBe,CAAhB;AAkBH;;AAED,MAAIK,cAAc,GAAG,UAAUxB,GAAV,EAAe;AAAE,WAAOpH,SAAS,CAAC,KAAK,CAAN,EAAS,KAAK,CAAd,EAAiB,KAAK,CAAtB,EAAyB,YAAY;AACvF,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,eAAO,CAAC,CAAD,EAAIhH,OAAO,CAACC,MAAR,CAAe,IAAIuH,KAAJ,CAAU,CAC5B,4DAD4B,EAE5BZ,GAF4B,EAG5B,6CAH4B,EAI5B,kEAJ4B,EAK5B,wDAL4B,EAM5B,qCAN4B,EAO9ByB,IAP8B,CAOzB,GAPyB,CAAV,CAAf,CAAJ,CAAP;AAQH,OATiB,CAAlB;AAUH,KAXqD,CAAhB;AAWjC,GAXL;;AAYA,MAAIC,OAAO,GAAGF,cAAd;;AACA,WAASG,gBAAT,CAA0BtB,KAA1B,EAAiC;AAC7B,QAAIA,KAAJ,EAAW;AACPqB,MAAAA,OAAO,GAAGrB,KAAV;AACH,KAFD,MAGK;AACDqB,MAAAA,OAAO,GAAGF,cAAV;AACH;AACJ;;AACD,WAASI,eAAT,CAAyB5B,GAAzB,EAA8B;AAC1B,WAAOpH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIyH,OAAO,CAAC1B,GAAD,CAAX,CAAP;;AACR,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAII,EAAE,CAAClG,IAAH,EAAJ,CAAP;AAFZ;AAIH,OALiB,CAAlB;AAMH,KAPe,CAAhB;AAQH;;AAED,MAAI,CAAC2H,MAAM,CAAClC,MAAZ,EAAoB;AAChBkC,IAAAA,MAAM,CAAClC,MAAP,GAAgB,EAAhB;AACH;;AACD,MAAI,CAACA,MAAM,CAACC,OAAZ,EAAqB;AACjBD,IAAAA,MAAM,CAACC,OAAP,GAAiB,EAAjB;AACH;;AACD,MAAIkC,gBAAgB,GAAG,IAAIC,GAAJ,EAAvB;;AACA,WAASC,WAAT,GAAuB;AACnB,QAAIC,IAAI,GAAG,EAAX;;AACA,SAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG7J,SAAS,CAACC,MAAhC,EAAwC4J,EAAE,EAA1C,EAA8C;AAC1CD,MAAAA,IAAI,CAACC,EAAD,CAAJ,GAAW7J,SAAS,CAAC6J,EAAD,CAApB;AACH;;AACD,WAAOtJ,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAIuJ,IAAJ,EAAU/B,EAAV,EAAcJ,GAAd,EAAmBoC,YAAnB,EAAiCjC,QAAjC,EAA2CkC,MAA3C,EAAmDC,OAAnD;;AACA,aAAOxI,WAAW,CAAC,IAAD,EAAO,UAAUyI,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACtI,KAAX;AACI,eAAK,CAAL;AACI,gBAAI,EAAEgI,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,CAAQO,IAAR,KAAiBzG,WAAW,CAACqC,QAA1C,CAAJ,EAAyD,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACzD+D,YAAAA,IAAI,GAAGF,IAAI,CAAC,CAAD,CAAJ,CAAQQ,EAAf;AACAF,YAAAA,EAAE,CAACtI,KAAH,GAAW,CAAX;;AACJ,eAAK,CAAL;AACIsI,YAAAA,EAAE,CAACpI,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,CAAJ,GAAS,CAAT,CAAb;;AACAqF,YAAAA,EAAE,GAAG6B,IAAI,CAAC,CAAD,CAAJ,CAAQS,IAAb,EAAmB1C,GAAG,GAAGI,EAAE,CAACJ,GAA5B,EAAiCoC,YAAY,GAAGhC,EAAE,CAACgC,YAAnD;AACA,mBAAO,CAAC,CAAD,EAAIR,eAAe,CAAC5B,GAAD,CAAnB,CAAP;;AACJ,eAAK,CAAL;AACIG,YAAAA,QAAQ,GAAGoC,EAAE,CAACrI,IAAH,EAAX;AACA,gBAAI,EAAEkI,YAAY,KAAK,UAAnB,CAAJ,EAAoC,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACpC,mBAAO,CAAC,CAAD,EAAInB,qBAAqB,CAACd,QAAD,CAAzB,CAAP;;AACJ,eAAK,CAAL;AACIkC,YAAAA,MAAM,GAAGE,EAAE,CAACrI,IAAH,EAAT;AACA,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIiG,QAAQ,CAACwC,IAAT,EAAJ,CAAP;;AACR,eAAK,CAAL;AACIN,YAAAA,MAAM,GAAGE,EAAE,CAACrI,IAAH,EAAT;AACAqI,YAAAA,EAAE,CAACtI,KAAH,GAAW,CAAX;;AACJ,eAAK,CAAL;AACI6H,YAAAA,gBAAgB,CAACc,OAAjB,CAAyB,UAAUC,EAAV,EAAc;AAAE,qBAAOA,EAAE,CAAC;AAAEL,gBAAAA,IAAI,EAAEzG,WAAW,CAAC4B,iBAApB;AAAuC+E,gBAAAA,IAAI,EAAEL,MAA7C;AAAqD/G,gBAAAA,KAAK,EAAE,IAA5D;AAAkEmH,gBAAAA,EAAE,EAAEN;AAAtE,eAAD,CAAT;AAA0F,aAAnI;AACA,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,eAAK,CAAL;AACIG,YAAAA,OAAO,GAAGC,EAAE,CAACrI,IAAH,EAAV;AACA4I,YAAAA,OAAO,CAACxH,KAAR,CAAcgH,OAAd;AACAR,YAAAA,gBAAgB,CAACc,OAAjB,CAAyB,UAAUC,EAAV,EAAc;AAAE,qBAAOA,EAAE,CAAC;AAAEL,gBAAAA,IAAI,EAAEzG,WAAW,CAAC4B,iBAApB;AAAuC+E,gBAAAA,IAAI,EAAE,IAA7C;AAAmDpH,gBAAAA,KAAK,EAAEgH,OAA1D;AAAmEG,gBAAAA,EAAE,EAAEN;AAAvE,eAAD,CAAT;AAA2F,aAApI;AACA,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,CAAP;AA5BZ;AA8BH,OA/BiB,CAAlB;AAgCH,KAlCe,CAAhB;AAmCH;;AACD,WAASY,kBAAT,CAA4BC,QAA5B,EAAsC;AAClClB,IAAAA,gBAAgB,CAACmB,GAAjB,CAAqBD,QAArB;AACH;;AACD,MAAI,OAAOrD,MAAM,CAACC,OAAP,CAAeoC,WAAtB,KAAsC,UAA1C,EAAsD;AAClD,QAAIkB,mBAAmB,GAAGvD,MAAM,CAACC,OAAP,CAAeoC,WAAzC;;AACArC,IAAAA,MAAM,CAACC,OAAP,CAAeoC,WAAf,GAA6B,YAAY;AACrC,UAAIC,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG7J,SAAS,CAACC,MAAhC,EAAwC4J,EAAE,EAA1C,EAA8C;AAC1CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAW7J,SAAS,CAAC6J,EAAD,CAApB;AACH;;AACDF,MAAAA,WAAW,CAACrJ,KAAZ,CAAkB,KAAK,CAAvB,EAA0B4C,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAAC8G,IAAD,CAAX,CAAvC;AACAiB,MAAAA,mBAAmB,CAACvK,KAApB,CAA0BgH,MAAM,CAACC,OAAjC,EAA0CqC,IAA1C;AACH,KAPD;AAQH,GAVD,MAWK;AACDtC,IAAAA,MAAM,CAACC,OAAP,CAAeoC,WAAf,GAA6BA,WAA7B;AACH;;AACD,MAAI,CAACrC,MAAM,CAACC,OAAP,CAAeuD,SAApB,EAA+B;AAC3BxD,IAAAA,MAAM,CAACC,OAAP,CAAeuD,SAAf,GAA2B,EAA3B;AACH;;AACD,MAAI,OAAOxD,MAAM,CAACC,OAAP,CAAeuD,SAAf,CAAyBC,WAAhC,KAAgD,UAApD,EAAgE;AAC5D,QAAIC,mBAAmB,GAAG1D,MAAM,CAACC,OAAP,CAAeuD,SAAf,CAAyBC,WAAnD;;AACAzD,IAAAA,MAAM,CAACC,OAAP,CAAeuD,SAAf,CAAyBC,WAAzB,GAAuC,YAAY;AAC/C,UAAInB,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG7J,SAAS,CAACC,MAAhC,EAAwC4J,EAAE,EAA1C,EAA8C;AAC1CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAW7J,SAAS,CAAC6J,EAAD,CAApB;AACH;;AACDa,MAAAA,kBAAkB,CAACpK,KAAnB,CAAyB,KAAK,CAA9B,EAAiC4C,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAAC8G,IAAD,CAAX,CAA9C;AACAoB,MAAAA,mBAAmB,CAAC1K,KAApB,CAA0BgH,MAAM,CAACC,OAAP,CAAeuD,SAAzC,EAAoDlB,IAApD;AACH,KAPD;AAQH,GAVD,MAWK;AACDtC,IAAAA,MAAM,CAACC,OAAP,CAAeuD,SAAf,CAAyBC,WAAzB,GAAuCL,kBAAvC;AACH;;AAED,MAAIO,YAAY,GAAG;AACfC,IAAAA,SAAS,EAAE,WADI;AAEfC,IAAAA,SAAS,EAAE,WAFI;AAGfC,IAAAA,WAAW,EAAE,aAHE;AAIfC,IAAAA,YAAY,EAAE;AAJC,GAAnB;AAOA,MAAIC,cAAc,GAAG;AACjBC,IAAAA,UAAU,EAAE;AACRC,MAAAA,UAAU,EAAE,SADJ;AAERlB,MAAAA,IAAI,EAAE;AAFE,KADK;AAKjBmB,IAAAA,WAAW,EAAE;AACTD,MAAAA,UAAU,EAAE,SADH;AAETlB,MAAAA,IAAI,EAAE;AAFG;AALI,GAArB;AAUA,MAAIoB,aAAa,GAAG;AAChBC,IAAAA,IAAI,EAAE,CADU;AAEhBC,IAAAA,UAAU,EAAE,GAFI;AAGhBC,IAAAA,QAAQ,EAAE,GAHM;AAIhBC,IAAAA,SAAS,EAAE,CAJK;AAKhBC,IAAAA,KAAK,EAAE,CALS;AAMhBC,IAAAA,OAAO,EAAE,KANO;AAOhBC,IAAAA,UAAU,EAAEtF,OAAO,GAAG,gBAAH,GAAsBF,SAAS,GAAG,UAAH,GAAgB,WAPlD;AAQhByF,IAAAA,UAAU,EAAE,CARI;AAShBC,IAAAA,MAAM,EAAElB,YAAY,CAACI,YATL;AAUhBe,IAAAA,UAAU,EAAE,EAVI;AAWhBC,IAAAA,yBAAyB,EAAEf,cAAc,CAACC,UAAf,CAA0BC,UAXrC;AAYhBc,IAAAA,mBAAmB,EAAEhB,cAAc,CAACC,UAAf,CAA0BjB,IAZ/B;AAahBiC,IAAAA,0BAA0B,EAAEjB,cAAc,CAACG,WAAf,CAA2BD,UAbvC;AAchBgB,IAAAA,oBAAoB,EAAElB,cAAc,CAACG,WAAf,CAA2BnB,IAdjC;AAehBmC,IAAAA,cAAc,EAAE9F,OAAO,GAAG,EAAH,GAAQ,MAff;AAgBhB+F,IAAAA,cAAc,EAAE,MAhBA;AAiBhBC,IAAAA,mBAAmB,EAAE;AAjBL,GAApB;;AAoBA,WAASC,WAAT,CAAqBC,KAArB,EAA4B;AACxB,WAAOA,KAAK,CAAC5M,MAAN,IAAgB,IAAvB;AACH;;AACD,WAASsK,OAAT,CAAiBsC,KAAjB,EAAwBxK,QAAxB,EAAkC;AAC9B,QAAIyK,GAAJ,EAAS/E,EAAT;;AACA,QAAI6E,WAAW,CAACC,KAAD,CAAf,EAAwB;AACpB,WAAK,IAAI/M,CAAC,GAAG,CAAR,EAAWiN,GAAG,GAAGF,KAAK,CAAC5M,MAA5B,EAAoCH,CAAC,GAAGiN,GAAxC,EAA6CjN,CAAC,EAA9C,EAAkD;AAC9CuC,QAAAA,QAAQ,CAACwK,KAAK,CAAC/M,CAAD,CAAN,CAAR;AACH;AACJ,KAJD,MAKK;AACD,UAAI;AACA,aAAK,IAAIkN,OAAO,GAAGrK,QAAQ,CAACkK,KAAD,CAAtB,EAA+BI,SAAS,GAAGD,OAAO,CAAC7L,IAAR,EAAhD,EAAgE,CAAC8L,SAAS,CAAC1L,IAA3E,EAAiF0L,SAAS,GAAGD,OAAO,CAAC7L,IAAR,EAA7F,EAA6G;AACzG,cAAI+L,IAAI,GAAGD,SAAS,CAACpM,KAArB;AACAwB,UAAAA,QAAQ,CAAC6K,IAAD,CAAR;AACH;AACJ,OALD,CAMA,OAAOC,KAAP,EAAc;AAAEL,QAAAA,GAAG,GAAG;AAAE7J,UAAAA,KAAK,EAAEkK;AAAT,SAAN;AAAyB,OANzC,SAOQ;AACJ,YAAI;AACA,cAAIF,SAAS,IAAI,CAACA,SAAS,CAAC1L,IAAxB,KAAiCwG,EAAE,GAAGiF,OAAO,CAACI,MAA9C,CAAJ,EAA2DrF,EAAE,CAAC1H,IAAH,CAAQ2M,OAAR;AAC9D,SAFD,SAGQ;AAAE,cAAIF,GAAJ,EAAS,MAAMA,GAAG,CAAC7J,KAAV;AAAkB;AACxC;AACJ;AACJ;;AACD,WAASP,IAAT,CAAc2K,KAAd,EAAqBC,QAArB,EAA+B;AAC3B/C,IAAAA,OAAO,CAAC+C,QAAD,EAAW,UAAUC,CAAV,EAAa;AAAE,aAAOF,KAAK,CAAC3K,IAAN,CAAW6K,CAAX,CAAP;AAAuB,KAAjD,CAAP;AACH;;AACD,WAASC,OAAT,CAAiBX,KAAjB,EAAwB;AACpB,QAAIY,OAAO,GAAG,EAAd;;AACA,SAAK,IAAI3N,CAAC,GAAG,CAAR,EAAWiN,GAAG,GAAGF,KAAK,CAAC5M,MAA5B,EAAoCH,CAAC,GAAGiN,GAAxC,EAA6CjN,CAAC,EAA9C,EAAkD;AAC9C2N,MAAAA,OAAO,CAAC/K,IAAR,CAAamK,KAAK,CAAC/M,CAAD,CAAlB;AACH;;AACD,WAAO2N,OAAP;AACH;;AAED,WAASC,OAAT,GAAmB;AACf,QAAI9D,IAAI,GAAG,EAAX;;AACA,SAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG7J,SAAS,CAACC,MAAhC,EAAwC4J,EAAE,EAA1C,EAA8C;AAC1CD,MAAAA,IAAI,CAACC,EAAD,CAAJ,GAAW7J,SAAS,CAAC6J,EAAD,CAApB;AACH;AACJ;;AACD,WAAS8D,OAAT,GAAmB;AACf,QAAI/D,IAAI,GAAG,EAAX;;AACA,SAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG7J,SAAS,CAACC,MAAhC,EAAwC4J,EAAE,EAA1C,EAA8C;AAC1CD,MAAAA,IAAI,CAACC,EAAD,CAAJ,GAAW7J,SAAS,CAAC6J,EAAD,CAApB;AACH;AACJ;;AAED,WAAS+D,QAAT,CAAkBjD,QAAlB,EAA4B;AACxB,QAAIkD,OAAO,GAAG,KAAd;AACA,QAAIC,OAAO,GAAG,IAAd;AACA,QAAIC,QAAJ;;AACA,QAAIC,SAAS,GAAI,YAAY;AACzB,UAAIpE,IAAI,GAAG,EAAX;;AACA,WAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG7J,SAAS,CAACC,MAAhC,EAAwC4J,EAAE,EAA1C,EAA8C;AAC1CD,QAAAA,IAAI,CAACC,EAAD,CAAJ,GAAW7J,SAAS,CAAC6J,EAAD,CAApB;AACH;;AACDkE,MAAAA,QAAQ,GAAGnE,IAAX;;AACA,UAAIkE,OAAJ,EAAa;AACTD,QAAAA,OAAO,GAAG,IAAV;AACH,OAFD,MAGK;AACDlD,QAAAA,QAAQ,CAACrK,KAAT,CAAe,KAAK,CAApB,EAAuB4C,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACiL,QAAD,CAAX,CAApC;AACAD,QAAAA,OAAO,GAAGG,qBAAqB,CAAC,YAAY;AACxCH,UAAAA,OAAO,GAAG,IAAV;;AACA,cAAID,OAAJ,EAAa;AACTlD,YAAAA,QAAQ,CAACrK,KAAT,CAAe,KAAK,CAApB,EAAuB4C,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACiL,QAAD,CAAX,CAApC;AACAF,YAAAA,OAAO,GAAG,KAAV;AACH;AACJ,SAN8B,CAA/B;AAOH;AACJ,KAnBD;;AAoBA,QAAIK,MAAM,GAAG,YAAY;AACrBC,MAAAA,oBAAoB,CAACL,OAAD,CAApB;AACAD,MAAAA,OAAO,GAAG,KAAV;AACAC,MAAAA,OAAO,GAAG,IAAV;AACH,KAJD;;AAKA,WAAOpO,MAAM,CAACC,MAAP,CAAcqO,SAAd,EAAyB;AAAEE,MAAAA,MAAM,EAAEA;AAAV,KAAzB,CAAP;AACH;;AACD,WAASE,qBAAT,GAAiC;AAC7B,QAAIC,KAAK,GAAG,EAAZ;AACA,QAAIP,OAAO,GAAG,IAAd;;AACA,aAASQ,QAAT,GAAoB;AAChB,UAAIC,IAAJ;;AACA,aAAQA,IAAI,GAAGF,KAAK,CAACG,KAAN,EAAf,EAA+B;AAC3BD,QAAAA,IAAI;AACP;;AACDT,MAAAA,OAAO,GAAG,IAAV;AACH;;AACD,aAASlD,GAAT,CAAa2D,IAAb,EAAmB;AACfF,MAAAA,KAAK,CAAC3L,IAAN,CAAW6L,IAAX;;AACA,UAAI,CAACT,OAAL,EAAc;AACVA,QAAAA,OAAO,GAAGG,qBAAqB,CAACK,QAAD,CAA/B;AACH;AACJ;;AACD,aAASJ,MAAT,GAAkB;AACdG,MAAAA,KAAK,CAACI,MAAN,CAAa,CAAb;AACAN,MAAAA,oBAAoB,CAACL,OAAD,CAApB;AACAA,MAAAA,OAAO,GAAG,IAAV;AACH;;AACD,WAAO;AAAElD,MAAAA,GAAG,EAAEA,GAAP;AAAYsD,MAAAA,MAAM,EAAEA;AAApB,KAAP;AACH;;AAED,WAASQ,WAAT,CAAqBC,IAArB,EAA2B;AACvB,QAAIC,QAAQ,GAAG,CAAf;;AACA,QAAID,IAAI,CAACE,OAAT,EAAkB;AACdD,MAAAA,QAAQ,IAAID,IAAI,CAACE,OAAL,GAAe,IAA3B;AACH;;AACD,QAAIF,IAAI,CAACG,OAAT,EAAkB;AACdF,MAAAA,QAAQ,IAAID,IAAI,CAACG,OAAL,GAAe,EAAf,GAAoB,IAAhC;AACH;;AACD,QAAIH,IAAI,CAACI,KAAT,EAAgB;AACZH,MAAAA,QAAQ,IAAID,IAAI,CAACI,KAAL,GAAa,EAAb,GAAkB,EAAlB,GAAuB,IAAnC;AACH;;AACD,QAAIJ,IAAI,CAACK,IAAT,EAAe;AACXJ,MAAAA,QAAQ,IAAID,IAAI,CAACK,IAAL,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,EAAtB,GAA2B,IAAvC;AACH;;AACD,WAAOJ,QAAP;AACH;;AAED,WAASK,UAAT,CAAoBC,IAApB,EAA0B;AACtBA,IAAAA,IAAI,IAAIA,IAAI,CAACC,UAAb,IAA2BD,IAAI,CAACC,UAAL,CAAgBC,WAAhB,CAA4BF,IAA5B,CAA3B;AACH;;AACD,WAASG,oBAAT,CAA8BH,IAA9B,EAAoCvD,IAApC,EAA0C2D,SAA1C,EAAqD;AACjD,QAAIA,SAAS,KAAK,KAAK,CAAvB,EAA0B;AAAEA,MAAAA,SAAS,GAAGC,QAAQ,CAACpP,SAArB;AAAiC;;AAC7D,QAAIqP,kBAAkB,GAAG,EAAzB;AACA,QAAIC,aAAa,GAAGf,WAAW,CAAC;AAAEG,MAAAA,OAAO,EAAE;AAAX,KAAD,CAA/B;AACA,QAAIa,iBAAiB,GAAGhB,WAAW,CAAC;AAAEG,MAAAA,OAAO,EAAE;AAAX,KAAD,CAAnC;AACA,QAAIc,WAAW,GAAGT,IAAI,CAACU,eAAvB;AACA,QAAIC,MAAM,GAAGX,IAAI,CAACC,UAAlB;;AACA,QAAI,CAACU,MAAL,EAAa;AACT,YAAM,IAAItH,KAAJ,CAAU,6DAAV,CAAN;AACH;;AACD,QAAIoD,IAAI,KAAK,cAAT,IAA2B,CAACgE,WAAhC,EAA6C;AACzC,YAAM,IAAIpH,KAAJ,CAAU,iEAAV,CAAN;AACH;;AACD,QAAIuH,QAAQ,GAAG,CAAf;AACA,QAAIC,KAAK,GAAG,IAAZ;AACA,QAAIC,SAAS,GAAG,IAAhB;AACA,QAAIC,OAAO,GAAGrC,QAAQ,CAAC,YAAY;AAC/B,UAAIoC,SAAJ,EAAe;AACX;AACH;;AACDF,MAAAA,QAAQ;AACR,UAAII,GAAG,GAAGC,IAAI,CAACD,GAAL,EAAV;;AACA,UAAIH,KAAK,IAAI,IAAb,EAAmB;AACfA,QAAAA,KAAK,GAAGG,GAAR;AACH,OAFD,MAGK,IAAIJ,QAAQ,IAAIN,kBAAhB,EAAoC;AACrC,YAAIU,GAAG,GAAGH,KAAN,GAAcL,iBAAlB,EAAqC;AACjC/B,UAAAA,OAAO,CAAC,4CAA4C8B,aAA5C,GAA4D,IAA7D,EAAmEP,IAAnE,EAAyES,WAAzE,CAAP;AACAK,UAAAA,SAAS,GAAGI,UAAU,CAAC,YAAY;AAC/BL,YAAAA,KAAK,GAAG,IAAR;AACAD,YAAAA,QAAQ,GAAG,CAAX;AACAE,YAAAA,SAAS,GAAG,IAAZ;AACAC,YAAAA,OAAO;AACV,WALqB,EAKnBR,aALmB,CAAtB;AAMA;AACH;;AACDM,QAAAA,KAAK,GAAGG,GAAR;AACAJ,QAAAA,QAAQ,GAAG,CAAX;AACH;;AACD,UAAInE,IAAI,KAAK,QAAb,EAAuB;AACnB,YAAIgE,WAAW,IAAIA,WAAW,CAACR,UAAZ,KAA2BU,MAA9C,EAAsD;AAClDlC,UAAAA,OAAO,CAAC,yDAAD,EAA4DuB,IAA5D,EAAkES,WAAlE,EAA+EE,MAA/E,CAAP;AACAQ,UAAAA,IAAI;AACJ;AACH;AACJ;;AACD,UAAI1E,IAAI,KAAK,cAAb,EAA6B;AACzB,YAAIgE,WAAW,CAACR,UAAZ,IAA0B,IAA9B,EAAoC;AAChCxB,UAAAA,OAAO,CAAC,sDAAD,EAAyDuB,IAAzD,EAA+DS,WAA/D,EAA4EE,MAA5E,CAAP;AACAQ,UAAAA,IAAI;AACJ;AACH;;AACD,YAAIV,WAAW,CAACR,UAAZ,KAA2BU,MAA/B,EAAuC;AACnClC,UAAAA,OAAO,CAAC,mCAAD,EAAsCuB,IAAtC,EAA4CS,WAA5C,EAAyDE,MAAzD,CAAP;AACAS,UAAAA,YAAY,CAACX,WAAW,CAACR,UAAb,CAAZ;AACH;AACJ;;AACDxB,MAAAA,OAAO,CAAC,yBAAD,EAA4BuB,IAA5B,EAAkCS,WAAlC,EAA+CE,MAA/C,CAAP;AACAA,MAAAA,MAAM,CAACU,YAAP,CAAoBrB,IAApB,EAA0BS,WAAW,GAAGA,WAAW,CAACa,WAAf,GAA6BX,MAAM,CAACY,UAAzE;AACAC,MAAAA,QAAQ,CAACC,WAAT;AACArB,MAAAA,SAAS,IAAIA,SAAS,EAAtB;AACH,KA7CqB,CAAtB;AA8CA,QAAIoB,QAAQ,GAAG,IAAIE,gBAAJ,CAAqB,YAAY;AAC5C,UAAKjF,IAAI,KAAK,QAAT,IAAqBuD,IAAI,CAACC,UAAL,KAAoBU,MAA1C,IACClE,IAAI,KAAK,cAAT,IAA2BuD,IAAI,CAACU,eAAL,KAAyBD,WADzD,EACuE;AACnEM,QAAAA,OAAO;AACV;AACJ,KALc,CAAf;;AAMA,QAAIY,GAAG,GAAG,YAAY;AAClBH,MAAAA,QAAQ,CAACI,OAAT,CAAiBjB,MAAjB,EAAyB;AAAEkB,QAAAA,SAAS,EAAE;AAAb,OAAzB;AACH,KAFD;;AAGA,QAAIV,IAAI,GAAG,YAAY;AACnBW,MAAAA,YAAY,CAAChB,SAAD,CAAZ;AACAU,MAAAA,QAAQ,CAACO,UAAT;AACAhB,MAAAA,OAAO,CAAC/B,MAAR;AACH,KAJD;;AAKA,QAAIgD,IAAI,GAAG,YAAY;AACnBR,MAAAA,QAAQ,CAACC,WAAT;AACH,KAFD;;AAGA,QAAIL,YAAY,GAAG,UAAUnB,UAAV,EAAsB;AACrCU,MAAAA,MAAM,GAAGV,UAAT;AACAkB,MAAAA,IAAI;AACJQ,MAAAA,GAAG;AACN,KAJD;;AAKAA,IAAAA,GAAG;AACH,WAAO;AAAEA,MAAAA,GAAG,EAAEA,GAAP;AAAYR,MAAAA,IAAI,EAAEA,IAAlB;AAAwBa,MAAAA,IAAI,EAAEA;AAA9B,KAAP;AACH;;AACD,WAASC,kBAAT,CAA4BC,IAA5B,EAAkC/O,QAAlC,EAA4C;AACxC,QAAI+O,IAAI,IAAI,IAAZ,EAAkB;AACd;AACH;;AACD,QAAIC,MAAM,GAAGlK,QAAQ,CAACmK,gBAAT,CAA0BF,IAA1B,EAAgCG,UAAU,CAACC,YAA3C,EAAyD;AAClEC,MAAAA,UAAU,EAAE,UAAUvC,IAAV,EAAgB;AACxB,eAAOA,IAAI,CAACwC,UAAL,IAAmB,IAAnB,GAA0BH,UAAU,CAACI,WAArC,GAAmDJ,UAAU,CAACK,aAArE;AACH;AAHiE,KAAzD,CAAb;;AAKA,SAAK,IAAI1C,IAAI,GAAIkC,IAAI,CAACM,UAAL,GAAkBL,MAAM,CAACQ,WAAzB,GAAuCR,MAAM,CAACS,QAAP,EAAxD,EAA4E5C,IAAI,IAAI,IAApF,EAA0FA,IAAI,GAAGmC,MAAM,CAACS,QAAP,EAAjG,EAAoH;AAChHzP,MAAAA,QAAQ,CAAC6M,IAAD,CAAR;AACAiC,MAAAA,kBAAkB,CAACjC,IAAI,CAACwC,UAAN,EAAkBrP,QAAlB,CAAlB;AACH;AACJ;;AACD,WAAS0P,UAAT,GAAsB;AAClB,WAAO5K,QAAQ,CAAC6K,UAAT,KAAwB,UAAxB,IAAsC7K,QAAQ,CAAC6K,UAAT,KAAwB,aAArE;AACH;;AACD,MAAIC,mBAAmB,GAAG,IAAIvI,GAAJ,EAA1B;;AACA,WAASwI,mBAAT,CAA6BC,QAA7B,EAAuC;AACnCF,IAAAA,mBAAmB,CAACrH,GAApB,CAAwBuH,QAAxB;AACH;;AACD,WAASC,sBAAT,CAAgCD,QAAhC,EAA0C;AACtCF,IAAAA,mBAAmB,CAACI,MAApB,CAA2BF,QAA3B;AACH;;AACD,WAASG,oBAAT,GAAgC;AAC5B,WAAOnL,QAAQ,CAAC6K,UAAT,KAAwB,UAA/B;AACH;;AACD,MAAIO,2BAA2B,GAAG,IAAI7I,GAAJ,EAAlC;;AACA,WAAS8I,6BAAT,CAAuCL,QAAvC,EAAiD;AAC7CI,IAAAA,2BAA2B,CAAC3H,GAA5B,CAAgCuH,QAAhC;AACH;;AACD,WAASM,gCAAT,GAA4C;AACxCF,IAAAA,2BAA2B,CAACG,KAA5B;AACH;;AACD,MAAI,CAACX,UAAU,EAAf,EAAmB;AACf,QAAIY,oBAAoB,GAAG,YAAY;AACnC,UAAIZ,UAAU,EAAd,EAAkB;AACdE,QAAAA,mBAAmB,CAAC1H,OAApB,CAA4B,UAAU4H,QAAV,EAAoB;AAAE,iBAAOA,QAAQ,EAAf;AAAoB,SAAtE;AACAF,QAAAA,mBAAmB,CAACS,KAApB;;AACA,YAAIJ,oBAAoB,EAAxB,EAA4B;AACxBnL,UAAAA,QAAQ,CAACyL,mBAAT,CAA6B,kBAA7B,EAAiDD,oBAAjD;AACAJ,UAAAA,2BAA2B,CAAChI,OAA5B,CAAoC,UAAU4H,QAAV,EAAoB;AAAE,mBAAOA,QAAQ,EAAf;AAAoB,WAA9E;AACAI,UAAAA,2BAA2B,CAACG,KAA5B;AACH;AACJ;AACJ,KAVD;;AAWAvL,IAAAA,QAAQ,CAACH,gBAAT,CAA0B,kBAA1B,EAA8C2L,oBAA9C;AACH;;AACD,MAAIE,oBAAoB,GAAG,IAA3B;;AACA,WAASC,cAAT,CAAwBC,SAAxB,EAAmC;AAC/B,QAAIA,SAAS,CAAC9S,MAAV,GAAmB4S,oBAAvB,EAA6C;AACzC,aAAO,IAAP;AACH;;AACD,QAAIG,eAAe,GAAG,CAAtB;;AACA,SAAK,IAAIlT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiT,SAAS,CAAC9S,MAA9B,EAAsCH,CAAC,EAAvC,EAA2C;AACvCkT,MAAAA,eAAe,IAAID,SAAS,CAACjT,CAAD,CAAT,CAAamT,UAAb,CAAwBhT,MAA3C;;AACA,UAAI+S,eAAe,GAAGH,oBAAtB,EAA4C;AACxC,eAAO,IAAP;AACH;AACJ;;AACD,WAAO,KAAP;AACH;;AACD,WAASK,yBAAT,CAAmCH,SAAnC,EAA8C;AAC1C,QAAII,SAAS,GAAG,IAAIzJ,GAAJ,EAAhB;AACA,QAAI0J,SAAS,GAAG,IAAI1J,GAAJ,EAAhB;AACA,QAAI2J,KAAK,GAAG,IAAI3J,GAAJ,EAAZ;AACAqJ,IAAAA,SAAS,CAACxI,OAAV,CAAkB,UAAU1H,CAAV,EAAa;AAC3B0H,MAAAA,OAAO,CAAC1H,CAAC,CAACoQ,UAAH,EAAe,UAAUlT,CAAV,EAAa;AAC/B,YAAIA,CAAC,YAAYuT,OAAb,IAAwBvT,CAAC,CAACwT,WAA9B,EAA2C;AACvCJ,UAAAA,SAAS,CAACvI,GAAV,CAAc7K,CAAd;AACH;AACJ,OAJM,CAAP;AAKAwK,MAAAA,OAAO,CAAC1H,CAAC,CAAC2Q,YAAH,EAAiB,UAAUzT,CAAV,EAAa;AACjC,YAAIA,CAAC,YAAYuT,OAAjB,EAA0B;AACtB,cAAIvT,CAAC,CAACwT,WAAN,EAAmB;AACfF,YAAAA,KAAK,CAACzI,GAAN,CAAU7K,CAAV;AACH,WAFD,MAGK;AACDqT,YAAAA,SAAS,CAACxI,GAAV,CAAc7K,CAAd;AACH;AACJ;AACJ,OATM,CAAP;AAUH,KAhBD;AAiBAsT,IAAAA,KAAK,CAAC9I,OAAN,CAAc,UAAUxK,CAAV,EAAa;AAAE,aAAOoT,SAAS,CAACd,MAAV,CAAiBtS,CAAjB,CAAP;AAA6B,KAA1D;AACA,QAAI0T,kBAAkB,GAAG,EAAzB;AACA,QAAIC,kBAAkB,GAAG,EAAzB;AACAP,IAAAA,SAAS,CAAC5I,OAAV,CAAkB,UAAU2E,IAAV,EAAgB;AAC9B,UAAIiE,SAAS,CAACQ,GAAV,CAAczE,IAAI,CAAC0E,aAAnB,CAAJ,EAAuC;AACnCH,QAAAA,kBAAkB,CAAC/Q,IAAnB,CAAwBwM,IAAxB;AACH;AACJ,KAJD;AAKAkE,IAAAA,SAAS,CAAC7I,OAAV,CAAkB,UAAU2E,IAAV,EAAgB;AAC9B,UAAIkE,SAAS,CAACO,GAAV,CAAczE,IAAI,CAAC0E,aAAnB,CAAJ,EAAuC;AACnCF,QAAAA,kBAAkB,CAAChR,IAAnB,CAAwBwM,IAAxB;AACH;AACJ,KAJD;AAKAuE,IAAAA,kBAAkB,CAAClJ,OAAnB,CAA2B,UAAU2E,IAAV,EAAgB;AAAE,aAAOiE,SAAS,CAACd,MAAV,CAAiBnD,IAAjB,CAAP;AAAgC,KAA7E;AACAwE,IAAAA,kBAAkB,CAACnJ,OAAnB,CAA2B,UAAU2E,IAAV,EAAgB;AAAE,aAAOkE,SAAS,CAACf,MAAV,CAAiBnD,IAAjB,CAAP;AAAgC,KAA7E;AACA,WAAO;AAAEiE,MAAAA,SAAS,EAAEA,SAAb;AAAwBE,MAAAA,KAAK,EAAEA,KAA/B;AAAsCD,MAAAA,SAAS,EAAEA;AAAjD,KAAP;AACH;;AACD,MAAIS,sBAAsB,GAAG,IAAIC,GAAJ,EAA7B;AACA,MAAIC,sBAAsB,GAAG,IAAIC,OAAJ,EAA7B;;AACA,WAASC,2BAAT,CAAqC7C,IAArC,EAA2C8C,SAA3C,EAAsD;AAClD,QAAIxD,QAAJ;AACA,QAAIyD,iBAAJ;AACA,QAAIC,gBAAJ;;AACA,QAAIP,sBAAsB,CAACF,GAAvB,CAA2BvC,IAA3B,CAAJ,EAAsC;AAClCV,MAAAA,QAAQ,GAAGmD,sBAAsB,CAACvL,GAAvB,CAA2B8I,IAA3B,CAAX;AACA+C,MAAAA,iBAAiB,GAAGJ,sBAAsB,CAACzL,GAAvB,CAA2BoI,QAA3B,CAApB;AACH,KAHD,MAIK;AACD,UAAI2D,wBAAwB,GAAG,KAA/B;AACA,UAAIC,yBAAyB,GAAG,KAAhC;AACA5D,MAAAA,QAAQ,GAAG,IAAIE,gBAAJ,CAAqB,UAAUmC,SAAV,EAAqB;AACjD,YAAID,cAAc,CAACC,SAAD,CAAlB,EAA+B;AAC3B,cAAI,CAACsB,wBAAD,IAA6BtC,UAAU,EAA3C,EAA+C;AAC3CoC,YAAAA,iBAAiB,CAAC5J,OAAlB,CAA0B,UAAUxC,EAAV,EAAc;AACpC,kBAAIwM,eAAe,GAAGxM,EAAE,CAACwM,eAAzB;AACA,qBAAOA,eAAe,CAACnD,IAAD,CAAtB;AACH,aAHD;AAIH,WALD,MAMK,IAAI,CAACkD,yBAAL,EAAgC;AACjCF,YAAAA,gBAAgB,GAAG,YAAY;AAAE,qBAAOD,iBAAiB,CAAC5J,OAAlB,CAA0B,UAAUxC,EAAV,EAAc;AAC5E,oBAAIwM,eAAe,GAAGxM,EAAE,CAACwM,eAAzB;AACA,uBAAOA,eAAe,CAACnD,IAAD,CAAtB;AACH,eAHuC,CAAP;AAG5B,aAHL;;AAIAc,YAAAA,mBAAmB,CAACkC,gBAAD,CAAnB;AACAE,YAAAA,yBAAyB,GAAG,IAA5B;AACH;;AACDD,UAAAA,wBAAwB,GAAG,IAA3B;AACH,SAhBD,MAiBK;AACD,cAAIG,oBAAoB,GAAGtB,yBAAyB,CAACH,SAAD,CAApD;AACAoB,UAAAA,iBAAiB,CAAC5J,OAAlB,CAA0B,UAAUxC,EAAV,EAAc;AACpC,gBAAI0M,gBAAgB,GAAG1M,EAAE,CAAC0M,gBAA1B;AACA,mBAAOA,gBAAgB,CAACD,oBAAD,CAAvB;AACH,WAHD;AAIH;AACJ,OAzBU,CAAX;AA0BA9D,MAAAA,QAAQ,CAACI,OAAT,CAAiBM,IAAjB,EAAuB;AAAEL,QAAAA,SAAS,EAAE,IAAb;AAAmB2D,QAAAA,OAAO,EAAE;AAA5B,OAAvB;AACAb,MAAAA,sBAAsB,CAACc,GAAvB,CAA2BvD,IAA3B,EAAiCV,QAAjC;AACAyD,MAAAA,iBAAiB,GAAG,IAAIzK,GAAJ,EAApB;AACAqK,MAAAA,sBAAsB,CAACY,GAAvB,CAA2BjE,QAA3B,EAAqCyD,iBAArC;AACH;;AACDA,IAAAA,iBAAiB,CAACvJ,GAAlB,CAAsBsJ,SAAtB;AACA,WAAO;AACHjD,MAAAA,UAAU,EAAE,YAAY;AACpBkD,QAAAA,iBAAiB,CAAC9B,MAAlB,CAAyB6B,SAAzB;;AACA,YAAIE,gBAAJ,EAAsB;AAClBhC,UAAAA,sBAAsB,CAACgC,gBAAD,CAAtB;AACH;;AACD,YAAID,iBAAiB,CAACS,IAAlB,KAA2B,CAA/B,EAAkC;AAC9BlE,UAAAA,QAAQ,CAACO,UAAT;AACA8C,UAAAA,sBAAsB,CAAC1B,MAAvB,CAA8B3B,QAA9B;AACAmD,UAAAA,sBAAsB,CAACxB,MAAvB,CAA8BjB,IAA9B;AACH;AACJ;AAXE,KAAP;AAaH;;AAED,MAAIyD,MAAJ;AACA,MAAIC,cAAc,GAAG,IAAIhB,GAAJ,EAArB;;AACA,WAASiB,UAAT,CAAoBC,IAApB,EAA0B;AACtB,QAAI,CAACH,MAAL,EAAa;AACTA,MAAAA,MAAM,GAAG1N,QAAQ,CAAC8N,aAAT,CAAuB,GAAvB,CAAT;AACH;;AACDJ,IAAAA,MAAM,CAACK,IAAP,GAAcF,IAAd;AACA,WAAOH,MAAM,CAACK,IAAd;AACH;;AACD,WAASC,QAAT,CAAkBH,IAAlB,EAAwBI,KAAxB,EAA+B;AAC3B,QAAIA,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,MAAAA,KAAK,GAAG,IAAR;AAAe;;AACvC,QAAIC,GAAG,GAAG,KAAKL,IAAL,IAAaI,KAAK,GAAG,MAAMA,KAAT,GAAiB,EAAnC,CAAV;;AACA,QAAIN,cAAc,CAACnB,GAAf,CAAmB0B,GAAnB,CAAJ,EAA6B;AACzB,aAAOP,cAAc,CAACxM,GAAf,CAAmB+M,GAAnB,CAAP;AACH;;AACD,QAAID,KAAJ,EAAW;AACP,UAAIE,WAAW,GAAG,IAAIC,GAAJ,CAAQP,IAAR,EAAcD,UAAU,CAACK,KAAD,CAAxB,CAAlB;AACAN,MAAAA,cAAc,CAACH,GAAf,CAAmBU,GAAnB,EAAwBC,WAAxB;AACA,aAAOA,WAAP;AACH;;AACD,QAAIE,SAAS,GAAG,IAAID,GAAJ,CAAQR,UAAU,CAACC,IAAD,CAAlB,CAAhB;AACAF,IAAAA,cAAc,CAACH,GAAf,CAAmBK,IAAnB,EAAyBQ,SAAzB;AACA,WAAOA,SAAP;AACH;;AACD,WAASC,cAAT,CAAwBL,KAAxB,EAA+BM,SAA/B,EAA0C;AACtC,QAAIA,SAAS,CAACzO,KAAV,CAAgB,YAAhB,CAAJ,EAAmC;AAC/B,aAAOyO,SAAP;AACH;;AACD,QAAI,QAAQC,IAAR,CAAaD,SAAb,CAAJ,EAA6B;AACzB,aAAO,KAAKE,QAAQ,CAACC,QAAd,GAAyBH,SAAhC;AACH;;AACD,QAAII,CAAC,GAAGX,QAAQ,CAACC,KAAD,CAAhB;AACA,QAAI7H,CAAC,GAAG4H,QAAQ,CAACO,SAAD,EAAYI,CAAC,CAACZ,IAAd,CAAhB;AACA,WAAO3H,CAAC,CAAC2H,IAAT;AACH;;AAED,WAASa,eAAT,CAAyBC,KAAzB,EAAgCC,OAAhC,EAAyCC,gBAAzC,EAA2D;AACvD3L,IAAAA,OAAO,CAACyL,KAAD,EAAQ,UAAUG,IAAV,EAAgB;AAC3B,UAAIA,IAAI,CAACC,YAAT,EAAuB;AACnBH,QAAAA,OAAO,CAACE,IAAD,CAAP;AACH,OAFD,MAGK,IAAIA,IAAI,CAACjB,IAAT,EAAe;AAChB,YAAI;AACAa,UAAAA,eAAe,CAACI,IAAI,CAACE,UAAL,CAAgBC,QAAjB,EAA2BL,OAA3B,EAAoCC,gBAApC,CAAf;AACH,SAFD,CAGA,OAAO7O,GAAP,EAAY;AACRqG,UAAAA,OAAO,CAAC,0BAAD,CAAP;AACAwI,UAAAA,gBAAgB,IAAIA,gBAAgB,EAApC;AACH;AACJ,OARI,MASA,IAAIC,IAAI,CAACI,KAAT,EAAgB;AACjB,YAAIA,KAAK,GAAGhT,KAAK,CAACH,IAAN,CAAW+S,IAAI,CAACI,KAAhB,CAAZ;AACA,YAAIC,aAAa,GAAGD,KAAK,CAACE,IAAN,CAAW,UAAU5T,CAAV,EAAa;AAAE,iBAAOA,CAAC,CAAC6D,UAAF,CAAa,QAAb,KAA0B7D,CAAC,CAAC6D,UAAF,CAAa,KAAb,CAAjC;AAAuD,SAAjF,CAApB;AACA,YAAIgQ,eAAe,GAAGH,KAAK,CAACE,IAAN,CAAW,UAAU5T,CAAV,EAAa;AAAE,iBAAOA,CAAC,CAAC6D,UAAF,CAAa,OAAb,KAAyB7D,CAAC,CAAC6D,UAAF,CAAa,QAAb,CAAhC;AAAyD,SAAnF,CAAtB;;AACA,YAAI8P,aAAa,IAAI,CAACE,eAAtB,EAAuC;AACnCX,UAAAA,eAAe,CAACI,IAAI,CAACG,QAAN,EAAgBL,OAAhB,EAAyBC,gBAAzB,CAAf;AACH;AACJ,OAPI,MAQA,IAAIC,IAAI,CAACQ,aAAT,EAAwB;AACzB,YAAIC,GAAG,CAACC,QAAJ,CAAaV,IAAI,CAACQ,aAAlB,CAAJ,EAAsC;AAClCZ,UAAAA,eAAe,CAACI,IAAI,CAACG,QAAN,EAAgBL,OAAhB,EAAyBC,gBAAzB,CAAf;AACH;AACJ,OAJI,MAKA;AACDvI,QAAAA,OAAO,CAAC,4BAAD,EAA+BwI,IAA/B,CAAP;AACH;AACJ,KA7BM,CAAP;AA8BH;;AACD,MAAIW,+BAA+B,GAAG,CAClC,YADkC,EAElC,QAFkC,EAGlC,cAHkC,EAIlC,eAJkC,EAKlC,aALkC,EAMlC,cANkC,EAOlC,YAPkC,EAQlC,SARkC,EASlC,eATkC,CAAtC;AAWA,MAAIC,0BAA0B,GAAGvQ,QAAQ,GAAGsQ,+BAA+B,CAACE,GAAhC,CAAoC,UAAUC,IAAV,EAAgB;AAC5F,QAAIC,MAAM,GAAG,IAAIC,MAAJ,CAAWF,IAAI,GAAG,iBAAlB,CAAb;AACA,WAAO,CAACA,IAAD,EAAOC,MAAP,CAAP;AACH,GAH2C,CAAH,GAGpC,IAHL;;AAIA,WAASE,sBAAT,CAAgCC,KAAhC,EAAuCpB,OAAvC,EAAgD;AAC5C1L,IAAAA,OAAO,CAAC8M,KAAD,EAAQ,UAAUC,QAAV,EAAoB;AAC/B,UAAIzW,KAAK,GAAGwW,KAAK,CAACE,gBAAN,CAAuBD,QAAvB,EAAiCE,IAAjC,EAAZ;;AACA,UAAI,CAAC3W,KAAL,EAAY;AACR;AACH;;AACDoV,MAAAA,OAAO,CAACqB,QAAD,EAAWzW,KAAX,CAAP;AACH,KANM,CAAP;AAOA,QAAI4W,OAAO,GAAGJ,KAAK,CAACI,OAApB;;AACA,QAAIA,OAAO,CAACpR,QAAR,CAAiB,MAAjB,CAAJ,EAA8B;AAC1B,UAAIG,QAAJ,EAAc;AACVuQ,QAAAA,0BAA0B,CAACxM,OAA3B,CAAmC,UAAUxC,EAAV,EAAc;AAC7C,cAAImC,EAAE,GAAGpH,MAAM,CAACiF,EAAD,EAAK,CAAL,CAAf;AAAA,cAAwBkP,IAAI,GAAG/M,EAAE,CAAC,CAAD,CAAjC;AAAA,cAAsCgN,MAAM,GAAGhN,EAAE,CAAC,CAAD,CAAjD;;AACA,cAAIjD,KAAK,GAAGwQ,OAAO,CAACxQ,KAAR,CAAciQ,MAAd,CAAZ;;AACA,cAAIjQ,KAAK,IAAIA,KAAK,CAAC,CAAD,CAAlB,EAAuB;AACnB,gBAAIyQ,GAAG,GAAGzQ,KAAK,CAAC,CAAD,CAAL,CAASuQ,IAAT,EAAV;AACAvB,YAAAA,OAAO,CAACgB,IAAD,EAAOS,GAAP,CAAP;AACH;AACJ,SAPD;AAQH,OATD,MAUK;AACDZ,QAAAA,+BAA+B,CAACvM,OAAhC,CAAwC,UAAU0M,IAAV,EAAgB;AACpD,cAAIS,GAAG,GAAGL,KAAK,CAACE,gBAAN,CAAuBN,IAAvB,CAAV;;AACA,cAAIS,GAAG,IAAIA,GAAG,CAACrR,QAAJ,CAAa,MAAb,CAAX,EAAiC;AAC7B4P,YAAAA,OAAO,CAACgB,IAAD,EAAOS,GAAP,CAAP;AACH;AACJ,SALD;AAMH;AACJ;AACJ;;AACD,MAAIC,WAAW,GAAG,qCAAlB;AACA,MAAIC,cAAc,GAAG,qDAArB;;AACA,WAASC,cAAT,CAAwBC,MAAxB,EAAgC;AAC5B,WAAOA,MAAM,CAACC,OAAP,CAAe,eAAf,EAAgC,IAAhC,EAAsCP,IAAtC,GAA6CO,OAA7C,CAAqD,UAArD,EAAiE,IAAjE,EAAuEA,OAAvE,CAA+E,UAA/E,EAA2F,IAA3F,CAAP;AACH;;AACD,WAASC,cAAT,CAAwBrQ,GAAxB,EAA6B;AACzB,QAAImQ,MAAM,GAAG3C,QAAQ,CAACxN,GAAD,CAArB;AACA,WAAO,KAAKmQ,MAAM,CAACjQ,MAAZ,GAAqBiQ,MAAM,CAACG,QAAP,CAAgBF,OAAhB,CAAwB,OAAxB,EAAiC,EAAjC,EAAqCA,OAArC,CAA6C,gBAA7C,EAA+D,IAA/D,CAA5B;AACH;;AACD,WAASG,kCAAT,CAA4CC,IAA5C,EAAkDC,WAAlD,EAA+D;AAC3D,WAAOD,IAAI,CAACJ,OAAL,CAAaJ,WAAb,EAA0B,UAAU1Q,KAAV,EAAiB;AAC9C,UAAIoR,SAAS,GAAGR,cAAc,CAAC5Q,KAAD,CAA9B;AACA,aAAO,WAAWwO,cAAc,CAAC2C,WAAD,EAAcC,SAAd,CAAzB,GAAoD,KAA3D;AACH,KAHM,CAAP;AAIH;;AACD,MAAIC,gBAAgB,GAAG,mBAAvB;;AACA,WAASC,iBAAT,CAA2BJ,IAA3B,EAAiC;AAC7B,WAAOA,IAAI,CAACJ,OAAL,CAAaO,gBAAb,EAA+B,EAA/B,CAAP;AACH;;AACD,MAAIE,aAAa,GAAG,uBAApB;;AACA,WAASC,kBAAT,CAA4BN,IAA5B,EAAkC;AAC9B,WAAOA,IAAI,CAACJ,OAAL,CAAaS,aAAb,EAA4B,EAA5B,CAAP;AACH;;AAED,WAASE,QAAT,CAAkB3Q,EAAlB,EAAsB;AAClB,QAAI4Q,CAAC,GAAG5Q,EAAE,CAAC4Q,CAAX;AAAA,QAAc9Y,CAAC,GAAGkI,EAAE,CAAClI,CAArB;AAAA,QAAwByD,CAAC,GAAGyE,EAAE,CAACzE,CAA/B;AAAA,QAAkC4G,EAAE,GAAGnC,EAAE,CAACwF,CAA1C;AAAA,QAA6CA,CAAC,GAAGrD,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAArE;;AACA,QAAIrK,CAAC,KAAK,CAAV,EAAa;AACT,UAAI+Y,EAAE,GAAG9V,MAAM,CAAC,CAACQ,CAAD,EAAIA,CAAJ,EAAOA,CAAP,EAAU0T,GAAV,CAAc,UAAU6B,CAAV,EAAa;AAAE,eAAOC,IAAI,CAACC,KAAL,CAAWF,CAAC,GAAG,GAAf,CAAP;AAA6B,OAA1D,CAAD,EAA8D,CAA9D,CAAf;AAAA,UAAiFG,GAAG,GAAGJ,EAAE,CAAC,CAAD,CAAzF;AAAA,UAA8FK,GAAG,GAAGL,EAAE,CAAC,CAAD,CAAtG;AAAA,UAA2GM,GAAG,GAAGN,EAAE,CAAC,CAAD,CAAnH;;AACA,aAAO;AAAE7V,QAAAA,CAAC,EAAEiW,GAAL;AAAU9W,QAAAA,CAAC,EAAEgX,GAAb;AAAkBpD,QAAAA,CAAC,EAAEmD,GAArB;AAA0B1L,QAAAA,CAAC,EAAEA;AAA7B,OAAP;AACH;;AACD,QAAI4L,CAAC,GAAG,CAAC,IAAIL,IAAI,CAACM,GAAL,CAAS,IAAI9V,CAAJ,GAAQ,CAAjB,CAAL,IAA4BzD,CAApC;AACA,QAAIgZ,CAAC,GAAGM,CAAC,IAAI,IAAIL,IAAI,CAACM,GAAL,CAAUT,CAAC,GAAG,EAAL,GAAW,CAAX,GAAe,CAAxB,CAAR,CAAT;AACA,QAAI9V,CAAC,GAAGS,CAAC,GAAG6V,CAAC,GAAG,CAAhB;;AACA,QAAIE,EAAE,GAAGvW,MAAM,CAAC,CAAC6V,CAAC,GAAG,EAAJ,GAAS,CAACQ,CAAD,EAAIN,CAAJ,EAAO,CAAP,CAAT,GACbF,CAAC,GAAG,GAAJ,GAAU,CAACE,CAAD,EAAIM,CAAJ,EAAO,CAAP,CAAV,GACIR,CAAC,GAAG,GAAJ,GAAU,CAAC,CAAD,EAAIQ,CAAJ,EAAON,CAAP,CAAV,GACIF,CAAC,GAAG,GAAJ,GAAU,CAAC,CAAD,EAAIE,CAAJ,EAAOM,CAAP,CAAV,GACIR,CAAC,GAAG,GAAJ,GAAU,CAACE,CAAD,EAAI,CAAJ,EAAOM,CAAP,CAAV,GACI,CAACA,CAAD,EAAI,CAAJ,EAAON,CAAP,CALJ,EAKe7B,GALf,CAKmB,UAAUjX,CAAV,EAAa;AAAE,aAAO+Y,IAAI,CAACC,KAAL,CAAW,CAAChZ,CAAC,GAAG8C,CAAL,IAAU,GAArB,CAAP;AAAmC,KALrE,CAAD,EAKyE,CALzE,CAAf;AAAA,QAK4FE,CAAC,GAAGsW,EAAE,CAAC,CAAD,CALlG;AAAA,QAKuGnX,CAAC,GAAGmX,EAAE,CAAC,CAAD,CAL7G;AAAA,QAKkHvD,CAAC,GAAGuD,EAAE,CAAC,CAAD,CALxH;;AAMA,WAAO;AAAEtW,MAAAA,CAAC,EAAEA,CAAL;AAAQb,MAAAA,CAAC,EAAEA,CAAX;AAAc4T,MAAAA,CAAC,EAAEA,CAAjB;AAAoBvI,MAAAA,CAAC,EAAEA;AAAvB,KAAP;AACH;;AACD,WAAS+L,QAAT,CAAkBvR,EAAlB,EAAsB;AAClB,QAAIwR,IAAI,GAAGxR,EAAE,CAAChF,CAAd;AAAA,QAAiByW,IAAI,GAAGzR,EAAE,CAAC7F,CAA3B;AAAA,QAA8BuX,IAAI,GAAG1R,EAAE,CAAC+N,CAAxC;AAAA,QAA2C5L,EAAE,GAAGnC,EAAE,CAACwF,CAAnD;AAAA,QAAsDA,CAAC,GAAGrD,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAA9E;AACA,QAAInH,CAAC,GAAGwW,IAAI,GAAG,GAAf;AACA,QAAIrX,CAAC,GAAGsX,IAAI,GAAG,GAAf;AACA,QAAI1D,CAAC,GAAG2D,IAAI,GAAG,GAAf;AACA,QAAIC,GAAG,GAAGZ,IAAI,CAACY,GAAL,CAAS3W,CAAT,EAAYb,CAAZ,EAAe4T,CAAf,CAAV;AACA,QAAI6D,GAAG,GAAGb,IAAI,CAACa,GAAL,CAAS5W,CAAT,EAAYb,CAAZ,EAAe4T,CAAf,CAAV;AACA,QAAIqD,CAAC,GAAGO,GAAG,GAAGC,GAAd;AACA,QAAIrW,CAAC,GAAG,CAACoW,GAAG,GAAGC,GAAP,IAAc,CAAtB;;AACA,QAAIR,CAAC,KAAK,CAAV,EAAa;AACT,aAAO;AAAER,QAAAA,CAAC,EAAE,CAAL;AAAQ9Y,QAAAA,CAAC,EAAE,CAAX;AAAcyD,QAAAA,CAAC,EAAEA,CAAjB;AAAoBiK,QAAAA,CAAC,EAAEA;AAAvB,OAAP;AACH;;AACD,QAAIoL,CAAC,GAAG,CAACe,GAAG,KAAK3W,CAAR,GAAc,CAACb,CAAC,GAAG4T,CAAL,IAAUqD,CAAX,GAAgB,CAA7B,GACLO,GAAG,KAAKxX,CAAR,GAAa,CAAC4T,CAAC,GAAG/S,CAAL,IAAUoW,CAAV,GAAc,CAA3B,GACK,CAACpW,CAAC,GAAGb,CAAL,IAAUiX,CAAV,GAAc,CAFf,IAEqB,EAF7B;;AAGA,QAAIR,CAAC,GAAG,CAAR,EAAW;AACPA,MAAAA,CAAC,IAAI,GAAL;AACH;;AACD,QAAI9Y,CAAC,GAAGsZ,CAAC,IAAI,IAAIL,IAAI,CAACM,GAAL,CAAS,IAAI9V,CAAJ,GAAQ,CAAjB,CAAR,CAAT;AACA,WAAO;AAAEqV,MAAAA,CAAC,EAAEA,CAAL;AAAQ9Y,MAAAA,CAAC,EAAEA,CAAX;AAAcyD,MAAAA,CAAC,EAAEA,CAAjB;AAAoBiK,MAAAA,CAAC,EAAEA;AAAvB,KAAP;AACH;;AACD,WAASqM,OAAT,CAAiB7Z,CAAjB,EAAoB8Z,MAApB,EAA4B;AACxB,QAAIA,MAAM,KAAK,KAAK,CAApB,EAAuB;AAAEA,MAAAA,MAAM,GAAG,CAAT;AAAa;;AACtC,QAAIC,KAAK,GAAG/Z,CAAC,CAAC6Z,OAAF,CAAUC,MAAV,CAAZ;;AACA,QAAIA,MAAM,KAAK,CAAf,EAAkB;AACd,aAAOC,KAAP;AACH;;AACD,QAAIC,GAAG,GAAGD,KAAK,CAACE,OAAN,CAAc,GAAd,CAAV;;AACA,QAAID,GAAG,IAAI,CAAX,EAAc;AACV,UAAIE,UAAU,GAAGH,KAAK,CAAC7S,KAAN,CAAY,KAAZ,CAAjB;;AACA,UAAIgT,UAAJ,EAAgB;AACZ,YAAIA,UAAU,CAACC,KAAX,KAAqBH,GAAG,GAAG,CAA/B,EAAkC;AAC9B,iBAAOD,KAAK,CAACK,SAAN,CAAgB,CAAhB,EAAmBJ,GAAnB,CAAP;AACH;;AACD,eAAOD,KAAK,CAACK,SAAN,CAAgB,CAAhB,EAAmBF,UAAU,CAACC,KAA9B,CAAP;AACH;AACJ;;AACD,WAAOJ,KAAP;AACH;;AACD,WAASM,WAAT,CAAqBC,GAArB,EAA0B;AACtB,QAAItX,CAAC,GAAGsX,GAAG,CAACtX,CAAZ;AAAA,QAAeb,CAAC,GAAGmY,GAAG,CAACnY,CAAvB;AAAA,QAA0B4T,CAAC,GAAGuE,GAAG,CAACvE,CAAlC;AAAA,QAAqCvI,CAAC,GAAG8M,GAAG,CAAC9M,CAA7C;;AACA,QAAIA,CAAC,IAAI,IAAL,IAAaA,CAAC,GAAG,CAArB,EAAwB;AACpB,aAAO,UAAUqM,OAAO,CAAC7W,CAAD,CAAjB,GAAuB,IAAvB,GAA8B6W,OAAO,CAAC1X,CAAD,CAArC,GAA2C,IAA3C,GAAkD0X,OAAO,CAAC9D,CAAD,CAAzD,GAA+D,IAA/D,GAAsE8D,OAAO,CAACrM,CAAD,EAAI,CAAJ,CAA7E,GAAsF,GAA7F;AACH;;AACD,WAAO,SAASqM,OAAO,CAAC7W,CAAD,CAAhB,GAAsB,IAAtB,GAA6B6W,OAAO,CAAC1X,CAAD,CAApC,GAA0C,IAA1C,GAAiD0X,OAAO,CAAC9D,CAAD,CAAxD,GAA8D,GAArE;AACH;;AACD,WAASwE,cAAT,CAAwBvS,EAAxB,EAA4B;AACxB,QAAIhF,CAAC,GAAGgF,EAAE,CAAChF,CAAX;AAAA,QAAcb,CAAC,GAAG6F,EAAE,CAAC7F,CAArB;AAAA,QAAwB4T,CAAC,GAAG/N,EAAE,CAAC+N,CAA/B;AAAA,QAAkCvI,CAAC,GAAGxF,EAAE,CAACwF,CAAzC;AACA,WAAO,MAAM,CAACA,CAAC,IAAI,IAAL,IAAaA,CAAC,GAAG,CAAjB,GAAqB,CAACxK,CAAD,EAAIb,CAAJ,EAAO4T,CAAP,EAAUgD,IAAI,CAACC,KAAL,CAAWxL,CAAC,GAAG,GAAf,CAAV,CAArB,GAAsD,CAACxK,CAAD,EAAIb,CAAJ,EAAO4T,CAAP,CAAvD,EAAkEkB,GAAlE,CAAsE,UAAU6B,CAAV,EAAa;AAC5F,aAAO,MAAMA,CAAC,GAAG,EAAJ,GAAS,GAAT,GAAe,EAArB,IAA2BA,CAAC,CAAC0B,QAAF,CAAW,EAAX,CAAlC;AACH,KAFY,EAEVnR,IAFU,CAEL,EAFK,CAAb;AAGH;;AACD,WAASoR,WAAT,CAAqBC,GAArB,EAA0B;AACtB,QAAI9B,CAAC,GAAG8B,GAAG,CAAC9B,CAAZ;AAAA,QAAe9Y,CAAC,GAAG4a,GAAG,CAAC5a,CAAvB;AAAA,QAA0ByD,CAAC,GAAGmX,GAAG,CAACnX,CAAlC;AAAA,QAAqCiK,CAAC,GAAGkN,GAAG,CAAClN,CAA7C;;AACA,QAAIA,CAAC,IAAI,IAAL,IAAaA,CAAC,GAAG,CAArB,EAAwB;AACpB,aAAO,UAAUqM,OAAO,CAACjB,CAAD,CAAjB,GAAuB,IAAvB,GAA8BiB,OAAO,CAAC/Z,CAAC,GAAG,GAAL,CAArC,GAAiD,KAAjD,GAAyD+Z,OAAO,CAACtW,CAAC,GAAG,GAAL,CAAhE,GAA4E,KAA5E,GAAoFsW,OAAO,CAACrM,CAAD,EAAI,CAAJ,CAA3F,GAAoG,GAA3G;AACH;;AACD,WAAO,SAASqM,OAAO,CAACjB,CAAD,CAAhB,GAAsB,IAAtB,GAA6BiB,OAAO,CAAC/Z,CAAC,GAAG,GAAL,CAApC,GAAgD,KAAhD,GAAwD+Z,OAAO,CAACtW,CAAC,GAAG,GAAL,CAA/D,GAA2E,IAAlF;AACH;;AACD,MAAIoX,QAAQ,GAAG,qBAAf;AACA,MAAIC,QAAQ,GAAG,qBAAf;AACA,MAAIC,QAAQ,GAAG,eAAf;;AACA,WAASC,KAAT,CAAeC,MAAf,EAAuB;AACnB,QAAI3B,CAAC,GAAG2B,MAAM,CAACtD,IAAP,GAActR,WAAd,EAAR;;AACA,QAAIiT,CAAC,CAAClS,KAAF,CAAQyT,QAAR,CAAJ,EAAuB;AACnB,aAAOK,QAAQ,CAAC5B,CAAD,CAAf;AACH;;AACD,QAAIA,CAAC,CAAClS,KAAF,CAAQ0T,QAAR,CAAJ,EAAuB;AACnB,aAAOK,QAAQ,CAAC7B,CAAD,CAAf;AACH;;AACD,QAAIA,CAAC,CAAClS,KAAF,CAAQ2T,QAAR,CAAJ,EAAuB;AACnB,aAAOK,QAAQ,CAAC9B,CAAD,CAAf;AACH;;AACD,QAAI+B,WAAW,CAACvH,GAAZ,CAAgBwF,CAAhB,CAAJ,EAAwB;AACpB,aAAOgC,cAAc,CAAChC,CAAD,CAArB;AACH;;AACD,QAAIiC,YAAY,CAACzH,GAAb,CAAiBwF,CAAjB,CAAJ,EAAyB;AACrB,aAAOkC,cAAc,CAAClC,CAAD,CAArB;AACH;;AACD,QAAI2B,MAAM,KAAK,aAAf,EAA8B;AAC1B,aAAO;AAAE/X,QAAAA,CAAC,EAAE,CAAL;AAAQb,QAAAA,CAAC,EAAE,CAAX;AAAc4T,QAAAA,CAAC,EAAE,CAAjB;AAAoBvI,QAAAA,CAAC,EAAE;AAAvB,OAAP;AACH;;AACD,UAAM,IAAIhF,KAAJ,CAAU,qBAAqBuS,MAA/B,CAAN;AACH;;AACD,WAASQ,UAAT,CAAoBR,MAApB,EAA4B;AACxB,QAAIS,OAAO,GAAG,EAAd;AACA,QAAIC,OAAO,GAAG,CAAd;AACA,QAAIC,QAAQ,GAAG,KAAf;AACA,QAAIC,UAAU,GAAGZ,MAAM,CAACd,OAAP,CAAe,GAAf,CAAjB;AACAc,IAAAA,MAAM,GAAGA,MAAM,CAACX,SAAP,CAAiBuB,UAAU,GAAG,CAA9B,EAAiCZ,MAAM,CAAC7a,MAAP,GAAgB,CAAjD,CAAT;;AACA,SAAK,IAAIH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGgb,MAAM,CAAC7a,MAA3B,EAAmCH,CAAC,EAApC,EAAwC;AACpC,UAAIqZ,CAAC,GAAG2B,MAAM,CAAChb,CAAD,CAAd;;AACA,UAAIqZ,CAAC,IAAI,GAAL,IAAYA,CAAC,IAAI,GAAjB,IAAwBA,CAAC,KAAK,GAA9B,IAAqCA,CAAC,KAAK,GAA3C,IAAkDA,CAAC,KAAK,GAA5D,EAAiE;AAC7DsC,QAAAA,QAAQ,GAAG,IAAX;AACH,OAFD,MAGK,IAAIA,QAAQ,KAAKtC,CAAC,KAAK,GAAN,IAAaA,CAAC,KAAK,GAAxB,CAAZ,EAA0C;AAC3CoC,QAAAA,OAAO,CAAC7Y,IAAR,CAAaoY,MAAM,CAACX,SAAP,CAAiBqB,OAAjB,EAA0B1b,CAA1B,CAAb;AACA2b,QAAAA,QAAQ,GAAG,KAAX;AACAD,QAAAA,OAAO,GAAG1b,CAAC,GAAG,CAAd;AACH,OAJI,MAKA,IAAI,CAAC2b,QAAL,EAAe;AAChBD,QAAAA,OAAO,GAAG1b,CAAC,GAAG,CAAd;AACH;AACJ;;AACD,QAAI2b,QAAJ,EAAc;AACVF,MAAAA,OAAO,CAAC7Y,IAAR,CAAaoY,MAAM,CAACX,SAAP,CAAiBqB,OAAjB,EAA0BV,MAAM,CAAC7a,MAAjC,CAAb;AACH;;AACD,WAAOsb,OAAP;AACH;;AACD,WAASI,oBAAT,CAA8BC,GAA9B,EAAmCC,KAAnC,EAA0CC,KAA1C,EAAiD;AAC7C,QAAIC,GAAG,GAAGT,UAAU,CAACM,GAAD,CAApB;AACA,QAAII,SAAS,GAAGtc,MAAM,CAACuc,OAAP,CAAeH,KAAf,CAAhB;AACA,QAAIP,OAAO,GAAGQ,GAAG,CAAC/E,GAAJ,CAAQ,UAAUjU,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACyU,IAAF,EAAP;AAAkB,KAAzC,EAA2CR,GAA3C,CAA+C,UAAUjU,CAAV,EAAajD,CAAb,EAAgB;AACzE,UAAIC,CAAJ;AACA,UAAImc,IAAI,GAAGF,SAAS,CAACG,IAAV,CAAe,UAAUpU,EAAV,EAAc;AACpC,YAAImC,EAAE,GAAGpH,MAAM,CAACiF,EAAD,EAAK,CAAL,CAAf;AAAA,YAAwBqU,CAAC,GAAGlS,EAAE,CAAC,CAAD,CAA9B;;AACA,eAAOnH,CAAC,CAACqF,QAAF,CAAWgU,CAAX,CAAP;AACH,OAHU,CAAX;;AAIA,UAAIF,IAAJ,EAAU;AACNnc,QAAAA,CAAC,GAAGsc,UAAU,CAACtZ,CAAC,CAACoX,SAAF,CAAY,CAAZ,EAAepX,CAAC,CAAC9C,MAAF,GAAWic,IAAI,CAAC,CAAD,CAAJ,CAAQjc,MAAlC,CAAD,CAAV,GAAwDic,IAAI,CAAC,CAAD,CAA5D,GAAkEL,KAAK,CAAC/b,CAAD,CAA3E;AACH,OAFD,MAGK;AACDC,QAAAA,CAAC,GAAGsc,UAAU,CAACtZ,CAAD,CAAd;AACH;;AACD,UAAI8Y,KAAK,CAAC/b,CAAD,CAAL,GAAW,CAAf,EAAkB;AACd,eAAOgZ,IAAI,CAACC,KAAL,CAAWhZ,CAAX,CAAP;AACH;;AACD,aAAOA,CAAP;AACH,KAhBa,CAAd;AAiBA,WAAOwb,OAAP;AACH;;AACD,MAAIe,QAAQ,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,CAAhB,CAAf;AACA,MAAIC,QAAQ,GAAG;AAAE,SAAK;AAAP,GAAf;;AACA,WAASxB,QAAT,CAAkByB,IAAlB,EAAwB;AACpB,QAAIzU,EAAE,GAAGjF,MAAM,CAAC6Y,oBAAoB,CAACa,IAAD,EAAOF,QAAP,EAAiBC,QAAjB,CAArB,EAAiD,CAAjD,CAAf;AAAA,QAAoExZ,CAAC,GAAGgF,EAAE,CAAC,CAAD,CAA1E;AAAA,QAA+E7F,CAAC,GAAG6F,EAAE,CAAC,CAAD,CAArF;AAAA,QAA0F+N,CAAC,GAAG/N,EAAE,CAAC,CAAD,CAAhG;AAAA,QAAqGmC,EAAE,GAAGnC,EAAE,CAAC,CAAD,CAA5G;AAAA,QAAiHwF,CAAC,GAAGrD,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzI;;AACA,WAAO;AAAEnH,MAAAA,CAAC,EAAEA,CAAL;AAAQb,MAAAA,CAAC,EAAEA,CAAX;AAAc4T,MAAAA,CAAC,EAAEA,CAAjB;AAAoBvI,MAAAA,CAAC,EAAEA;AAAvB,KAAP;AACH;;AACD,MAAIkP,QAAQ,GAAG,CAAC,GAAD,EAAM,CAAN,EAAS,CAAT,EAAY,CAAZ,CAAf;AACA,MAAIC,QAAQ,GAAG;AAAE,SAAK,GAAP;AAAY,WAAO,GAAnB;AAAwB,WAAO,IAAI5D,IAAI,CAAC6D,EAAxC;AAA4C,YAAQ;AAApD,GAAf;;AACA,WAAS3B,QAAT,CAAkB4B,IAAlB,EAAwB;AACpB,QAAI7U,EAAE,GAAGjF,MAAM,CAAC6Y,oBAAoB,CAACiB,IAAD,EAAOH,QAAP,EAAiBC,QAAjB,CAArB,EAAiD,CAAjD,CAAf;AAAA,QAAoE/D,CAAC,GAAG5Q,EAAE,CAAC,CAAD,CAA1E;AAAA,QAA+ElI,CAAC,GAAGkI,EAAE,CAAC,CAAD,CAArF;AAAA,QAA0FzE,CAAC,GAAGyE,EAAE,CAAC,CAAD,CAAhG;AAAA,QAAqGmC,EAAE,GAAGnC,EAAE,CAAC,CAAD,CAA5G;AAAA,QAAiHwF,CAAC,GAAGrD,EAAE,KAAK,KAAK,CAAZ,GAAgB,CAAhB,GAAoBA,EAAzI;;AACA,WAAOwO,QAAQ,CAAC;AAAEC,MAAAA,CAAC,EAAEA,CAAL;AAAQ9Y,MAAAA,CAAC,EAAEA,CAAX;AAAcyD,MAAAA,CAAC,EAAEA,CAAjB;AAAoBiK,MAAAA,CAAC,EAAEA;AAAvB,KAAD,CAAf;AACH;;AACD,WAAS0N,QAAT,CAAkB4B,IAAlB,EAAwB;AACpB,QAAIlE,CAAC,GAAGkE,IAAI,CAAC1C,SAAL,CAAe,CAAf,CAAR;;AACA,YAAQxB,CAAC,CAAC1Y,MAAV;AACI,WAAK,CAAL;AACA,WAAK,CAAL;AAAQ;AACJ,cAAI8H,EAAE,GAAGjF,MAAM,CAAC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAUkU,GAAV,CAAc,UAAUlX,CAAV,EAAa;AAAE,mBAAOgd,QAAQ,CAAC,KAAKnE,CAAC,CAAC7Y,CAAD,CAAN,GAAY6Y,CAAC,CAAC7Y,CAAD,CAAd,EAAmB,EAAnB,CAAf;AAAwC,WAArE,CAAD,EAAyE,CAAzE,CAAf;AAAA,cAA4FiD,CAAC,GAAGgF,EAAE,CAAC,CAAD,CAAlG;AAAA,cAAuG7F,CAAC,GAAG6F,EAAE,CAAC,CAAD,CAA7G;AAAA,cAAkH+N,CAAC,GAAG/N,EAAE,CAAC,CAAD,CAAxH;;AACA,cAAIwF,CAAC,GAAGoL,CAAC,CAAC1Y,MAAF,KAAa,CAAb,GAAiB,CAAjB,GAAsB6c,QAAQ,CAAC,KAAKnE,CAAC,CAAC,CAAD,CAAN,GAAYA,CAAC,CAAC,CAAD,CAAd,EAAmB,EAAnB,CAAR,GAAiC,GAA/D;AACA,iBAAO;AAAE5V,YAAAA,CAAC,EAAEA,CAAL;AAAQb,YAAAA,CAAC,EAAEA,CAAX;AAAc4T,YAAAA,CAAC,EAAEA,CAAjB;AAAoBvI,YAAAA,CAAC,EAAEA;AAAvB,WAAP;AACH;;AACD,WAAK,CAAL;AACA,WAAK,CAAL;AAAQ;AACJ,cAAIrD,EAAE,GAAGpH,MAAM,CAAC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAUkU,GAAV,CAAc,UAAUlX,CAAV,EAAa;AAAE,mBAAOgd,QAAQ,CAACnE,CAAC,CAACwB,SAAF,CAAYra,CAAZ,EAAeA,CAAC,GAAG,CAAnB,CAAD,EAAwB,EAAxB,CAAf;AAA6C,WAA1E,CAAD,EAA8E,CAA9E,CAAf;AAAA,cAAiGiD,CAAC,GAAGmH,EAAE,CAAC,CAAD,CAAvG;AAAA,cAA4GhI,CAAC,GAAGgI,EAAE,CAAC,CAAD,CAAlH;AAAA,cAAuH4L,CAAC,GAAG5L,EAAE,CAAC,CAAD,CAA7H;;AACA,cAAIqD,CAAC,GAAGoL,CAAC,CAAC1Y,MAAF,KAAa,CAAb,GAAiB,CAAjB,GAAsB6c,QAAQ,CAACnE,CAAC,CAACwB,SAAF,CAAY,CAAZ,EAAe,CAAf,CAAD,EAAoB,EAApB,CAAR,GAAkC,GAAhE;AACA,iBAAO;AAAEpX,YAAAA,CAAC,EAAEA,CAAL;AAAQb,YAAAA,CAAC,EAAEA,CAAX;AAAc4T,YAAAA,CAAC,EAAEA,CAAjB;AAAoBvI,YAAAA,CAAC,EAAEA;AAAvB,WAAP;AACH;AAZL;;AAcA,UAAM,IAAIhF,KAAJ,CAAU,qBAAqBsU,IAA/B,CAAN;AACH;;AACD,WAAS1B,cAAT,CAAwBL,MAAxB,EAAgC;AAC5B,QAAI/a,CAAC,GAAGmb,WAAW,CAAC5S,GAAZ,CAAgBwS,MAAhB,CAAR;AACA,WAAO;AACH/X,MAAAA,CAAC,EAAGhD,CAAC,IAAI,EAAN,GAAY,GADZ;AAEHmC,MAAAA,CAAC,EAAGnC,CAAC,IAAI,CAAN,GAAW,GAFX;AAGH+V,MAAAA,CAAC,EAAG/V,CAAC,IAAI,CAAN,GAAW,GAHX;AAIHwN,MAAAA,CAAC,EAAE;AAJA,KAAP;AAMH;;AACD,WAAS8N,cAAT,CAAwBP,MAAxB,EAAgC;AAC5B,QAAI/a,CAAC,GAAGqb,YAAY,CAAC9S,GAAb,CAAiBwS,MAAjB,CAAR;AACA,WAAO;AACH/X,MAAAA,CAAC,EAAGhD,CAAC,IAAI,EAAN,GAAY,GADZ;AAEHmC,MAAAA,CAAC,EAAGnC,CAAC,IAAI,CAAN,GAAW,GAFX;AAGH+V,MAAAA,CAAC,EAAG/V,CAAC,IAAI,CAAN,GAAW,GAHX;AAIHwN,MAAAA,CAAC,EAAE;AAJA,KAAP;AAMH;;AACD,MAAI2N,WAAW,GAAG,IAAIpH,GAAJ,CAAQpU,MAAM,CAACuc,OAAP,CAAe;AACrCc,IAAAA,SAAS,EAAE,QAD0B;AAErCC,IAAAA,YAAY,EAAE,QAFuB;AAGrCC,IAAAA,IAAI,EAAE,QAH+B;AAIrCC,IAAAA,UAAU,EAAE,QAJyB;AAKrCC,IAAAA,KAAK,EAAE,QAL8B;AAMrCC,IAAAA,KAAK,EAAE,QAN8B;AAOrCC,IAAAA,MAAM,EAAE,QAP6B;AAQrCC,IAAAA,KAAK,EAAE,QAR8B;AASrCC,IAAAA,cAAc,EAAE,QATqB;AAUrCC,IAAAA,IAAI,EAAE,QAV+B;AAWrCC,IAAAA,UAAU,EAAE,QAXyB;AAYrCC,IAAAA,KAAK,EAAE,QAZ8B;AAarCC,IAAAA,SAAS,EAAE,QAb0B;AAcrCC,IAAAA,SAAS,EAAE,QAd0B;AAerCC,IAAAA,UAAU,EAAE,QAfyB;AAgBrCC,IAAAA,SAAS,EAAE,QAhB0B;AAiBrCC,IAAAA,KAAK,EAAE,QAjB8B;AAkBrCC,IAAAA,cAAc,EAAE,QAlBqB;AAmBrCC,IAAAA,QAAQ,EAAE,QAnB2B;AAoBrCC,IAAAA,OAAO,EAAE,QApB4B;AAqBrCC,IAAAA,IAAI,EAAE,QArB+B;AAsBrCC,IAAAA,QAAQ,EAAE,QAtB2B;AAuBrCC,IAAAA,QAAQ,EAAE,QAvB2B;AAwBrCC,IAAAA,aAAa,EAAE,QAxBsB;AAyBrCC,IAAAA,QAAQ,EAAE,QAzB2B;AA0BrCC,IAAAA,QAAQ,EAAE,QA1B2B;AA2BrCC,IAAAA,SAAS,EAAE,QA3B0B;AA4BrCC,IAAAA,SAAS,EAAE,QA5B0B;AA6BrCC,IAAAA,WAAW,EAAE,QA7BwB;AA8BrCC,IAAAA,cAAc,EAAE,QA9BqB;AA+BrCC,IAAAA,UAAU,EAAE,QA/ByB;AAgCrCC,IAAAA,UAAU,EAAE,QAhCyB;AAiCrCC,IAAAA,OAAO,EAAE,QAjC4B;AAkCrCC,IAAAA,UAAU,EAAE,QAlCyB;AAmCrCC,IAAAA,YAAY,EAAE,QAnCuB;AAoCrCC,IAAAA,aAAa,EAAE,QApCsB;AAqCrCC,IAAAA,aAAa,EAAE,QArCsB;AAsCrCC,IAAAA,aAAa,EAAE,QAtCsB;AAuCrCC,IAAAA,aAAa,EAAE,QAvCsB;AAwCrCC,IAAAA,UAAU,EAAE,QAxCyB;AAyCrCC,IAAAA,QAAQ,EAAE,QAzC2B;AA0CrCC,IAAAA,WAAW,EAAE,QA1CwB;AA2CrCC,IAAAA,OAAO,EAAE,QA3C4B;AA4CrCC,IAAAA,OAAO,EAAE,QA5C4B;AA6CrCC,IAAAA,UAAU,EAAE,QA7CyB;AA8CrCC,IAAAA,SAAS,EAAE,QA9C0B;AA+CrCC,IAAAA,WAAW,EAAE,QA/CwB;AAgDrCC,IAAAA,WAAW,EAAE,QAhDwB;AAiDrCC,IAAAA,OAAO,EAAE,QAjD4B;AAkDrCC,IAAAA,SAAS,EAAE,QAlD0B;AAmDrCC,IAAAA,UAAU,EAAE,QAnDyB;AAoDrCC,IAAAA,IAAI,EAAE,QApD+B;AAqDrCC,IAAAA,SAAS,EAAE,QArD0B;AAsDrCC,IAAAA,IAAI,EAAE,QAtD+B;AAuDrCC,IAAAA,IAAI,EAAE,QAvD+B;AAwDrCC,IAAAA,KAAK,EAAE,QAxD8B;AAyDrCC,IAAAA,WAAW,EAAE,QAzDwB;AA0DrCC,IAAAA,QAAQ,EAAE,QA1D2B;AA2DrCC,IAAAA,OAAO,EAAE,QA3D4B;AA4DrCC,IAAAA,SAAS,EAAE,QA5D0B;AA6DrCC,IAAAA,MAAM,EAAE,QA7D6B;AA8DrCC,IAAAA,KAAK,EAAE,QA9D8B;AA+DrCC,IAAAA,KAAK,EAAE,QA/D8B;AAgErCC,IAAAA,QAAQ,EAAE,QAhE2B;AAiErCC,IAAAA,aAAa,EAAE,QAjEsB;AAkErCC,IAAAA,SAAS,EAAE,QAlE0B;AAmErCC,IAAAA,YAAY,EAAE,QAnEuB;AAoErCC,IAAAA,SAAS,EAAE,QApE0B;AAqErCC,IAAAA,UAAU,EAAE,QArEyB;AAsErCC,IAAAA,SAAS,EAAE,QAtE0B;AAuErCC,IAAAA,oBAAoB,EAAE,QAvEe;AAwErCC,IAAAA,SAAS,EAAE,QAxE0B;AAyErCC,IAAAA,SAAS,EAAE,QAzE0B;AA0ErCC,IAAAA,UAAU,EAAE,QA1EyB;AA2ErCC,IAAAA,SAAS,EAAE,QA3E0B;AA4ErCC,IAAAA,WAAW,EAAE,QA5EwB;AA6ErCC,IAAAA,aAAa,EAAE,QA7EsB;AA8ErCC,IAAAA,YAAY,EAAE,QA9EuB;AA+ErCC,IAAAA,cAAc,EAAE,QA/EqB;AAgFrCC,IAAAA,cAAc,EAAE,QAhFqB;AAiFrCC,IAAAA,cAAc,EAAE,QAjFqB;AAkFrCC,IAAAA,WAAW,EAAE,QAlFwB;AAmFrCC,IAAAA,IAAI,EAAE,QAnF+B;AAoFrCC,IAAAA,SAAS,EAAE,QApF0B;AAqFrCC,IAAAA,KAAK,EAAE,QArF8B;AAsFrCC,IAAAA,OAAO,EAAE,QAtF4B;AAuFrCC,IAAAA,MAAM,EAAE,QAvF6B;AAwFrCC,IAAAA,gBAAgB,EAAE,QAxFmB;AAyFrCC,IAAAA,UAAU,EAAE,QAzFyB;AA0FrCC,IAAAA,YAAY,EAAE,QA1FuB;AA2FrCC,IAAAA,YAAY,EAAE,QA3FuB;AA4FrCC,IAAAA,cAAc,EAAE,QA5FqB;AA6FrCC,IAAAA,eAAe,EAAE,QA7FoB;AA8FrCC,IAAAA,iBAAiB,EAAE,QA9FkB;AA+FrCC,IAAAA,eAAe,EAAE,QA/FoB;AAgGrCC,IAAAA,eAAe,EAAE,QAhGoB;AAiGrCC,IAAAA,YAAY,EAAE,QAjGuB;AAkGrCC,IAAAA,SAAS,EAAE,QAlG0B;AAmGrCC,IAAAA,SAAS,EAAE,QAnG0B;AAoGrCC,IAAAA,QAAQ,EAAE,QApG2B;AAqGrCC,IAAAA,WAAW,EAAE,QArGwB;AAsGrCC,IAAAA,IAAI,EAAE,QAtG+B;AAuGrCC,IAAAA,OAAO,EAAE,QAvG4B;AAwGrCC,IAAAA,KAAK,EAAE,QAxG8B;AAyGrCC,IAAAA,SAAS,EAAE,QAzG0B;AA0GrCC,IAAAA,MAAM,EAAE,QA1G6B;AA2GrCC,IAAAA,SAAS,EAAE,QA3G0B;AA4GrCC,IAAAA,MAAM,EAAE,QA5G6B;AA6GrCC,IAAAA,aAAa,EAAE,QA7GsB;AA8GrCC,IAAAA,SAAS,EAAE,QA9G0B;AA+GrCC,IAAAA,aAAa,EAAE,QA/GsB;AAgHrCC,IAAAA,aAAa,EAAE,QAhHsB;AAiHrCC,IAAAA,UAAU,EAAE,QAjHyB;AAkHrCC,IAAAA,SAAS,EAAE,QAlH0B;AAmHrCC,IAAAA,IAAI,EAAE,QAnH+B;AAoHrCC,IAAAA,IAAI,EAAE,QApH+B;AAqHrCC,IAAAA,IAAI,EAAE,QArH+B;AAsHrCC,IAAAA,UAAU,EAAE,QAtHyB;AAuHrCC,IAAAA,MAAM,EAAE,QAvH6B;AAwHrCC,IAAAA,aAAa,EAAE,QAxHsB;AAyHrCC,IAAAA,GAAG,EAAE,QAzHgC;AA0HrCC,IAAAA,SAAS,EAAE,QA1H0B;AA2HrCC,IAAAA,SAAS,EAAE,QA3H0B;AA4HrCC,IAAAA,WAAW,EAAE,QA5HwB;AA6HrCC,IAAAA,MAAM,EAAE,QA7H6B;AA8HrCC,IAAAA,UAAU,EAAE,QA9HyB;AA+HrCC,IAAAA,QAAQ,EAAE,QA/H2B;AAgIrCC,IAAAA,QAAQ,EAAE,QAhI2B;AAiIrCC,IAAAA,MAAM,EAAE,QAjI6B;AAkIrCC,IAAAA,MAAM,EAAE,QAlI6B;AAmIrCC,IAAAA,OAAO,EAAE,QAnI4B;AAoIrCC,IAAAA,SAAS,EAAE,QApI0B;AAqIrCC,IAAAA,SAAS,EAAE,QArI0B;AAsIrCC,IAAAA,SAAS,EAAE,QAtI0B;AAuIrCC,IAAAA,IAAI,EAAE,QAvI+B;AAwIrCC,IAAAA,WAAW,EAAE,QAxIwB;AAyIrCC,IAAAA,SAAS,EAAE,QAzI0B;AA0IrCC,IAAAA,GAAG,EAAE,QA1IgC;AA2IrCC,IAAAA,IAAI,EAAE,QA3I+B;AA4IrCC,IAAAA,OAAO,EAAE,QA5I4B;AA6IrCC,IAAAA,MAAM,EAAE,QA7I6B;AA8IrCC,IAAAA,SAAS,EAAE,QA9I0B;AA+IrCC,IAAAA,MAAM,EAAE,QA/I6B;AAgJrCC,IAAAA,KAAK,EAAE,QAhJ8B;AAiJrCC,IAAAA,KAAK,EAAE,QAjJ8B;AAkJrCC,IAAAA,UAAU,EAAE,QAlJyB;AAmJrCC,IAAAA,MAAM,EAAE,QAnJ6B;AAoJrCC,IAAAA,WAAW,EAAE;AApJwB,GAAf,CAAR,CAAlB;AAsJA,MAAI9K,YAAY,GAAG,IAAItH,GAAJ,CAAQpU,MAAM,CAACuc,OAAP,CAAe;AACtCkK,IAAAA,YAAY,EAAE,QADwB;AAEtCC,IAAAA,aAAa,EAAE,QAFuB;AAGtCC,IAAAA,YAAY,EAAE,QAHwB;AAItCC,IAAAA,UAAU,EAAE,QAJ0B;AAKtCC,IAAAA,UAAU,EAAE,QAL0B;AAMtCC,IAAAA,eAAe,EAAE,QANqB;AAOtCC,IAAAA,YAAY,EAAE,QAPwB;AAQtCC,IAAAA,UAAU,EAAE,QAR0B;AAStCC,IAAAA,WAAW,EAAE,QATyB;AAUtCC,IAAAA,QAAQ,EAAE,QAV4B;AAWtCC,IAAAA,SAAS,EAAE,QAX2B;AAYtCC,IAAAA,aAAa,EAAE,QAZuB;AAatCC,IAAAA,cAAc,EAAE,QAbsB;AActCC,IAAAA,eAAe,EAAE,QAdqB;AAetCC,IAAAA,mBAAmB,EAAE,QAfiB;AAgBtCC,IAAAA,cAAc,EAAE,QAhBsB;AAiBtCC,IAAAA,QAAQ,EAAE,QAjB4B;AAkBtCC,IAAAA,IAAI,EAAE,QAlBgC;AAmBtCC,IAAAA,QAAQ,EAAE,QAnB4B;AAoBtCC,IAAAA,SAAS,EAAE,QApB2B;AAqBtCC,IAAAA,gBAAgB,EAAE,QArBoB;AAsBtCC,IAAAA,UAAU,EAAE,QAtB0B;AAuBtCC,IAAAA,eAAe,EAAE,QAvBqB;AAwBtCC,IAAAA,iBAAiB,EAAE,QAxBmB;AAyBtCC,IAAAA,YAAY,EAAE,QAzBwB;AA0BtCC,IAAAA,MAAM,EAAE,QA1B8B;AA2BtCC,IAAAA,WAAW,EAAE,QA3ByB;AA4BtCC,IAAAA,UAAU,EAAE,QA5B0B;AA6BtC,gCAA4B;AA7BU,GAAf,EA8BxB9Q,GA9BwB,CA8BpB,UAAUjP,EAAV,EAAc;AACjB,QAAImC,EAAE,GAAGpH,MAAM,CAACiF,EAAD,EAAK,CAAL,CAAf;AAAA,QAAwBsN,GAAG,GAAGnL,EAAE,CAAC,CAAD,CAAhC;AAAA,QAAqCrJ,KAAK,GAAGqJ,EAAE,CAAC,CAAD,CAA/C;;AACA,WAAO,CAACmL,GAAG,CAACnP,WAAJ,EAAD,EAAoBrF,KAApB,CAAP;AACH,GAjC0B,CAAR,CAAnB;;AAmCA,WAASknB,KAAT,CAAelP,CAAf,EAAkBmP,KAAlB,EAAyBC,MAAzB,EAAiCC,MAAjC,EAAyCC,OAAzC,EAAkD;AAC9C,WAAO,CAACtP,CAAC,GAAGmP,KAAL,KAAeG,OAAO,GAAGD,MAAzB,KAAoCD,MAAM,GAAGD,KAA7C,IAAsDE,MAA7D;AACH;;AACD,WAASE,KAAT,CAAevP,CAAf,EAAkBc,GAAlB,EAAuBD,GAAvB,EAA4B;AACxB,WAAOZ,IAAI,CAACa,GAAL,CAASD,GAAT,EAAcZ,IAAI,CAACY,GAAL,CAASC,GAAT,EAAcd,CAAd,CAAd,CAAP;AACH;;AACD,WAASwP,gBAAT,CAA0BC,EAA1B,EAA8BC,EAA9B,EAAkC;AAC9B,QAAIjnB,MAAM,GAAG,EAAb;;AACA,SAAK,IAAIxB,CAAC,GAAG,CAAR,EAAWiN,GAAG,GAAGub,EAAE,CAACroB,MAAzB,EAAiCH,CAAC,GAAGiN,GAArC,EAA0CjN,CAAC,EAA3C,EAA+C;AAC3CwB,MAAAA,MAAM,CAACxB,CAAD,CAAN,GAAY,EAAZ;;AACA,WAAK,IAAI0oB,CAAC,GAAG,CAAR,EAAWC,IAAI,GAAGF,EAAE,CAAC,CAAD,CAAF,CAAMtoB,MAA7B,EAAqCuoB,CAAC,GAAGC,IAAzC,EAA+CD,CAAC,EAAhD,EAAoD;AAChD,YAAIE,GAAG,GAAG,CAAV;;AACA,aAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,IAAI,GAAGN,EAAE,CAAC,CAAD,CAAF,CAAMroB,MAA7B,EAAqC0oB,CAAC,GAAGC,IAAzC,EAA+CD,CAAC,EAAhD,EAAoD;AAChDD,UAAAA,GAAG,IAAIJ,EAAE,CAACxoB,CAAD,CAAF,CAAM6oB,CAAN,IAAWJ,EAAE,CAACI,CAAD,CAAF,CAAMH,CAAN,CAAlB;AACH;;AACDlnB,QAAAA,MAAM,CAACxB,CAAD,CAAN,CAAU0oB,CAAV,IAAeE,GAAf;AACH;AACJ;;AACD,WAAOpnB,MAAP;AACH;;AAED,WAASunB,UAAT,CAAoBC,KAApB,EAA2BC,KAA3B,EAAkCC,KAAlC,EAAyC;AACrC,QAAIA,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,MAAAA,KAAK,GAAG,CAAR;AAAY;;AACpC,QAAIC,OAAO,GAAG,EAAd;AACA,QAAIpmB,CAAJ;;AACA,WAAQA,CAAC,GAAGimB,KAAK,CAACI,IAAN,CAAWH,KAAX,CAAZ,EAAgC;AAC5BE,MAAAA,OAAO,CAACvmB,IAAR,CAAaG,CAAC,CAACmmB,KAAD,CAAd;AACH;;AACD,WAAOC,OAAP;AACH;;AACD,WAASE,SAAT,CAAmB7e,IAAnB,EAAyB;AACrB,aAAS8e,QAAT,CAAkB9e,IAAlB,EAAwB;AACpB,aAAOA,IAAI,CAACyN,OAAL,CAAa,MAAb,EAAqB,EAArB,CAAP;AACH;;AACD,aAASsR,SAAT,CAAmBC,KAAnB,EAA0B;AACtB,UAAIA,KAAK,KAAK,CAAd,EAAiB;AACb,eAAO,EAAP;AACH;;AACD,aAAO,IAAIC,MAAJ,CAAW,IAAID,KAAf,CAAP;AACH;;AACD,QAAIhf,IAAI,CAACrK,MAAL,GAAc,KAAlB,EAAyB;AACrB,UAAIupB,eAAe,GAAG,aAAtB;;AACA,aAAOA,eAAe,CAAC7T,IAAhB,CAAqBrL,IAArB,CAAP,EAAmC;AAC/BA,QAAAA,IAAI,GAAGA,IAAI,CAACyN,OAAL,CAAayR,eAAb,EAA8B,EAA9B,CAAP;AACH;AACJ;;AACD,QAAIC,GAAG,GAAInf,IAAI,CACVyN,OADM,CACE,SADF,EACa,GADb,EAENA,OAFM,CAEE,KAFF,EAES,KAFT,EAGNA,OAHM,CAGE,KAHF,EAGS,OAHT,EAINA,OAJM,CAIE,yBAJF,EAI6B,KAJ7B,EAKNA,OALM,CAKE,yBALF,EAK6B,KAL7B,EAMNA,OANM,CAME,UANF,EAMc,IANd,EAON2R,KAPM,CAOA,IAPA,CAAX;AAQA,QAAIJ,KAAK,GAAG,CAAZ;AACA,QAAIK,SAAS,GAAG,EAAhB;;AACA,SAAK,IAAI9Q,CAAC,GAAG,CAAR,EAAW9L,GAAG,GAAG0c,GAAG,CAACxpB,MAA1B,EAAkC4Y,CAAC,GAAG9L,GAAtC,EAA2C8L,CAAC,EAA5C,EAAgD;AAC5C,UAAI+Q,IAAI,GAAGH,GAAG,CAAC5Q,CAAD,CAAH,GAAS,IAApB;;AACA,UAAI+Q,IAAI,CAACvjB,QAAL,CAAc,GAAd,CAAJ,EAAwB;AACpBsjB,QAAAA,SAAS,CAACjnB,IAAV,CAAe2mB,SAAS,CAACC,KAAK,EAAN,CAAT,GAAqBF,QAAQ,CAACQ,IAAD,CAA5C;AACH,OAFD,MAGK,IAAIA,IAAI,CAACvjB,QAAL,CAAc,IAAd,CAAJ,EAAyB;AAC1BsjB,QAAAA,SAAS,CAACjnB,IAAV,CAAe2mB,SAAS,CAAC,EAAEC,KAAH,CAAT,GAAqBF,QAAQ,CAACQ,IAAD,CAA5C;AACH,OAFI,MAGA;AACDD,QAAAA,SAAS,CAACjnB,IAAV,CAAe2mB,SAAS,CAACC,KAAD,CAAT,GAAmBF,QAAQ,CAACQ,IAAD,CAA1C;AACH;AACJ;;AACD,WAAOD,SAAS,CAACvgB,IAAV,CAAe,EAAf,EAAmBoO,IAAnB,EAAP;AACH;;AACD,WAASqS,mBAAT,CAA6Bd,KAA7B,EAAoCe,gBAApC,EAAsD;AAClD,QAAIA,gBAAgB,KAAK,KAAK,CAA9B,EAAiC;AAAEA,MAAAA,gBAAgB,GAAG,CAAnB;AAAuB;;AAC1D,QAAI7pB,MAAM,GAAG8oB,KAAK,CAAC9oB,MAAnB;AACA,QAAIqpB,KAAK,GAAG,CAAZ;AACA,QAAIS,cAAc,GAAG,CAAC,CAAtB;;AACA,SAAK,IAAIjqB,CAAC,GAAGgqB,gBAAb,EAA+BhqB,CAAC,GAAGG,MAAnC,EAA2CH,CAAC,EAA5C,EAAgD;AAC5C,UAAIwpB,KAAK,KAAK,CAAd,EAAiB;AACb,YAAIU,SAAS,GAAGjB,KAAK,CAAC/O,OAAN,CAAc,GAAd,EAAmBla,CAAnB,CAAhB;;AACA,YAAIkqB,SAAS,GAAG,CAAhB,EAAmB;AACf;AACH;;AACDD,QAAAA,cAAc,GAAGC,SAAjB;AACAV,QAAAA,KAAK;AACLxpB,QAAAA,CAAC,GAAGkqB,SAAJ;AACH,OARD,MASK;AACD,YAAIC,YAAY,GAAGlB,KAAK,CAAC/O,OAAN,CAAc,GAAd,EAAmBla,CAAnB,CAAnB;;AACA,YAAImqB,YAAY,GAAG,CAAnB,EAAsB;AAClB;AACH;;AACD,YAAID,SAAS,GAAGjB,KAAK,CAAC/O,OAAN,CAAc,GAAd,EAAmBla,CAAnB,CAAhB;;AACA,YAAIkqB,SAAS,GAAG,CAAZ,IAAiBC,YAAY,GAAGD,SAApC,EAA+C;AAC3CV,UAAAA,KAAK;;AACL,cAAIA,KAAK,KAAK,CAAd,EAAiB;AACb,mBAAO;AAAEvZ,cAAAA,KAAK,EAAEga,cAAT;AAAyBG,cAAAA,GAAG,EAAED,YAAY,GAAG;AAA7C,aAAP;AACH;;AACDnqB,UAAAA,CAAC,GAAGmqB,YAAJ;AACH,SAND,MAOK;AACDX,UAAAA,KAAK;AACLxpB,UAAAA,CAAC,GAAGkqB,SAAJ;AACH;AACJ;AACJ;;AACD,WAAO,IAAP;AACH;;AAED,WAASG,kBAAT,CAA4BC,MAA5B,EAAoC;AAChC,QAAIvnB,CAAC,GAAGwnB,MAAM,CAACC,QAAP,EAAR;;AACA,QAAIF,MAAM,CAACre,KAAP,KAAiB,CAArB,EAAwB;AACpBlJ,MAAAA,CAAC,GAAGwlB,gBAAgB,CAACxlB,CAAD,EAAIwnB,MAAM,CAACte,KAAP,CAAaqe,MAAM,CAACre,KAAP,GAAe,GAA5B,CAAJ,CAApB;AACH;;AACD,QAAIqe,MAAM,CAACte,SAAP,KAAqB,CAAzB,EAA4B;AACxBjJ,MAAAA,CAAC,GAAGwlB,gBAAgB,CAACxlB,CAAD,EAAIwnB,MAAM,CAACve,SAAP,CAAiBse,MAAM,CAACte,SAAP,GAAmB,GAApC,CAAJ,CAApB;AACH;;AACD,QAAIse,MAAM,CAACve,QAAP,KAAoB,GAAxB,EAA6B;AACzBhJ,MAAAA,CAAC,GAAGwlB,gBAAgB,CAACxlB,CAAD,EAAIwnB,MAAM,CAACxe,QAAP,CAAgBue,MAAM,CAACve,QAAP,GAAkB,GAAlC,CAAJ,CAApB;AACH;;AACD,QAAIue,MAAM,CAACxe,UAAP,KAAsB,GAA1B,EAA+B;AAC3B/I,MAAAA,CAAC,GAAGwlB,gBAAgB,CAACxlB,CAAD,EAAIwnB,MAAM,CAACze,UAAP,CAAkBwe,MAAM,CAACxe,UAAP,GAAoB,GAAtC,CAAJ,CAApB;AACH;;AACD,QAAIwe,MAAM,CAACze,IAAP,KAAgB,CAApB,EAAuB;AACnB9I,MAAAA,CAAC,GAAGwlB,gBAAgB,CAACxlB,CAAD,EAAIwnB,MAAM,CAACE,UAAP,EAAJ,CAApB;AACH;;AACD,WAAO1nB,CAAP;AACH;;AACD,WAAS2nB,gBAAT,CAA0BziB,EAA1B,EAA8B0iB,MAA9B,EAAsC;AAClC,QAAIvgB,EAAE,GAAGpH,MAAM,CAACiF,EAAD,EAAK,CAAL,CAAf;AAAA,QAAwBhF,CAAC,GAAGmH,EAAE,CAAC,CAAD,CAA9B;AAAA,QAAmChI,CAAC,GAAGgI,EAAE,CAAC,CAAD,CAAzC;AAAA,QAA8C4L,CAAC,GAAG5L,EAAE,CAAC,CAAD,CAApD;;AACA,QAAImQ,GAAG,GAAG,CAAC,CAACtX,CAAC,GAAG,GAAL,CAAD,EAAY,CAACb,CAAC,GAAG,GAAL,CAAZ,EAAuB,CAAC4T,CAAC,GAAG,GAAL,CAAvB,EAAkC,CAAC,CAAD,CAAlC,EAAuC,CAAC,CAAD,CAAvC,CAAV;AACA,QAAIxU,MAAM,GAAG+mB,gBAAgB,CAACoC,MAAD,EAASpQ,GAAT,CAA7B;AACA,WAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAUrD,GAAV,CAAc,UAAUlX,CAAV,EAAa;AAAE,aAAOsoB,KAAK,CAACtP,IAAI,CAACC,KAAL,CAAWzX,MAAM,CAACxB,CAAD,CAAN,CAAU,CAAV,IAAe,GAA1B,CAAD,EAAiC,CAAjC,EAAoC,GAApC,CAAZ;AAAuD,KAApF,CAAP;AACH;;AACD,MAAIuqB,MAAM,GAAG;AACTC,IAAAA,QAAQ,EAAE,YAAY;AAClB,aAAO,CACH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CADG,EAEH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAFG,EAGH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAHG,EAIH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAJG,EAKH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CALG,CAAP;AAOH,KATQ;AAUTC,IAAAA,UAAU,EAAE,YAAY;AACpB,aAAO,CACH,CAAC,KAAD,EAAQ,CAAC,KAAT,EAAgB,CAAC,KAAjB,EAAwB,CAAxB,EAA2B,CAA3B,CADG,EAEH,CAAC,CAAC,KAAF,EAAS,KAAT,EAAgB,CAAC,KAAjB,EAAwB,CAAxB,EAA2B,CAA3B,CAFG,EAGH,CAAC,CAAC,KAAF,EAAS,CAAC,KAAV,EAAiB,KAAjB,EAAwB,CAAxB,EAA2B,CAA3B,CAHG,EAIH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAJG,EAKH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CALG,CAAP;AAOH,KAlBQ;AAmBT3e,IAAAA,UAAU,EAAE,UAAUtJ,CAAV,EAAa;AACrB,aAAO,CACH,CAACA,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CADG,EAEH,CAAC,CAAD,EAAIA,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAFG,EAGH,CAAC,CAAD,EAAI,CAAJ,EAAOA,CAAP,EAAU,CAAV,EAAa,CAAb,CAHG,EAIH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAJG,EAKH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CALG,CAAP;AAOH,KA3BQ;AA4BTuJ,IAAAA,QAAQ,EAAE,UAAUvJ,CAAV,EAAa;AACnB,UAAI1C,CAAC,GAAG,CAAC,IAAI0C,CAAL,IAAU,CAAlB;AACA,aAAO,CACH,CAACA,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa1C,CAAb,CADG,EAEH,CAAC,CAAD,EAAI0C,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa1C,CAAb,CAFG,EAGH,CAAC,CAAD,EAAI,CAAJ,EAAO0C,CAAP,EAAU,CAAV,EAAa1C,CAAb,CAHG,EAIH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAJG,EAKH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CALG,CAAP;AAOH,KArCQ;AAsCTmM,IAAAA,KAAK,EAAE,UAAUzJ,CAAV,EAAa;AAChB,aAAO,CACH,CAAE,QAAQ,SAAS,IAAIA,CAAb,CAAV,EAA6B,QAAQ,SAAS,IAAIA,CAAb,CAArC,EAAwD,QAAQ,SAAS,IAAIA,CAAb,CAAhE,EAAkF,CAAlF,EAAqF,CAArF,CADG,EAEH,CAAE,QAAQ,SAAS,IAAIA,CAAb,CAAV,EAA6B,QAAQ,SAAS,IAAIA,CAAb,CAArC,EAAwD,QAAQ,SAAS,IAAIA,CAAb,CAAhE,EAAkF,CAAlF,EAAqF,CAArF,CAFG,EAGH,CAAE,QAAQ,SAAS,IAAIA,CAAb,CAAV,EAA6B,QAAQ,SAAS,IAAIA,CAAb,CAArC,EAAwD,QAAQ,SAAS,IAAIA,CAAb,CAAhE,EAAkF,CAAlF,EAAqF,CAArF,CAHG,EAIH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAJG,EAKH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CALG,CAAP;AAOH,KA9CQ;AA+CTwJ,IAAAA,SAAS,EAAE,UAAUxJ,CAAV,EAAa;AACpB,aAAO,CACH,CAAE,SAAS,UAAU,IAAIA,CAAd,CAAX,EAA+B,SAAS,UAAU,IAAIA,CAAd,CAAxC,EAA4D,SAAS,UAAU,IAAIA,CAAd,CAArE,EAAwF,CAAxF,EAA2F,CAA3F,CADG,EAEH,CAAE,SAAS,UAAU,IAAIA,CAAd,CAAX,EAA+B,SAAS,UAAU,IAAIA,CAAd,CAAxC,EAA4D,SAAS,UAAU,IAAIA,CAAd,CAArE,EAAwF,CAAxF,EAA2F,CAA3F,CAFG,EAGH,CAAE,SAAS,UAAU,IAAIA,CAAd,CAAX,EAA+B,SAAS,UAAU,IAAIA,CAAd,CAAxC,EAA4D,SAAS,UAAU,IAAIA,CAAd,CAArE,EAAwF,CAAxF,EAA2F,CAA3F,CAHG,EAIH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CAJG,EAKH,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,CALG,CAAP;AAOH;AAvDQ,GAAb;;AA0DA,WAASooB,SAAT,CAAmBC,KAAnB,EAA0B;AACtB,QAAIC,YAAY,GAAGD,KAAK,CAAChf,IAAN,KAAe,CAAlC;AACA,QAAIsL,IAAI,GAAG2T,YAAY,GAAG,2BAAH,GAAiC,4BAAxD;AACA,WAAOD,KAAK,CAAC1T,IAAD,CAAZ;AACH;;AACD,WAAS4T,SAAT,CAAmBF,KAAnB,EAA0B;AACtB,QAAIC,YAAY,GAAGD,KAAK,CAAChf,IAAN,KAAe,CAAlC;AACA,QAAIsL,IAAI,GAAG2T,YAAY,GAAG,qBAAH,GAA2B,sBAAlD;AACA,WAAOD,KAAK,CAAC1T,IAAD,CAAZ;AACH;;AACD,MAAI6T,sBAAsB,GAAG,IAAIhX,GAAJ,EAA7B;AACA,MAAIiX,iBAAiB,GAAG,IAAIjX,GAAJ,EAAxB;;AACA,WAASkX,mBAAT,CAA6BC,KAA7B,EAAoC;AAChC,QAAIF,iBAAiB,CAACpX,GAAlB,CAAsBsX,KAAtB,CAAJ,EAAkC;AAC9B,aAAOF,iBAAiB,CAACziB,GAAlB,CAAsB2iB,KAAtB,CAAP;AACH;;AACD,QAAI5Q,GAAG,GAAGQ,KAAK,CAACoQ,KAAD,CAAf;AACA,QAAIxQ,GAAG,GAAGnB,QAAQ,CAACe,GAAD,CAAlB;AACA0Q,IAAAA,iBAAiB,CAACpW,GAAlB,CAAsBsW,KAAtB,EAA6BxQ,GAA7B;AACA,WAAOA,GAAP;AACH;;AACD,WAASyQ,2BAAT,GAAuC;AACnCJ,IAAAA,sBAAsB,CAACpY,KAAvB;AACAqY,IAAAA,iBAAiB,CAACrY,KAAlB;AACH;;AACD,MAAIyY,YAAY,GAAG,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAnB;AACA,MAAIC,gBAAgB,GAAG,CAAC,MAAD,EAAS,YAAT,EAAuB,UAAvB,EAAmC,WAAnC,EAAgD,OAAhD,EAAyD,2BAAzD,EAAsF,qBAAtF,EAA6G,4BAA7G,EAA2I,sBAA3I,CAAvB;;AACA,WAASC,UAAT,CAAoBhR,GAApB,EAAyBsQ,KAAzB,EAAgC;AAC5B,QAAIW,QAAQ,GAAG,EAAf;AACAH,IAAAA,YAAY,CAAC5gB,OAAb,CAAqB,UAAU8K,GAAV,EAAe;AAChCiW,MAAAA,QAAQ,IAAIjR,GAAG,CAAChF,GAAD,CAAH,GAAW,GAAvB;AACH,KAFD;AAGA+V,IAAAA,gBAAgB,CAAC7gB,OAAjB,CAAyB,UAAU8K,GAAV,EAAe;AACpCiW,MAAAA,QAAQ,IAAIX,KAAK,CAACtV,GAAD,CAAL,GAAa,GAAzB;AACH,KAFD;AAGA,WAAOiW,QAAP;AACH;;AACD,WAASC,oBAAT,CAA8BlR,GAA9B,EAAmCsQ,KAAnC,EAA0Ca,SAA1C,EAAqDC,SAArD,EAAgEC,gBAAhE,EAAkF;AAC9E,QAAIC,OAAJ;;AACA,QAAIb,sBAAsB,CAACnX,GAAvB,CAA2B6X,SAA3B,CAAJ,EAA2C;AACvCG,MAAAA,OAAO,GAAGb,sBAAsB,CAACxiB,GAAvB,CAA2BkjB,SAA3B,CAAV;AACH,KAFD,MAGK;AACDG,MAAAA,OAAO,GAAG,IAAI7X,GAAJ,EAAV;AACAgX,MAAAA,sBAAsB,CAACnW,GAAvB,CAA2B6W,SAA3B,EAAsCG,OAAtC;AACH;;AACD,QAAIvhB,EAAE,GAAGihB,UAAU,CAAChR,GAAD,EAAMsQ,KAAN,CAAnB;;AACA,QAAIgB,OAAO,CAAChY,GAAR,CAAYvJ,EAAZ,CAAJ,EAAqB;AACjB,aAAOuhB,OAAO,CAACrjB,GAAR,CAAY8B,EAAZ,CAAP;AACH;;AACD,QAAIqQ,GAAG,GAAGnB,QAAQ,CAACe,GAAD,CAAlB;AACA,QAAIuR,IAAI,GAAGH,SAAS,IAAI,IAAb,GAAoB,IAApB,GAA2BT,mBAAmB,CAACS,SAAD,CAAzD;AACA,QAAII,WAAW,GAAGH,gBAAgB,IAAI,IAApB,GAA2B,IAA3B,GAAkCV,mBAAmB,CAACU,gBAAD,CAAvE;AACA,QAAII,QAAQ,GAAGN,SAAS,CAAC/Q,GAAD,EAAMmR,IAAN,EAAYC,WAAZ,CAAxB;;AACA,QAAI9jB,EAAE,GAAG2Q,QAAQ,CAACoT,QAAD,CAAjB;AAAA,QAA6B/oB,CAAC,GAAGgF,EAAE,CAAChF,CAApC;AAAA,QAAuCb,CAAC,GAAG6F,EAAE,CAAC7F,CAA9C;AAAA,QAAiD4T,CAAC,GAAG/N,EAAE,CAAC+N,CAAxD;AAAA,QAA2DvI,CAAC,GAAGxF,EAAE,CAACwF,CAAlE;;AACA,QAAIkd,MAAM,GAAGN,kBAAkB,CAACQ,KAAD,CAA/B;;AACA,QAAIzgB,EAAE,GAAGpH,MAAM,CAAC0nB,gBAAgB,CAAC,CAACznB,CAAD,EAAIb,CAAJ,EAAO4T,CAAP,CAAD,EAAY2U,MAAZ,CAAjB,EAAsC,CAAtC,CAAf;AAAA,QAAyDsB,EAAE,GAAG7hB,EAAE,CAAC,CAAD,CAAhE;AAAA,QAAqE8hB,EAAE,GAAG9hB,EAAE,CAAC,CAAD,CAA5E;AAAA,QAAiF+hB,EAAE,GAAG/hB,EAAE,CAAC,CAAD,CAAxF;;AACA,QAAI+gB,KAAK,GAAI1d,CAAC,KAAK,CAAN,GACT+M,cAAc,CAAC;AAAEvX,MAAAA,CAAC,EAAEgpB,EAAL;AAAS7pB,MAAAA,CAAC,EAAE8pB,EAAZ;AAAgBlW,MAAAA,CAAC,EAAEmW;AAAnB,KAAD,CADL,GAET7R,WAAW,CAAC;AAAErX,MAAAA,CAAC,EAAEgpB,EAAL;AAAS7pB,MAAAA,CAAC,EAAE8pB,EAAZ;AAAgBlW,MAAAA,CAAC,EAAEmW,EAAnB;AAAuB1e,MAAAA,CAAC,EAAEA;AAA1B,KAAD,CAFf;AAGAoe,IAAAA,OAAO,CAAChX,GAAR,CAAYvK,EAAZ,EAAgB6gB,KAAhB;AACA,WAAOA,KAAP;AACH;;AACD,WAASiB,OAAT,CAAiBzR,GAAjB,EAAsB;AAClB,WAAOA,GAAP;AACH;;AACD,WAAS0R,WAAT,CAAqB9R,GAArB,EAA0BsQ,KAA1B,EAAiC;AAC7B,WAAOY,oBAAoB,CAAClR,GAAD,EAAMsQ,KAAN,EAAauB,OAAb,CAA3B;AACH;;AACD,WAASE,sBAAT,CAAgC/R,GAAhC,EAAqCsQ,KAArC,EAA4C;AACxC,QAAI0B,MAAM,GAAG3B,SAAS,CAACC,KAAD,CAAtB;AACA,QAAI2B,MAAM,GAAGzB,SAAS,CAACF,KAAD,CAAtB;AACA,WAAOY,oBAAoB,CAAClR,GAAD,EAAMsQ,KAAN,EAAa4B,kBAAb,EAAiCD,MAAjC,EAAyCD,MAAzC,CAA3B;AACH;;AACD,WAASE,kBAAT,CAA4BxkB,EAA5B,EAAgCukB,MAAhC,EAAwCD,MAAxC,EAAgD;AAC5C,QAAI1T,CAAC,GAAG5Q,EAAE,CAAC4Q,CAAX;AAAA,QAAc9Y,CAAC,GAAGkI,EAAE,CAAClI,CAArB;AAAA,QAAwByD,CAAC,GAAGyE,EAAE,CAACzE,CAA/B;AAAA,QAAkCiK,CAAC,GAAGxF,EAAE,CAACwF,CAAzC;AACA,QAAIif,MAAM,GAAGlpB,CAAC,GAAG,GAAjB;AACA,QAAImpB,SAAJ;;AACA,QAAID,MAAJ,EAAY;AACRC,MAAAA,SAAS,GAAGnpB,CAAC,GAAG,GAAJ,IAAWzD,CAAC,GAAG,IAA3B;AACH,KAFD,MAGK;AACD,UAAI6sB,MAAM,GAAG/T,CAAC,GAAG,GAAJ,IAAWA,CAAC,GAAG,GAA5B;AACA8T,MAAAA,SAAS,GAAG5sB,CAAC,GAAG,IAAJ,IAAayD,CAAC,GAAG,GAAJ,IAAWopB,MAApC;AACH;;AACD,QAAIC,EAAE,GAAGhU,CAAT;AACA,QAAIiU,EAAE,GAAGtpB,CAAT;;AACA,QAAImpB,SAAJ,EAAe;AACX,UAAID,MAAJ,EAAY;AACRG,QAAAA,EAAE,GAAGL,MAAM,CAAC3T,CAAZ;AACAiU,QAAAA,EAAE,GAAGN,MAAM,CAACzsB,CAAZ;AACH,OAHD,MAIK;AACD8sB,QAAAA,EAAE,GAAGN,MAAM,CAAC1T,CAAZ;AACAiU,QAAAA,EAAE,GAAGP,MAAM,CAACxsB,CAAZ;AACH;AACJ;;AACD,QAAIgtB,EAAE,GAAG9E,KAAK,CAACzkB,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAUgpB,MAAM,CAAChpB,CAAjB,EAAoB+oB,MAAM,CAAC/oB,CAA3B,CAAd;AACA,WAAO;AAAEqV,MAAAA,CAAC,EAAEgU,EAAL;AAAS9sB,MAAAA,CAAC,EAAE+sB,EAAZ;AAAgBtpB,MAAAA,CAAC,EAAEupB,EAAnB;AAAuBtf,MAAAA,CAAC,EAAEA;AAA1B,KAAP;AACH;;AACD,MAAIuf,gBAAgB,GAAG,GAAvB;;AACA,WAASC,WAAT,CAAqBhlB,EAArB,EAAyB6jB,IAAzB,EAA+B;AAC3B,QAAIjT,CAAC,GAAG5Q,EAAE,CAAC4Q,CAAX;AAAA,QAAc9Y,CAAC,GAAGkI,EAAE,CAAClI,CAArB;AAAA,QAAwByD,CAAC,GAAGyE,EAAE,CAACzE,CAA/B;AAAA,QAAkCiK,CAAC,GAAGxF,EAAE,CAACwF,CAAzC;AACA,QAAIif,MAAM,GAAGlpB,CAAC,GAAG,GAAjB;AACA,QAAIopB,MAAM,GAAG/T,CAAC,GAAG,GAAJ,IAAWA,CAAC,GAAG,GAA5B;AACA,QAAI8T,SAAS,GAAG5sB,CAAC,GAAG,IAAJ,IAAayD,CAAC,GAAG,GAAJ,IAAWopB,MAAxC;;AACA,QAAIF,MAAJ,EAAY;AACR,UAAIQ,IAAI,GAAGjF,KAAK,CAACzkB,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,CAAZ,EAAewpB,gBAAf,CAAhB;;AACA,UAAIL,SAAJ,EAAe;AACX,YAAIQ,IAAI,GAAGrB,IAAI,CAACjT,CAAhB;AACA,YAAIiU,EAAE,GAAGhB,IAAI,CAAC/rB,CAAd;AACA,eAAO;AAAE8Y,UAAAA,CAAC,EAAEsU,IAAL;AAAWptB,UAAAA,CAAC,EAAE+sB,EAAd;AAAkBtpB,UAAAA,CAAC,EAAE0pB,IAArB;AAA2Bzf,UAAAA,CAAC,EAAEA;AAA9B,SAAP;AACH;;AACD,aAAO;AAAEoL,QAAAA,CAAC,EAAEA,CAAL;AAAQ9Y,QAAAA,CAAC,EAAEA,CAAX;AAAcyD,QAAAA,CAAC,EAAE0pB,IAAjB;AAAuBzf,QAAAA,CAAC,EAAEA;AAA1B,OAAP;AACH;;AACD,QAAIsf,EAAE,GAAG9E,KAAK,CAACzkB,CAAD,EAAI,GAAJ,EAAS,CAAT,EAAYwpB,gBAAZ,EAA8BlB,IAAI,CAACtoB,CAAnC,CAAd;;AACA,QAAImpB,SAAJ,EAAe;AACX,UAAIS,IAAI,GAAGtB,IAAI,CAACjT,CAAhB;AACA,UAAIiU,EAAE,GAAGhB,IAAI,CAAC/rB,CAAd;AACA,aAAO;AAAE8Y,QAAAA,CAAC,EAAEuU,IAAL;AAAWrtB,QAAAA,CAAC,EAAE+sB,EAAd;AAAkBtpB,QAAAA,CAAC,EAAEupB,EAArB;AAAyBtf,QAAAA,CAAC,EAAEA;AAA5B,OAAP;AACH;;AACD,QAAIof,EAAE,GAAGhU,CAAT;AACA,QAAIwU,QAAQ,GAAGxU,CAAC,GAAG,EAAJ,IAAUA,CAAC,GAAG,GAA7B;;AACA,QAAIwU,QAAJ,EAAc;AACV,UAAIC,eAAe,GAAGzU,CAAC,GAAG,GAA1B;;AACA,UAAIyU,eAAJ,EAAqB;AACjBT,QAAAA,EAAE,GAAG5E,KAAK,CAACpP,CAAD,EAAI,GAAJ,EAAS,GAAT,EAAc,GAAd,EAAmB,GAAnB,CAAV;AACH,OAFD,MAGK;AACDgU,QAAAA,EAAE,GAAG5E,KAAK,CAACpP,CAAD,EAAI,EAAJ,EAAQ,GAAR,EAAa,EAAb,EAAiB,GAAjB,CAAV;AACH;AACJ;;AACD,WAAO;AAAEA,MAAAA,CAAC,EAAEgU,EAAL;AAAS9sB,MAAAA,CAAC,EAAEA,CAAZ;AAAeyD,MAAAA,CAAC,EAAEupB,EAAlB;AAAsBtf,MAAAA,CAAC,EAAEA;AAAzB,KAAP;AACH;;AACD,WAAS8f,qBAAT,CAA+BhT,GAA/B,EAAoCsQ,KAApC,EAA2C;AACvC,QAAIA,KAAK,CAAChf,IAAN,KAAe,CAAnB,EAAsB;AAClB,aAAOygB,sBAAsB,CAAC/R,GAAD,EAAMsQ,KAAN,CAA7B;AACH;;AACD,QAAIiB,IAAI,GAAGlB,SAAS,CAACC,KAAD,CAApB;AACA,WAAOY,oBAAoB,CAAClR,GAAD,EAAM5a,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKkrB,KAAL,CAAT,EAAsB;AAAEhf,MAAAA,IAAI,EAAE;AAAR,KAAtB,CAAd,EAAkDohB,WAAlD,EAA+DnB,IAA/D,CAA3B;AACH;;AACD,MAAI0B,gBAAgB,GAAG,IAAvB;;AACA,WAASC,eAAT,CAAyBC,GAAzB,EAA8B;AAC1B,WAAOzF,KAAK,CAACyF,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,EAAqB,GAArB,CAAZ;AACH;;AACD,WAASC,WAAT,CAAqB1lB,EAArB,EAAyB6jB,IAAzB,EAA+B;AAC3B,QAAIjT,CAAC,GAAG5Q,EAAE,CAAC4Q,CAAX;AAAA,QAAc9Y,CAAC,GAAGkI,EAAE,CAAClI,CAArB;AAAA,QAAwByD,CAAC,GAAGyE,EAAE,CAACzE,CAA/B;AAAA,QAAkCiK,CAAC,GAAGxF,EAAE,CAACwF,CAAzC;AACA,QAAImgB,OAAO,GAAGpqB,CAAC,GAAG,GAAlB;AACA,QAAImpB,SAAS,GAAGnpB,CAAC,GAAG,GAAJ,IAAWzD,CAAC,GAAG,IAA/B;AACA,QAAI6sB,MAAM,GAAG,CAACD,SAAD,IAAc9T,CAAC,GAAG,GAAlB,IAAyBA,CAAC,GAAG,GAA1C;;AACA,QAAI+U,OAAJ,EAAa;AACT,UAAIC,IAAI,GAAG5F,KAAK,CAACzkB,CAAD,EAAI,GAAJ,EAAS,CAAT,EAAYgqB,gBAAZ,EAA8B1B,IAAI,CAACtoB,CAAnC,CAAhB;;AACA,UAAImpB,SAAJ,EAAe;AACX,YAAImB,IAAI,GAAGhC,IAAI,CAACjT,CAAhB;AACA,YAAIiU,EAAE,GAAGhB,IAAI,CAAC/rB,CAAd;AACA,eAAO;AAAE8Y,UAAAA,CAAC,EAAEiV,IAAL;AAAW/tB,UAAAA,CAAC,EAAE+sB,EAAd;AAAkBtpB,UAAAA,CAAC,EAAEqqB,IAArB;AAA2BpgB,UAAAA,CAAC,EAAEA;AAA9B,SAAP;AACH;;AACD,UAAIsgB,IAAI,GAAGlV,CAAX;;AACA,UAAI+T,MAAJ,EAAY;AACRmB,QAAAA,IAAI,GAAGN,eAAe,CAAC5U,CAAD,CAAtB;AACH;;AACD,aAAO;AAAEA,QAAAA,CAAC,EAAEkV,IAAL;AAAWhuB,QAAAA,CAAC,EAAEA,CAAd;AAAiByD,QAAAA,CAAC,EAAEqqB,IAApB;AAA0BpgB,QAAAA,CAAC,EAAEA;AAA7B,OAAP;AACH;;AACD,QAAIkf,SAAJ,EAAe;AACX,UAAIqB,IAAI,GAAGlC,IAAI,CAACjT,CAAhB;AACA,UAAIiU,EAAE,GAAGhB,IAAI,CAAC/rB,CAAd;AACA,UAAIkuB,IAAI,GAAGhG,KAAK,CAACzkB,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAYsoB,IAAI,CAACtoB,CAAjB,EAAoBgqB,gBAApB,CAAhB;AACA,aAAO;AAAE3U,QAAAA,CAAC,EAAEmV,IAAL;AAAWjuB,QAAAA,CAAC,EAAE+sB,EAAd;AAAkBtpB,QAAAA,CAAC,EAAEyqB,IAArB;AAA2BxgB,QAAAA,CAAC,EAAEA;AAA9B,OAAP;AACH;;AACD,QAAIof,EAAE,GAAGhU,CAAT;AACA,QAAIkU,EAAJ;;AACA,QAAIH,MAAJ,EAAY;AACRC,MAAAA,EAAE,GAAGY,eAAe,CAAC5U,CAAD,CAApB;AACAkU,MAAAA,EAAE,GAAG9E,KAAK,CAACzkB,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAYsoB,IAAI,CAACtoB,CAAjB,EAAoBwV,IAAI,CAACa,GAAL,CAAS,CAAT,EAAY2T,gBAAgB,GAAG,IAA/B,CAApB,CAAV;AACH,KAHD,MAIK;AACDT,MAAAA,EAAE,GAAG9E,KAAK,CAACzkB,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAYsoB,IAAI,CAACtoB,CAAjB,EAAoBgqB,gBAApB,CAAV;AACH;;AACD,WAAO;AAAE3U,MAAAA,CAAC,EAAEgU,EAAL;AAAS9sB,MAAAA,CAAC,EAAEA,CAAZ;AAAeyD,MAAAA,CAAC,EAAEupB,EAAlB;AAAsBtf,MAAAA,CAAC,EAAEA;AAAzB,KAAP;AACH;;AACD,WAASygB,qBAAT,CAA+B3T,GAA/B,EAAoCsQ,KAApC,EAA2C;AACvC,QAAIA,KAAK,CAAChf,IAAN,KAAe,CAAnB,EAAsB;AAClB,aAAOygB,sBAAsB,CAAC/R,GAAD,EAAMsQ,KAAN,CAA7B;AACH;;AACD,QAAIiB,IAAI,GAAGf,SAAS,CAACF,KAAD,CAApB;AACA,WAAOY,oBAAoB,CAAClR,GAAD,EAAM5a,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKkrB,KAAL,CAAT,EAAsB;AAAEhf,MAAAA,IAAI,EAAE;AAAR,KAAtB,CAAd,EAAkD8hB,WAAlD,EAA+D7B,IAA/D,CAA3B;AACH;;AACD,WAASqC,eAAT,CAAyBlmB,EAAzB,EAA6BukB,MAA7B,EAAqCD,MAArC,EAA6C;AACzC,QAAI1T,CAAC,GAAG5Q,EAAE,CAAC4Q,CAAX;AAAA,QAAc9Y,CAAC,GAAGkI,EAAE,CAAClI,CAArB;AAAA,QAAwByD,CAAC,GAAGyE,EAAE,CAACzE,CAA/B;AAAA,QAAkCiK,CAAC,GAAGxF,EAAE,CAACwF,CAAzC;AACA,QAAIif,MAAM,GAAGlpB,CAAC,GAAG,GAAjB;AACA,QAAImpB,SAAS,GAAGnpB,CAAC,GAAG,GAAJ,IAAWzD,CAAC,GAAG,IAA/B;AACA,QAAI8sB,EAAE,GAAGhU,CAAT;AACA,QAAIiU,EAAE,GAAG/sB,CAAT;;AACA,QAAI4sB,SAAJ,EAAe;AACX,UAAID,MAAJ,EAAY;AACRG,QAAAA,EAAE,GAAGL,MAAM,CAAC3T,CAAZ;AACAiU,QAAAA,EAAE,GAAGN,MAAM,CAACzsB,CAAZ;AACH,OAHD,MAIK;AACD8sB,QAAAA,EAAE,GAAGN,MAAM,CAAC1T,CAAZ;AACAiU,QAAAA,EAAE,GAAGP,MAAM,CAACxsB,CAAZ;AACH;AACJ;;AACD,QAAIgtB,EAAE,GAAG9E,KAAK,CAACzkB,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,GAAV,EAAe,GAAf,CAAd;AACA,WAAO;AAAEqV,MAAAA,CAAC,EAAEgU,EAAL;AAAS9sB,MAAAA,CAAC,EAAE+sB,EAAZ;AAAgBtpB,MAAAA,CAAC,EAAEupB,EAAnB;AAAuBtf,MAAAA,CAAC,EAAEA;AAA1B,KAAP;AACH;;AACD,WAAS2gB,iBAAT,CAA2B7T,GAA3B,EAAgCsQ,KAAhC,EAAuC;AACnC,QAAIA,KAAK,CAAChf,IAAN,KAAe,CAAnB,EAAsB;AAClB,aAAOygB,sBAAsB,CAAC/R,GAAD,EAAMsQ,KAAN,CAA7B;AACH;;AACD,QAAI2B,MAAM,GAAGzB,SAAS,CAACF,KAAD,CAAtB;AACA,QAAI0B,MAAM,GAAG3B,SAAS,CAACC,KAAD,CAAtB;AACA,WAAOY,oBAAoB,CAAClR,GAAD,EAAM5a,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKkrB,KAAL,CAAT,EAAsB;AAAEhf,MAAAA,IAAI,EAAE;AAAR,KAAtB,CAAd,EAAkDsiB,eAAlD,EAAmE3B,MAAnE,EAA2ED,MAA3E,CAA3B;AACH;;AACD,WAAS8B,iBAAT,CAA2B9T,GAA3B,EAAgC+T,MAAhC,EAAwC;AACpC,WAAOf,qBAAqB,CAAChT,GAAD,EAAM+T,MAAN,CAA5B;AACH;;AACD,WAASC,mBAAT,CAA6BhU,GAA7B,EAAkC+T,MAAlC,EAA0C;AACtC,WAAOf,qBAAqB,CAAChT,GAAD,EAAM+T,MAAN,CAA5B;AACH;;AAED,WAASE,eAAT,CAAyBlE,MAAzB,EAAiC;AAC7B,QAAImE,KAAK,GAAG,EAAZ;AACAA,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,qKAAX;;AACA,QAAI0nB,MAAM,CAACpe,OAAP,IAAkBoe,MAAM,CAACne,UAA7B,EAAyC;AACrCsiB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,oBAAoB0nB,MAAM,CAACne,UAA3B,GAAwC,cAAnD;AACH;;AACD,QAAIme,MAAM,CAACle,UAAP,GAAoB,CAAxB,EAA2B;AACvBqiB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,4BAA4B0nB,MAAM,CAACle,UAAnC,GAAgD,gBAA3D;AACAqiB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,oBAAoB0nB,MAAM,CAACle,UAA3B,GAAwC,gBAAnD;AACH;;AACDqiB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA,WAAO6rB,KAAK,CAACnlB,IAAN,CAAW,IAAX,CAAP;AACH;;AAED,MAAIolB,UAAJ;;AACA,GAAC,UAAUA,UAAV,EAAsB;AACnBA,IAAAA,UAAU,CAACA,UAAU,CAAC,OAAD,CAAV,GAAsB,CAAvB,CAAV,GAAsC,OAAtC;AACAA,IAAAA,UAAU,CAACA,UAAU,CAAC,MAAD,CAAV,GAAqB,CAAtB,CAAV,GAAqC,MAArC;AACH,GAHD,EAGGA,UAAU,KAAKA,UAAU,GAAG,EAAlB,CAHb;;AAIA,WAASC,iBAAT,CAA2BrE,MAA3B,EAAmC;AAC/B,QAAIsE,OAAO,GAAG,EAAd;;AACA,QAAItE,MAAM,CAACze,IAAP,KAAgB6iB,UAAU,CAACG,IAA/B,EAAqC;AACjCD,MAAAA,OAAO,CAAChsB,IAAR,CAAa,iCAAb;AACH;;AACD,QAAI0nB,MAAM,CAACxe,UAAP,KAAsB,GAA1B,EAA+B;AAC3B8iB,MAAAA,OAAO,CAAChsB,IAAR,CAAa,gBAAgB0nB,MAAM,CAACxe,UAAvB,GAAoC,IAAjD;AACH;;AACD,QAAIwe,MAAM,CAACve,QAAP,KAAoB,GAAxB,EAA6B;AACzB6iB,MAAAA,OAAO,CAAChsB,IAAR,CAAa,cAAc0nB,MAAM,CAACve,QAArB,GAAgC,IAA7C;AACH;;AACD,QAAIue,MAAM,CAACte,SAAP,KAAqB,CAAzB,EAA4B;AACxB4iB,MAAAA,OAAO,CAAChsB,IAAR,CAAa,eAAe0nB,MAAM,CAACte,SAAtB,GAAkC,IAA/C;AACH;;AACD,QAAIse,MAAM,CAACre,KAAP,KAAiB,CAArB,EAAwB;AACpB2iB,MAAAA,OAAO,CAAChsB,IAAR,CAAa,WAAW0nB,MAAM,CAACre,KAAlB,GAA0B,IAAvC;AACH;;AACD,QAAI2iB,OAAO,CAACzuB,MAAR,KAAmB,CAAvB,EAA0B;AACtB,aAAO,IAAP;AACH;;AACD,WAAOyuB,OAAO,CAACtlB,IAAR,CAAa,GAAb,CAAP;AACH;;AAED,WAASwlB,WAAT,CAAqBnE,MAArB,EAA6B;AACzB,WAAOA,MAAM,CAACjnB,KAAP,CAAa,CAAb,EAAgB,CAAhB,EAAmBwT,GAAnB,CAAuB,UAAUnU,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACmU,GAAF,CAAM,UAAUnU,CAAV,EAAa;AAAE,eAAOA,CAAC,CAAC+W,OAAF,CAAU,CAAV,CAAP;AAAsB,OAA3C,EAA6CxQ,IAA7C,CAAkD,GAAlD,CAAP;AAAgE,KAAtG,EAAwGA,IAAxG,CAA6G,GAA7G,CAAP;AACH;;AACD,WAASylB,uBAAT,CAAiCzE,MAAjC,EAAyC;AACrC,WAAOwE,WAAW,CAACzE,kBAAkB,CAACC,MAAD,CAAnB,CAAlB;AACH;;AAED,MAAI0E,OAAO,GAAG,CAAd;AACA,MAAIC,WAAW,GAAG,IAAIjb,GAAJ,EAAlB;AACA,MAAIkb,SAAS,GAAG,IAAIlb,GAAJ,EAAhB;;AACA,WAASmb,OAAT,CAAiBC,OAAjB,EAA0B;AACtB,WAAO3uB,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,eAAO,CAAC,CAAD,EAAI,IAAIhH,OAAJ,CAAY,UAAUD,OAAV,EAAmBE,MAAnB,EAA2B;AAC1C,cAAIoJ,EAAE,GAAG,EAAE0kB,OAAX;AACAC,UAAAA,WAAW,CAACpa,GAAZ,CAAgBvK,EAAhB,EAAoBtJ,OAApB;AACAkuB,UAAAA,SAAS,CAACra,GAAV,CAAcvK,EAAd,EAAkBpJ,MAAlB;AACAsG,UAAAA,MAAM,CAACC,OAAP,CAAeoC,WAAf,CAA2B;AAAEQ,YAAAA,IAAI,EAAEzG,WAAW,CAACqC,QAApB;AAA8BsE,YAAAA,IAAI,EAAE6kB,OAApC;AAA6C9kB,YAAAA,EAAE,EAAEA;AAAjD,WAA3B;AACH,SALM,CAAJ,CAAP;AAMH,OAPiB,CAAlB;AAQH,KATe,CAAhB;AAUH;;AACD9C,EAAAA,MAAM,CAACC,OAAP,CAAeuD,SAAf,CAAyBC,WAAzB,CAAqC,UAAUhD,EAAV,EAAc;AAC/C,QAAIoC,IAAI,GAAGpC,EAAE,CAACoC,IAAd;AAAA,QAAoBE,IAAI,GAAGtC,EAAE,CAACsC,IAA9B;AAAA,QAAoCpH,KAAK,GAAG8E,EAAE,CAAC9E,KAA/C;AAAA,QAAsDmH,EAAE,GAAGrC,EAAE,CAACqC,EAA9D;;AACA,QAAID,IAAI,KAAKzG,WAAW,CAAC4B,iBAAzB,EAA4C;AACxC,UAAIxE,OAAO,GAAGiuB,WAAW,CAACzmB,GAAZ,CAAgB8B,EAAhB,CAAd;AACA,UAAIpJ,MAAM,GAAGguB,SAAS,CAAC1mB,GAAV,CAAc8B,EAAd,CAAb;AACA2kB,MAAAA,WAAW,CAAC1c,MAAZ,CAAmBjI,EAAnB;AACA4kB,MAAAA,SAAS,CAAC3c,MAAV,CAAiBjI,EAAjB;;AACA,UAAInH,KAAJ,EAAW;AACPjC,QAAAA,MAAM,IAAIA,MAAM,CAACiC,KAAD,CAAhB;AACH,OAFD,MAGK;AACDnC,QAAAA,OAAO,IAAIA,OAAO,CAACuJ,IAAD,CAAlB;AACH;AACJ;AACJ,GAdD;;AAgBA,MAAI8kB,UAAU,GAAI,YAAY;AAC1B,aAASA,UAAT,GAAsB;AAClB,WAAKC,KAAL,GAAa,EAAb;AACA,WAAKC,OAAL,GAAe,IAAf;AACA,WAAKC,aAAL,GAAqB,OAAO,EAA5B;AACH;;AACDH,IAAAA,UAAU,CAAChvB,SAAX,CAAqBovB,UAArB,GAAkC,UAAUC,KAAV,EAAiB;AAC/C,WAAKJ,KAAL,CAAW1sB,IAAX,CAAgB8sB,KAAhB;AACA,WAAKC,UAAL;AACH,KAHD;;AAIAN,IAAAA,UAAU,CAAChvB,SAAX,CAAqBuvB,SAArB,GAAiC,YAAY;AACzC,UAAI,KAAKL,OAAL,KAAiB,IAArB,EAA2B;AACvBlhB,QAAAA,oBAAoB,CAAC,KAAKkhB,OAAN,CAApB;AACA,aAAKA,OAAL,GAAe,IAAf;AACH;;AACD,WAAKD,KAAL,GAAa,EAAb;AACH,KAND;;AAOAD,IAAAA,UAAU,CAAChvB,SAAX,CAAqBsvB,UAArB,GAAkC,YAAY;AAC1C,UAAIE,KAAK,GAAG,IAAZ;;AACA,UAAI,KAAKN,OAAT,EAAkB;AACd;AACH;;AACD,WAAKA,OAAL,GAAephB,qBAAqB,CAAC,YAAY;AAC7C0hB,QAAAA,KAAK,CAACN,OAAN,GAAgB,IAAhB;AACA,YAAItf,KAAK,GAAGI,IAAI,CAACD,GAAL,EAAZ;AACA,YAAI1F,EAAJ;;AACA,eAAQA,EAAE,GAAGmlB,KAAK,CAACP,KAAN,CAAY5gB,KAAZ,EAAb,EAAmC;AAC/BhE,UAAAA,EAAE;;AACF,cAAI2F,IAAI,CAACD,GAAL,KAAaH,KAAb,IAAsB4f,KAAK,CAACL,aAAhC,EAA+C;AAC3CK,YAAAA,KAAK,CAACF,UAAN;;AACA;AACH;AACJ;AACJ,OAXmC,CAApC;AAYH,KAjBD;;AAkBA,WAAON,UAAP;AACH,GApCiB,EAAlB;;AAsCA,MAAIS,YAAY,GAAG,IAAIT,UAAJ,EAAnB;;AACA,WAASU,eAAT,CAAyBloB,GAAzB,EAA8B;AAC1B,WAAOpH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAIovB,KAAK,GAAG,IAAZ;;AACA,aAAOluB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,eAAO,CAAC,CAAD,EAAI,IAAIhH,OAAJ,CAAY,UAAUD,OAAV,EAAmBE,MAAnB,EAA2B;AAAE,iBAAOT,SAAS,CAACovB,KAAD,EAAQ,KAAK,CAAb,EAAgB,KAAK,CAArB,EAAwB,YAAY;AAChG,gBAAI7mB,OAAJ,EAAamB,OAAb,EAAsB6lB,OAAtB,EAA+BC,OAA/B;AACA,mBAAOtuB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,sBAAQA,EAAE,CAACnG,KAAX;AACI,qBAAK,CAAL;AACI,sBAAI,CAAC+F,GAAG,CAACjB,UAAJ,CAAe,OAAf,CAAL,EAA8B,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AAC9BoC,kBAAAA,OAAO,GAAGnB,GAAV;AACA,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACII,kBAAAA,EAAE,CAACjG,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,CAAJ,GAAS,CAAT,CAAb;;AACA,yBAAO,CAAC,CAAD,EAAIstB,eAAe,CAACroB,GAAD,CAAnB,CAAP;;AACJ,qBAAK,CAAL;AACImB,kBAAAA,OAAO,GAAGf,EAAE,CAAClG,IAAH,EAAV;AACA,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACIoI,kBAAAA,OAAO,GAAGlC,EAAE,CAAClG,IAAH,EAAV;AACAb,kBAAAA,MAAM,CAACiJ,OAAD,CAAN;AACA,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACIlC,kBAAAA,EAAE,CAACjG,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,CAAJ,GAAS,CAAT,CAAb;;AACA,yBAAO,CAAC,CAAD,EAAIutB,UAAU,CAACnnB,OAAD,CAAd,CAAP;;AACJ,qBAAK,CAAL;AACIgnB,kBAAAA,OAAO,GAAG/nB,EAAE,CAAClG,IAAH,EAAV;AACA+tB,kBAAAA,YAAY,CAACL,UAAb,CAAwB,YAAY;AAChCzuB,oBAAAA,OAAO,CAACrB,QAAQ,CAAC;AAAEywB,sBAAAA,GAAG,EAAEvoB,GAAP;AAAYmB,sBAAAA,OAAO,EAAEA,OAArB;AAA8BqnB,sBAAAA,KAAK,EAAEL,OAAO,CAACM,YAA7C;AAA2DC,sBAAAA,MAAM,EAAEP,OAAO,CAACQ;AAA3E,qBAAD,EAA6FC,YAAY,CAACT,OAAD,CAAzG,CAAT,CAAP;AACH,mBAFD;AAGA,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACIC,kBAAAA,OAAO,GAAGhoB,EAAE,CAAClG,IAAH,EAAV;AACAb,kBAAAA,MAAM,CAAC+uB,OAAD,CAAN;AACA,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AAAQ,yBAAO,CAAC,CAAD,CAAP;AA5BZ;AA8BH,aA/BiB,CAAlB;AAgCH,WAlC+D,CAAhB;AAkC3C,SAlCE,CAAJ,CAAP;AAmCH,OApCiB,CAAlB;AAqCH,KAvCe,CAAhB;AAwCH;;AACD,WAASC,eAAT,CAAyBroB,GAAzB,EAA8B;AAC1B,WAAOpH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAIiV,SAAJ;AACA,aAAO/T,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AACI4T,YAAAA,SAAS,GAAG,IAAID,GAAJ,CAAQ5N,GAAR,CAAZ;AACA,gBAAI,EAAE6N,SAAS,CAAC3N,MAAV,KAAqB+N,QAAQ,CAAC/N,MAAhC,CAAJ,EAA6C,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AAC7C,mBAAO,CAAC,CAAD,EAAIc,aAAa,CAAChB,GAAD,CAAjB,CAAP;;AACJ,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAII,EAAE,CAAClG,IAAH,EAAJ,CAAP;;AACR,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIotB,OAAO,CAAC;AAAEtnB,cAAAA,GAAG,EAAEA,GAAP;AAAYoC,cAAAA,YAAY,EAAE;AAA1B,aAAD,CAAX,CAAP;;AACR,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIhC,EAAE,CAAClG,IAAH,EAAJ,CAAP;AAPZ;AASH,OAViB,CAAlB;AAWH,KAbe,CAAhB;AAcH;;AACD,WAASouB,UAAT,CAAoBtoB,GAApB,EAAyB;AACrB,WAAOpH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,eAAO,CAAC,CAAD,EAAI,IAAIhH,OAAJ,CAAY,UAAUD,OAAV,EAAmBE,MAAnB,EAA2B;AAC1C,cAAIwvB,KAAK,GAAG,IAAIC,KAAJ,EAAZ;;AACAD,UAAAA,KAAK,CAACE,MAAN,GAAe,YAAY;AAAE,mBAAO5vB,OAAO,CAAC0vB,KAAD,CAAd;AAAwB,WAArD;;AACAA,UAAAA,KAAK,CAACG,OAAN,GAAgB,YAAY;AAAE,mBAAO3vB,MAAM,CAAC,0BAA0B2G,GAA3B,CAAb;AAA+C,WAA7E;;AACA6oB,UAAAA,KAAK,CAACN,GAAN,GAAYvoB,GAAZ;AACH,SALM,CAAJ,CAAP;AAMH,OAPiB,CAAlB;AAQH,KATe,CAAhB;AAUH;;AACD,MAAIipB,wBAAwB,GAAG,KAAK,EAApC;AACA,MAAIC,MAAJ;AACA,MAAIC,OAAJ;;AACA,WAASC,YAAT,GAAwB;AACpB,QAAIC,QAAQ,GAAGJ,wBAAf;AACA,QAAIK,SAAS,GAAGL,wBAAhB;AACAC,IAAAA,MAAM,GAAG1pB,QAAQ,CAAC8N,aAAT,CAAuB,QAAvB,CAAT;AACA4b,IAAAA,MAAM,CAACV,KAAP,GAAea,QAAf;AACAH,IAAAA,MAAM,CAACR,MAAP,GAAgBY,SAAhB;AACAH,IAAAA,OAAO,GAAGD,MAAM,CAACK,UAAP,CAAkB,IAAlB,CAAV;AACAJ,IAAAA,OAAO,CAACK,qBAAR,GAAgC,KAAhC;AACH;;AACD,WAASC,YAAT,GAAwB;AACpBP,IAAAA,MAAM,GAAG,IAAT;AACAC,IAAAA,OAAO,GAAG,IAAV;AACH;;AACD,MAAIO,cAAc,GAAG,IAAI,IAAJ,GAAW,IAAhC;;AACA,WAASd,YAAT,CAAsBC,KAAtB,EAA6B;AACzB,QAAI,CAACK,MAAL,EAAa;AACTE,MAAAA,YAAY;AACf;;AACD,QAAIX,YAAY,GAAGI,KAAK,CAACJ,YAAzB;AAAA,QAAuCE,aAAa,GAAGE,KAAK,CAACF,aAA7D;;AACA,QAAIA,aAAa,KAAK,CAAlB,IAAuBF,YAAY,KAAK,CAA5C,EAA+C;AAC3CziB,MAAAA,OAAO,CAAC,4BAA4B6iB,KAAK,CAACc,UAAlC,GAA+C,GAAhD,CAAP;AACA,aAAO,IAAP;AACH;;AACD,QAAI1c,IAAI,GAAGwb,YAAY,GAAGE,aAAf,GAA+B,CAA1C;;AACA,QAAI1b,IAAI,GAAGyc,cAAX,EAA2B;AACvB3jB,MAAAA,OAAO,CAAC,0DAAD,CAAP;AACA,aAAO;AACH8e,QAAAA,MAAM,EAAE,KADL;AAEHkB,QAAAA,OAAO,EAAE,KAFN;AAGH6D,QAAAA,aAAa,EAAE,KAHZ;AAIHC,QAAAA,OAAO,EAAE,KAJN;AAKHC,QAAAA,UAAU,EAAE;AALT,OAAP;AAOH;;AACD,QAAIC,kBAAkB,GAAGtB,YAAY,GAAGE,aAAxC;AACA,QAAI3H,CAAC,GAAG7P,IAAI,CAACa,GAAL,CAAS,CAAT,EAAYb,IAAI,CAAC6Y,IAAL,CAAUf,wBAAwB,GAAGc,kBAArC,CAAZ,CAAR;AACA,QAAIvB,KAAK,GAAGrX,IAAI,CAAC8Y,IAAL,CAAUxB,YAAY,GAAGzH,CAAzB,CAAZ;AACA,QAAI0H,MAAM,GAAGvX,IAAI,CAAC8Y,IAAL,CAAUtB,aAAa,GAAG3H,CAA1B,CAAb;AACAmI,IAAAA,OAAO,CAACe,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwB1B,KAAxB,EAA+BE,MAA/B;AACAS,IAAAA,OAAO,CAACgB,SAAR,CAAkBtB,KAAlB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+BJ,YAA/B,EAA6CE,aAA7C,EAA4D,CAA5D,EAA+D,CAA/D,EAAkEH,KAAlE,EAAyEE,MAAzE;AACA,QAAI0B,SAAS,GAAGjB,OAAO,CAACkB,YAAR,CAAqB,CAArB,EAAwB,CAAxB,EAA2B7B,KAA3B,EAAkCE,MAAlC,CAAhB;AACA,QAAI4B,CAAC,GAAGF,SAAS,CAAC1nB,IAAlB;AACA,QAAI6nB,2BAA2B,GAAG,IAAlC;AACA,QAAIC,wBAAwB,GAAG,GAA/B;AACA,QAAIC,yBAAyB,GAAG,GAAhC;AACA,QAAIC,sBAAsB,GAAG,CAA7B;AACA,QAAIC,eAAe,GAAG,CAAtB;AACA,QAAIC,gBAAgB,GAAG,CAAvB;AACA,QAAIzyB,CAAJ,EAAO+Y,CAAP,EAAU5W,CAAV;AACA,QAAIc,CAAJ,EAAOb,CAAP,EAAU4T,CAAV,EAAavI,CAAb;AACA,QAAIjK,CAAJ;;AACA,SAAKrB,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGouB,MAAhB,EAAwBpuB,CAAC,EAAzB,EAA6B;AACzB,WAAK4W,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGsX,KAAhB,EAAuBtX,CAAC,EAAxB,EAA4B;AACxB/Y,QAAAA,CAAC,GAAG,KAAKmC,CAAC,GAAGkuB,KAAJ,GAAYtX,CAAjB,CAAJ;AACA9V,QAAAA,CAAC,GAAGkvB,CAAC,CAACnyB,CAAC,GAAG,CAAL,CAAD,GAAW,GAAf;AACAoC,QAAAA,CAAC,GAAG+vB,CAAC,CAACnyB,CAAC,GAAG,CAAL,CAAD,GAAW,GAAf;AACAgW,QAAAA,CAAC,GAAGmc,CAAC,CAACnyB,CAAC,GAAG,CAAL,CAAD,GAAW,GAAf;AACAyN,QAAAA,CAAC,GAAG0kB,CAAC,CAACnyB,CAAC,GAAG,CAAL,CAAD,GAAW,GAAf;;AACA,YAAIyN,CAAC,GAAG2kB,2BAAR,EAAqC;AACjCG,UAAAA,sBAAsB;AACzB,SAFD,MAGK;AACD/uB,UAAAA,CAAC,GAAG,SAASP,CAAT,GAAa,SAASb,CAAtB,GAA0B,SAAS4T,CAAvC;;AACA,cAAIxS,CAAC,GAAG6uB,wBAAR,EAAkC;AAC9BG,YAAAA,eAAe;AAClB;;AACD,cAAIhvB,CAAC,GAAG8uB,yBAAR,EAAmC;AAC/BG,YAAAA,gBAAgB;AACnB;AACJ;AACJ;AACJ;;AACD,QAAIC,gBAAgB,GAAGrC,KAAK,GAAGE,MAA/B;AACA,QAAIoC,iBAAiB,GAAGD,gBAAgB,GAAGH,sBAA3C;AACA,QAAIK,oBAAoB,GAAG,GAA3B;AACA,QAAIC,qBAAqB,GAAG,GAA5B;AACA,QAAIC,2BAA2B,GAAG,GAAlC;AACA,QAAIC,wBAAwB,GAAG,MAAM,GAArC;AACA,WAAO;AACHrG,MAAAA,MAAM,EAAI8F,eAAe,GAAGG,iBAAnB,IAAyCC,oBAD/C;AAEHhF,MAAAA,OAAO,EAAI6E,gBAAgB,GAAGE,iBAApB,IAA0CE,qBAFjD;AAGHpB,MAAAA,aAAa,EAAIc,sBAAsB,GAAGG,gBAA1B,IAA+CI,2BAH5D;AAIHpB,MAAAA,OAAO,EAAGE,kBAAkB,IAAImB,wBAJ7B;AAKHpB,MAAAA,UAAU,EAAE;AALT,KAAP;AAOH;;AACD,WAASqB,uBAAT,CAAiC/qB,EAAjC,EAAqC4iB,KAArC,EAA4C;AACxC,QAAI7hB,OAAO,GAAGf,EAAE,CAACe,OAAjB;AAAA,QAA0BqnB,KAAK,GAAGpoB,EAAE,CAACooB,KAArC;AAAA,QAA4CE,MAAM,GAAGtoB,EAAE,CAACsoB,MAAxD;AACA,QAAI5F,MAAM,GAAGoE,uBAAuB,CAAClE,KAAD,CAApC;AACA,QAAIoI,GAAG,GAAG,CACN,oGAAoG5C,KAApG,GAA4G,cAA5G,GAA6HE,MAA7H,GAAsI,KADhI,EAEN,QAFM,EAGN,uCAHM,EAIN,6CAA6C5F,MAA7C,GAAsD,OAJhD,EAKN,WALM,EAMN,SANM,EAON,oBAAoB0F,KAApB,GAA4B,cAA5B,GAA6CE,MAA7C,GAAsD,2DAAtD,GAAoHvnB,OAApH,GAA8H,OAPxH,EAQN,QARM,EASRM,IATQ,CASH,EATG,CAAV;AAUA,WAAO,+BAA+B4pB,IAAI,CAACD,GAAD,CAA1C;AACH;;AACD,WAASE,yBAAT,GAAqC;AACjCrD,IAAAA,YAAY,IAAIA,YAAY,CAACF,SAAb,EAAhB;AACA0B,IAAAA,YAAY;AACf;;AAED,WAAS8B,WAAT,CAAqBC,SAArB,EAAgC7b,QAAhC,EAA0C;AACtC,WAAO8b,OAAO,CAACD,SAAS,IAAIA,SAAS,CAACE,mBAAV,CAA8B/b,QAA9B,CAAd,CAAd;AACH;;AACD,WAASgc,2BAAT,CAAqChc,QAArC,EAA+CzW,KAA/C,EAAsDsV,IAAtD,EAA4Dod,cAA5D,EAA4EC,oBAA5E,EAAkGC,WAAlG,EAA+G;AAC3G,QAAInc,QAAQ,CAAC5Q,UAAT,CAAoB,IAApB,CAAJ,EAA+B;AAC3B,UAAIgtB,QAAQ,GAAGC,mBAAmB,CAACJ,cAAD,EAAiBjc,QAAjB,EAA2BzW,KAA3B,EAAkCsV,IAAlC,EAAwCqd,oBAAxC,EAA8DC,WAA9D,CAAlC;;AACA,UAAIC,QAAJ,EAAc;AACV,eAAO;AAAEpc,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,UAAAA,KAAK,EAAE6yB,QAA7B;AAAuCE,UAAAA,SAAS,EAAEV,WAAW,CAAC/c,IAAI,CAACkB,KAAN,EAAaC,QAAb,CAA7D;AAAqFuc,UAAAA,WAAW,EAAEhzB;AAAlG,SAAP;AACH;AACJ,KALD,MAMK,IAAIA,KAAK,CAACwF,QAAN,CAAe,MAAf,CAAJ,EAA4B;AAC7B,UAAIqtB,QAAQ,GAAGI,4BAA4B,CAACP,cAAD,EAAiBjc,QAAjB,EAA2BzW,KAA3B,CAA3C;;AACA,UAAI6yB,QAAJ,EAAc;AACV,eAAO;AAAEpc,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,UAAAA,KAAK,EAAE6yB,QAA7B;AAAuCE,UAAAA,SAAS,EAAEV,WAAW,CAAC/c,IAAI,CAACkB,KAAN,EAAaC,QAAb,CAA7D;AAAqFuc,UAAAA,WAAW,EAAEhzB;AAAlG,SAAP;AACH;AACJ,KALI,MAMA,IAAKyW,QAAQ,CAACjR,QAAT,CAAkB,OAAlB,KAA8BiR,QAAQ,KAAK,4BAA5C,IACLA,QAAQ,KAAK,MADR,IAELA,QAAQ,KAAK,QAFR,IAGLA,QAAQ,KAAK,YAHZ,EAG0B;AAC3B,UAAIoc,QAAQ,GAAGK,gBAAgB,CAACzc,QAAD,EAAWzW,KAAX,CAA/B;;AACA,UAAI6yB,QAAJ,EAAc;AACV,eAAO;AAAEpc,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,UAAAA,KAAK,EAAE6yB,QAA7B;AAAuCE,UAAAA,SAAS,EAAEV,WAAW,CAAC/c,IAAI,CAACkB,KAAN,EAAaC,QAAb,CAA7D;AAAqFuc,UAAAA,WAAW,EAAEhzB;AAAlG,SAAP;AACH;AACJ,KARI,MASA,IAAIyW,QAAQ,KAAK,kBAAb,IAAmCA,QAAQ,KAAK,kBAApD,EAAwE;AACzE,UAAIoc,QAAQ,GAAGM,kBAAkB,CAACnzB,KAAD,EAAQsV,IAAR,EAAcqd,oBAAd,EAAoCC,WAApC,CAAjC;;AACA,UAAIC,QAAJ,EAAc;AACV,eAAO;AAAEpc,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,UAAAA,KAAK,EAAE6yB,QAA7B;AAAuCE,UAAAA,SAAS,EAAEV,WAAW,CAAC/c,IAAI,CAACkB,KAAN,EAAaC,QAAb,CAA7D;AAAqFuc,UAAAA,WAAW,EAAEhzB;AAAlG,SAAP;AACH;AACJ,KALI,MAMA,IAAIyW,QAAQ,CAACjR,QAAT,CAAkB,QAAlB,CAAJ,EAAiC;AAClC,UAAIqtB,QAAQ,GAAGO,iBAAiB,CAACpzB,KAAD,CAAhC;;AACA,UAAI6yB,QAAJ,EAAc;AACV,eAAO;AAAEpc,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,UAAAA,KAAK,EAAE6yB,QAA7B;AAAuCE,UAAAA,SAAS,EAAEV,WAAW,CAAC/c,IAAI,CAACkB,KAAN,EAAaC,QAAb,CAA7D;AAAqFuc,UAAAA,WAAW,EAAEhzB;AAAlG,SAAP;AACH;AACJ;;AACD,WAAO,IAAP;AACH;;AACD,WAASqzB,yBAAT,CAAmCvJ,KAAnC,EAA0CwJ,QAA1C,EAAoDxnB,mBAApD,EAAyE;AACrE,QAAI4hB,KAAK,GAAG,EAAZ;;AACA,QAAI,CAAC4F,QAAL,EAAe;AACX5F,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,QAAX;AACA6rB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2B2qB,qBAAqB,CAAC;AAAEtqB,QAAAA,CAAC,EAAE,GAAL;AAAUb,QAAAA,CAAC,EAAE,GAAb;AAAkB4T,QAAAA,CAAC,EAAE;AAArB,OAAD,EAA6B6U,KAA7B,CAAhD,GAAsF,cAAjG;AACA4D,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACH;;AACD6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,MAAMyxB,QAAQ,GAAG,EAAH,GAAQ,cAAtB,KAAyCxnB,mBAAmB,GAAG,iCAAH,GAAuC,EAAnG,IAAyG,IAApH;AACA4hB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2B2qB,qBAAqB,CAAC;AAAEtqB,MAAAA,CAAC,EAAE,GAAL;AAAUb,MAAAA,CAAC,EAAE,GAAb;AAAkB4T,MAAAA,CAAC,EAAE;AAArB,KAAD,EAA6B6U,KAA7B,CAAhD,GAAsF,GAAjG;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,kBAAkBiK,mBAAmB,GAAG,iCAAH,GAAuC,EAA5E,IAAkF,IAA7F;AACA4hB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,uBAAuBwrB,iBAAiB,CAAC;AAAEnrB,MAAAA,CAAC,EAAE,EAAL;AAASb,MAAAA,CAAC,EAAE,EAAZ;AAAgB4T,MAAAA,CAAC,EAAE;AAAnB,KAAD,EAA0B6U,KAA1B,CAAxC,GAA2E,GAAtF;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,gBAAgBsrB,qBAAqB,CAAC;AAAEjrB,MAAAA,CAAC,EAAE,CAAL;AAAQb,MAAAA,CAAC,EAAE,CAAX;AAAc4T,MAAAA,CAAC,EAAE;AAAjB,KAAD,EAAuB6U,KAAvB,CAArC,GAAqE,GAAhF;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,KAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,gBAAgBsrB,qBAAqB,CAAC;AAAEjrB,MAAAA,CAAC,EAAE,CAAL;AAAQb,MAAAA,CAAC,EAAE,EAAX;AAAe4T,MAAAA,CAAC,EAAE;AAAlB,KAAD,EAA0B6U,KAA1B,CAArC,GAAwE,GAAnF;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,SAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,uBAAuBwrB,iBAAiB,CAAC;AAAEnrB,MAAAA,CAAC,EAAE,GAAL;AAAUb,MAAAA,CAAC,EAAE,GAAb;AAAkB4T,MAAAA,CAAC,EAAE;AAArB,KAAD,EAA6B6U,KAA7B,CAAxC,GAA8E,GAAzF;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,iBAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,gBAAgBsrB,qBAAqB,CAAC;AAAEjrB,MAAAA,CAAC,EAAE,GAAL;AAAUb,MAAAA,CAAC,EAAE,GAAb;AAAkB4T,MAAAA,CAAC,EAAE;AAArB,KAAD,EAA6B6U,KAA7B,CAArC,GAA2E,GAAtF;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,yBAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,4BAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2B2qB,qBAAqB,CAAC;AAAEtqB,MAAAA,CAAC,EAAE,GAAL;AAAUb,MAAAA,CAAC,EAAE,GAAb;AAAkB4T,MAAAA,CAAC,EAAE;AAArB,KAAD,EAA6B6U,KAA7B,CAAhD,GAAsF,cAAjG;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,gBAAgBsrB,qBAAqB,CAAC;AAAEjrB,MAAAA,CAAC,EAAE,CAAL;AAAQb,MAAAA,CAAC,EAAE,CAAX;AAAc4T,MAAAA,CAAC,EAAE;AAAjB,KAAD,EAAuB6U,KAAvB,CAArC,GAAqE,cAAhF;AACA4D,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;;AACA,QAAIioB,KAAK,CAACle,cAAV,EAA0B;AACtB8hB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW0xB,yBAAyB,CAACzJ,KAAD,CAApC;AACH;;AACD,QAAIA,KAAK,CAACje,cAAV,EAA0B;AACtB6hB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW2xB,yBAAyB,CAAC1J,KAAD,CAApC;AACH;;AACD,WAAO4D,KAAK,CAACnlB,IAAN,CAAW,IAAX,CAAP;AACH;;AACD,WAASkrB,iBAAT,CAA2B3J,KAA3B,EAAkC;AAC9B,QAAI4J,wBAAJ;AACA,QAAIC,wBAAJ;;AACA,QAAI7J,KAAK,CAACje,cAAN,KAAyB,MAA7B,EAAqC;AACjC6nB,MAAAA,wBAAwB,GAAGlH,qBAAqB,CAAC;AAAEtqB,QAAAA,CAAC,EAAE,CAAL;AAAQb,QAAAA,CAAC,EAAE,EAAX;AAAe4T,QAAAA,CAAC,EAAE;AAAlB,OAAD,EAA0BrW,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKkrB,KAAL,CAAT,EAAsB;AAAE7e,QAAAA,SAAS,EAAE;AAAb,OAAtB,CAAlC,CAAhD;AACA0oB,MAAAA,wBAAwB,GAAGxG,qBAAqB,CAAC;AAAEjrB,QAAAA,CAAC,EAAE,GAAL;AAAUb,QAAAA,CAAC,EAAE,GAAb;AAAkB4T,QAAAA,CAAC,EAAE;AAArB,OAAD,EAA6BrW,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKkrB,KAAL,CAAT,EAAsB;AAAE7e,QAAAA,SAAS,EAAE;AAAb,OAAtB,CAArC,CAAhD;AACH,KAHD,MAIK;AACD,UAAIuO,GAAG,GAAGQ,KAAK,CAAC8P,KAAK,CAACje,cAAP,CAAf;AACA,UAAI+N,GAAG,GAAGnB,QAAQ,CAACe,GAAD,CAAlB;AACAka,MAAAA,wBAAwB,GAAG5J,KAAK,CAACje,cAAjC;;AACA,UAAI+N,GAAG,CAACnX,CAAJ,GAAQ,GAAZ,EAAiB;AACbkxB,QAAAA,wBAAwB,GAAG,MAA3B;AACH,OAFD,MAGK;AACDA,QAAAA,wBAAwB,GAAG,MAA3B;AACH;AACJ;;AACD,WAAO;AAAED,MAAAA,wBAAwB,EAAEA,wBAA5B;AAAsDC,MAAAA,wBAAwB,EAAEA;AAAhF,KAAP;AACH;;AACD,WAASH,yBAAT,CAAmC1J,KAAnC,EAA0C;AACtC,QAAI4D,KAAK,GAAG,EAAZ;AACA,QAAIkG,sBAAsB,GAAGH,iBAAiB,CAAC3J,KAAD,CAA9C;AACA,QAAI4J,wBAAwB,GAAGE,sBAAsB,CAACF,wBAAtD;AACA,QAAIC,wBAAwB,GAAGC,sBAAsB,CAACD,wBAAtD;AACA,KAAC,aAAD,EAAgB,kBAAhB,EAAoCjqB,OAApC,CAA4C,UAAUmqB,SAAV,EAAqB;AAC7DnG,MAAAA,KAAK,CAAC7rB,IAAN,CAAWgyB,SAAS,GAAG,IAAvB;AACAnG,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2B6xB,wBAA3B,GAAsD,cAAjE;AACAhG,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,gBAAgB8xB,wBAAhB,GAA2C,cAAtD;AACAjG,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACH,KALD;AAMA,WAAO6rB,KAAK,CAACnlB,IAAN,CAAW,IAAX,CAAP;AACH;;AACD,WAASgrB,yBAAT,CAAmCzJ,KAAnC,EAA0C;AACtC,QAAI4D,KAAK,GAAG,EAAZ;AACA,QAAIoG,UAAJ;AACA,QAAIC,UAAJ;AACA,QAAIC,UAAJ;AACA,QAAIC,eAAJ;AACA,QAAIC,gBAAJ;AACA,QAAIC,WAAJ;;AACA,QAAIrK,KAAK,CAACle,cAAN,KAAyB,MAA7B,EAAqC;AACjCkoB,MAAAA,UAAU,GAAGtH,qBAAqB,CAAC;AAAEtqB,QAAAA,CAAC,EAAE,GAAL;AAAUb,QAAAA,CAAC,EAAE,GAAb;AAAkB4T,QAAAA,CAAC,EAAE;AAArB,OAAD,EAA6B6U,KAA7B,CAAlC;AACAiK,MAAAA,UAAU,GAAG5G,qBAAqB,CAAC;AAAEjrB,QAAAA,CAAC,EAAE,EAAL;AAASb,QAAAA,CAAC,EAAE,EAAZ;AAAgB4T,QAAAA,CAAC,EAAE;AAAnB,OAAD,EAA0B6U,KAA1B,CAAlC;AACAkK,MAAAA,UAAU,GAAGxH,qBAAqB,CAAC;AAAEtqB,QAAAA,CAAC,EAAE,GAAL;AAAUb,QAAAA,CAAC,EAAE,GAAb;AAAkB4T,QAAAA,CAAC,EAAE;AAArB,OAAD,EAA6B6U,KAA7B,CAAlC;AACAmK,MAAAA,eAAe,GAAGzH,qBAAqB,CAAC;AAAEtqB,QAAAA,CAAC,EAAE,GAAL;AAAUb,QAAAA,CAAC,EAAE,GAAb;AAAkB4T,QAAAA,CAAC,EAAE;AAArB,OAAD,EAA6B6U,KAA7B,CAAvC;AACAoK,MAAAA,gBAAgB,GAAG1H,qBAAqB,CAAC;AAAEtqB,QAAAA,CAAC,EAAE,EAAL;AAASb,QAAAA,CAAC,EAAE,EAAZ;AAAgB4T,QAAAA,CAAC,EAAE;AAAnB,OAAD,EAA0B6U,KAA1B,CAAxC;AACAqK,MAAAA,WAAW,GAAG3H,qBAAqB,CAAC;AAAEtqB,QAAAA,CAAC,EAAE,GAAL;AAAUb,QAAAA,CAAC,EAAE,GAAb;AAAkB4T,QAAAA,CAAC,EAAE;AAArB,OAAD,EAA6B6U,KAA7B,CAAnC;AACH,KAPD,MAQK;AACD,UAAItQ,GAAG,GAAGQ,KAAK,CAAC8P,KAAK,CAACle,cAAP,CAAf;AACA,UAAIwoB,KAAK,GAAG3b,QAAQ,CAACe,GAAD,CAApB;AACA,UAAIqT,OAAO,GAAGuH,KAAK,CAAC3xB,CAAN,GAAU,GAAxB;;AACA,UAAI4xB,OAAO,GAAG,UAAUC,OAAV,EAAmB;AAAE,eAAQ11B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKw1B,KAAL,CAAT,EAAsB;AAAE3xB,UAAAA,CAAC,EAAE8kB,KAAK,CAAC6M,KAAK,CAAC3xB,CAAN,GAAU6xB,OAAX,EAAoB,CAApB,EAAuB,CAAvB;AAAV,SAAtB,CAAhB;AAAgF,OAAnH;;AACA,UAAIC,MAAM,GAAG,UAAUC,MAAV,EAAkB;AAAE,eAAQ51B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKw1B,KAAL,CAAT,EAAsB;AAAE3xB,UAAAA,CAAC,EAAE8kB,KAAK,CAAC6M,KAAK,CAAC3xB,CAAN,GAAU+xB,MAAX,EAAmB,CAAnB,EAAsB,CAAtB;AAAV,SAAtB,CAAhB;AAA+E,OAAhH;;AACAV,MAAAA,UAAU,GAAGna,WAAW,CAAC4a,MAAM,CAAC,GAAD,CAAP,CAAxB;AACAR,MAAAA,UAAU,GAAGpa,WAAW,CAACkT,OAAO,GAAG0H,MAAM,CAAC,GAAD,CAAT,GAAiBF,OAAO,CAAC,GAAD,CAAhC,CAAxB;AACAL,MAAAA,UAAU,GAAGra,WAAW,CAACya,KAAD,CAAxB;AACAH,MAAAA,eAAe,GAAGta,WAAW,CAAC0a,OAAO,CAAC,GAAD,CAAR,CAA7B;AACAH,MAAAA,gBAAgB,GAAGva,WAAW,CAAC0a,OAAO,CAAC,GAAD,CAAR,CAA9B;AACH;;AACD3G,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,uBAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2BiyB,UAA3B,GAAwC,GAAnD;AACApG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,gBAAgBkyB,UAAhB,GAA6B,GAAxC;AACArG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,6BAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2BmyB,UAA3B,GAAwC,GAAnD;AACAtG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,mCAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2BoyB,eAA3B,GAA6C,GAAxD;AACAvG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,oCAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2BqyB,gBAA3B,GAA8C,GAAzD;AACAxG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,8BAAX;AACA6rB,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2BsyB,WAA3B,GAAyC,GAApD;AACAzG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;;AACA,QAAI6D,SAAJ,EAAe;AACXgoB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,KAAX;AACA6rB,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,0BAA0BmyB,UAA1B,GAAuC,GAAvC,GAA6CF,UAA7C,GAA0D,GAArE;AACApG,MAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACH;;AACD,WAAO6rB,KAAK,CAACnlB,IAAN,CAAW,IAAX,CAAP;AACH;;AACD,WAASksB,wBAAT,CAAkClH,MAAlC,EAA0CrmB,EAA1C,EAA8C;AAC1C,QAAIwtB,MAAM,GAAGxtB,EAAE,CAACwtB,MAAhB;AACA,QAAIhH,KAAK,GAAG,EAAZ;AACAA,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,kBAAkB6yB,MAAM,GAAG,mBAAH,GAAyB,qBAAjD,IAA0E,IAArF;AACAhH,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,2BAA2B2qB,qBAAqB,CAAC;AAAEtqB,MAAAA,CAAC,EAAE,GAAL;AAAUb,MAAAA,CAAC,EAAE,GAAb;AAAkB4T,MAAAA,CAAC,EAAE;AAArB,KAAD,EAA6BsY,MAA7B,CAAhD,GAAuF,cAAlG;AACAG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,uBAAuBwrB,iBAAiB,CAAC;AAAEnrB,MAAAA,CAAC,EAAE,EAAL;AAASb,MAAAA,CAAC,EAAE,EAAZ;AAAgB4T,MAAAA,CAAC,EAAE;AAAnB,KAAD,EAA0BsY,MAA1B,CAAxC,GAA4E,cAAvF;AACAG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,gBAAgBsrB,qBAAqB,CAAC;AAAEjrB,MAAAA,CAAC,EAAE,CAAL;AAAQb,MAAAA,CAAC,EAAE,CAAX;AAAc4T,MAAAA,CAAC,EAAE;AAAjB,KAAD,EAAuBsY,MAAvB,CAArC,GAAsE,cAAjF;AACAG,IAAAA,KAAK,CAAC7rB,IAAN,CAAW,GAAX;AACA,WAAO6rB,KAAK,CAACnlB,IAAN,CAAW,IAAX,CAAP;AACH;;AACD,MAAIosB,gBAAgB,GAAG,IAAI9rB,GAAJ,CAAQ,CAC3B,SAD2B,EAE3B,aAF2B,EAG3B,SAH2B,EAI3B,cAJ2B,EAK3B,MAL2B,EAM3B,OAN2B,CAAR,CAAvB;AAQA,MAAI+rB,eAAe,GAAG,IAAI3hB,GAAJ,EAAtB;;AACA,WAAS4hB,mBAAT,CAA6B5a,MAA7B,EAAqC;AACjCA,IAAAA,MAAM,GAAGA,MAAM,CAACtD,IAAP,EAAT;;AACA,QAAIie,eAAe,CAAC9hB,GAAhB,CAAoBmH,MAApB,CAAJ,EAAiC;AAC7B,aAAO2a,eAAe,CAACntB,GAAhB,CAAoBwS,MAApB,CAAP;AACH;;AACD,QAAImQ,KAAK,GAAGpQ,KAAK,CAACC,MAAD,CAAjB;AACA2a,IAAAA,eAAe,CAAC9gB,GAAhB,CAAoBmG,MAApB,EAA4BmQ,KAA5B;AACA,WAAOA,KAAP;AACH;;AACD,WAAS0K,aAAT,CAAuB7a,MAAvB,EAA+B;AAC3B,QAAI;AACA,aAAO4a,mBAAmB,CAAC5a,MAAD,CAA1B;AACH,KAFD,CAGA,OAAOzT,GAAP,EAAY;AACR,aAAO,IAAP;AACH;AACJ;;AACD,WAAS0sB,gBAAT,CAA0B9c,IAA1B,EAAgCpW,KAAhC,EAAuC;AACnC,QAAI20B,gBAAgB,CAAC7hB,GAAjB,CAAqB9S,KAAK,CAACqF,WAAN,EAArB,CAAJ,EAA+C;AAC3C,aAAOrF,KAAP;AACH;;AACD,QAAI;AACA,UAAI+0B,KAAK,GAAGF,mBAAmB,CAAC70B,KAAD,CAA/B;;AACA,UAAIoW,IAAI,CAAC5Q,QAAL,CAAc,YAAd,CAAJ,EAAiC;AAC7B,eAAO,UAAU+nB,MAAV,EAAkB;AAAE,iBAAOf,qBAAqB,CAACuI,KAAD,EAAQxH,MAAR,CAA5B;AAA8C,SAAzE;AACH;;AACD,UAAInX,IAAI,CAAC5Q,QAAL,CAAc,QAAd,KAA2B4Q,IAAI,CAAC5Q,QAAL,CAAc,SAAd,CAA/B,EAAyD;AACrD,eAAO,UAAU+nB,MAAV,EAAkB;AAAE,iBAAOF,iBAAiB,CAAC0H,KAAD,EAAQxH,MAAR,CAAxB;AAA0C,SAArE;AACH;;AACD,aAAO,UAAUA,MAAV,EAAkB;AAAE,eAAOJ,qBAAqB,CAAC4H,KAAD,EAAQxH,MAAR,CAA5B;AAA8C,OAAzE;AACH,KATD,CAUA,OAAO/mB,GAAP,EAAY;AACRsG,MAAAA,OAAO,CAAC,mBAAD,EAAsBtG,GAAtB,CAAP;AACA,aAAO,IAAP;AACH;AACJ;;AACD,MAAIwuB,aAAa,GAAG,iFAApB;AACA,MAAIC,iBAAiB,GAAG,IAAIhiB,GAAJ,EAAxB;AACA,MAAIiiB,uBAAuB,GAAG,IAAIjiB,GAAJ,EAA9B;;AACA,WAASkiB,iBAAT,CAA2B5f,YAA3B,EAAyC6f,SAAzC,EAAoD;AAChD,QAAI,CAAC7f,YAAD,IAAiB6f,SAAS,CAACh2B,MAAV,KAAqB,CAA1C,EAA6C;AACzC,aAAO,KAAP;AACH;;AACD,QAAIg2B,SAAS,CAACxf,IAAV,CAAe,UAAU5W,CAAV,EAAa;AAAE,aAAOA,CAAC,KAAK,GAAb;AAAmB,KAAjD,CAAJ,EAAwD;AACpD,aAAO,IAAP;AACH;;AACD,QAAIq2B,aAAa,GAAG9f,YAAY,CAACsT,KAAb,CAAmB,OAAnB,CAApB;;AACA,QAAIyM,OAAO,GAAG,UAAUr2B,CAAV,EAAa;AACvB,UAAIs2B,eAAe,GAAGH,SAAS,CAACn2B,CAAD,CAA/B;;AACA,UAAIo2B,aAAa,CAACzf,IAAd,CAAmB,UAAU5W,CAAV,EAAa;AAAE,eAAOA,CAAC,KAAKu2B,eAAb;AAA+B,OAAjE,CAAJ,EAAwE;AACpE,eAAO;AAAEv1B,UAAAA,KAAK,EAAE;AAAT,SAAP;AACH;AACJ,KALD;;AAMA,SAAK,IAAIf,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGm2B,SAAS,CAACh2B,MAA9B,EAAsCH,CAAC,EAAvC,EAA2C;AACvC,UAAIu2B,OAAO,GAAGF,OAAO,CAACr2B,CAAD,CAArB;;AACA,UAAI,OAAOu2B,OAAP,KAAmB,QAAvB,EACI,OAAOA,OAAO,CAACx1B,KAAf;AACP;;AACD,WAAO,KAAP;AACH;;AACD,WAASmzB,kBAAT,CAA4BnzB,KAA5B,EAAmCsV,IAAnC,EAAyCqd,oBAAzC,EAA+DC,WAA/D,EAA4E;AACxE,QAAI9D,KAAK,GAAG,IAAZ;;AACA,QAAI;AACA,UAAI2G,SAAS,GAAGzN,UAAU,CAACgN,aAAD,EAAgBh1B,KAAhB,CAA1B;AACA,UAAI01B,IAAI,GAAG1N,UAAU,CAAClR,WAAD,EAAc9W,KAAd,CAArB;;AACA,UAAI01B,IAAI,CAACt2B,MAAL,KAAgB,CAAhB,IAAqBq2B,SAAS,CAACr2B,MAAV,KAAqB,CAA9C,EAAiD;AAC7C,eAAOY,KAAP;AACH;;AACD,UAAI21B,UAAU,GAAG,UAAUvN,OAAV,EAAmB;AAChC,YAAI/O,KAAK,GAAG,CAAZ;AACA,eAAO+O,OAAO,CAACjS,GAAR,CAAY,UAAU/P,KAAV,EAAiB;AAChC,cAAIwvB,UAAU,GAAG51B,KAAK,CAACmZ,OAAN,CAAc/S,KAAd,EAAqBiT,KAArB,CAAjB;AACAA,UAAAA,KAAK,GAAGuc,UAAU,GAAGxvB,KAAK,CAAChH,MAA3B;AACA,iBAAO;AAAEgH,YAAAA,KAAK,EAAEA,KAAT;AAAgBiT,YAAAA,KAAK,EAAEuc;AAAvB,WAAP;AACH,SAJM,CAAP;AAKH,OAPD;;AAQA,UAAIC,SAAS,GAAGF,UAAU,CAACD,IAAD,CAAV,CAAiBvf,GAAjB,CAAqB,UAAUlX,CAAV,EAAa;AAAE,eAAQL,QAAQ,CAAC;AAAE0K,UAAAA,IAAI,EAAE;AAAR,SAAD,EAAkBrK,CAAlB,CAAhB;AAAwC,OAA5E,EACX2D,MADW,CACJ+yB,UAAU,CAACF,SAAD,CAAV,CAAsBtf,GAAtB,CAA0B,UAAUlX,CAAV,EAAa;AAAE,eAAQL,QAAQ,CAAC;AAAE0K,UAAAA,IAAI,EAAE;AAAR,SAAD,EAAuBrK,CAAvB,CAAhB;AAA6C,OAAtF,CADI,EAEX62B,IAFW,CAEN,UAAUppB,CAAV,EAAauI,CAAb,EAAgB;AAAE,eAAOvI,CAAC,CAAC2M,KAAF,GAAUpE,CAAC,CAACoE,KAAnB;AAA2B,OAFvC,CAAhB;;AAGA,UAAI0c,qBAAqB,GAAG,UAAUC,QAAV,EAAoB;AAC5C,YAAI5vB,KAAK,GAAG4vB,QAAQ,CAAC5vB,KAAT,CAAe,yBAAf,CAAZ;AACA,YAAIkD,IAAI,GAAGlD,KAAK,CAAC,CAAD,CAAhB;AACA,YAAI6vB,OAAO,GAAG7vB,KAAK,CAAC,CAAD,CAAnB;AACA,YAAI8vB,UAAU,GAAG,gEAAjB;AACA,YAAIC,cAAc,GAAG,iDAArB;AACA,YAAIC,KAAK,GAAGpO,UAAU,CAACkO,UAAD,EAAaD,OAAb,EAAsB,CAAtB,CAAV,CAAmC9f,GAAnC,CAAuC,UAAUkgB,IAAV,EAAgB;AAC/DA,UAAAA,IAAI,GAAGA,IAAI,CAAC1f,IAAL,EAAP;AACA,cAAI6C,GAAG,GAAGsb,aAAa,CAACuB,IAAD,CAAvB;;AACA,cAAI7c,GAAJ,EAAS;AACL,mBAAO,UAAU+T,MAAV,EAAkB;AAAE,qBAAOC,mBAAmB,CAAChU,GAAD,EAAM+T,MAAN,CAA1B;AAA0C,aAArE;AACH;;AACD,cAAI+I,KAAK,GAAGD,IAAI,CAACE,WAAL,CAAiB,GAAjB,CAAZ;AACA/c,UAAAA,GAAG,GAAGsb,aAAa,CAACuB,IAAI,CAAC/c,SAAL,CAAe,CAAf,EAAkBgd,KAAlB,CAAD,CAAnB;;AACA,cAAI9c,GAAJ,EAAS;AACL,mBAAO,UAAU+T,MAAV,EAAkB;AAAE,qBAAOC,mBAAmB,CAAChU,GAAD,EAAM+T,MAAN,CAAnB,GAAmC,GAAnC,GAAyC8I,IAAI,CAAC/c,SAAL,CAAegd,KAAK,GAAG,CAAvB,CAAhD;AAA4E,aAAvG;AACH;;AACD,cAAIE,cAAc,GAAGH,IAAI,CAACjwB,KAAL,CAAW+vB,cAAX,CAArB;;AACA,cAAIK,cAAJ,EAAoB;AAChBhd,YAAAA,GAAG,GAAGsb,aAAa,CAAC0B,cAAc,CAAC,CAAD,CAAf,CAAnB;;AACA,gBAAIhd,GAAJ,EAAS;AACL,qBAAO,UAAU+T,MAAV,EAAkB;AAAE,uBAAOiJ,cAAc,CAAC,CAAD,CAAd,GAAoB,GAApB,IAA2BA,cAAc,CAAC,CAAD,CAAd,GAAoBA,cAAc,CAAC,CAAD,CAAd,GAAoB,IAAxC,GAA+C,EAA1E,IAAgFhJ,mBAAmB,CAAChU,GAAD,EAAM+T,MAAN,CAAnG,GAAmH,GAA1H;AAAgI,eAA3J;AACH;AACJ;;AACD,iBAAO,YAAY;AAAE,mBAAO8I,IAAP;AAAc,WAAnC;AACH,SAnBW,CAAZ;AAoBA,eAAO,UAAU9I,MAAV,EAAkB;AACrB,iBAAOjkB,IAAI,GAAG,GAAP,GAAa8sB,KAAK,CAACjgB,GAAN,CAAU,UAAUsgB,MAAV,EAAkB;AAAE,mBAAOA,MAAM,CAAClJ,MAAD,CAAb;AAAwB,WAAtD,EAAwDhlB,IAAxD,CAA6D,IAA7D,CAAb,GAAkF,GAAzF;AACH,SAFD;AAGH,OA7BD;;AA8BA,UAAImuB,gBAAgB,GAAG,UAAUC,QAAV,EAAoB;AACvC,YAAIzvB,EAAJ;;AACA,YAAIiuB,iBAAiB,CAAC7f,IAAI,CAACC,YAAN,EAAoBod,oBAApB,CAArB,EAAgE;AAC5D,iBAAO,IAAP;AACH;;AACD,YAAI7rB,GAAG,GAAGkQ,cAAc,CAAC2f,QAAD,CAAxB;AACA,YAAIC,gBAAgB,GAAGthB,IAAI,CAACshB,gBAA5B;AACA,YAAIC,OAAO,GAAID,gBAAgB,IAAIA,gBAAgB,CAACviB,IAAtC,GACV8C,cAAc,CAACyf,gBAAgB,CAACviB,IAAlB,CADJ,GAEV,CAAC,CAACnN,EAAE,GAAG0vB,gBAAgB,CAACE,SAAvB,MAAsC,IAAtC,IAA8C5vB,EAAE,KAAK,KAAK,CAA1D,GAA8D,KAAK,CAAnE,GAAuEA,EAAE,CAAC6vB,OAA3E,KAAuFhiB,QAAQ,CAAC/N,MAFpG;AAGAF,QAAAA,GAAG,GAAG8N,cAAc,CAACiiB,OAAD,EAAU/vB,GAAV,CAApB;AACA,YAAIkwB,aAAa,GAAG,WAAWlwB,GAAX,GAAiB,KAArC;AACA,eAAO,UAAUymB,MAAV,EAAkB;AAAE,iBAAO7tB,SAAS,CAACovB,KAAD,EAAQ,KAAK,CAAb,EAAgB,KAAK,CAArB,EAAwB,YAAY;AAC3E,gBAAImI,YAAJ,EAAkBC,UAAlB,EAA8BC,KAA9B,EAAqCC,YAArC;AACA,mBAAOx2B,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,sBAAQA,EAAE,CAACnG,KAAX;AACI,qBAAK,CAAL;AACI,sBAAI,CAACk0B,iBAAiB,CAACniB,GAAlB,CAAsBhM,GAAtB,CAAL,EAAiC,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACjCmwB,kBAAAA,YAAY,GAAGhC,iBAAiB,CAACxtB,GAAlB,CAAsBX,GAAtB,CAAf;AACA,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACII,kBAAAA,EAAE,CAACjG,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,CAAJ,GAAS,CAAT,CAAb;;AACA,sBAAI,CAACqzB,uBAAuB,CAACpiB,GAAxB,CAA4BhM,GAA5B,CAAL,EAAuC,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACvCowB,kBAAAA,UAAU,GAAGhC,uBAAuB,CAACztB,GAAxB,CAA4BX,GAA5B,CAAb;AACA,yBAAO,CAAC,CAAD,EAAI,IAAI5G,OAAJ,CAAY,UAAUD,OAAV,EAAmB;AAAE,2BAAOi3B,UAAU,CAACr1B,IAAX,CAAgB5B,OAAhB,CAAP;AAAkC,mBAAnE,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACIg3B,kBAAAA,YAAY,GAAG/vB,EAAE,CAAClG,IAAH,EAAf;;AACA,sBAAI,CAACi2B,YAAL,EAAmB;AACf,2BAAO,CAAC,CAAD,EAAI,IAAJ,CAAP;AACH;;AACD,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACI/B,kBAAAA,uBAAuB,CAACphB,GAAxB,CAA4BhN,GAA5B,EAAiC,EAAjC;AACA,yBAAO,CAAC,CAAD,EAAIkoB,eAAe,CAACloB,GAAD,CAAnB,CAAP;;AACJ,qBAAK,CAAL;AACImwB,kBAAAA,YAAY,GAAG/vB,EAAE,CAAClG,IAAH,EAAf;AACAi0B,kBAAAA,iBAAiB,CAACnhB,GAAlB,CAAsBhN,GAAtB,EAA2BmwB,YAA3B;AACA/B,kBAAAA,uBAAuB,CAACztB,GAAxB,CAA4BX,GAA5B,EAAiC4C,OAAjC,CAAyC,UAAUzJ,OAAV,EAAmB;AAAE,2BAAOA,OAAO,CAACg3B,YAAD,CAAd;AAA+B,mBAA7F;AACA/B,kBAAAA,uBAAuB,CAAC1jB,MAAxB,CAA+B1K,GAA/B;AACAI,kBAAAA,EAAE,CAACnG,KAAH,GAAW,CAAX;;AACJ,qBAAK,CAAL;AACI,sBAAI6xB,WAAW,EAAf,EAAmB;AACf,2BAAO,CAAC,CAAD,EAAI,IAAJ,CAAP;AACH;;AACD,yBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,qBAAK,CAAL;AACIuE,kBAAAA,KAAK,GAAGjwB,EAAE,CAAClG,IAAH,EAAR;AACA8L,kBAAAA,OAAO,CAACqqB,KAAD,CAAP;;AACA,sBAAIjC,uBAAuB,CAACpiB,GAAxB,CAA4BhM,GAA5B,CAAJ,EAAsC;AAClCouB,oBAAAA,uBAAuB,CAACztB,GAAxB,CAA4BX,GAA5B,EAAiC4C,OAAjC,CAAyC,UAAUzJ,OAAV,EAAmB;AAAE,6BAAOA,OAAO,CAAC,IAAD,CAAd;AAAuB,qBAArF;AACAi1B,oBAAAA,uBAAuB,CAAC1jB,MAAxB,CAA+B1K,GAA/B;AACH;;AACD,yBAAO,CAAC,CAAD,EAAIkwB,aAAJ,CAAP;;AACJ,qBAAK,CAAL;AACII,kBAAAA,YAAY,GAAGC,iBAAiB,CAACJ,YAAD,EAAe1J,MAAf,CAAjB,IAA2CyJ,aAA1D;AACA,yBAAO,CAAC,CAAD,EAAII,YAAJ,CAAP;AAxCR;AA0CH,aA3CiB,CAAlB;AA4CH,WA9C0C,CAAhB;AA8CtB,SA9CL;AA+CH,OA3DD;;AA4DA,UAAIC,iBAAiB,GAAG,UAAUJ,YAAV,EAAwB1J,MAAxB,EAAgC;AACpD,YAAI5B,MAAM,GAAGsL,YAAY,CAACtL,MAA1B;AAAA,YAAkCkB,OAAO,GAAGoK,YAAY,CAACpK,OAAzD;AAAA,YAAkE6D,aAAa,GAAGuG,YAAY,CAACvG,aAA/F;AAAA,YAA8GC,OAAO,GAAGsG,YAAY,CAACtG,OAArI;AAAA,YAA8IC,UAAU,GAAGqG,YAAY,CAACrG,UAAxK;AAAA,YAAoLtB,KAAK,GAAG2H,YAAY,CAAC3H,KAAzM;AACA,YAAI7uB,MAAJ;;AACA,YAAImwB,UAAJ,EAAgB;AACZnwB,UAAAA,MAAM,GAAG,WAAWw2B,YAAY,CAAC5H,GAAxB,GAA8B,KAAvC;AACH,SAFD,MAGK,IAAI1D,MAAM,IAAI+E,aAAV,IAA2BnD,MAAM,CAACziB,IAAP,KAAgB,CAA3C,IAAgD,CAAC6lB,OAAjD,IAA4DrB,KAAK,GAAG,CAAxE,EAA2E;AAC5EziB,UAAAA,OAAO,CAAC,0BAA0BoqB,YAAY,CAAC5H,GAAxC,CAAP;AACA,cAAIiI,QAAQ,GAAGrF,uBAAuB,CAACgF,YAAD,EAAer4B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2uB,MAAL,CAAT,EAAuB;AAAEriB,YAAAA,KAAK,EAAEqc,KAAK,CAACgG,MAAM,CAACriB,KAAP,GAAe,EAAhB,EAAoB,CAApB,EAAuB,GAAvB;AAAd,WAAvB,CAAvB,CAAtC;AACAzK,UAAAA,MAAM,GAAG,WAAW62B,QAAX,GAAsB,KAA/B;AACH,SAJI,MAKA,IAAIzK,OAAO,IAAI,CAAC6D,aAAZ,IAA6BnD,MAAM,CAACziB,IAAP,KAAgB,CAAjD,EAAoD;AACrD,cAAI6lB,OAAJ,EAAa;AACTlwB,YAAAA,MAAM,GAAG,MAAT;AACH,WAFD,MAGK;AACDoM,YAAAA,OAAO,CAAC,yBAAyBoqB,YAAY,CAAC5H,GAAvC,CAAP;AACA,gBAAIkI,MAAM,GAAGtF,uBAAuB,CAACgF,YAAD,EAAe1J,MAAf,CAApC;AACA9sB,YAAAA,MAAM,GAAG,WAAW82B,MAAX,GAAoB,KAA7B;AACH;AACJ,SATI,MAUA,IAAIhK,MAAM,CAACziB,IAAP,KAAgB,CAAhB,IAAqB+hB,OAArB,IAAgC,CAAC8D,OAArC,EAA8C;AAC/C9jB,UAAAA,OAAO,CAAC,8BAA8BoqB,YAAY,CAAC5H,GAA5C,CAAP;AACA,cAAImI,QAAQ,GAAGvF,uBAAuB,CAACgF,YAAD,EAAer4B,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2uB,MAAL,CAAT,EAAuB;AAAExiB,YAAAA,UAAU,EAAEwc,KAAK,CAACgG,MAAM,CAACxiB,UAAP,GAAoB,EAArB,EAAyB,CAAzB,EAA4B,GAA5B,CAAnB;AAAqDG,YAAAA,KAAK,EAAEqc,KAAK,CAACgG,MAAM,CAACriB,KAAP,GAAe,EAAhB,EAAoB,CAApB,EAAuB,GAAvB;AAAjE,WAAvB,CAAvB,CAAtC;AACAzK,UAAAA,MAAM,GAAG,WAAW+2B,QAAX,GAAsB,KAA/B;AACH,SAJI,MAKA;AACD/2B,UAAAA,MAAM,GAAG,IAAT;AACH;;AACD,eAAOA,MAAP;AACH,OA9BD;;AA+BA,UAAIg3B,WAAW,GAAG,EAAlB;AACA,UAAIC,OAAO,GAAG,CAAd;AACA7B,MAAAA,SAAS,CAACnsB,OAAV,CAAkB,UAAUxC,EAAV,EAAcjI,CAAd,EAAiB;AAC/B,YAAImH,KAAK,GAAGc,EAAE,CAACd,KAAf;AAAA,YAAsBkD,IAAI,GAAGpC,EAAE,CAACoC,IAAhC;AAAA,YAAsCquB,UAAU,GAAGzwB,EAAE,CAACmS,KAAtD;AACA,YAAIue,WAAW,GAAGF,OAAlB;AACA,YAAIG,QAAQ,GAAGF,UAAU,GAAGvxB,KAAK,CAAChH,MAAlC;AACAs4B,QAAAA,OAAO,GAAGG,QAAV;AACAJ,QAAAA,WAAW,CAAC51B,IAAZ,CAAiB,YAAY;AAAE,iBAAO7B,KAAK,CAACsZ,SAAN,CAAgBse,WAAhB,EAA6BD,UAA7B,CAAP;AAAkD,SAAjF;AACAF,QAAAA,WAAW,CAAC51B,IAAZ,CAAiByH,IAAI,KAAK,KAAT,GAAiBotB,gBAAgB,CAACtwB,KAAD,CAAjC,GAA2C2vB,qBAAqB,CAAC3vB,KAAD,CAAjF;;AACA,YAAInH,CAAC,KAAK42B,SAAS,CAACz2B,MAAV,GAAmB,CAA7B,EAAgC;AAC5Bq4B,UAAAA,WAAW,CAAC51B,IAAZ,CAAiB,YAAY;AAAE,mBAAO7B,KAAK,CAACsZ,SAAN,CAAgBue,QAAhB,CAAP;AAAmC,WAAlE;AACH;AACJ,OAVD;AAWA,aAAO,UAAUtK,MAAV,EAAkB;AACrB,YAAI3gB,OAAO,GAAG6qB,WAAW,CAAClK,MAAZ,CAAmBgF,OAAnB,EAA4Bpc,GAA5B,CAAgC,UAAUsgB,MAAV,EAAkB;AAAE,iBAAOA,MAAM,CAAClJ,MAAD,CAAb;AAAwB,SAA5E,CAAd;;AACA,YAAI3gB,OAAO,CAACgJ,IAAR,CAAa,UAAU1T,CAAV,EAAa;AAAE,iBAAOA,CAAC,YAAYhC,OAApB;AAA8B,SAA1D,CAAJ,EAAiE;AAC7D,iBAAOA,OAAO,CAAC43B,GAAR,CAAYlrB,OAAZ,EACFjM,IADE,CACG,UAAUo3B,YAAV,EAAwB;AAC9B,mBAAOA,YAAY,CAACxvB,IAAb,CAAkB,EAAlB,CAAP;AACH,WAHM,CAAP;AAIH;;AACD,eAAOqE,OAAO,CAACrE,IAAR,CAAa,EAAb,CAAP;AACH,OATD;AAUH,KAjKD,CAkKA,OAAO/B,GAAP,EAAY;AACRsG,MAAAA,OAAO,CAAC,8BAA8B9M,KAA/B,EAAsCwG,GAAtC,CAAP;AACA,aAAO,IAAP;AACH;AACJ;;AACD,WAAS4sB,iBAAT,CAA2BpzB,KAA3B,EAAkC;AAC9B,QAAI;AACA,UAAIg4B,OAAO,GAAG,CAAd;AACA,UAAIC,cAAc,GAAGjQ,UAAU,CAAC,4EAAD,EAA+EhoB,KAA/E,EAAsF,CAAtF,CAA/B;AACA,UAAIk4B,WAAW,GAAGD,cAAc,CAAC9hB,GAAf,CAAmB,UAAU/P,KAAV,EAAiBnH,CAAjB,EAAoB;AACrD,YAAIk5B,WAAW,GAAGH,OAAlB;AACA,YAAII,UAAU,GAAGp4B,KAAK,CAACmZ,OAAN,CAAc/S,KAAd,EAAqB4xB,OAArB,CAAjB;AACA,YAAIH,QAAQ,GAAGO,UAAU,GAAGhyB,KAAK,CAAChH,MAAlC;AACA44B,QAAAA,OAAO,GAAGH,QAAV;AACA,YAAIre,GAAG,GAAGsb,aAAa,CAAC1uB,KAAD,CAAvB;;AACA,YAAI,CAACoT,GAAL,EAAU;AACN,iBAAO,YAAY;AAAE,mBAAOxZ,KAAK,CAACsZ,SAAN,CAAgB6e,WAAhB,EAA6BN,QAA7B,CAAP;AAAgD,WAArE;AACH;;AACD,eAAO,UAAUtK,MAAV,EAAkB;AAAE,iBAAO,KAAKvtB,KAAK,CAACsZ,SAAN,CAAgB6e,WAAhB,EAA6BC,UAA7B,CAAL,GAAgD9K,iBAAiB,CAAC9T,GAAD,EAAM+T,MAAN,CAAjE,IAAkFtuB,CAAC,KAAKg5B,cAAc,CAAC74B,MAAf,GAAwB,CAA9B,GAAkCY,KAAK,CAACsZ,SAAN,CAAgBue,QAAhB,CAAlC,GAA8D,EAAhJ,CAAP;AAA6J,SAAxL;AACH,OAViB,CAAlB;AAWA,aAAO,UAAUtK,MAAV,EAAkB;AAAE,eAAO2K,WAAW,CAAC/hB,GAAZ,CAAgB,UAAUsgB,MAAV,EAAkB;AAAE,iBAAOA,MAAM,CAAClJ,MAAD,CAAb;AAAwB,SAA5D,EAA8DhlB,IAA9D,CAAmE,EAAnE,CAAP;AAAgF,OAA3G;AACH,KAfD,CAgBA,OAAO/B,GAAP,EAAY;AACRsG,MAAAA,OAAO,CAAC,4BAA4B9M,KAA7B,EAAoCwG,GAApC,CAAP;AACA,aAAO,IAAP;AACH;AACJ;;AACD,WAASssB,mBAAT,CAA6BJ,cAA7B,EAA6Ctc,IAA7C,EAAmDpW,KAAnD,EAA0DsV,IAA1D,EAAgE+iB,mBAAhE,EAAqFzF,WAArF,EAAkG;AAC9F,WAAOF,cAAc,CAAC4F,sBAAf,CAAsC;AACzCC,MAAAA,OAAO,EAAEniB,IADgC;AAEzC4c,MAAAA,WAAW,EAAEhzB,KAF4B;AAGzCsV,MAAAA,IAAI,EAAEA,IAHmC;AAIzC+iB,MAAAA,mBAAmB,EAAEA,mBAJoB;AAKzCzF,MAAAA,WAAW,EAAEA;AAL4B,KAAtC,CAAP;AAOH;;AACD,WAASK,4BAAT,CAAsCP,cAAtC,EAAsDtc,IAAtD,EAA4DpW,KAA5D,EAAmE;AAC/D,WAAO0yB,cAAc,CAAC8F,0BAAf,CAA0CpiB,IAA1C,EAAgDpW,KAAhD,CAAP;AACH;;AACD,WAASy4B,sBAAT,GAAkC;AAC9B7D,IAAAA,eAAe,CAAC/iB,KAAhB;AACAwY,IAAAA,2BAA2B;AAC3B4K,IAAAA,iBAAiB,CAACpjB,KAAlB;AACAugB,IAAAA,yBAAyB;AACzB8C,IAAAA,uBAAuB,CAACrjB,KAAxB;AACH;;AAED,MAAI6mB,gBAAgB,GAAG,KAAK,CAA5B;AACA,MAAIC,kBAAkB,GAAG,KAAK,CAA9B;AACA,MAAIC,oBAAoB,GAAG,KAAK,CAAhC;AACA,MAAIC,cAAc,GAAG,KAAK,CAA1B;;AACA,MAAIC,cAAc,GAAI,YAAY;AAC9B,aAASA,cAAT,GAA0B;AACtB,WAAKC,QAAL,GAAgB,IAAI9lB,GAAJ,EAAhB;AACA,WAAK+lB,UAAL,GAAkB,EAAlB;AACA,WAAKC,WAAL,GAAmB,IAAIpwB,GAAJ,EAAnB;AACA,WAAKqwB,OAAL,GAAe,IAAIjmB,GAAJ,EAAf;AACA,WAAKkmB,gBAAL,GAAwB,IAAItwB,GAAJ,EAAxB;AACA,WAAKuwB,aAAL,GAAqB,IAAIvwB,GAAJ,EAArB;AACA,WAAKwwB,aAAL,GAAqB,IAAIxwB,GAAJ,EAArB;AACA,WAAKywB,eAAL,GAAuB,IAAIrmB,GAAJ,EAAvB;AACA,WAAKsmB,eAAL,GAAuB,IAAI1wB,GAAJ,EAAvB;AACA,WAAK2wB,uBAAL,GAA+B,IAAIvmB,GAAJ,EAA/B;AACA,WAAKwmB,iBAAL,GAAyB,IAAIxmB,GAAJ,EAAzB;AACH;;AACD6lB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBuS,KAAzB,GAAiC,YAAY;AACzC,WAAKknB,QAAL,CAAclnB,KAAd;AACA,WAAKmnB,UAAL,CAAgBprB,MAAhB,CAAuB,CAAvB;AACA,WAAKqrB,WAAL,CAAiBpnB,KAAjB;AACA,WAAKqnB,OAAL,CAAarnB,KAAb;AACA,WAAKsnB,gBAAL,CAAsBtnB,KAAtB;AACA,WAAKunB,aAAL,CAAmBvnB,KAAnB;AACA,WAAKwnB,aAAL,CAAmBxnB,KAAnB;AACA,WAAKynB,eAAL,CAAqBznB,KAArB;AACA,WAAK0nB,eAAL,CAAqB1nB,KAArB;AACA,WAAK2nB,uBAAL,CAA6B3nB,KAA7B;AACA,WAAK4nB,iBAAL,CAAuB5nB,KAAvB;AACH,KAZD;;AAaAinB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBo6B,SAAzB,GAAqC,UAAUnB,OAAV,EAAmBoB,OAAnB,EAA4B;AAC7D,aAAQ,KAAKZ,QAAL,CAAcjmB,GAAd,CAAkBylB,OAAlB,KACJ,CAAC,KAAKQ,QAAL,CAActxB,GAAd,CAAkB8wB,OAAlB,IAA6BoB,OAA9B,IAAyC,CAD7C;AAEH,KAHD;;AAIAb,IAAAA,cAAc,CAACx5B,SAAf,CAAyBs6B,mBAAzB,GAA+C,UAAUzkB,KAAV,EAAiB;AAC5D,WAAK6jB,UAAL,CAAgBn3B,IAAhB,CAAqBsT,KAArB;AACH,KAFD;;AAGA2jB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBu6B,2BAAzB,GAAuD,YAAY;AAC/D,UAAI/K,KAAK,GAAG,IAAZ;;AACA,WAAKyK,eAAL,CAAqB1nB,KAArB;AACA,WAAKynB,eAAL,GAAuB,IAAIrmB,GAAJ,CAAQ,KAAK8lB,QAAb,CAAvB;AACA,WAAKe,oBAAL;AACA,WAAKC,yBAAL,CAA+B,KAAKf,UAApC;AACA,WAAKA,UAAL,CAAgBprB,MAAhB,CAAuB,CAAvB;AACA,WAAKosB,wBAAL;AACA,WAAKd,OAAL,CAAaxvB,OAAb,CAAqB,UAAUuwB,IAAV,EAAgBx4B,CAAhB,EAAmB;AACpCw4B,QAAAA,IAAI,CAACvwB,OAAL,CAAa,UAAUxH,CAAV,EAAa;AACtB,cAAI4sB,KAAK,CAACiK,QAAN,CAAejmB,GAAf,CAAmBrR,CAAnB,CAAJ,EAA2B;AACvBqtB,YAAAA,KAAK,CAACoL,mBAAN,CAA0Bh4B,CAA1B,EAA6B4sB,KAAK,CAACiK,QAAN,CAAetxB,GAAf,CAAmBhG,CAAnB,CAA7B;AACH;AACJ,SAJD;AAKH,OAND;AAOA,WAAK03B,gBAAL,CAAsBzvB,OAAtB,CAA8B,UAAUjI,CAAV,EAAa;AACvC,YAAIqtB,KAAK,CAACsK,aAAN,CAAoBtmB,GAApB,CAAwBrR,CAAxB,CAAJ,EAAgC;AAC5BqtB,UAAAA,KAAK,CAACqK,gBAAN,CAAuB3nB,MAAvB,CAA8B/P,CAA9B;;AACAqtB,UAAAA,KAAK,CAACsK,aAAN,CAAoB5nB,MAApB,CAA2B/P,CAA3B;;AACAqtB,UAAAA,KAAK,CAACoL,mBAAN,CAA0Bz4B,CAA1B,EAA6Bi3B,gBAA7B;AACH,SAJD,MAKK,IAAI5J,KAAK,CAAC4K,SAAN,CAAgBj4B,CAAhB,EAAmBi3B,gBAAgB,GAAGC,kBAAnB,GAAwCC,oBAA3D,CAAJ,EAAsF;AACvF9J,UAAAA,KAAK,CAACqK,gBAAN,CAAuB3nB,MAAvB,CAA8B/P,CAA9B;AACH,SAFI,MAGA;AACDqtB,UAAAA,KAAK,CAACuK,aAAN,CAAoBtvB,GAApB,CAAwBtI,CAAxB;AACH;AACJ,OAZD;AAaA,WAAK23B,aAAL,CAAmB1vB,OAAnB,CAA2B,UAAUjI,CAAV,EAAa;AACpC,YAAI04B,QAAQ,GAAGrL,KAAK,CAACsL,UAAN,CAAiB34B,CAAjB,EAAoB,UAAU44B,GAAV,EAAe;AAC9C,iBAAQvL,KAAK,CAACqK,gBAAN,CAAuBrmB,GAAvB,CAA2BunB,GAA3B,KACJvL,KAAK,CAAC4K,SAAN,CAAgBW,GAAhB,EAAqB1B,kBAAkB,GAAGC,oBAA1C,CADJ;AAEH,SAHc,KAGT,IAHN;;AAIA,YAAIuB,QAAJ,EAAc;AACVrL,UAAAA,KAAK,CAACwL,cAAN,CAAqB74B,CAArB,EAAwB,UAAU44B,GAAV,EAAe;AACnCvL,YAAAA,KAAK,CAACoL,mBAAN,CAA0BG,GAA1B,EAA+B3B,gBAA/B;AACH,WAFD;AAGH,SAJD,MAKK,IAAI5J,KAAK,CAAC4K,SAAN,CAAgBj4B,CAAhB,EAAmBi3B,gBAAgB,GAAGG,cAAtC,CAAJ,EAA2D;AAC5D/J,UAAAA,KAAK,CAACsK,aAAN,CAAoB5nB,MAApB,CAA2B/P,CAA3B;AACH,SAFI,MAGA;AACDqtB,UAAAA,KAAK,CAACuK,aAAN,CAAoBtvB,GAApB,CAAwBtI,CAAxB;AACH;AACJ,OAhBD;AAiBA,WAAK83B,eAAL,CAAqB7vB,OAArB,CAA6B,UAAU6uB,OAAV,EAAmB;AAC5C,YAAIzJ,KAAK,CAAC0K,uBAAN,CAA8B1mB,GAA9B,CAAkCylB,OAAlC,CAAJ,EAAgD;AAC5CzJ,UAAAA,KAAK,CAAC0K,uBAAN,CACK/xB,GADL,CACS8wB,OADT,EAEK7uB,OAFL,CAEa,UAAUI,QAAV,EAAoB;AAC7BA,YAAAA,QAAQ;AACX,WAJD;AAKH;AACJ,OARD;AASA,WAAKyvB,eAAL,CAAqB1nB,KAArB;AACH,KAvDD;;AAwDAinB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBg5B,sBAAzB,GAAkD,UAAUiC,OAAV,EAAmB;AACjE,UAAIzL,KAAK,GAAG,IAAZ;;AACA,aAAO,UAAUhF,KAAV,EAAiB;AACpB,YAAIyO,OAAO,GAAGgC,OAAO,CAAChC,OAAtB;AAAA,YAA+BvF,WAAW,GAAGuH,OAAO,CAACvH,WAArD;AAAA,YAAkE1d,IAAI,GAAGilB,OAAO,CAACjlB,IAAjF;AAAA,YAAuF+iB,mBAAmB,GAAGkC,OAAO,CAAClC,mBAArH;AAAA,YAA0IzF,WAAW,GAAG2H,OAAO,CAAC3H,WAAhK;;AACA,YAAI4H,eAAe,GAAG,YAAY;AAC9B,cAAIC,YAAY,GAAG,EAAnB;;AACA,cAAIC,gBAAgB,GAAG,UAAUf,OAAV,EAAmBgB,cAAnB,EAAmCC,aAAnC,EAAkD;AACrE,gBAAI,CAAC9L,KAAK,CAAC4K,SAAN,CAAgBnB,OAAhB,EAAyBoB,OAAzB,CAAL,EAAwC;AACpC;AACH;;AACD,gBAAIljB,QAAQ,GAAGkkB,cAAc,CAACpC,OAAD,CAA7B;AACA,gBAAIsC,aAAJ;;AACA,gBAAIC,cAAc,CAAC9H,WAAD,CAAlB,EAAiC;AAC7B,kBAAI+H,qBAAqB,CAAC/H,WAAD,CAAzB,EAAwC;AACpC,oBAAIhzB,KAAK,GAAGg7B,eAAe,CAAChI,WAAD,EAAclE,KAAK,CAAC2K,iBAApB,CAA3B;;AACA,oBAAI,CAACz5B,KAAL,EAAY;AACRA,kBAAAA,KAAK,GAAG25B,OAAO,KAAKjB,gBAAZ,GAA+B,SAA/B,GAA2C,SAAnD;AACH;;AACDmC,gBAAAA,aAAa,GAAGD,aAAa,CAAC56B,KAAD,EAAQ8pB,KAAR,CAA7B;AACH,eAND,MAOK;AACD+Q,gBAAAA,aAAa,GAAGI,wBAAwB,CAACjI,WAAD,EAAc,UAAUvxB,CAAV,EAAa;AAAE,yBAAOk5B,cAAc,CAACl5B,CAAD,CAArB;AAA2B,iBAAxD,EAA0D,UAAUy5B,QAAV,EAAoB;AAAE,yBAAON,aAAa,CAACM,QAAD,EAAWpR,KAAX,CAApB;AAAwC,iBAAxH,CAAxC;AACH;AACJ,aAXD,MAYK;AACD+Q,cAAAA,aAAa,GAAGD,aAAa,CAAC5H,WAAD,EAAclJ,KAAd,CAA7B;AACH;;AACD2Q,YAAAA,YAAY,CAAC54B,IAAb,CAAkB;AACd4U,cAAAA,QAAQ,EAAEA,QADI;AAEdzW,cAAAA,KAAK,EAAE66B;AAFO,aAAlB;AAIH,WAzBD;;AA0BAH,UAAAA,gBAAgB,CAAChC,gBAAD,EAAmByC,uBAAnB,EAA4CC,gBAA5C,CAAhB;AACAV,UAAAA,gBAAgB,CAAC/B,kBAAD,EAAqB0C,yBAArB,EAAgDC,kBAAhD,CAAhB;AACAZ,UAAAA,gBAAgB,CAAC9B,oBAAD,EAAuB2C,2BAAvB,EAAoDC,oBAApD,CAAhB;;AACA,cAAI1M,KAAK,CAAC4K,SAAN,CAAgBnB,OAAhB,EAAyBM,cAAzB,CAAJ,EAA8C;AAC1C,gBAAIpiB,QAAQ,GAAGglB,qBAAqB,CAAClD,OAAD,CAApC;AACA,gBAAIsC,aAAa,GAAG7H,WAApB;;AACA,gBAAI8H,cAAc,CAAC9H,WAAD,CAAlB,EAAiC;AAC7B6H,cAAAA,aAAa,GAAGI,wBAAwB,CAACjI,WAAD,EAAc,UAAUvxB,CAAV,EAAa;AAAE,uBAAO05B,uBAAuB,CAAC15B,CAAD,CAA9B;AAAoC,eAAjE,EAAmE,UAAUy5B,QAAV,EAAoB;AAAE,uBAAOE,gBAAgB,CAACF,QAAD,EAAWpR,KAAX,CAAvB;AAA2C,eAApI,CAAxC;AACH;;AACD,gBAAI4R,UAAU,GAAGvI,kBAAkB,CAAC0H,aAAD,EAAgBvlB,IAAhB,EAAsB+iB,mBAAtB,EAA2CzF,WAA3C,CAAnC;AACAiI,YAAAA,aAAa,GAAG,OAAOa,UAAP,KAAsB,UAAtB,GAAmCA,UAAU,CAAC5R,KAAD,CAA7C,GAAuD4R,UAAvE;AACAjB,YAAAA,YAAY,CAAC54B,IAAb,CAAkB;AACd4U,cAAAA,QAAQ,EAAEA,QADI;AAEdzW,cAAAA,KAAK,EAAE66B;AAFO,aAAlB;AAIH;;AACD,iBAAOJ,YAAP;AACH,SA7CD;;AA8CA,YAAIpnB,SAAS,GAAG,IAAIxK,GAAJ,EAAhB;;AACA,YAAIqB,WAAW,GAAG,UAAUyxB,YAAV,EAAwB;AACtC,cAAI7xB,QAAQ,GAAG,YAAY;AACvB,gBAAI8xB,IAAI,GAAGpB,eAAe,EAA1B;AACAmB,YAAAA,YAAY,CAACC,IAAD,CAAZ;AACH,WAHD;;AAIAvoB,UAAAA,SAAS,CAACtJ,GAAV,CAAcD,QAAd;;AACAglB,UAAAA,KAAK,CAAC+M,yBAAN,CAAgCtD,OAAhC,EAAyCzuB,QAAzC;AACH,SAPD;;AAQA,YAAIgyB,eAAe,GAAG,YAAY;AAC9BzoB,UAAAA,SAAS,CAAC3J,OAAV,CAAkB,UAAUI,QAAV,EAAoB;AAClCglB,YAAAA,KAAK,CAACiN,kCAAN,CAAyCxD,OAAzC,EAAkDzuB,QAAlD;AACH,WAFD;AAGH,SAJD;;AAKA,eAAO;AACH2wB,UAAAA,YAAY,EAAED,eAAe,EAD1B;AAEHmB,UAAAA,YAAY,EAAE;AAAEzxB,YAAAA,WAAW,EAAEA,WAAf;AAA4B4xB,YAAAA,eAAe,EAAEA;AAA7C;AAFX,SAAP;AAIH,OAlED;AAmEH,KArED;;AAsEAhD,IAAAA,cAAc,CAACx5B,SAAf,CAAyBk5B,0BAAzB,GAAsD,UAAU/hB,QAAV,EAAoBuc,WAApB,EAAiC;AACnF,UAAIlE,KAAK,GAAG,IAAZ;;AACA,UAAIkE,WAAW,CAAC5sB,KAAZ,CAAkB,mBAAlB,CAAJ,EAA4C;AACxC,YAAI41B,MAAM,GAAGvlB,QAAQ,CAAC5Q,UAAT,CAAoB,YAApB,CAAb;AACA,YAAIo2B,QAAQ,GAAIxlB,QAAQ,KAAK,OAAb,IAAwBA,QAAQ,KAAK,aAArD;AACA,eAAO,UAAUqT,KAAV,EAAiB;AACpB,cAAI9pB,KAAK,GAAGg7B,eAAe,CAAChI,WAAD,EAAclE,KAAK,CAAC2K,iBAApB,CAA3B;;AACA,cAAI,CAACz5B,KAAL,EAAY;AACRA,YAAAA,KAAK,GAAGg8B,MAAM,GAAG,SAAH,GAAe,SAA7B;AACH;;AACD,cAAInJ,QAAQ,GAAGmJ,MAAM,GAAGZ,gBAAH,GAAsBa,QAAQ,GAAGX,kBAAH,GAAwBE,oBAA3E;AACA,iBAAO3I,QAAQ,CAAC7yB,KAAD,EAAQ8pB,KAAR,CAAf;AACH,SAPD;AAQH;;AACD,UAAIrT,QAAQ,KAAK,kBAAjB,EAAqC;AACjC,eAAO,UAAUqT,KAAV,EAAiB;AACpB,iBAAOmR,wBAAwB,CAACjI,WAAD,EAAc,UAAUvxB,CAAV,EAAa;AAAE,mBAAO05B,uBAAuB,CAAC15B,CAAD,CAA9B;AAAoC,WAAjE,EAAmE,UAAUy5B,QAAV,EAAoB;AAAE,mBAAOE,gBAAgB,CAACF,QAAD,EAAWpR,KAAX,CAAvB;AAA2C,WAApI,CAA/B;AACH,SAFD;AAGH;;AACD,UAAIrT,QAAQ,KAAK,OAAb,IAAwBA,QAAQ,KAAK,aAAzC,EAAwD;AACpD,eAAO,UAAUqT,KAAV,EAAiB;AACpB,iBAAOmR,wBAAwB,CAACjI,WAAD,EAAc,UAAUvxB,CAAV,EAAa;AAAE,mBAAO45B,yBAAyB,CAAC55B,CAAD,CAAhC;AAAsC,WAAnE,EAAqE,UAAUy5B,QAAV,EAAoB;AAAE,mBAAOI,kBAAkB,CAACJ,QAAD,EAAWpR,KAAX,CAAzB;AAA6C,WAAxI,CAA/B;AACH,SAFD;AAGH;;AACD,UAAIrT,QAAQ,KAAK,YAAb,IAA6BA,QAAQ,KAAK,kBAA1C,IAAgEA,QAAQ,KAAK,YAAjF,EAA+F;AAC3F,eAAO,UAAUqT,KAAV,EAAiB;AACpB,cAAIoS,WAAW,GAAG,IAAIrzB,GAAJ,EAAlB;;AACA,cAAI4tB,MAAM,GAAG,YAAY;AACrB,gBAAI0F,gBAAgB,GAAGlB,wBAAwB,CAACjI,WAAD,EAAc,UAAUvxB,CAAV,EAAa;AACtE,kBAAIqtB,KAAK,CAAC4K,SAAN,CAAgBj4B,CAAhB,EAAmBi3B,gBAAnB,CAAJ,EAA0C;AACtC,uBAAOyC,uBAAuB,CAAC15B,CAAD,CAA9B;AACH;;AACD,kBAAIqtB,KAAK,CAAC4K,SAAN,CAAgBj4B,CAAhB,EAAmBo3B,cAAnB,CAAJ,EAAwC;AACpC,uBAAO4C,qBAAqB,CAACh6B,CAAD,CAA5B;AACH;;AACDy6B,cAAAA,WAAW,CAACnyB,GAAZ,CAAgBtI,CAAhB;AACA,qBAAOA,CAAP;AACH,aAT8C,EAS5C,UAAUy5B,QAAV,EAAoB;AAAE,qBAAOE,gBAAgB,CAACF,QAAD,EAAWpR,KAAX,CAAvB;AAA2C,aATrB,CAA/C;;AAUA,gBAAIrT,QAAQ,KAAK,YAAjB,EAA+B;AAC3B,kBAAI2lB,cAAc,GAAGhJ,iBAAiB,CAAC+I,gBAAD,CAAtC;AACA,qBAAOC,cAAc,CAACtS,KAAD,CAAd,IAAyBqS,gBAAhC;AACH;;AACD,mBAAOA,gBAAP;AACH,WAhBD;;AAiBA,cAAIlR,QAAQ,GAAGwL,MAAM,EAArB;;AACA,cAAIyF,WAAW,CAACnoB,IAAZ,GAAmB,CAAvB,EAA0B;AACtB,mBAAO,IAAI7T,OAAJ,CAAY,UAAUD,OAAV,EAAmB;AAClC,kBAAIo8B,eAAe,GAAGH,WAAW,CAACI,MAAZ,GAAqBh8B,IAArB,GAA4BN,KAAlD;;AACA,kBAAI8J,QAAQ,GAAG,YAAY;AACvBglB,gBAAAA,KAAK,CAACiN,kCAAN,CAAyCM,eAAzC,EAA0DvyB,QAA1D;;AACA,oBAAIyyB,QAAQ,GAAG9F,MAAM,EAArB;AACAx2B,gBAAAA,OAAO,CAACs8B,QAAD,CAAP;AACH,eAJD;;AAKAzN,cAAAA,KAAK,CAAC+M,yBAAN,CAAgCQ,eAAhC,EAAiDvyB,QAAjD;AACH,aARM,CAAP;AASH;;AACD,iBAAOmhB,QAAP;AACH,SAhCD;AAiCH;;AACD,UAAIxU,QAAQ,CAAC5Q,UAAT,CAAoB,QAApB,KAAiC4Q,QAAQ,CAAC5Q,UAAT,CAAoB,SAApB,CAArC,EAAqE;AACjE,YAAImtB,WAAW,CAACzrB,QAAZ,CAAqB,GAArB,CAAJ,EAA+B;AAC3B,cAAIi1B,cAAc,GAAGxJ,WAAW,CAAC5sB,KAAZ,CAAkB,iBAAlB,CAArB;;AACA,cAAIo2B,cAAJ,EAAoB;AAChB,gBAAI9E,OAAO,GAAG8E,cAAc,CAACnjB,KAA7B;AACA,mBAAO,UAAUyQ,KAAV,EAAiB;AACpB,kBAAI9pB,KAAK,GAAGg7B,eAAe,CAAChI,WAAD,EAAclE,KAAK,CAAC2K,iBAApB,CAA3B;;AACA,kBAAI,CAACz5B,KAAL,EAAY;AACR,uBAAOgzB,WAAP;AACH;;AACD,kBAAIyJ,SAAS,GAAGzJ,WAAW,CAAC1Z,SAAZ,CAAsB,CAAtB,EAAyBoe,OAAzB,CAAhB;AACA,kBAAItN,KAAK,GAAG4I,WAAW,CAAC1Z,SAAZ,CAAsBoe,OAAtB,EAA+B1E,WAAW,CAAC5zB,MAA3C,CAAZ;AACA,kBAAIs9B,QAAQ,GAAG1B,eAAe,CAAC5Q,KAAD,EAAQ0E,KAAK,CAAC2K,iBAAd,CAA9B;AACA,kBAAIxO,QAAQ,GAAGuQ,oBAAoB,CAACkB,QAAD,EAAW5S,KAAX,CAAnC;AACA,qBAAO,KAAK2S,SAAL,GAAiBxR,QAAxB;AACH,aAVD;AAWH;AACJ;;AACD,eAAO,UAAUnB,KAAV,EAAiB;AACpB,iBAAOmR,wBAAwB,CAACjI,WAAD,EAAc,UAAUvxB,CAAV,EAAa;AAAE,mBAAO85B,2BAA2B,CAAC95B,CAAD,CAAlC;AAAwC,WAArE,EAAuE,UAAUy5B,QAAV,EAAoB;AAAE,mBAAOI,kBAAkB,CAACJ,QAAD,EAAWpR,KAAX,CAAzB;AAA6C,WAA1I,CAA/B;AACH,SAFD;AAGH;;AACD,aAAO,IAAP;AACH,KAlFD;;AAmFAgP,IAAAA,cAAc,CAACx5B,SAAf,CAAyBu8B,yBAAzB,GAAqD,UAAUtD,OAAV,EAAmBzuB,QAAnB,EAA6B;AAC9E,UAAI,CAAC,KAAK0vB,uBAAL,CAA6B1mB,GAA7B,CAAiCylB,OAAjC,CAAL,EAAgD;AAC5C,aAAKiB,uBAAL,CAA6B1lB,GAA7B,CAAiCykB,OAAjC,EAA0C,IAAI1vB,GAAJ,EAA1C;AACH;;AACD,UAAI8zB,SAAS,GAAG,KAAKnD,uBAAL,CAA6B/xB,GAA7B,CAAiC8wB,OAAjC,CAAhB;;AACA,UAAI,CAACoE,SAAS,CAAC7pB,GAAV,CAAchJ,QAAd,CAAL,EAA8B;AAC1B6yB,QAAAA,SAAS,CAAC5yB,GAAV,CAAcD,QAAd;AACH;AACJ,KARD;;AASAgvB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBy8B,kCAAzB,GAA8D,UAAUxD,OAAV,EAAmBzuB,QAAnB,EAA6B;AACvF,UAAI,KAAK0vB,uBAAL,CAA6B1mB,GAA7B,CAAiCylB,OAAjC,CAAJ,EAA+C;AAC3C,aAAKiB,uBAAL,CAA6B/xB,GAA7B,CAAiC8wB,OAAjC,EAA0C/mB,MAA1C,CAAiD1H,QAAjD;AACH;AACJ,KAJD;;AAKAgvB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBy6B,yBAAzB,GAAqD,UAAU6C,QAAV,EAAoB;AACrE,UAAI9N,KAAK,GAAG,IAAZ;;AACA8N,MAAAA,QAAQ,CAAClzB,OAAT,CAAiB,UAAUyL,KAAV,EAAiB;AAC9BD,QAAAA,eAAe,CAACC,KAAD,EAAQ,UAAUG,IAAV,EAAgB;AACnCA,UAAAA,IAAI,CAACkB,KAAL,IAAcD,sBAAsB,CAACjB,IAAI,CAACkB,KAAN,EAAa,UAAUC,QAAV,EAAoBzW,KAApB,EAA2B;AACxE,gBAAI68B,UAAU,CAACpmB,QAAD,CAAd,EAA0B;AACtBqY,cAAAA,KAAK,CAACgO,eAAN,CAAsBrmB,QAAtB,EAAgCzW,KAAhC;AACH;;AACD,gBAAI86B,cAAc,CAAC96B,KAAD,CAAlB,EAA2B;AACvB8uB,cAAAA,KAAK,CAACiO,mBAAN,CAA0BtmB,QAA1B,EAAoCzW,KAApC;AACH;AACJ,WAPmC,CAApC;AAQH,SATc,CAAf;AAUH,OAXD;AAYH,KAdD;;AAeA84B,IAAAA,cAAc,CAACx5B,SAAf,CAAyBw6B,oBAAzB,GAAgD,YAAY;AACxD,UAAIhL,KAAK,GAAG,IAAZ;;AACAvY,MAAAA,sBAAsB,CAACjQ,QAAQ,CAAC02B,eAAT,CAAyBxmB,KAA1B,EAAiC,UAAUC,QAAV,EAAoBzW,KAApB,EAA2B;AAC9E,YAAI68B,UAAU,CAACpmB,QAAD,CAAd,EAA0B;AACtBqY,UAAAA,KAAK,CAACgO,eAAN,CAAsBrmB,QAAtB,EAAgCzW,KAAhC;AACH;AACJ,OAJqB,CAAtB;AAKH,KAPD;;AAQA84B,IAAAA,cAAc,CAACx5B,SAAf,CAAyBw9B,eAAzB,GAA2C,UAAUvE,OAAV,EAAmBv4B,KAAnB,EAA0B;AACjE,WAAKy5B,iBAAL,CAAuB3lB,GAAvB,CAA2BykB,OAA3B,EAAoCv4B,KAApC;;AACA,UAAI86B,cAAc,CAAC96B,KAAD,CAAd,IAAyB+6B,qBAAqB,CAAC/6B,KAAD,CAAlD,EAA2D;AACvD,aAAKm5B,gBAAL,CAAsBpvB,GAAtB,CAA0BwuB,OAA1B;AACA,aAAKU,WAAL,CAAiBlvB,GAAjB,CAAqBwuB,OAArB;AACH;;AACD,UAAI,KAAKU,WAAL,CAAiBnmB,GAAjB,CAAqBylB,OAArB,CAAJ,EAAmC;AAC/B;AACH;;AACD,WAAKU,WAAL,CAAiBlvB,GAAjB,CAAqBwuB,OAArB;AACA,UAAInO,KAAK,GAAG0K,aAAa,CAAC90B,KAAD,CAAzB;;AACA,UAAIoqB,KAAJ,EAAW;AACP,aAAK+O,gBAAL,CAAsBpvB,GAAtB,CAA0BwuB,OAA1B;AACH,OAFD,MAGK,IAAIv4B,KAAK,CAACwF,QAAN,CAAe,MAAf,KACLxF,KAAK,CAACwF,QAAN,CAAe,kBAAf,CADK,IAELxF,KAAK,CAACwF,QAAN,CAAe,kBAAf,CAFC,EAEmC;AACpC,aAAK00B,mBAAL,CAAyB3B,OAAzB,EAAkCM,cAAlC;AACH;AACJ,KAnBD;;AAoBAC,IAAAA,cAAc,CAACx5B,SAAf,CAAyB46B,mBAAzB,GAA+C,UAAU3B,OAAV,EAAmBoB,OAAnB,EAA4B;AACvE,UAAIsD,WAAW,GAAG,KAAK3D,eAAL,CAAqB7xB,GAArB,CAAyB8wB,OAAzB,KAAqC,CAAvD;AACA,UAAI2E,WAAW,GAAG,KAAKnE,QAAL,CAActxB,GAAd,CAAkB8wB,OAAlB,KAA8B,CAAhD;AACA,UAAI4E,OAAO,GAAGD,WAAW,GAAGvD,OAA5B;AACA,WAAKZ,QAAL,CAAcjlB,GAAd,CAAkBykB,OAAlB,EAA2B4E,OAA3B;;AACA,UAAIA,OAAO,KAAKF,WAAZ,IAA2B,KAAK5D,aAAL,CAAmBvmB,GAAnB,CAAuBylB,OAAvB,CAA/B,EAAgE;AAC5D,aAAKgB,eAAL,CAAqBxvB,GAArB,CAAyBwuB,OAAzB;AACA,aAAKc,aAAL,CAAmB7nB,MAAnB,CAA0B+mB,OAA1B;AACH;;AACD,WAAKY,gBAAL,CAAsB3nB,MAAtB,CAA6B+mB,OAA7B;AACA,WAAKa,aAAL,CAAmB5nB,MAAnB,CAA0B+mB,OAA1B;AACH,KAXD;;AAYAO,IAAAA,cAAc,CAACx5B,SAAf,CAAyB06B,wBAAzB,GAAoD,YAAY;AAC5D,UAAIlL,KAAK,GAAG,IAAZ;;AACAvY,MAAAA,sBAAsB,CAACjQ,QAAQ,CAAC02B,eAAT,CAAyBxmB,KAA1B,EAAiC,UAAUC,QAAV,EAAoBzW,KAApB,EAA2B;AAC9E,YAAI86B,cAAc,CAAC96B,KAAD,CAAlB,EAA2B;AACvB8uB,UAAAA,KAAK,CAACiO,mBAAN,CAA0BtmB,QAA1B,EAAoCzW,KAApC;AACH;AACJ,OAJqB,CAAtB;AAKH,KAPD;;AAQA84B,IAAAA,cAAc,CAACx5B,SAAf,CAAyBy9B,mBAAzB,GAA+C,UAAUtmB,QAAV,EAAoBzW,KAApB,EAA2B;AACtE,UAAI8uB,KAAK,GAAG,IAAZ;;AACA,UAAI+N,UAAU,CAACpmB,QAAD,CAAd,EAA0B;AACtB,aAAK2mB,cAAL,CAAoBp9B,KAApB,EAA2B,UAAUq6B,GAAV,EAAe;AACtC,cAAI,CAACvL,KAAK,CAACoK,OAAN,CAAcpmB,GAAd,CAAkB2D,QAAlB,CAAL,EAAkC;AAC9BqY,YAAAA,KAAK,CAACoK,OAAN,CAAcplB,GAAd,CAAkB2C,QAAlB,EAA4B,IAAI5N,GAAJ,EAA5B;AACH;;AACDimB,UAAAA,KAAK,CAACoK,OAAN,CAAczxB,GAAd,CAAkBgP,QAAlB,EAA4B1M,GAA5B,CAAgCswB,GAAhC;AACH,SALD;AAMH,OAPD,MAQK,IAAI5jB,QAAQ,KAAK,kBAAb,IAAmCA,QAAQ,KAAK,YAApD,EAAkE;AACnE,aAAK2mB,cAAL,CAAoBp9B,KAApB,EAA2B,UAAUyB,CAAV,EAAa;AAAE,iBAAOqtB,KAAK,CAACoL,mBAAN,CAA0Bz4B,CAA1B,EAA6Bi3B,gBAA7B,CAAP;AAAwD,SAAlG;AACH,OAFI,MAGA,IAAIjiB,QAAQ,KAAK,OAAb,IAAwBA,QAAQ,KAAK,aAAzC,EAAwD;AACzD,aAAK2mB,cAAL,CAAoBp9B,KAApB,EAA2B,UAAUyB,CAAV,EAAa;AAAE,iBAAOqtB,KAAK,CAACoL,mBAAN,CAA0Bz4B,CAA1B,EAA6Bk3B,kBAA7B,CAAP;AAA0D,SAApG;AACH,OAFI,MAGA,IAAIliB,QAAQ,CAAC5Q,UAAT,CAAoB,QAApB,KAAiC4Q,QAAQ,CAAC5Q,UAAT,CAAoB,SAApB,CAArC,EAAqE;AACtE,aAAKu3B,cAAL,CAAoBp9B,KAApB,EAA2B,UAAUyB,CAAV,EAAa;AAAE,iBAAOqtB,KAAK,CAACoL,mBAAN,CAA0Bz4B,CAA1B,EAA6Bm3B,oBAA7B,CAAP;AAA4D,SAAtG;AACH,OAFI,MAGA,IAAIniB,QAAQ,KAAK,YAAb,IAA6BA,QAAQ,KAAK,kBAA9C,EAAkE;AACnE,aAAK2mB,cAAL,CAAoBp9B,KAApB,EAA2B,UAAUyB,CAAV,EAAa;AACpC,cAAIqtB,KAAK,CAAC4K,SAAN,CAAgBj4B,CAAhB,EAAmBi3B,gBAAgB,GAAGG,cAAtC,CAAJ,EAA2D;AACvD;AACH;;AACD,cAAIwE,SAAS,GAAGvO,KAAK,CAACsL,UAAN,CAAiB34B,CAAjB,EAAoB,UAAU44B,GAAV,EAAe;AAC/C,mBAAQvL,KAAK,CAACqK,gBAAN,CAAuBrmB,GAAvB,CAA2BunB,GAA3B,KACJvL,KAAK,CAAC4K,SAAN,CAAgBW,GAAhB,EAAqB1B,kBAAkB,GAAGC,oBAA1C,CADJ;AAEH,WAHe,KAGV,IAHN;;AAIA9J,UAAAA,KAAK,CAACwL,cAAN,CAAqB74B,CAArB,EAAwB,UAAU44B,GAAV,EAAe;AACnC,gBAAIgD,SAAJ,EAAe;AACXvO,cAAAA,KAAK,CAACoL,mBAAN,CAA0BG,GAA1B,EAA+B3B,gBAA/B;AACH,aAFD,MAGK;AACD5J,cAAAA,KAAK,CAACsK,aAAN,CAAoBrvB,GAApB,CAAwBswB,GAAxB;AACH;AACJ,WAPD;AAQH,SAhBD;AAiBH;AACJ,KAtCD;;AAuCAvB,IAAAA,cAAc,CAACx5B,SAAf,CAAyB89B,cAAzB,GAA0C,UAAUp9B,KAAV,EAAiBwB,QAAjB,EAA2B;AACjE,UAAI87B,OAAO,GAAG,IAAIz0B,GAAJ,EAAd;AACA00B,MAAAA,sBAAsB,CAACv9B,KAAD,EAAQ,UAAUyB,CAAV,EAAa;AAAE,eAAO67B,OAAO,CAACvzB,GAAR,CAAYtI,CAAZ,CAAP;AAAwB,OAA/C,CAAtB;AACA67B,MAAAA,OAAO,CAAC5zB,OAAR,CAAgB,UAAUjI,CAAV,EAAa;AAAE,eAAOD,QAAQ,CAACC,CAAD,CAAf;AAAqB,OAApD;AACH,KAJD;;AAKAq3B,IAAAA,cAAc,CAACx5B,SAAf,CAAyB86B,UAAzB,GAAsC,UAAU7B,OAAV,EAAmB/2B,QAAnB,EAA6Bg8B,KAA7B,EAAoC;AACtE,UAAIvxB,GAAJ,EAAS/E,EAAT;;AACA,UAAIs2B,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,QAAAA,KAAK,GAAG,IAAI30B,GAAJ,EAAR;AAAoB;;AAC5C,UAAI20B,KAAK,CAAC1qB,GAAN,CAAUylB,OAAV,CAAJ,EAAwB;AACpB,eAAO,IAAP;AACH;;AACDiF,MAAAA,KAAK,CAACzzB,GAAN,CAAUwuB,OAAV;AACA,UAAI93B,MAAM,GAAGe,QAAQ,CAAC+2B,OAAD,CAArB;;AACA,UAAI93B,MAAJ,EAAY;AACR,eAAO83B,OAAP;AACH;;AACD,UAAI0B,IAAI,GAAG,KAAKf,OAAL,CAAazxB,GAAb,CAAiB8wB,OAAjB,CAAX;;AACA,UAAI,CAAC0B,IAAD,IAASA,IAAI,CAAClmB,IAAL,KAAc,CAA3B,EAA8B;AAC1B,eAAO,IAAP;AACH;;AACD,UAAI;AACA,aAAK,IAAI0pB,MAAM,GAAG37B,QAAQ,CAACm4B,IAAD,CAArB,EAA6ByD,QAAQ,GAAGD,MAAM,CAACn9B,IAAP,EAA7C,EAA4D,CAACo9B,QAAQ,CAACh9B,IAAtE,EAA4Eg9B,QAAQ,GAAGD,MAAM,CAACn9B,IAAP,EAAvF,EAAsG;AAClG,cAAI+5B,GAAG,GAAGqD,QAAQ,CAAC19B,KAAnB;AACA,cAAI29B,KAAK,GAAG,KAAKvD,UAAL,CAAgBC,GAAhB,EAAqB74B,QAArB,EAA+Bg8B,KAA/B,CAAZ;;AACA,cAAIG,KAAJ,EAAW;AACP,mBAAOA,KAAP;AACH;AACJ;AACJ,OARD,CASA,OAAOrxB,KAAP,EAAc;AAAEL,QAAAA,GAAG,GAAG;AAAE7J,UAAAA,KAAK,EAAEkK;AAAT,SAAN;AAAyB,OATzC,SAUQ;AACJ,YAAI;AACA,cAAIoxB,QAAQ,IAAI,CAACA,QAAQ,CAACh9B,IAAtB,KAA+BwG,EAAE,GAAGu2B,MAAM,CAAClxB,MAA3C,CAAJ,EAAwDrF,EAAE,CAAC1H,IAAH,CAAQi+B,MAAR;AAC3D,SAFD,SAGQ;AAAE,cAAIxxB,GAAJ,EAAS,MAAMA,GAAG,CAAC7J,KAAV;AAAkB;AACxC;;AACD,aAAO,IAAP;AACH,KAhCD;;AAiCA02B,IAAAA,cAAc,CAACx5B,SAAf,CAAyBg7B,cAAzB,GAA0C,UAAU/B,OAAV,EAAmB/2B,QAAnB,EAA6B;AACnE,WAAK44B,UAAL,CAAgB7B,OAAhB,EAAyB,UAAU8B,GAAV,EAAe;AACpC74B,QAAAA,QAAQ,CAAC64B,GAAD,CAAR;AACA,eAAO,KAAP;AACH,OAHD;AAIH,KALD;;AAMAvB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBs+B,uBAAzB,GAAmD,UAAU9zB,QAAV,EAAoB;AACnE,WAAK+zB,qBAAL,GAA6B/zB,QAA7B;AACH,KAFD;;AAGAgvB,IAAAA,cAAc,CAACx5B,SAAf,CAAyBw+B,WAAzB,GAAuC,UAAUC,YAAV,EAAwBjU,KAAxB,EAA+B;AAClE,UAAIkU,GAAJ,EAAS92B,EAAT;;AACA,UAAI4nB,KAAK,GAAG,IAAZ;;AACA,UAAImP,KAAK,GAAGF,YAAY,CAACE,KAAzB;;AACA,UAAIA,KAAK,CAACxoB,QAAN,CAAerW,MAAf,GAAwB,CAA5B,EAA+B;AAC3B6+B,QAAAA,KAAK,CAACC,UAAN,CAAiB,CAAjB;AACH;;AACD,UAAIzD,YAAY,GAAG,IAAIxnB,GAAJ,EAAnB;AACAsD,MAAAA,sBAAsB,CAACjQ,QAAQ,CAAC02B,eAAT,CAAyBxmB,KAA1B,EAAiC,UAAUC,QAAV,EAAoBzW,KAApB,EAA2B;AAC9E,YAAI68B,UAAU,CAACpmB,QAAD,CAAd,EAA0B;AACtB,cAAIqY,KAAK,CAAC4K,SAAN,CAAgBjjB,QAAhB,EAA0BiiB,gBAA1B,CAAJ,EAAiD;AAC7C+B,YAAAA,YAAY,CAAC3mB,GAAb,CAAiBqnB,uBAAuB,CAAC1kB,QAAD,CAAxC,EAAoD2kB,gBAAgB,CAACp7B,KAAD,EAAQ8pB,KAAR,CAApE;AACH;;AACD,cAAIgF,KAAK,CAAC4K,SAAN,CAAgBjjB,QAAhB,EAA0BkiB,kBAA1B,CAAJ,EAAmD;AAC/C8B,YAAAA,YAAY,CAAC3mB,GAAb,CAAiBunB,yBAAyB,CAAC5kB,QAAD,CAA1C,EAAsD6kB,kBAAkB,CAACt7B,KAAD,EAAQ8pB,KAAR,CAAxE;AACH;;AACD,cAAIgF,KAAK,CAAC4K,SAAN,CAAgBjjB,QAAhB,EAA0BmiB,oBAA1B,CAAJ,EAAqD;AACjD6B,YAAAA,YAAY,CAAC3mB,GAAb,CAAiBynB,2BAA2B,CAAC9kB,QAAD,CAA5C,EAAwD+kB,oBAAoB,CAACx7B,KAAD,EAAQ8pB,KAAR,CAA5E;AACH;;AACDgF,UAAAA,KAAK,CAAC+M,yBAAN,CAAgCplB,QAAhC,EAA0CqY,KAAK,CAAC+O,qBAAhD;AACH;AACJ,OAbqB,CAAtB;AAcA,UAAIM,QAAQ,GAAG,EAAf;AACAA,MAAAA,QAAQ,CAACt8B,IAAT,CAAc,SAAd;;AACA,UAAI;AACA,aAAK,IAAIu8B,cAAc,GAAGt8B,QAAQ,CAAC24B,YAAD,CAA7B,EAA6C4D,gBAAgB,GAAGD,cAAc,CAAC99B,IAAf,EAArE,EAA4F,CAAC+9B,gBAAgB,CAAC39B,IAA9G,EAAoH29B,gBAAgB,GAAGD,cAAc,CAAC99B,IAAf,EAAvI,EAA8J;AAC1J,cAAI+I,EAAE,GAAGpH,MAAM,CAACo8B,gBAAgB,CAACr+B,KAAlB,EAAyB,CAAzB,CAAf;AAAA,cAA4CyW,QAAQ,GAAGpN,EAAE,CAAC,CAAD,CAAzD;AAAA,cAA8DrJ,KAAK,GAAGqJ,EAAE,CAAC,CAAD,CAAxE;;AACA80B,UAAAA,QAAQ,CAACt8B,IAAT,CAAc,SAAS4U,QAAT,GAAoB,IAApB,GAA2BzW,KAA3B,GAAmC,GAAjD;AACH;AACJ,OALD,CAMA,OAAOs+B,KAAP,EAAc;AAAEN,QAAAA,GAAG,GAAG;AAAE57B,UAAAA,KAAK,EAAEk8B;AAAT,SAAN;AAAyB,OANzC,SAOQ;AACJ,YAAI;AACA,cAAID,gBAAgB,IAAI,CAACA,gBAAgB,CAAC39B,IAAtC,KAA+CwG,EAAE,GAAGk3B,cAAc,CAAC7xB,MAAnE,CAAJ,EAAgFrF,EAAE,CAAC1H,IAAH,CAAQ4+B,cAAR;AACnF,SAFD,SAGQ;AAAE,cAAIJ,GAAJ,EAAS,MAAMA,GAAG,CAAC57B,KAAV;AAAkB;AACxC;;AACD+7B,MAAAA,QAAQ,CAACt8B,IAAT,CAAc,GAAd;AACA,UAAI+U,OAAO,GAAGunB,QAAQ,CAAC51B,IAAT,CAAc,IAAd,CAAd;AACA01B,MAAAA,KAAK,CAACM,UAAN,CAAiB3nB,OAAjB;AACH,KAxCD;;AAyCA,WAAOkiB,cAAP;AACH,GAhcqB,EAAtB;;AAicA,MAAIpG,cAAc,GAAG,IAAIoG,cAAJ,EAArB;;AACA,WAAS0F,gBAAT,CAA0BtW,KAA1B,EAAiCuW,WAAjC,EAA8C;AAC1C,QAAIA,WAAW,KAAK,KAAK,CAAzB,EAA4B;AAAEA,MAAAA,WAAW,GAAG,CAAd;AAAkB;;AAChD,QAAIvvB,KAAK,GAAGgZ,KAAK,CAAC/O,OAAN,CAAc,MAAd,EAAsBslB,WAAtB,CAAZ;;AACA,QAAIvvB,KAAK,IAAI,CAAb,EAAgB;AACZ,UAAI8L,KAAK,GAAGgO,mBAAmB,CAACd,KAAD,EAAQhZ,KAAK,GAAG,CAAhB,CAA/B;;AACA,UAAI8L,KAAJ,EAAW;AACP,eAAO;AAAE9L,UAAAA,KAAK,EAAEA,KAAT;AAAgBma,UAAAA,GAAG,EAAErO,KAAK,CAACqO;AAA3B,SAAP;AACH;;AACD,aAAO,IAAP;AACH;AACJ;;AACD,WAASqV,mBAAT,CAA6BxW,KAA7B,EAAoC;AAChC,QAAIyW,MAAM,GAAG,EAAb;AACA,QAAI1/B,CAAC,GAAG,CAAR;AACA,QAAI+b,KAAJ;;AACA,WAAQA,KAAK,GAAGwjB,gBAAgB,CAACtW,KAAD,EAAQjpB,CAAR,CAAhC,EAA6C;AACzC,UAAIiQ,KAAK,GAAG8L,KAAK,CAAC9L,KAAlB;AAAA,UAAyBma,GAAG,GAAGrO,KAAK,CAACqO,GAArC;AACAsV,MAAAA,MAAM,CAAC98B,IAAP,CAAY;AAAEqN,QAAAA,KAAK,EAAEA,KAAT;AAAgBma,QAAAA,GAAG,EAAEA,GAArB;AAA0BrpB,QAAAA,KAAK,EAAEkoB,KAAK,CAAC5O,SAAN,CAAgBpK,KAAhB,EAAuBma,GAAvB;AAAjC,OAAZ;AACApqB,MAAAA,CAAC,GAAG+b,KAAK,CAACqO,GAAN,GAAY,CAAhB;AACH;;AACD,WAAOsV,MAAP;AACH;;AACD,WAASC,uBAAT,CAAiC1W,KAAjC,EAAwC2W,QAAxC,EAAkD;AAC9C,QAAIzW,OAAO,GAAGsW,mBAAmB,CAACxW,KAAD,CAAjC;AACA,QAAI4W,YAAY,GAAG1W,OAAO,CAAChpB,MAA3B;;AACA,QAAI0/B,YAAY,KAAK,CAArB,EAAwB;AACpB,aAAO5W,KAAP;AACH;;AACD,QAAI6W,WAAW,GAAG7W,KAAK,CAAC9oB,MAAxB;AACA,QAAI4/B,YAAY,GAAG5W,OAAO,CAACjS,GAAR,CAAY,UAAUnU,CAAV,EAAa;AAAE,aAAO68B,QAAQ,CAAC78B,CAAC,CAAChC,KAAH,CAAf;AAA2B,KAAtD,CAAnB;AACA,QAAIo2B,KAAK,GAAG,EAAZ;AACAA,IAAAA,KAAK,CAACv0B,IAAN,CAAWqmB,KAAK,CAAC5O,SAAN,CAAgB,CAAhB,EAAmB8O,OAAO,CAAC,CAAD,CAAP,CAAWlZ,KAA9B,CAAX;;AACA,SAAK,IAAIjQ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6/B,YAApB,EAAkC7/B,CAAC,EAAnC,EAAuC;AACnCm3B,MAAAA,KAAK,CAACv0B,IAAN,CAAWm9B,YAAY,CAAC//B,CAAD,CAAvB;AACA,UAAIiQ,KAAK,GAAGkZ,OAAO,CAACnpB,CAAD,CAAP,CAAWoqB,GAAvB;AACA,UAAIA,GAAG,GAAGpqB,CAAC,GAAG6/B,YAAY,GAAG,CAAnB,GAAuB1W,OAAO,CAACnpB,CAAC,GAAG,CAAL,CAAP,CAAeiQ,KAAtC,GAA8C6vB,WAAxD;AACA3I,MAAAA,KAAK,CAACv0B,IAAN,CAAWqmB,KAAK,CAAC5O,SAAN,CAAgBpK,KAAhB,EAAuBma,GAAvB,CAAX;AACH;;AACD,WAAO+M,KAAK,CAAC7tB,IAAN,CAAW,EAAX,CAAP;AACH;;AACD,WAAS02B,0BAAT,CAAoC74B,KAApC,EAA2C;AACvC,QAAI84B,UAAU,GAAG94B,KAAK,CAAC+S,OAAN,CAAc,GAAd,CAAjB;AACA,QAAIgmB,IAAJ;AACA,QAAIjE,QAAJ;;AACA,QAAIgE,UAAU,IAAI,CAAlB,EAAqB;AACjBC,MAAAA,IAAI,GAAG/4B,KAAK,CAACkT,SAAN,CAAgB,CAAhB,EAAmB4lB,UAAnB,EAA+BvoB,IAA/B,EAAP;AACAukB,MAAAA,QAAQ,GAAG90B,KAAK,CAACkT,SAAN,CAAgB4lB,UAAU,GAAG,CAA7B,EAAgC94B,KAAK,CAAChH,MAAN,GAAe,CAA/C,EAAkDuX,IAAlD,EAAX;AACH,KAHD,MAIK;AACDwoB,MAAAA,IAAI,GAAG/4B,KAAK,CAACkT,SAAN,CAAgB,CAAhB,EAAmBlT,KAAK,CAAChH,MAAN,GAAe,CAAlC,EAAqCuX,IAArC,EAAP;AACAukB,MAAAA,QAAQ,GAAG,EAAX;AACH;;AACD,WAAO;AAAEiE,MAAAA,IAAI,EAAEA,IAAR;AAAcjE,MAAAA,QAAQ,EAAEA;AAAxB,KAAP;AACH;;AACD,WAASD,wBAAT,CAAkCj7B,KAAlC,EAAyCo/B,YAAzC,EAAuDC,gBAAvD,EAAyE;AACrE,QAAIC,aAAa,GAAG,UAAUl5B,KAAV,EAAiB;AACjC,UAAIc,EAAE,GAAG+3B,0BAA0B,CAAC74B,KAAD,CAAnC;AAAA,UAA4C+4B,IAAI,GAAGj4B,EAAE,CAACi4B,IAAtD;AAAA,UAA4DjE,QAAQ,GAAGh0B,EAAE,CAACg0B,QAA1E;;AACA,UAAIqE,OAAO,GAAGH,YAAY,CAACD,IAAD,CAA1B;;AACA,UAAI,CAACjE,QAAL,EAAe;AACX,eAAO,SAASqE,OAAT,GAAmB,GAA1B;AACH;;AACD,UAAIC,WAAJ;;AACA,UAAI1E,cAAc,CAACI,QAAD,CAAlB,EAA8B;AAC1BsE,QAAAA,WAAW,GAAGvE,wBAAwB,CAACC,QAAD,EAAWkE,YAAX,EAAyBC,gBAAzB,CAAtC;AACH,OAFD,MAGK,IAAIA,gBAAJ,EAAsB;AACvBG,QAAAA,WAAW,GAAGH,gBAAgB,CAACnE,QAAD,CAA9B;AACH,OAFI,MAGA;AACDsE,QAAAA,WAAW,GAAGtE,QAAd;AACH;;AACD,aAAO,SAASqE,OAAT,GAAmB,IAAnB,GAA0BC,WAA1B,GAAwC,GAA/C;AACH,KAjBD;;AAkBA,WAAOZ,uBAAuB,CAAC5+B,KAAD,EAAQs/B,aAAR,CAA9B;AACH;;AACD,WAAS/B,sBAAT,CAAgCv9B,KAAhC,EAAuCwB,QAAvC,EAAiD;AAC7Cy5B,IAAAA,wBAAwB,CAACj7B,KAAD,EAAQ,UAAUu4B,OAAV,EAAmB;AAC/C/2B,MAAAA,QAAQ,CAAC+2B,OAAD,CAAR;AACA,aAAOA,OAAP;AACH,KAHuB,CAAxB;AAIH;;AACD,WAAS4C,uBAAT,CAAiCgE,IAAjC,EAAuC;AACnC,WAAO,oBAAoBA,IAA3B;AACH;;AACD,WAAS9D,yBAAT,CAAmC8D,IAAnC,EAAyC;AACrC,WAAO,sBAAsBA,IAA7B;AACH;;AACD,WAAS5D,2BAAT,CAAqC4D,IAArC,EAA2C;AACvC,WAAO,wBAAwBA,IAA/B;AACH;;AACD,WAAS1D,qBAAT,CAA+B0D,IAA/B,EAAqC;AACjC,WAAO,uBAAuBA,IAA9B;AACH;;AACD,WAAStC,UAAT,CAAoBpmB,QAApB,EAA8B;AAC1B,WAAOA,QAAQ,CAAC5Q,UAAT,CAAoB,IAApB,CAAP;AACH;;AACD,WAASi1B,cAAT,CAAwB96B,KAAxB,EAA+B;AAC3B,WAAOA,KAAK,CAACwF,QAAN,CAAe,MAAf,CAAP;AACH;;AACD,WAASu1B,qBAAT,CAA+B/6B,KAA/B,EAAsC;AAClC,WAAOA,KAAK,CAACoG,KAAN,CAAY,mBAAZ,CAAP;AACH;;AACD,WAASg1B,gBAAT,CAA0BhR,KAA1B,EAAiCN,KAAjC,EAAwC;AACpC,QAAItQ,GAAG,GAAGsb,aAAa,CAAC1K,KAAD,CAAvB;AACA,WAAO5Q,GAAG,GAAGgT,qBAAqB,CAAChT,GAAD,EAAMsQ,KAAN,CAAxB,GAAuCM,KAAjD;AACH;;AACD,WAASkR,kBAAT,CAA4BlR,KAA5B,EAAmCN,KAAnC,EAA0C;AACtC,QAAItQ,GAAG,GAAGsb,aAAa,CAAC1K,KAAD,CAAvB;AACA,WAAO5Q,GAAG,GAAG2T,qBAAqB,CAAC3T,GAAD,EAAMsQ,KAAN,CAAxB,GAAuCM,KAAjD;AACH;;AACD,WAASoR,oBAAT,CAA8BpR,KAA9B,EAAqCN,KAArC,EAA4C;AACxC,QAAItQ,GAAG,GAAGsb,aAAa,CAAC1K,KAAD,CAAvB;AACA,WAAO5Q,GAAG,GAAG6T,iBAAiB,CAAC7T,GAAD,EAAMsQ,KAAN,CAApB,GAAmCM,KAA7C;AACH;;AACD,WAAS4Q,eAAT,CAAyByE,MAAzB,EAAiCC,SAAjC,EAA4ClC,KAA5C,EAAmD;AAC/C,QAAIA,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,MAAAA,KAAK,GAAG,IAAI30B,GAAJ,EAAR;AAAoB;;AAC5C,QAAI82B,qBAAqB,GAAG,KAA5B;;AACA,QAAIL,aAAa,GAAG,UAAUl5B,KAAV,EAAiB;AACjC,UAAIc,EAAE,GAAG+3B,0BAA0B,CAAC74B,KAAD,CAAnC;AAAA,UAA4C+4B,IAAI,GAAGj4B,EAAE,CAACi4B,IAAtD;AAAA,UAA4DjE,QAAQ,GAAGh0B,EAAE,CAACg0B,QAA1E;;AACA,UAAIsC,KAAK,CAAC1qB,GAAN,CAAUqsB,IAAV,CAAJ,EAAqB;AACjBQ,QAAAA,qBAAqB,GAAG,IAAxB;AACA,eAAO,IAAP;AACH;;AACDnC,MAAAA,KAAK,CAACzzB,GAAN,CAAUo1B,IAAV;AACA,UAAIS,QAAQ,GAAGF,SAAS,CAACj4B,GAAV,CAAc03B,IAAd,KAAuBjE,QAAtC;AACA,UAAIwB,QAAQ,GAAG,IAAf;;AACA,UAAIkD,QAAJ,EAAc;AACV,YAAI9E,cAAc,CAAC8E,QAAD,CAAlB,EAA8B;AAC1BlD,UAAAA,QAAQ,GAAG1B,eAAe,CAAC4E,QAAD,EAAWF,SAAX,EAAsBlC,KAAtB,CAA1B;AACH,SAFD,MAGK;AACDd,UAAAA,QAAQ,GAAGkD,QAAX;AACH;AACJ;;AACD,UAAI,CAAClD,QAAL,EAAe;AACXiD,QAAAA,qBAAqB,GAAG,IAAxB;AACA,eAAO,IAAP;AACH;;AACD,aAAOjD,QAAP;AACH,KAtBD;;AAuBA,QAAImD,QAAQ,GAAGjB,uBAAuB,CAACa,MAAD,EAASH,aAAT,CAAtC;;AACA,QAAIK,qBAAJ,EAA2B;AACvB,aAAO,IAAP;AACH;;AACD,WAAOE,QAAP;AACH;;AAED,MAAIC,SAAS,GAAG;AACZ,wBAAoB;AAChBC,MAAAA,UAAU,EAAE,6BADI;AAEhBC,MAAAA,OAAO,EAAE,kBAFO;AAGhBC,MAAAA,QAAQ,EAAE;AAHM,KADR;AAMZ,wBAAoB;AAChBF,MAAAA,UAAU,EAAE,6BADI;AAEhBC,MAAAA,OAAO,EAAE,kBAFO;AAGhBC,MAAAA,QAAQ,EAAE;AAHM,KANR;AAWZ,oBAAgB;AACZF,MAAAA,UAAU,EAAE,4BADA;AAEZC,MAAAA,OAAO,EAAE,cAFG;AAGZC,MAAAA,QAAQ,EAAE;AAHE,KAXJ;AAgBZ,2BAAuB;AACnBF,MAAAA,UAAU,EAAE,mCADO;AAEnBC,MAAAA,OAAO,EAAE,qBAFU;AAGnBC,MAAAA,QAAQ,EAAE;AAHS,KAhBX;AAqBZ,yBAAqB;AACjBF,MAAAA,UAAU,EAAE,iCADK;AAEjBC,MAAAA,OAAO,EAAE,mBAFQ;AAGjBC,MAAAA,QAAQ,EAAE;AAHO,KArBT;AA0BZ,0BAAsB;AAClBF,MAAAA,UAAU,EAAE,kCADM;AAElBC,MAAAA,OAAO,EAAE,oBAFS;AAGlBC,MAAAA,QAAQ,EAAE;AAHQ,KA1BV;AA+BZ,wBAAoB;AAChBF,MAAAA,UAAU,EAAE,gCADI;AAEhBC,MAAAA,OAAO,EAAE,kBAFO;AAGhBC,MAAAA,QAAQ,EAAE;AAHM,KA/BR;AAoCZ,kBAAc;AACVF,MAAAA,UAAU,EAAE,+BADF;AAEVC,MAAAA,OAAO,EAAE,YAFC;AAGVC,MAAAA,QAAQ,EAAE;AAHA,KApCF;AAyCZ,aAAS;AACLF,MAAAA,UAAU,EAAE,2BADP;AAELC,MAAAA,OAAO,EAAE,OAFJ;AAGLC,MAAAA,QAAQ,EAAE;AAHL,KAzCG;AA8CZ,YAAQ;AACJF,MAAAA,UAAU,EAAE,0BADR;AAEJC,MAAAA,OAAO,EAAE,MAFL;AAGJC,MAAAA,QAAQ,EAAE;AAHN,KA9CI;AAmDZ,cAAU;AACNF,MAAAA,UAAU,EAAE,4BADN;AAENC,MAAAA,OAAO,EAAE,QAFH;AAGNC,MAAAA,QAAQ,EAAE;AAHJ,KAnDE;AAwDZ,qBAAiB;AACbF,MAAAA,UAAU,EAAE,6BADC;AAEbC,MAAAA,OAAO,EAAE,eAFI;AAGbC,MAAAA,QAAQ,EAAE;AAHG,KAxDL;AA6DZ,kBAAc;AACVF,MAAAA,UAAU,EAAE,+BADF;AAEVC,MAAAA,OAAO,EAAE,YAFC;AAGVC,MAAAA,QAAQ,EAAE;AAHA;AA7DF,GAAhB;AAmEA,MAAIC,aAAa,GAAGrhC,MAAM,CAACy9B,MAAP,CAAcwD,SAAd,CAApB;AACA,MAAIK,kBAAkB,GAAG,EAAzB;AACAD,EAAAA,aAAa,CAACx2B,OAAd,CAAsB,UAAUxC,EAAV,EAAc;AAChC,QAAI84B,OAAO,GAAG94B,EAAE,CAAC84B,OAAjB;AAAA,QAA0BD,UAAU,GAAG74B,EAAE,CAAC64B,UAA1C;AACA,WAAOI,kBAAkB,CAACJ,UAAD,CAAlB,GAAiCC,OAAxC;AACH,GAHD;AAIA,MAAII,kBAAkB,GAAG,CAAC,OAAD,EAAU,MAAV,EAAkB,YAAlB,EAAgC,QAAhC,EAA0C,SAA1C,EAAqD,OAArD,CAAzB;AACA,MAAIC,qBAAqB,GAAGD,kBAAkB,CAACjqB,GAAnB,CAAuB,UAAUmqB,IAAV,EAAgB;AAAE,WAAO,MAAMA,IAAN,GAAa,GAApB;AAA0B,GAAnE,EAAqE/3B,IAArE,CAA0E,IAA1E,CAA5B;;AACA,WAASg4B,sBAAT,GAAkC;AAC9B,WAAOL,aAAa,CAAC/pB,GAAd,CAAkB,UAAUjP,EAAV,EAAc;AACnC,UAAI+4B,QAAQ,GAAG/4B,EAAE,CAAC+4B,QAAlB;AAAA,UAA4BF,UAAU,GAAG74B,EAAE,CAAC64B,UAA5C;AAAA,UAAwDC,OAAO,GAAG94B,EAAE,CAAC84B,OAArE;AACA,aAAO,CACH,MAAMC,QAAN,GAAiB,KADd,EAEH,OAAOD,OAAP,GAAiB,QAAjB,GAA4BD,UAA5B,GAAyC,eAFtC,EAGH,GAHG,EAILx3B,IAJK,CAIA,IAJA,CAAP;AAKH,KAPM,EAOJA,IAPI,CAOC,IAPD,CAAP;AAQH;;AACD,WAASi4B,sBAAT,CAAgCjwB,IAAhC,EAAsC;AAClC,QAAI3D,OAAO,GAAG,EAAd;;AACA,QAAI2D,IAAI,YAAYkC,OAAhB,IAA2BlC,IAAI,CAAC6X,OAAL,CAAaiY,qBAAb,CAA/B,EAAoE;AAChEzzB,MAAAA,OAAO,CAAC/K,IAAR,CAAa0O,IAAb;AACH;;AACD,QAAIA,IAAI,YAAYkC,OAAhB,IAA4B1M,oBAAoB,IAAIwK,IAAI,YAAYvK,UAApE,IAAmFuK,IAAI,YAAYkwB,QAAvG,EAAiH;AAC7G5+B,MAAAA,IAAI,CAAC+K,OAAD,EAAU2D,IAAI,CAACmwB,gBAAL,CAAsBL,qBAAtB,CAAV,CAAJ;AACH;;AACD,WAAOzzB,OAAP;AACH;;AACD,MAAI+zB,aAAa,GAAG,IAAI1tB,GAAJ,EAApB;AACA,MAAI2tB,aAAa,GAAG,IAAI3tB,GAAJ,EAApB;;AACA,WAAS4tB,oBAAT,CAA8BC,qBAA9B,EAAqDC,oBAArD,EAA2E;AACvEC,IAAAA,wBAAwB,CAAC16B,QAAD,EAAWw6B,qBAAX,EAAkCC,oBAAlC,CAAxB;AACAzwB,IAAAA,kBAAkB,CAAChK,QAAQ,CAAC02B,eAAV,EAA2B,UAAUiE,IAAV,EAAgB;AACzDD,MAAAA,wBAAwB,CAACC,IAAI,CAACpwB,UAAN,EAAkBiwB,qBAAlB,EAAyCC,oBAAzC,CAAxB;AACH,KAFiB,CAAlB;AAGH;;AACD,WAASC,wBAAT,CAAkCzwB,IAAlC,EAAwCuwB,qBAAxC,EAA+DC,oBAA/D,EAAqF;AACjF,QAAIJ,aAAa,CAAC7tB,GAAd,CAAkBvC,IAAlB,CAAJ,EAA6B;AACzBowB,MAAAA,aAAa,CAACl5B,GAAd,CAAkB8I,IAAlB,EAAwBH,UAAxB;AACAwwB,MAAAA,aAAa,CAACn5B,GAAd,CAAkB8I,IAAlB,EAAwBH,UAAxB;AACH;;AACD,QAAI8wB,eAAe,GAAG,IAAIC,OAAJ,EAAtB;;AACA,aAASC,aAAT,CAAuB/yB,IAAvB,EAA6B;AACzBmyB,MAAAA,sBAAsB,CAACnyB,IAAD,CAAtB,CAA6B3E,OAA7B,CAAqC,UAAU23B,EAAV,EAAc;AAC/C,YAAIH,eAAe,CAACpuB,GAAhB,CAAoBuuB,EAApB,CAAJ,EAA6B;AACzB;AACH;;AACDH,QAAAA,eAAe,CAACn3B,GAAhB,CAAoBs3B,EAApB;AACAP,QAAAA,qBAAqB,CAACO,EAAD,CAArB;AACH,OAND;AAOA/wB,MAAAA,kBAAkB,CAACjC,IAAD,EAAO,UAAUnP,CAAV,EAAa;AAClC,YAAIgiC,eAAe,CAACpuB,GAAhB,CAAoBzE,IAApB,CAAJ,EAA+B;AAC3B;AACH;;AACD6yB,QAAAA,eAAe,CAACn3B,GAAhB,CAAoBsE,IAApB;AACA0yB,QAAAA,oBAAoB,CAAC7hC,CAAC,CAAC2R,UAAH,CAApB;AACAmwB,QAAAA,wBAAwB,CAAC9hC,CAAC,CAAC2R,UAAH,EAAeiwB,qBAAf,EAAsCC,oBAAtC,CAAxB;AACH,OAPiB,CAAlB;AAQH;;AACD,QAAIO,YAAY,GAAGluB,2BAA2B,CAAC7C,IAAD,EAAO;AACjDqD,MAAAA,gBAAgB,EAAE,UAAU1M,EAAV,EAAc;AAC5B,YAAIoL,SAAS,GAAGpL,EAAE,CAACoL,SAAnB;AACAA,QAAAA,SAAS,CAAC5I,OAAV,CAAkB,UAAU63B,KAAV,EAAiB;AAAE,iBAAOH,aAAa,CAACG,KAAD,CAApB;AAA8B,SAAnE;AACH,OAJgD;AAKjD7tB,MAAAA,eAAe,EAAE,YAAY;AACzB0tB,QAAAA,aAAa,CAAC7wB,IAAD,CAAb;AACH;AAPgD,KAAP,CAA9C;AASAowB,IAAAA,aAAa,CAAC7sB,GAAd,CAAkBvD,IAAlB,EAAwB+wB,YAAxB;AACA,QAAIE,YAAY,GAAG,CAAnB;AACA,QAAItyB,KAAK,GAAG,IAAZ;AACA,QAAIL,iBAAiB,GAAGhB,WAAW,CAAC;AAAEG,MAAAA,OAAO,EAAE;AAAX,KAAD,CAAnC;AACA,QAAIY,aAAa,GAAGf,WAAW,CAAC;AAAEG,MAAAA,OAAO,EAAE;AAAX,KAAD,CAA/B;AACA,QAAIW,kBAAkB,GAAG,EAAzB;AACA,QAAIvH,KAAK,GAAG,EAAZ;AACA,QAAI+H,SAAS,GAAG,IAAhB;AACA,QAAIsyB,wBAAwB,GAAG10B,QAAQ,CAAC,UAAUmF,SAAV,EAAqB;AACzDA,MAAAA,SAAS,CAACxI,OAAV,CAAkB,UAAU1H,CAAV,EAAa;AAC3B,YAAIo+B,kBAAkB,CAAC56B,QAAnB,CAA4BxD,CAAC,CAAC0/B,aAA9B,CAAJ,EAAkD;AAC9CZ,UAAAA,qBAAqB,CAAC9+B,CAAC,CAAC2/B,MAAH,CAArB;AACH;AACJ,OAJD;AAKH,KANsC,CAAvC;AAOA,QAAIC,YAAY,GAAG,IAAI7xB,gBAAJ,CAAqB,UAAUmC,SAAV,EAAqB;AACzD,UAAI/C,SAAJ,EAAe;AACX/H,QAAAA,KAAK,CAACvF,IAAN,CAAWpC,KAAX,CAAiB2H,KAAjB,EAAwB/E,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACiQ,SAAD,CAAX,CAArC;AACA;AACH;;AACDsvB,MAAAA,YAAY;AACZ,UAAInyB,GAAG,GAAGC,IAAI,CAACD,GAAL,EAAV;;AACA,UAAIH,KAAK,IAAI,IAAb,EAAmB;AACfA,QAAAA,KAAK,GAAGG,GAAR;AACH,OAFD,MAGK,IAAImyB,YAAY,IAAI7yB,kBAApB,EAAwC;AACzC,YAAIU,GAAG,GAAGH,KAAN,GAAcL,iBAAlB,EAAqC;AACjCM,UAAAA,SAAS,GAAGI,UAAU,CAAC,YAAY;AAC/BL,YAAAA,KAAK,GAAG,IAAR;AACAsyB,YAAAA,YAAY,GAAG,CAAf;AACAryB,YAAAA,SAAS,GAAG,IAAZ;AACA,gBAAI0yB,cAAc,GAAGz6B,KAArB;AACAA,YAAAA,KAAK,GAAG,EAAR;AACAq6B,YAAAA,wBAAwB,CAACI,cAAD,CAAxB;AACH,WAPqB,EAOnBjzB,aAPmB,CAAtB;AAQAxH,UAAAA,KAAK,CAACvF,IAAN,CAAWpC,KAAX,CAAiB2H,KAAjB,EAAwB/E,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACiQ,SAAD,CAAX,CAArC;AACA;AACH;;AACDhD,QAAAA,KAAK,GAAGG,GAAR;AACAmyB,QAAAA,YAAY,GAAG,CAAf;AACH;;AACDC,MAAAA,wBAAwB,CAACvvB,SAAD,CAAxB;AACH,KA3BkB,CAAnB;AA4BA0vB,IAAAA,YAAY,CAAC3xB,OAAb,CAAqBM,IAArB,EAA2B;AACvBuxB,MAAAA,UAAU,EAAE,IADW;AAEvBC,MAAAA,eAAe,EAAE3B,kBAAkB,CAACx9B,MAAnB,CAA0Bs9B,aAAa,CAAC/pB,GAAd,CAAkB,UAAUjP,EAAV,EAAc;AACvE,YAAI+4B,QAAQ,GAAG/4B,EAAE,CAAC+4B,QAAlB;AACA,eAAOA,QAAP;AACH,OAH0C,CAA1B,CAFM;AAMvBpsB,MAAAA,OAAO,EAAE;AANc,KAA3B;AAQA+sB,IAAAA,aAAa,CAAC9sB,GAAd,CAAkBvD,IAAlB,EAAwBqxB,YAAxB;AACH;;AACD,WAASI,2BAAT,GAAuC;AACnCrB,IAAAA,aAAa,CAACj3B,OAAd,CAAsB,UAAU3H,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACqO,UAAF,EAAP;AAAwB,KAA7D;AACAwwB,IAAAA,aAAa,CAACl3B,OAAd,CAAsB,UAAU3H,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACqO,UAAF,EAAP;AAAwB,KAA7D;AACAuwB,IAAAA,aAAa,CAAC9uB,KAAd;AACA+uB,IAAAA,aAAa,CAAC/uB,KAAd;AACH;;AACD,MAAIowB,gBAAgB,GAAG,IAAI9uB,OAAJ,EAAvB;AACA,MAAI+uB,WAAW,GAAG,CAAC,YAAD,EAAe,UAAf,EAA2B,WAA3B,EAAwC,OAAxC,EAAiD,MAAjD,CAAlB;;AACA,WAASC,sBAAT,CAAgCd,EAAhC,EAAoCvX,KAApC,EAA2C;AACvC,WAAOsW,kBAAkB,CACpBjqB,GADE,CACE,UAAUmqB,IAAV,EAAgB;AAAE,aAAOA,IAAI,GAAG,KAAP,GAAee,EAAE,CAACe,YAAH,CAAgB9B,IAAhB,CAAf,GAAuC,IAA9C;AAAqD,KADzE,EAEF19B,MAFE,CAEKs/B,WAAW,CAAC/rB,GAAZ,CAAgB,UAAUC,IAAV,EAAgB;AAAE,aAAOA,IAAI,GAAG,KAAP,GAAe0T,KAAK,CAAC1T,IAAD,CAApB,GAA6B,IAApC;AAA2C,KAA7E,CAFL,EAGF7N,IAHE,CAGG,GAHH,CAAP;AAIH;;AACD,WAAS85B,uBAAT,CAAiCC,OAAjC,EAA0ClN,SAA1C,EAAqD;AACjD,SAAK,IAAIn2B,CAAC,GAAG,CAAR,EAAWiN,GAAG,GAAGkpB,SAAS,CAACh2B,MAAhC,EAAwCH,CAAC,GAAGiN,GAA5C,EAAiDjN,CAAC,EAAlD,EAAsD;AAClD,UAAIsjC,gBAAgB,GAAGnN,SAAS,CAACn2B,CAAD,CAAhC;;AACA,UAAIqjC,OAAO,CAACla,OAAR,CAAgBma,gBAAhB,CAAJ,EAAuC;AACnC,eAAO,IAAP;AACH;AACJ;;AACD,WAAO,KAAP;AACH;;AACD,WAASC,mBAAT,CAA6BF,OAA7B,EAAsCxY,KAAtC,EAA6C2Y,qBAA7C,EAAoE9P,oBAApE,EAA0F;AACtF,QAAI+P,QAAQ,GAAGP,sBAAsB,CAACG,OAAD,EAAUxY,KAAV,CAArC;;AACA,QAAI4Y,QAAQ,KAAKT,gBAAgB,CAACx6B,GAAjB,CAAqB66B,OAArB,CAAjB,EAAgD;AAC5C;AACH;;AACD,QAAIK,UAAU,GAAG,IAAI95B,GAAJ,CAAQhK,MAAM,CAAC+jC,IAAP,CAAY9C,SAAZ,CAAR,CAAjB;;AACA,aAAS+C,aAAT,CAAuBC,aAAvB,EAAsCC,eAAtC,EAAuDC,MAAvD,EAA+D;AAC3D,UAAI97B,EAAE,GAAG44B,SAAS,CAACgD,aAAD,CAAlB;AAAA,UAAmC/C,UAAU,GAAG74B,EAAE,CAAC64B,UAAnD;AAAA,UAA+DE,QAAQ,GAAG/4B,EAAE,CAAC+4B,QAA7E;AACA,UAAIgD,GAAG,GAAGxQ,2BAA2B,CAACsQ,eAAD,EAAkBC,MAAlB,EAA0B,EAA1B,EAA8BtQ,cAA9B,EAA8CC,oBAA9C,EAAoE,IAApE,CAArC;;AACA,UAAI,CAACsQ,GAAL,EAAU;AACN;AACH;;AACD,UAAIjjC,KAAK,GAAGijC,GAAG,CAACjjC,KAAhB;;AACA,UAAI,OAAOA,KAAP,KAAiB,UAArB,EAAiC;AAC7BA,QAAAA,KAAK,GAAGA,KAAK,CAAC8pB,KAAD,CAAb;AACH;;AACDwY,MAAAA,OAAO,CAAC9rB,KAAR,CAAc0sB,WAAd,CAA0BnD,UAA1B,EAAsC//B,KAAtC;;AACA,UAAI,CAACsiC,OAAO,CAACa,YAAR,CAAqBlD,QAArB,CAAL,EAAqC;AACjCqC,QAAAA,OAAO,CAACc,YAAR,CAAqBnD,QAArB,EAA+B,EAA/B;AACH;;AACD0C,MAAAA,UAAU,CAACnxB,MAAX,CAAkBsxB,aAAlB;AACH;;AACD,QAAIL,qBAAqB,CAACrjC,MAAtB,GAA+B,CAAnC,EAAsC;AAClC,UAAIijC,uBAAuB,CAACC,OAAD,EAAUG,qBAAV,CAA3B,EAA6D;AACzDE,QAAAA,UAAU,CAACj5B,OAAX,CAAmB,UAAUs2B,OAAV,EAAmB;AAClCsC,UAAAA,OAAO,CAACe,eAAR,CAAwBvD,SAAS,CAACE,OAAD,CAAT,CAAmBC,QAA3C;AACH,SAFD;AAGA;AACH;AACJ;;AACD,QAAIqC,OAAO,CAACa,YAAR,CAAqB,SAArB,CAAJ,EAAqC;AACjC,UAAInjC,KAAK,GAAGsiC,OAAO,CAACF,YAAR,CAAqB,SAArB,CAAZ;;AACA,UAAIpiC,KAAK,CAACoG,KAAN,CAAY,gBAAZ,KAAiCpG,KAAK,CAACoG,KAAN,CAAY,gBAAZ,CAArC,EAAoE;AAChEpG,QAAAA,KAAK,GAAG,MAAMA,KAAd;AACH;;AACD6iC,MAAAA,aAAa,CAAC,kBAAD,EAAqB,kBAArB,EAAyC7iC,KAAzC,CAAb;AACH;;AACD,QAAIsiC,OAAO,CAACa,YAAR,CAAqB,OAArB,KAAiCb,OAAO,CAACgB,GAAR,KAAgB,WAArD,EAAkE;AAC9D,UAAItjC,KAAK,GAAGsiC,OAAO,CAACF,YAAR,CAAqB,OAArB,CAAZ;;AACA,UAAIpiC,KAAK,CAACoG,KAAN,CAAY,gBAAZ,KAAiCpG,KAAK,CAACoG,KAAN,CAAY,gBAAZ,CAArC,EAAoE;AAChEpG,QAAAA,KAAK,GAAG,MAAMA,KAAd;AACH;;AACD6iC,MAAAA,aAAa,CAAC,OAAD,EAAU,OAAV,EAAmB7iC,KAAnB,CAAb;AACH;;AACD,QAAIsiC,OAAO,YAAYiB,UAAvB,EAAmC;AAC/B,UAAIjB,OAAO,CAACa,YAAR,CAAqB,MAArB,CAAJ,EAAkC;AAC9B,YAAIK,iBAAiB,GAAG,EAAxB;AACA,YAAIC,OAAO,GAAGnB,OAAO,CAACF,YAAR,CAAqB,MAArB,CAAd;;AACA,YAAIqB,OAAO,KAAK,MAAhB,EAAwB;AACpB,cAAI,EAAEnB,OAAO,YAAYoB,cAArB,CAAJ,EAA0C;AACtC,gBAAIC,gBAAgB,GAAG,YAAY;AAC/B,kBAAIz8B,EAAE,GAAGo7B,OAAO,CAACsB,qBAAR,EAAT;AAAA,kBAA0CtU,KAAK,GAAGpoB,EAAE,CAACooB,KAArD;AAAA,kBAA4DE,MAAM,GAAGtoB,EAAE,CAACsoB,MAAxE;;AACA,kBAAIqU,IAAI,GAAIvU,KAAK,GAAGkU,iBAAR,IAA6BhU,MAAM,GAAGgU,iBAAlD;AACAX,cAAAA,aAAa,CAAC,MAAD,EAASgB,IAAI,GAAG,kBAAH,GAAwB,OAArC,EAA8CJ,OAA9C,CAAb;AACH,aAJD;;AAKA,gBAAIhyB,oBAAoB,EAAxB,EAA4B;AACxBkyB,cAAAA,gBAAgB;AACnB,aAFD,MAGK;AACDhyB,cAAAA,6BAA6B,CAACgyB,gBAAD,CAA7B;AACH;AACJ,WAZD,MAaK;AACDd,YAAAA,aAAa,CAAC,MAAD,EAAS,OAAT,EAAkBY,OAAlB,CAAb;AACH;AACJ;AACJ;;AACD,UAAInB,OAAO,CAACa,YAAR,CAAqB,YAArB,CAAJ,EAAwC;AACpCN,QAAAA,aAAa,CAAC,YAAD,EAAe,kBAAf,EAAmCP,OAAO,CAACF,YAAR,CAAqB,YAArB,CAAnC,CAAb;AACH;AACJ;;AACD,QAAIE,OAAO,CAACa,YAAR,CAAqB,QAArB,CAAJ,EAAoC;AAChC,UAAInjC,KAAK,GAAGsiC,OAAO,CAACF,YAAR,CAAqB,QAArB,CAAZ;AACAS,MAAAA,aAAa,CAAC,QAAD,EAAWP,OAAO,YAAYwB,cAAnB,IAAqCxB,OAAO,YAAYoB,cAAxD,GAAyE,cAAzE,GAA0F,OAArG,EAA8G1jC,KAA9G,CAAb;AACH;;AACDsiC,IAAAA,OAAO,CAAC9rB,KAAR,IAAiBD,sBAAsB,CAAC+rB,OAAO,CAAC9rB,KAAT,EAAgB,UAAUC,QAAV,EAAoBzW,KAApB,EAA2B;AAC9E,UAAIyW,QAAQ,KAAK,kBAAb,IAAmCzW,KAAK,CAACwF,QAAN,CAAe,KAAf,CAAvC,EAA8D;AAC1D;AACH;;AACD,UAAIs6B,SAAS,CAACvgC,cAAV,CAAyBkX,QAAzB,CAAJ,EAAwC;AACpCosB,QAAAA,aAAa,CAACpsB,QAAD,EAAWA,QAAX,EAAqBzW,KAArB,CAAb;AACH,OAFD,MAGK;AACD,YAAI+jC,aAAa,GAAG5D,kBAAkB,CAAC1pB,QAAD,CAAtC;;AACA,YAAIstB,aAAa,IAAK,CAACzB,OAAO,CAAC9rB,KAAR,CAAcE,gBAAd,CAA+BqtB,aAA/B,CAAD,IAAkD,CAACzB,OAAO,CAACa,YAAR,CAAqBY,aAArB,CAAzE,EAA+G;AAC3GzB,UAAAA,OAAO,CAAC9rB,KAAR,CAAc0sB,WAAd,CAA0BzsB,QAA1B,EAAoC,EAApC;AACH;AACJ;AACJ,KAbsC,CAAvC;;AAcA,QAAI6rB,OAAO,CAAC9rB,KAAR,IAAiB8rB,OAAO,YAAYoB,cAApC,IAAsDpB,OAAO,CAAC9rB,KAAR,CAAcwtB,IAAxE,EAA8E;AAC1EnB,MAAAA,aAAa,CAAC,MAAD,EAAS,OAAT,EAAkBP,OAAO,CAAC9rB,KAAR,CAAcE,gBAAd,CAA+B,MAA/B,CAAlB,CAAb;AACH;;AACDhN,IAAAA,OAAO,CAACi5B,UAAD,EAAa,UAAU3C,OAAV,EAAmB;AACnCsC,MAAAA,OAAO,CAACe,eAAR,CAAwBvD,SAAS,CAACE,OAAD,CAAT,CAAmBC,QAA3C;AACH,KAFM,CAAP;AAGAgC,IAAAA,gBAAgB,CAACnuB,GAAjB,CAAqBwuB,OAArB,EAA8BH,sBAAsB,CAACG,OAAD,EAAUxY,KAAV,CAApD;AACH;;AAED,MAAIma,kBAAkB,GAAG,aAAzB;AACA,MAAIC,sBAAsB,GAAG,iBAAiBD,kBAAjB,GAAsC,KAAnE;AACA,MAAIE,iBAAiB,GAAG,IAAxB;AACA,MAAIt0B,QAAQ,GAAG,IAAf;;AACA,WAASu0B,oBAAT,CAA8BC,IAA9B,EAAoCva,KAApC,EAA2C;AACvCqa,IAAAA,iBAAiB,GAAGA,iBAAiB,IAAIE,IAAI,CAACpO,OAA9C;;AACA,QAAI;AACA,UAAI7L,KAAK,GAAGpQ,KAAK,CAACmqB,iBAAD,CAAjB;AACAE,MAAAA,IAAI,CAACpO,OAAL,GAAezJ,qBAAqB,CAACpC,KAAD,EAAQN,KAAR,CAApC;AACH,KAHD,CAIA,OAAOtjB,GAAP,EAAY;AACRsG,MAAAA,OAAO,CAACtG,GAAD,CAAP;AACH;AACJ;;AACD,WAAS89B,iCAAT,CAA2Cxa,KAA3C,EAAkD;AAC9C,QAAIua,IAAI,GAAG/9B,QAAQ,CAACC,aAAT,CAAuB29B,sBAAvB,CAAX;;AACA,QAAIG,IAAJ,EAAU;AACND,MAAAA,oBAAoB,CAACC,IAAD,EAAOva,KAAP,CAApB;AACH,KAFD,MAGK;AACD,UAAIja,QAAJ,EAAc;AACVA,QAAAA,QAAQ,CAACO,UAAT;AACH;;AACDP,MAAAA,QAAQ,GAAG,IAAIE,gBAAJ,CAAqB,UAAUmC,SAAV,EAAqB;AACjDqyB,QAAAA,IAAI,EAAE,KAAK,IAAItlC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiT,SAAS,CAAC9S,MAA9B,EAAsCH,CAAC,EAAvC,EAA2C;AAC7C,cAAImT,UAAU,GAAGF,SAAS,CAACjT,CAAD,CAAT,CAAamT,UAA9B;;AACA,eAAK,IAAIuV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGvV,UAAU,CAAChT,MAA/B,EAAuCuoB,CAAC,EAAxC,EAA4C;AACxC,gBAAItZ,IAAI,GAAG+D,UAAU,CAACuV,CAAD,CAArB;;AACA,gBAAItZ,IAAI,YAAYm2B,eAAhB,IAAmCn2B,IAAI,CAAC8wB,IAAL,KAAc8E,kBAArD,EAAyE;AACrEp0B,cAAAA,QAAQ,CAACO,UAAT;AACAP,cAAAA,QAAQ,GAAG,IAAX;AACAu0B,cAAAA,oBAAoB,CAAC/1B,IAAD,EAAOyb,KAAP,CAApB;AACA,oBAAMya,IAAN;AACH;AACJ;AACJ;AACJ,OAbU,CAAX;AAcA10B,MAAAA,QAAQ,CAACI,OAAT,CAAiB3J,QAAQ,CAACm+B,IAA1B,EAAgC;AAAEv0B,QAAAA,SAAS,EAAE;AAAb,OAAhC;AACH;AACJ;;AACD,WAASw0B,qBAAT,GAAiC;AAC7B,QAAI70B,QAAJ,EAAc;AACVA,MAAAA,QAAQ,CAACO,UAAT;AACAP,MAAAA,QAAQ,GAAG,IAAX;AACH;;AACD,QAAIw0B,IAAI,GAAG/9B,QAAQ,CAACC,aAAT,CAAuB29B,sBAAvB,CAAX;;AACA,QAAIG,IAAI,IAAIF,iBAAZ,EAA+B;AAC3BE,MAAAA,IAAI,CAACpO,OAAL,GAAekO,iBAAf;AACH;AACJ;;AAED,MAAIQ,cAAc,GAAG,CACjB,MADiB,EAEjB,YAFiB,EAGjB,UAHiB,EAIjB,WAJiB,EAKjB,OALiB,EAMjB,2BANiB,EAOjB,qBAPiB,EAQjB,4BARiB,EASjB,sBATiB,CAArB;;AAWA,WAASC,WAAT,CAAqB9a,KAArB,EAA4B;AACxB,WAAO6a,cAAc,CAACxuB,GAAf,CAAmB,UAAU9W,CAAV,EAAa;AAAE,aAAOA,CAAC,GAAG,GAAJ,GAAUyqB,KAAK,CAACzqB,CAAD,CAAtB;AAA4B,KAA9D,EAAgEkJ,IAAhE,CAAqE,GAArE,CAAP;AACH;;AACD,MAAIs8B,UAAU,GAAGt3B,qBAAqB,EAAtC;;AACA,WAASu3B,wBAAT,GAAoC;AAChC,QAAIC,QAAQ,GAAG,CAAf;AACA,QAAIC,cAAc,GAAG,IAAIn8B,GAAJ,EAArB;AACA,QAAIo8B,aAAa,GAAG,IAAIhyB,GAAJ,EAApB;AACA,QAAIiyB,qBAAqB,GAAG,IAAIr8B,GAAJ,EAA5B;AACA,QAAIs8B,aAAa,GAAG,IAApB;AACA,QAAIC,gBAAgB,GAAG,KAAvB;AACA,QAAIC,UAAU,GAAG,KAAjB;;AACA,aAASC,kBAAT,GAA8B;AAC1B,aAAOF,gBAAgB,IAAI,CAACC,UAA5B;AACH;;AACD,aAASE,WAAT,CAAqBhL,OAArB,EAA8B;AAC1B,UAAIplB,KAAK,GAAGolB,OAAO,CAACiL,cAApB;AACA,UAAI1b,KAAK,GAAGyQ,OAAO,CAACzQ,KAApB;AAAA,UAA2B2b,mBAAmB,GAAGlL,OAAO,CAACkL,mBAAzD;AAAA,UAA8EC,KAAK,GAAGnL,OAAO,CAACmL,KAA9F;AAAA,UAAqGC,YAAY,GAAGpL,OAAO,CAACoL,YAA5H;AAAA,UAA0IC,gBAAgB,GAAGrL,OAAO,CAACqL,gBAArK;AACA,UAAIC,YAAY,GAAIZ,aAAa,CAAClxB,IAAd,KAAuB,CAA3C;AACA,UAAI+xB,iBAAiB,GAAG,IAAIj9B,GAAJ,CAAQo8B,aAAa,CAACrC,IAAd,EAAR,CAAxB;AACA,UAAImD,QAAQ,GAAGnB,WAAW,CAAC9a,KAAD,CAA1B;AACA,UAAIkc,YAAY,GAAID,QAAQ,KAAKZ,aAAjC;;AACA,UAAIC,gBAAJ,EAAsB;AAClBC,QAAAA,UAAU,GAAG,IAAb;AACH;;AACD,UAAIY,QAAQ,GAAG,EAAf;AACA/wB,MAAAA,eAAe,CAACC,KAAD,EAAQ,UAAUG,IAAV,EAAgB;AACnC,YAAIsB,OAAO,GAAGtB,IAAI,CAACsB,OAAnB;AACA,YAAIsvB,mBAAmB,GAAG,KAA1B;AACAJ,QAAAA,iBAAiB,CAACt0B,MAAlB,CAAyBoF,OAAzB;;AACA,YAAItB,IAAI,CAAC6wB,UAAL,YAA2BC,YAA/B,EAA6C;AACzCxvB,UAAAA,OAAO,IAAI,MAAMtB,IAAI,CAAC6wB,UAAL,CAAgBzwB,KAAhB,CAAsB2wB,SAAvC;AACH;;AACD,YAAI,CAACrB,cAAc,CAAClyB,GAAf,CAAmB8D,OAAnB,CAAL,EAAkC;AAC9BouB,UAAAA,cAAc,CAACj7B,GAAf,CAAmB6M,OAAnB;AACAsvB,UAAAA,mBAAmB,GAAG,IAAtB;AACH;;AACD,YAAIA,mBAAJ,EAAyB;AACrBL,UAAAA,YAAY,GAAG,IAAf;AACH,SAFD,MAGK;AACDI,UAAAA,QAAQ,CAACpkC,IAAT,CAAcojC,aAAa,CAACx9B,GAAd,CAAkBmP,OAAlB,CAAd;AACA;AACH;;AACD,YAAI0vB,OAAO,GAAG,EAAd;AACAhxB,QAAAA,IAAI,CAACkB,KAAL,IAAcD,sBAAsB,CAACjB,IAAI,CAACkB,KAAN,EAAa,UAAUC,QAAV,EAAoBzW,KAApB,EAA2B;AACxE,cAAIijC,GAAG,GAAGxQ,2BAA2B,CAAChc,QAAD,EAAWzW,KAAX,EAAkBsV,IAAlB,EAAwBod,cAAxB,EAAwC+S,mBAAxC,EAA6DG,gBAA7D,CAArC;;AACA,cAAI3C,GAAJ,EAAS;AACLqD,YAAAA,OAAO,CAACzkC,IAAR,CAAaohC,GAAb;AACH;AACJ,SALmC,CAApC;AAMA,YAAIsD,OAAO,GAAG,IAAd;;AACA,YAAID,OAAO,CAAClnC,MAAR,GAAiB,CAArB,EAAwB;AACpB,cAAI+mC,UAAU,GAAG7wB,IAAI,CAAC6wB,UAAtB;AACAI,UAAAA,OAAO,GAAG;AAAEC,YAAAA,QAAQ,EAAElxB,IAAI,CAACC,YAAjB;AAA+BklB,YAAAA,YAAY,EAAE6L,OAA7C;AAAsDH,YAAAA,UAAU,EAAEA;AAAlE,WAAV;AACAF,UAAAA,QAAQ,CAACpkC,IAAT,CAAc0kC,OAAd;AACH;;AACDtB,QAAAA,aAAa,CAACnxB,GAAd,CAAkB8C,OAAlB,EAA2B2vB,OAA3B;AACH,OAhCc,EAgCZ,YAAY;AACXnB,QAAAA,gBAAgB,GAAG,IAAnB;AACH,OAlCc,CAAf;AAmCAU,MAAAA,iBAAiB,CAACp8B,OAAlB,CAA0B,UAAU8K,GAAV,EAAe;AACrCwwB,QAAAA,cAAc,CAACxzB,MAAf,CAAsBgD,GAAtB;AACAywB,QAAAA,aAAa,CAACzzB,MAAd,CAAqBgD,GAArB;AACH,OAHD;AAIA2wB,MAAAA,aAAa,GAAGY,QAAhB;;AACA,UAAI,CAACL,KAAD,IAAU,CAACG,YAAX,IAA2B,CAACG,YAAhC,EAA8C;AAC1C;AACH;;AACDjB,MAAAA,QAAQ;;AACR,eAAS0B,OAAT,CAAiB9E,MAAjB,EAAyBtoB,KAAzB,EAAgC/D,IAAhC,EAAsC;AAClC,YAAIkxB,QAAQ,GAAGlxB,IAAI,CAACkxB,QAApB;AAAA,YAA8B/L,YAAY,GAAGnlB,IAAI,CAACmlB,YAAlD;;AACA,YAAIiM,kBAAkB,GAAG,UAAUC,GAAV,EAAe;AACpC,cAAIlwB,QAAQ,GAAGkwB,GAAG,CAAClwB,QAAnB;AAAA,cAA6BzW,KAAK,GAAG2mC,GAAG,CAAC3mC,KAAzC;AAAA,cAAgD+yB,SAAS,GAAG4T,GAAG,CAAC5T,SAAhE;AAAA,cAA2EC,WAAW,GAAG2T,GAAG,CAAC3T,WAA7F;AACA,iBAAOvc,QAAQ,GAAG,IAAX,IAAmBzW,KAAK,IAAI,IAAT,GAAgBgzB,WAAhB,GAA8BhzB,KAAjD,KAA2D+yB,SAAS,GAAG,aAAH,GAAmB,EAAvF,IAA6F,GAApG;AACH,SAHD;;AAIA,YAAI6T,QAAQ,GAAGJ,QAAQ,GAAG,KAAX,GAAmB/L,YAAY,CAACtkB,GAAb,CAAiBuwB,kBAAjB,EAAqCn+B,IAArC,CAA0C,GAA1C,CAAnB,GAAoE,IAAnF;AACAo5B,QAAAA,MAAM,CAACpD,UAAP,CAAkBqI,QAAlB,EAA4BvtB,KAA5B;AACH;;AACD,UAAIwtB,iBAAiB,GAAG,IAAI5zB,GAAJ,EAAxB;AACA,UAAI6zB,eAAe,GAAG,IAAI7zB,GAAJ,EAAtB;AACA,UAAI8zB,uBAAuB,GAAG,CAA9B;AACA,UAAIC,qBAAqB,GAAG,CAA5B;AACA,UAAIC,cAAc,GAAG;AAAE3xB,QAAAA,IAAI,EAAE,IAAR;AAAcH,QAAAA,KAAK,EAAE,EAArB;AAAyB+xB,QAAAA,OAAO,EAAE;AAAlC,OAArB;AACA,UAAIC,SAAS,GAAG,IAAIh0B,OAAJ,EAAhB;;AACA,eAASi0B,QAAT,CAAkB9xB,IAAlB,EAAwB;AACpB,YAAIA,IAAI,IAAI,IAAZ,EAAkB;AACd,iBAAO2xB,cAAP;AACH;;AACD,YAAIE,SAAS,CAACr0B,GAAV,CAAcwC,IAAd,CAAJ,EAAyB;AACrB,iBAAO6xB,SAAS,CAAC1/B,GAAV,CAAc6N,IAAd,CAAP;AACH;;AACD,YAAI6S,KAAK,GAAG;AAAE7S,UAAAA,IAAI,EAAEA,IAAR;AAAcH,UAAAA,KAAK,EAAE,EAArB;AAAyB+xB,UAAAA,OAAO,EAAE;AAAlC,SAAZ;AACAC,QAAAA,SAAS,CAACrzB,GAAV,CAAcwB,IAAd,EAAoB6S,KAApB;AACA,YAAIkf,WAAW,GAAGD,QAAQ,CAAC9xB,IAAI,CAAC6wB,UAAN,CAA1B;AACAkB,QAAAA,WAAW,CAAClyB,KAAZ,CAAkBtT,IAAlB,CAAuBsmB,KAAvB;AACA,eAAOA,KAAP;AACH;;AACD+c,MAAAA,qBAAqB,CAACx7B,OAAtB,CAA8B,UAAUmI,KAAV,EAAiB;AAAE,eAAOA,KAAK,EAAZ;AAAiB,OAAlE;AACAqzB,MAAAA,qBAAqB,CAACrzB,KAAtB;AACAo0B,MAAAA,QAAQ,CAAC1Y,MAAT,CAAgB,UAAUrrB,CAAV,EAAa;AAAE,eAAOA,CAAP;AAAW,OAA1C,EAA4CwH,OAA5C,CAAoD,UAAUxC,EAAV,EAAc;AAC9D,YAAIs/B,QAAQ,GAAGt/B,EAAE,CAACs/B,QAAlB;AAAA,YAA4B/L,YAAY,GAAGvzB,EAAE,CAACuzB,YAA9C;AAAA,YAA4D0L,UAAU,GAAGj/B,EAAE,CAACi/B,UAA5E;AACA,YAAIhe,KAAK,GAAGif,QAAQ,CAACjB,UAAD,CAApB;AACA,YAAImB,cAAc,GAAG;AAAEd,UAAAA,QAAQ,EAAEA,QAAZ;AAAsB/L,UAAAA,YAAY,EAAE,EAApC;AAAwCyM,UAAAA,OAAO,EAAE;AAAjD,SAArB;AACA,YAAIK,iBAAiB,GAAGD,cAAc,CAAC7M,YAAvC;AACAtS,QAAAA,KAAK,CAAChT,KAAN,CAAYtT,IAAZ,CAAiBylC,cAAjB;;AACA,iBAASE,sBAAT,CAAgC/wB,QAAhC,EAA0CwU,QAA1C,EAAoD8H,SAApD,EAA+DC,WAA/D,EAA4E;AACxE,cAAIyU,QAAQ,GAAG,EAAEV,uBAAjB;AACA,cAAIW,gBAAgB,GAAG;AAAEjxB,YAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,YAAAA,KAAK,EAAE,IAA7B;AAAmC+yB,YAAAA,SAAS,EAAEA,SAA9C;AAAyD0U,YAAAA,QAAQ,EAAEA,QAAnE;AAA6EzU,YAAAA,WAAW,EAAEA;AAA1F,WAAvB;AACAuU,UAAAA,iBAAiB,CAAC1lC,IAAlB,CAAuB6lC,gBAAvB;AACA,cAAIC,eAAe,GAAG5C,QAAtB;AACA9Z,UAAAA,QAAQ,CAACtqB,IAAT,CAAc,UAAUinC,UAAV,EAAsB;AAChC,gBAAI,CAACA,UAAD,IAAehC,gBAAgB,EAA/B,IAAqC+B,eAAe,KAAK5C,QAA7D,EAAuE;AACnE;AACH;;AACD2C,YAAAA,gBAAgB,CAAC1nC,KAAjB,GAAyB4nC,UAAzB;AACA/C,YAAAA,UAAU,CAAC96B,GAAX,CAAe,YAAY;AACvB,kBAAI67B,gBAAgB,MAAM+B,eAAe,KAAK5C,QAA9C,EAAwD;AACpD;AACH;;AACD8C,cAAAA,gBAAgB,CAACJ,QAAD,CAAhB;AACH,aALD;AAMH,WAXD;AAYH;;AACD,iBAASK,qBAAT,CAA+BrxB,QAA/B,EAAyCwU,QAAzC,EAAmD8H,SAAnD,EAA8DC,WAA9D,EAA2E;AACvE,cAAI9rB,EAAE,GAAG+jB,QAAT;AAAA,cAAmB8c,OAAO,GAAG7gC,EAAE,CAACuzB,YAAhC;AAAA,cAA8CkB,YAAY,GAAGz0B,EAAE,CAACy0B,YAAhE;AACA,cAAIqM,MAAM,GAAG,EAAEhB,qBAAf;AACA,cAAIW,eAAe,GAAG5C,QAAtB;AACA,cAAIkD,YAAY,GAAGV,iBAAiB,CAACnoC,MAArC;AACA,cAAI8oC,OAAO,GAAG,EAAd;;AACA,cAAIH,OAAO,CAAC3oC,MAAR,KAAmB,CAAvB,EAA0B;AACtB,gBAAI+oC,OAAO,GAAG;AAAE1xB,cAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,cAAAA,KAAK,EAAEgzB,WAA7B;AAA0CD,cAAAA,SAAS,EAAEA,SAArD;AAAgEC,cAAAA,WAAW,EAAEA,WAA7E;AAA0FgV,cAAAA,MAAM,EAAEA;AAAlG,aAAd;AACAT,YAAAA,iBAAiB,CAAC1lC,IAAlB,CAAuBsmC,OAAvB;AACAD,YAAAA,OAAO,GAAG,CAACC,OAAD,CAAV;AACH;;AACDJ,UAAAA,OAAO,CAACr+B,OAAR,CAAgB,UAAUu5B,GAAV,EAAe;AAC3B,gBAAIA,GAAG,CAACjjC,KAAJ,YAAqBE,OAAzB,EAAkC;AAC9BsnC,cAAAA,sBAAsB,CAACvE,GAAG,CAACxsB,QAAL,EAAewsB,GAAG,CAACjjC,KAAnB,EAA0B+yB,SAA1B,EAAqCC,WAArC,CAAtB;AACH,aAFD,MAGK;AACD,kBAAIoV,QAAQ,GAAG;AAAE3xB,gBAAAA,QAAQ,EAAEwsB,GAAG,CAACxsB,QAAhB;AAA0BzW,gBAAAA,KAAK,EAAEijC,GAAG,CAACjjC,KAArC;AAA4C+yB,gBAAAA,SAAS,EAAEA,SAAvD;AAAkEC,gBAAAA,WAAW,EAAEA,WAA/E;AAA4FgV,gBAAAA,MAAM,EAAEA;AAApG,eAAf;AACAT,cAAAA,iBAAiB,CAAC1lC,IAAlB,CAAuBumC,QAAvB;AACAF,cAAAA,OAAO,CAACrmC,IAAR,CAAaumC,QAAb;AACH;AACJ,WATD;AAUAzM,UAAAA,YAAY,CAACzxB,WAAb,CAAyB,UAAUm+B,OAAV,EAAmB;AACxC,gBAAIzC,gBAAgB,MAAM+B,eAAe,KAAK5C,QAA9C,EAAwD;AACpD;AACH;;AACD,gBAAIuD,YAAY,GAAGD,OAAO,CAAClyB,GAAR,CAAY,UAAU8sB,GAAV,EAAe;AAC1C,qBAAO;AAAExsB,gBAAAA,QAAQ,EAAEwsB,GAAG,CAACxsB,QAAhB;AAA0BzW,gBAAAA,KAAK,EAAEijC,GAAG,CAACjjC,KAArC;AAA4C+yB,gBAAAA,SAAS,EAAEA,SAAvD;AAAkEC,gBAAAA,WAAW,EAAEA,WAA/E;AAA4FgV,gBAAAA,MAAM,EAAEA;AAApG,eAAP;AACH,aAFkB,CAAnB;AAGA,gBAAI3uB,KAAK,GAAGkuB,iBAAiB,CAACpuB,OAAlB,CAA0B+uB,OAAO,CAAC,CAAD,CAAjC,EAAsCD,YAAtC,CAAZ;AACAV,YAAAA,iBAAiB,CAAC35B,MAAlB,CAAyBnO,KAAzB,CAA+B8nC,iBAA/B,EAAkDllC,aAAa,CAAC,CAACgX,KAAD,EAAQ6uB,OAAO,CAAC9oC,MAAhB,CAAD,EAA0B6C,MAAM,CAACqmC,YAAD,CAAhC,CAA/D;AACAJ,YAAAA,OAAO,GAAGI,YAAV;AACAC,YAAAA,cAAc,CAACP,MAAD,CAAd;AACH,WAXD;AAYA9C,UAAAA,qBAAqB,CAACn7B,GAAtB,CAA0B,YAAY;AAAE,mBAAO4xB,YAAY,CAACG,eAAb,EAAP;AAAwC,WAAhF;AACH;;AACDrB,QAAAA,YAAY,CAAC/wB,OAAb,CAAqB,UAAUxC,EAAV,EAAc;AAC/B,cAAIuP,QAAQ,GAAGvP,EAAE,CAACuP,QAAlB;AAAA,cAA4BzW,KAAK,GAAGkH,EAAE,CAAClH,KAAvC;AAAA,cAA8C+yB,SAAS,GAAG7rB,EAAE,CAAC6rB,SAA7D;AAAA,cAAwEC,WAAW,GAAG9rB,EAAE,CAAC8rB,WAAzF;;AACA,cAAI,OAAOhzB,KAAP,KAAiB,UAArB,EAAiC;AAC7B,gBAAIirB,QAAQ,GAAGjrB,KAAK,CAAC8pB,KAAD,CAApB;;AACA,gBAAImB,QAAQ,YAAY/qB,OAAxB,EAAiC;AAC7BsnC,cAAAA,sBAAsB,CAAC/wB,QAAD,EAAWwU,QAAX,EAAqB8H,SAArB,EAAgCC,WAAhC,CAAtB;AACH,aAFD,MAGK,IAAIvc,QAAQ,CAAC5Q,UAAT,CAAoB,IAApB,CAAJ,EAA+B;AAChCiiC,cAAAA,qBAAqB,CAACrxB,QAAD,EAAWwU,QAAX,EAAqB8H,SAArB,EAAgCC,WAAhC,CAArB;AACH,aAFI,MAGA;AACDuU,cAAAA,iBAAiB,CAAC1lC,IAAlB,CAAuB;AAAE4U,gBAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,gBAAAA,KAAK,EAAEirB,QAA7B;AAAuC8H,gBAAAA,SAAS,EAAEA,SAAlD;AAA6DC,gBAAAA,WAAW,EAAEA;AAA1E,eAAvB;AACH;AACJ,WAXD,MAYK;AACDuU,YAAAA,iBAAiB,CAAC1lC,IAAlB,CAAuB;AAAE4U,cAAAA,QAAQ,EAAEA,QAAZ;AAAsBzW,cAAAA,KAAK,EAAEA,KAA7B;AAAoC+yB,cAAAA,SAAS,EAAEA,SAA/C;AAA0DC,cAAAA,WAAW,EAAEA;AAAvE,aAAvB;AACH;AACJ,SAjBD;AAkBH,OA7ED;AA8EA,UAAIiL,KAAK,GAAG0H,YAAY,EAAxB;;AACA,eAAS6C,eAAT,GAA2B;AACvB,iBAASC,YAAT,CAAsBtgB,KAAtB,EAA6BnZ,MAA7B,EAAqC;AACjC,cAAIsG,IAAI,GAAG6S,KAAK,CAAC7S,IAAjB;;AACA,cAAIA,IAAI,YAAY8wB,YAApB,EAAkC;AAC9B,gBAAI1wB,KAAK,GAAGJ,IAAI,CAACI,KAAjB;AACA,gBAAI2D,KAAK,GAAGrK,MAAM,CAACyG,QAAP,CAAgBrW,MAA5B;AACA4P,YAAAA,MAAM,CAACuvB,UAAP,CAAkB,YAAY7oB,KAAK,CAAC2wB,SAAlB,GAA8B,KAAhD,EAAuDhtB,KAAvD;AACA,mBAAOrK,MAAM,CAACyG,QAAP,CAAgB4D,KAAhB,CAAP;AACH;;AACD,iBAAOrK,MAAP;AACH;;AACD,iBAAS05B,iBAAT,CAA2BvgB,KAA3B,EAAkCwZ,MAAlC,EAA0CgH,aAA1C,EAAyD;AACrDxgB,UAAAA,KAAK,CAAChT,KAAN,CAAYzL,OAAZ,CAAoB,UAAUxH,CAAV,EAAa;AAC7B,gBAAIA,CAAC,CAACglC,OAAN,EAAe;AACX,kBAAInoC,CAAC,GAAG0pC,YAAY,CAACvmC,CAAD,EAAIy/B,MAAJ,CAApB;AACA+G,cAAAA,iBAAiB,CAACxmC,CAAD,EAAInD,CAAJ,EAAO4pC,aAAP,CAAjB;AACH,aAHD,MAIK;AACDA,cAAAA,aAAa,CAACzmC,CAAD,EAAIy/B,MAAJ,CAAb;AACH;AACJ,WARD;AASH;;AACD+G,QAAAA,iBAAiB,CAACzB,cAAD,EAAiBhJ,KAAjB,EAAwB,UAAU3oB,IAAV,EAAgBqsB,MAAhB,EAAwB;AAC7D,cAAItoB,KAAK,GAAGsoB,MAAM,CAAClsB,QAAP,CAAgBrW,MAA5B;AACAkW,UAAAA,IAAI,CAACmlB,YAAL,CAAkB/wB,OAAlB,CAA0B,UAAUxC,EAAV,EAAc;AACpC,gBAAIugC,QAAQ,GAAGvgC,EAAE,CAACugC,QAAlB;AAAA,gBAA4BO,MAAM,GAAG9gC,EAAE,CAAC8gC,MAAxC;;AACA,gBAAIP,QAAQ,IAAI,IAAhB,EAAsB;AAClBZ,cAAAA,iBAAiB,CAAC/yB,GAAlB,CAAsB2zB,QAAtB,EAAgC;AAAEnyB,gBAAAA,IAAI,EAAEA,IAAR;AAAcqsB,gBAAAA,MAAM,EAAEA,MAAtB;AAA8BtoB,gBAAAA,KAAK,EAAEA;AAArC,eAAhC;AACH;;AACD,gBAAI2uB,MAAM,IAAI,IAAd,EAAoB;AAChBlB,cAAAA,eAAe,CAAChzB,GAAhB,CAAoBk0B,MAApB,EAA4B;AAAE1yB,gBAAAA,IAAI,EAAEA,IAAR;AAAcqsB,gBAAAA,MAAM,EAAEA,MAAtB;AAA8BtoB,gBAAAA,KAAK,EAAEA;AAArC,eAA5B;AACH;AACJ,WARD;AASAotB,UAAAA,OAAO,CAAC9E,MAAD,EAAStoB,KAAT,EAAgB/D,IAAhB,CAAP;AACH,SAZgB,CAAjB;AAaH;;AACD,eAASuyB,gBAAT,CAA0BrzB,GAA1B,EAA+B;AAC3B,YAAItN,EAAE,GAAG2/B,iBAAiB,CAACp/B,GAAlB,CAAsB+M,GAAtB,CAAT;AAAA,YAAqCc,IAAI,GAAGpO,EAAE,CAACoO,IAA/C;AAAA,YAAqDqsB,MAAM,GAAGz6B,EAAE,CAACy6B,MAAjE;AAAA,YAAyEtoB,KAAK,GAAGnS,EAAE,CAACmS,KAApF;;AACAsoB,QAAAA,MAAM,CAACzD,UAAP,CAAkB7kB,KAAlB;AACAotB,QAAAA,OAAO,CAAC9E,MAAD,EAAStoB,KAAT,EAAgB/D,IAAhB,CAAP;AACAuxB,QAAAA,iBAAiB,CAACr1B,MAAlB,CAAyBgD,GAAzB;AACH;;AACD,eAAS+zB,cAAT,CAAwB/zB,GAAxB,EAA6B;AACzB,YAAItN,EAAE,GAAG4/B,eAAe,CAACr/B,GAAhB,CAAoB+M,GAApB,CAAT;AAAA,YAAmCc,IAAI,GAAGpO,EAAE,CAACoO,IAA7C;AAAA,YAAmDqsB,MAAM,GAAGz6B,EAAE,CAACy6B,MAA/D;AAAA,YAAuEtoB,KAAK,GAAGnS,EAAE,CAACmS,KAAlF;;AACAsoB,QAAAA,MAAM,CAACzD,UAAP,CAAkB7kB,KAAlB;AACAotB,QAAAA,OAAO,CAAC9E,MAAD,EAAStoB,KAAT,EAAgB/D,IAAhB,CAAP;AACH;;AACDkzB,MAAAA,eAAe;AAClB;;AACD,WAAO;AAAEjD,MAAAA,WAAW,EAAEA,WAAf;AAA4BD,MAAAA,kBAAkB,EAAEA;AAAhD,KAAP;AACH;;AAED,MAAIsD,cAAc,GAAG,kDAArB;;AACA,WAASC,iBAAT,CAA2BvG,OAA3B,EAAoC;AAChC,WAAQ,CAAEA,OAAO,YAAYwG,gBAApB,IACJxG,OAAO,YAAYyG,eADf,IAEJzG,OAAO,YAAY0G,eAAnB,IACG1G,OAAO,CAACgB,GADX,IAEGhB,OAAO,CAACgB,GAAR,CAAYj+B,WAAZ,GAA0BG,QAA1B,CAAmC,YAAnC,CAFH,IAGG,CAAC88B,OAAO,CAAC2G,QALT,KAMJ,CAAC3G,OAAO,CAAC4G,SAAR,CAAkBC,QAAlB,CAA2B,YAA3B,CANG,IAOJ7G,OAAO,CAAC5sB,KAAR,CAAcrQ,WAAd,OAAgC,OAP5B,IAQJ,CAACi9B,OAAO,CAAC4G,SAAR,CAAkBC,QAAlB,CAA2B,QAA3B,CARL;AASH;;AACD,WAASC,mBAAT,CAA6B/6B,IAA7B,EAAmCzB,OAAnC,EAA4Cy8B,IAA5C,EAAkD;AAC9C,QAAIz8B,OAAO,KAAK,KAAK,CAArB,EAAwB;AAAEA,MAAAA,OAAO,GAAG,EAAV;AAAe;;AACzC,QAAIy8B,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAEA,MAAAA,IAAI,GAAG,IAAP;AAAc;;AACrC,QAAIR,iBAAiB,CAACx6B,IAAD,CAArB,EAA6B;AACzBzB,MAAAA,OAAO,CAAC/K,IAAR,CAAawM,IAAb;AACH,KAFD,MAGK,IAAIA,IAAI,YAAYoE,OAAhB,IAA4B1M,oBAAoB,IAAIsI,IAAI,YAAYrI,UAApE,IAAmFqI,IAAI,KAAK/H,QAAhG,EAA0G;AAC3GoD,MAAAA,OAAO,CAAC2E,IAAI,CAACqyB,gBAAL,CAAsBkI,cAAtB,CAAD,EAAwC,UAAUpyB,KAAV,EAAiB;AAAE,eAAO4yB,mBAAmB,CAAC5yB,KAAD,EAAQ5J,OAAR,EAAiB,KAAjB,CAA1B;AAAoD,OAA/G,CAAP;;AACA,UAAIy8B,IAAJ,EAAU;AACN/4B,QAAAA,kBAAkB,CAACjC,IAAD,EAAO,UAAU4yB,IAAV,EAAgB;AAAE,iBAAOmI,mBAAmB,CAACnI,IAAI,CAACpwB,UAAN,EAAkBjE,OAAlB,EAA2B,KAA3B,CAA1B;AAA8D,SAAvF,CAAlB;AACH;AACJ;;AACD,WAAOA,OAAP;AACH;;AACD,MAAI08B,YAAY,GAAG,IAAInI,OAAJ,EAAnB;AACA,MAAIoI,YAAY,GAAG,IAAIpI,OAAJ,EAAnB;AACA,MAAIqI,uBAAuB,GAAG,KAA9B;AACAljC,EAAAA,QAAQ,CAACH,gBAAT,CAA0B,oCAA1B,EAAgE,YAAY;AACxEqjC,IAAAA,uBAAuB,GAAG,IAA1B;AACH,GAFD;AAGA,MAAIC,kBAAkB,GAAG,CAAzB;AACA,MAAIC,wBAAwB,GAAG,IAAIz2B,GAAJ,EAA/B;;AACA,WAAS02B,iBAAT,GAA6B;AACzBD,IAAAA,wBAAwB,CAAC73B,KAAzB;AACH;;AACD,WAAS+3B,WAAT,CAAqBtH,OAArB,EAA8Bp7B,EAA9B,EAAkC;AAC9B,QAAI2iC,MAAM,GAAG3iC,EAAE,CAAC2iC,MAAhB;AAAA,QAAwBC,YAAY,GAAG5iC,EAAE,CAAC4iC,YAA1C;AAAA,QAAwDC,UAAU,GAAG7iC,EAAE,CAAC6iC,UAAxE;AACA,QAAIC,UAAU,GAAG,EAAjB;AACA,QAAI1pC,IAAI,GAAGgiC,OAAX;;AACA,WAAO,CAAChiC,IAAI,GAAGA,IAAI,CAAC2pC,kBAAb,KAAoC3pC,IAAI,CAAC8nB,OAAL,CAAa,aAAb,CAA3C,EAAwE;AACpE4hB,MAAAA,UAAU,CAACnoC,IAAX,CAAgBvB,IAAhB;AACH;;AACD,QAAI4pC,QAAQ,GAAGF,UAAU,CAAC1uB,IAAX,CAAgB,UAAU+lB,EAAV,EAAc;AAAE,aAAOA,EAAE,CAACjZ,OAAH,CAAW,mBAAX,KAAmC,CAACmhB,YAAY,CAACz2B,GAAb,CAAiBuuB,EAAjB,CAA3C;AAAkE,KAAlG,KAAuG,IAAtH;AACA,QAAI8I,SAAS,GAAGH,UAAU,CAAC1uB,IAAX,CAAgB,UAAU+lB,EAAV,EAAc;AAAE,aAAOA,EAAE,CAACjZ,OAAH,CAAW,mBAAX,KAAmC,CAACkhB,YAAY,CAACx2B,GAAb,CAAiBuuB,EAAjB,CAA3C;AAAkE,KAAlG,KAAuG,IAAvH;AACA,QAAI+I,uBAAuB,GAAG,IAA9B;AACA,QAAIC,wBAAwB,GAAG,IAA/B;AACA,QAAIC,qBAAqB,GAAG,KAA5B;AACA,QAAIC,eAAe,GAAG,IAAtB;AACA,QAAIC,aAAa,GAAG1F,wBAAwB,EAA5C;AACA,QAAIj1B,QAAQ,GAAG,IAAIE,gBAAJ,CAAqB,YAAY;AAC5C85B,MAAAA,MAAM;AACT,KAFc,CAAf;AAGA,QAAIY,eAAe,GAAG;AAAE3I,MAAAA,UAAU,EAAE,IAAd;AAAoB5xB,MAAAA,SAAS,EAAE,IAA/B;AAAqC2D,MAAAA,OAAO,EAAE,IAA9C;AAAoD62B,MAAAA,aAAa,EAAE;AAAnE,KAAtB;;AACA,aAASC,iBAAT,GAA6B;AACzB,aAAOrI,OAAO,YAAYwG,gBAAnB,IAAuCxG,OAAO,CAACsI,WAAR,CAAoBj0B,IAApB,GAA2BvQ,KAA3B,CAAiC2Q,cAAjC,CAA9C;AACH;;AACD,aAAS8zB,qBAAT,CAA+Bp1B,QAA/B,EAAyC;AACrC,UAAIhV,MAAM,GAAG,KAAb;;AACA,UAAIgV,QAAJ,EAAc;AACV,YAAIH,IAAI,GAAG,KAAK,CAAhB;;AACAw1B,QAAAA,YAAY,EAAE,KAAK,IAAI7rC,CAAC,GAAG,CAAR,EAAWiN,GAAG,GAAGuJ,QAAQ,CAACrW,MAA/B,EAAuCH,CAAC,GAAGiN,GAA3C,EAAgDjN,CAAC,EAAjD,EAAqD;AAC/DqW,UAAAA,IAAI,GAAGG,QAAQ,CAACxW,CAAD,CAAf;;AACA,cAAIqW,IAAI,CAACjB,IAAT,EAAe;AACX,gBAAIiB,IAAI,CAACjB,IAAL,CAAUxO,UAAV,CAAqB,MAArB,KAAgC,CAACyP,IAAI,CAACjB,IAAL,CAAUxO,UAAV,CAAqBkP,QAAQ,CAAC/N,MAA9B,CAArC,EAA4E;AACxEvG,cAAAA,MAAM,GAAG,IAAT;AACA,oBAAMqqC,YAAN;AACH;AACJ;AACJ;AACJ;;AACD,aAAOrqC,MAAP;AACH;;AACD,aAASsqC,YAAT,GAAwB;AACpB,UAAIb,QAAJ,EAAc;AACV,eAAOA,QAAQ,CAACjM,KAAT,CAAexoB,QAAtB;AACH;;AACD,UAAIk1B,iBAAiB,EAArB,EAAyB;AACrB,eAAO,IAAP;AACH;;AACD,UAAIl1B,QAAQ,GAAGu1B,iBAAiB,EAAhC;;AACA,UAAIH,qBAAqB,CAACp1B,QAAD,CAAzB,EAAqC;AACjC,eAAO,IAAP;AACH;;AACD,aAAOA,QAAP;AACH;;AACD,aAASw1B,WAAT,GAAuB;AACnB,UAAIf,QAAJ,EAAc;AACV,YAAI5H,OAAO,CAAC3yB,WAAR,KAAwBu6B,QAA5B,EAAsC;AAClC5H,UAAAA,OAAO,CAACh0B,UAAR,CAAmBoB,YAAnB,CAAgCw6B,QAAhC,EAA0C5H,OAAO,CAAC3yB,WAAlD;AACH;;AACD,YAAIu6B,QAAQ,CAACv6B,WAAT,KAAyBw6B,SAA7B,EAAwC;AACpC7H,UAAAA,OAAO,CAACh0B,UAAR,CAAmBoB,YAAnB,CAAgCy6B,SAAhC,EAA2CD,QAAQ,CAACv6B,WAApD;AACH;AACJ,OAPD,MAQK,IAAI2yB,OAAO,CAAC3yB,WAAR,KAAwBw6B,SAA5B,EAAuC;AACxC7H,QAAAA,OAAO,CAACh0B,UAAR,CAAmBoB,YAAnB,CAAgCy6B,SAAhC,EAA2C7H,OAAO,CAAC3yB,WAAnD;AACH;AACJ;;AACD,aAASu7B,eAAT,GAA2B;AACvBf,MAAAA,SAAS,GAAG7H,OAAO,YAAYyG,eAAnB,GACRziC,QAAQ,CAAC6kC,eAAT,CAAyB,4BAAzB,EAAuD,OAAvD,CADQ,GAER7kC,QAAQ,CAAC8N,aAAT,CAAuB,OAAvB,CAFJ;AAGA+1B,MAAAA,SAAS,CAACjB,SAAV,CAAoBn/B,GAApB,CAAwB,YAAxB;AACAogC,MAAAA,SAAS,CAACjB,SAAV,CAAoBn/B,GAApB,CAAwB,kBAAxB;AACAogC,MAAAA,SAAS,CAACz0B,KAAV,GAAkB,QAAlB;;AACA,UAAI,CAACnQ,UAAD,IAAe+8B,OAAO,CAAC8I,KAA3B,EAAkC;AAC9BjB,QAAAA,SAAS,CAACiB,KAAV,GAAkB9I,OAAO,CAAC8I,KAA1B;AACH;;AACD9B,MAAAA,YAAY,CAACv/B,GAAb,CAAiBogC,SAAjB;AACH;;AACD,QAAIkB,cAAc,GAAG,KAArB;AACA,QAAIC,eAAe,GAAG,KAAtB;AACA,QAAIC,aAAa,GAAG,EAAE9B,kBAAtB;;AACA,aAAS+B,aAAT,GAAyB;AACrB,aAAO9rC,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,YAAIkX,OAAJ,EAAaW,WAAb,EAA0BrQ,EAA1B,EAA8BuO,QAA9B,EAAwCg2B,WAAxC,EAAqDtU,KAArD,EAA4DuU,iBAA5D,EAA+EC,WAA/E,EAA4FC,KAA5F;;AACA,YAAIviC,EAAJ;;AACA,eAAOzI,WAAW,CAAC,IAAD,EAAO,UAAUmX,EAAV,EAAc;AACnC,kBAAQA,EAAE,CAAChX,KAAX;AACI,iBAAK,CAAL;AACI,kBAAI,EAAEuhC,OAAO,YAAY0G,eAArB,CAAJ,EAA2C,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AAC3C9hC,cAAAA,EAAE,GAAGjF,MAAM,CAAC4pC,eAAe,EAAhB,EAAoB,CAApB,CAAX,EAAmCp2B,QAAQ,GAAGvO,EAAE,CAAC,CAAD,CAAhD,EAAqDukC,WAAW,GAAGvkC,EAAE,CAAC,CAAD,CAArE;;AACA,kBAAIukC,WAAJ,EAAiB;AACb3+B,gBAAAA,OAAO,CAAC2+B,WAAD,CAAP;AACH;;AACD,kBAAI,EAAG,CAACh2B,QAAD,IAAa,CAACg2B,WAAd,IAA6B,CAAC9lC,QAA/B,IACDA,QAAQ,IAAI,CAAC28B,OAAO,CAACrE,KADpB,IAEF6N,mBAAmB,CAACL,WAAD,CAFnB,CAAJ,EAEuC,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACvC1zB,cAAAA,EAAE,CAAChX,KAAH,GAAW,CAAX;;AACJ,iBAAK,CAAL;AACIgX,cAAAA,EAAE,CAAC9W,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,CAAJ,GAAS,CAAT,CAAb;;AACAgL,cAAAA,OAAO,CAAC,iBAAiB0+B,aAAjB,GAAiC,+CAAlC,EAAmFjJ,OAAnF,CAAP;AACA,qBAAO,CAAC,CAAD,EAAIyJ,WAAW,CAACzJ,OAAD,EAAUiJ,aAAV,CAAf,CAAP;;AACJ,iBAAK,CAAL;AACIxzB,cAAAA,EAAE,CAAC/W,IAAH;;AACA,qBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,iBAAK,CAAL;AACIm2B,cAAAA,KAAK,GAAGpf,EAAE,CAAC/W,IAAH,EAAR;AACA8L,cAAAA,OAAO,CAACqqB,KAAD,CAAP;AACAmU,cAAAA,eAAe,GAAG,IAAlB;AACA,qBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,iBAAK,CAAL;AACI,kBAAIhB,qBAAJ,EAA2B;AACvB,uBAAO,CAAC,CAAD,EAAI,IAAJ,CAAP;AACH;;AACDjhC,cAAAA,EAAE,GAAGpH,MAAM,CAAC4pC,eAAe,EAAhB,EAAoB,CAApB,CAAX,EAAmCp2B,QAAQ,GAAGpM,EAAE,CAAC,CAAD,CAAhD,EAAqDoiC,WAAW,GAAGpiC,EAAE,CAAC,CAAD,CAArE;;AACA,kBAAIoiC,WAAJ,EAAiB;AACb3+B,gBAAAA,OAAO,CAAC2+B,WAAD,CAAP;AACH;;AACD1zB,cAAAA,EAAE,CAAChX,KAAH,GAAW,CAAX;;AACJ,iBAAK,CAAL;AACI2qC,cAAAA,iBAAiB,GAAGb,qBAAqB,CAACp1B,QAAD,CAAzC;;AACA,kBAAIA,QAAQ,IAAI,IAAZ,IAAoB,CAACi2B,iBAAzB,EAA4C;AACxC,uBAAO,CAAC,CAAD,EAAIj2B,QAAJ,CAAP;AACH;;AACD,qBAAO,CAAC,CAAD,EAAIu2B,QAAQ,CAAC1J,OAAO,CAACjuB,IAAT,CAAZ,CAAP;;AACJ,iBAAK,CAAL;AACIuC,cAAAA,OAAO,GAAGmB,EAAE,CAAC/W,IAAH,EAAV;AACAuW,cAAAA,WAAW,GAAGJ,cAAc,CAACmrB,OAAO,CAACjuB,IAAT,CAA5B;;AACA,kBAAIi2B,qBAAJ,EAA2B;AACvB,uBAAO,CAAC,CAAD,EAAI,IAAJ,CAAP;AACH;;AACD,qBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,iBAAK,CAAL;AACI,kBAAIK,iBAAiB,EAArB,EAAyB;AACrB/zB,gBAAAA,OAAO,GAAG0rB,OAAO,CAACsI,WAAR,CAAoBj0B,IAApB,EAAV;AACAY,gBAAAA,WAAW,GAAGJ,cAAc,CAACpC,QAAQ,CAACV,IAAV,CAA5B;AACH,eAHD,MAIK;AACD,uBAAO,CAAC,CAAD,EAAI,IAAJ,CAAP;AACH;;AACD0D,cAAAA,EAAE,CAAChX,KAAH,GAAW,CAAX;;AACJ,iBAAK,CAAL;AACI,kBAAI,CAAC6V,OAAL,EAAc,OAAO,CAAC,CAAD,EAAI,EAAJ,CAAP;AACdmB,cAAAA,EAAE,CAAChX,KAAH,GAAW,CAAX;;AACJ,iBAAK,CAAL;AACIgX,cAAAA,EAAE,CAAC9W,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,EAAJ,GAAU,EAAV,CAAb;;AACA,qBAAO,CAAC,CAAD,EAAIoqC,iBAAiB,CAACr1B,OAAD,EAAUW,WAAV,CAArB,CAAP;;AACJ,iBAAK,EAAL;AACIo0B,cAAAA,WAAW,GAAG5zB,EAAE,CAAC/W,IAAH,EAAd;AACAkpC,cAAAA,QAAQ,GAAGgC,cAAc,CAAC5J,OAAD,EAAUqJ,WAAV,CAAzB;AACA,qBAAO,CAAC,CAAD,EAAI,EAAJ,CAAP;;AACJ,iBAAK,EAAL;AACIC,cAAAA,KAAK,GAAG7zB,EAAE,CAAC/W,IAAH,EAAR;AACA8L,cAAAA,OAAO,CAAC8+B,KAAD,CAAP;AACA,qBAAO,CAAC,CAAD,EAAI,EAAJ,CAAP;;AACJ,iBAAK,EAAL;AACI,kBAAI1B,QAAJ,EAAc;AACVE,gBAAAA,uBAAuB,GAAG57B,oBAAoB,CAAC07B,QAAD,EAAW,cAAX,CAA9C;AACA,uBAAO,CAAC,CAAD,EAAIA,QAAQ,CAACjM,KAAT,CAAexoB,QAAnB,CAAP;AACH;;AACDsC,cAAAA,EAAE,CAAChX,KAAH,GAAW,EAAX;;AACJ,iBAAK,EAAL;AAAS,qBAAO,CAAC,CAAD,EAAI,IAAJ,CAAP;AA1Eb;AA4EH,SA7EiB,CAAlB;AA8EH,OAjFe,CAAhB;AAkFH;;AACD,aAASorC,OAAT,GAAmB;AACf,UAAIh3B,KAAK,GAAG41B,YAAY,EAAxB;;AACA,UAAI,CAAC51B,KAAL,EAAY;AACR,YAAIk2B,cAAc,IAAIC,eAAtB,EAAuC;AACnC,iBAAO,IAAP;AACH;;AACDD,QAAAA,cAAc,GAAG,IAAjB;AACAvB,QAAAA,YAAY;AACZ0B,QAAAA,aAAa,GAAG7qC,IAAhB,CAAqB,UAAUiM,OAAV,EAAmB;AACpCy+B,UAAAA,cAAc,GAAG,KAAjB;AACAtB,UAAAA,UAAU;;AACV,cAAIn9B,OAAJ,EAAa;AACTi9B,YAAAA,MAAM;AACT;AACJ,SAND,EAMGuC,KANH,CAMS,UAAU5lC,GAAV,EAAe;AACpBsG,UAAAA,OAAO,CAACtG,GAAD,CAAP;AACA6kC,UAAAA,cAAc,GAAG,KAAjB;AACAtB,UAAAA,UAAU;AACb,SAVD;AAWA,eAAO,IAAP;AACH;;AACD,aAAO;AAAE50B,QAAAA,KAAK,EAAEA;AAAT,OAAP;AACH;;AACD,QAAIk3B,gBAAgB,GAAG,KAAvB;;AACA,aAASC,MAAT,CAAgBxiB,KAAhB,EAAuB2b,mBAAvB,EAA4C;AACxC,UAAItwB,KAAK,GAAG41B,YAAY,EAAxB;;AACA,UAAI,CAAC51B,KAAL,EAAY;AACR;AACH;;AACDm1B,MAAAA,qBAAqB,GAAG,KAAxB;;AACA,eAASiC,qBAAT,GAAiC;AAC7B,YAAI,CAACpC,SAAL,EAAgB;AACZe,UAAAA,eAAe;AAClB;;AACDb,QAAAA,wBAAwB,IAAIA,wBAAwB,CAAC76B,IAAzB,EAA5B;AACAy7B,QAAAA,WAAW;;AACX,YAAId,SAAS,CAAClM,KAAV,IAAmB,IAAvB,EAA6B;AACzBkM,UAAAA,SAAS,CAACS,WAAV,GAAwB,EAAxB;AACH;;AACD,YAAI3M,KAAK,GAAGkM,SAAS,CAAClM,KAAtB;;AACA,aAAK,IAAIh/B,CAAC,GAAGg/B,KAAK,CAACxoB,QAAN,CAAerW,MAAf,GAAwB,CAArC,EAAwCH,CAAC,IAAI,CAA7C,EAAgDA,CAAC,EAAjD,EAAqD;AACjDg/B,UAAAA,KAAK,CAACC,UAAN,CAAiBj/B,CAAjB;AACH;;AACD,YAAIorC,wBAAJ,EAA8B;AAC1BA,UAAAA,wBAAwB,CAACr6B,GAAzB;AACH,SAFD,MAGK;AACDq6B,UAAAA,wBAAwB,GAAG77B,oBAAoB,CAAC27B,SAAD,EAAY,cAAZ,EAA4B,YAAY;AACnFkC,YAAAA,gBAAgB,GAAG,IAAnB;AACAG,YAAAA,cAAc;AACjB,WAH8C,CAA/C;AAIH;;AACD,eAAOrC,SAAS,CAAClM,KAAjB;AACH;;AACD,eAASuO,cAAT,GAA0B;AACtB,YAAI9G,KAAK,GAAG2G,gBAAZ;AACAA,QAAAA,gBAAgB,GAAG,KAAnB;AACA7B,QAAAA,aAAa,CAACjF,WAAd,CAA0B;AACtBI,UAAAA,YAAY,EAAE4G,qBADQ;AAEtB/G,UAAAA,cAAc,EAAErwB,KAFM;AAGtB2U,UAAAA,KAAK,EAAEA,KAHe;AAItB2b,UAAAA,mBAAmB,EAAEA,mBAJC;AAKtBC,UAAAA,KAAK,EAAEA,KALe;AAMtBE,UAAAA,gBAAgB,EAAE,YAAY;AAAE,mBAAO0E,qBAAP;AAA+B;AANzC,SAA1B;AAQAC,QAAAA,eAAe,GAAGJ,SAAS,CAAClM,KAAV,CAAgBxoB,QAAhB,CAAyBrW,MAAzB,KAAoC,CAAtD;;AACA,YAAIorC,aAAa,CAAClF,kBAAd,EAAJ,EAAwC;AACpC3zB,UAAAA,6BAA6B,CAAC,YAAY;AAAE,mBAAOk4B,MAAM,EAAb;AAAkB,WAAjC,CAA7B;AACH;AACJ;;AACD2C,MAAAA,cAAc;AACjB;;AACD,aAASX,eAAT,GAA2B;AACvB,UAAI;AACA,YAAIvJ,OAAO,CAACrE,KAAR,IAAiB,IAArB,EAA2B;AACvB,iBAAO,CAAC,IAAD,EAAO,IAAP,CAAP;AACH;;AACD,eAAO,CAACqE,OAAO,CAACrE,KAAR,CAAcxoB,QAAf,EAAyB,IAAzB,CAAP;AACH,OALD,CAMA,OAAOjP,GAAP,EAAY;AACR,eAAO,CAAC,IAAD,EAAOA,GAAP,CAAP;AACH;AACJ;;AACD,aAASslC,mBAAT,CAA6B1pC,KAA7B,EAAoC;AAChC,aAAOA,KAAK,IAAIA,KAAK,CAACqqC,OAAf,IAA0BrqC,KAAK,CAACqqC,OAAN,CAAcjnC,QAAd,CAAuB,SAAvB,CAAjC;AACH;;AACD,aAASwlC,iBAAT,GAA6B;AACzB,UAAI9jC,EAAE,GAAGjF,MAAM,CAAC4pC,eAAe,EAAhB,EAAoB,CAApB,CAAf;AAAA,UAAuCp2B,QAAQ,GAAGvO,EAAE,CAAC,CAAD,CAApD;AAAA,UAAyDV,GAAG,GAAGU,EAAE,CAAC,CAAD,CAAjE;;AACA,UAAIV,GAAJ,EAAS;AACLsG,QAAAA,OAAO,CAACtG,GAAD,CAAP;AACA,eAAO,IAAP;AACH;;AACD,aAAOiP,QAAP;AACH;;AACD,aAASi3B,oBAAT,GAAgC;AAC5BC,MAAAA,8BAA8B;;AAC9B,UAAI,CAAClnC,aAAD,IAAkB,EAAE+jC,uBAAuB,IAAIlH,OAAO,CAACrE,KAArC,CAAtB,EAAmE;AAC/D2O,QAAAA,4BAA4B;AAC/B;AACJ;;AACD,QAAIC,cAAc,GAAG,IAArB;AACA,QAAIC,iBAAiB,GAAG,IAAxB;;AACA,aAASC,iBAAT,GAA6B;AACzB,UAAI53B,KAAK,GAAG61B,iBAAiB,EAA7B;AACA,aAAO71B,KAAK,GAAGA,KAAK,CAAC/V,MAAT,GAAkB,IAA9B;AACH;;AACD,aAAS4tC,iBAAT,GAA6B;AACzB,aAAOD,iBAAiB,OAAOF,cAA/B;AACH;;AACD,aAASD,4BAAT,GAAwC;AACpCC,MAAAA,cAAc,GAAGE,iBAAiB,EAAlC;AACAE,MAAAA,mCAAmC;;AACnC,UAAIC,cAAc,GAAG,YAAY;AAC7B,YAAIF,iBAAiB,EAArB,EAAyB;AACrBH,UAAAA,cAAc,GAAGE,iBAAiB,EAAlC;AACAlD,UAAAA,MAAM;AACT;;AACD,YAAIL,uBAAuB,IAAIlH,OAAO,CAACrE,KAAvC,EAA8C;AAC1CgP,UAAAA,mCAAmC;AACnC;AACH;;AACDH,QAAAA,iBAAiB,GAAG1/B,qBAAqB,CAAC8/B,cAAD,CAAzC;AACH,OAVD;;AAWAA,MAAAA,cAAc;AACjB;;AACD,aAASD,mCAAT,GAA+C;AAC3C3/B,MAAAA,oBAAoB,CAACw/B,iBAAD,CAApB;AACH;;AACD,QAAIK,sBAAsB,GAAG,KAA7B;;AACA,aAASC,aAAT,GAAyB;AACrB5D,MAAAA,uBAAuB,GAAG,IAA1B;AACAyD,MAAAA,mCAAmC;;AACnC,UAAIE,sBAAJ,EAA4B;AACxB;AACH;;AACD,eAASE,kBAAT,GAA8B;AAC1BF,QAAAA,sBAAsB,GAAG,KAAzB;;AACA,YAAI7C,qBAAJ,EAA2B;AACvB;AACH;;AACDT,QAAAA,MAAM;AACT;;AACDsD,MAAAA,sBAAsB,GAAG,IAAzB;;AACA,UAAI,OAAOG,cAAP,KAA0B,UAA9B,EAA0C;AACtCA,QAAAA,cAAc,CAACD,kBAAD,CAAd;AACH,OAFD,MAGK;AACDjgC,QAAAA,qBAAqB,CAACigC,kBAAD,CAArB;AACH;AACJ;;AACD,aAASV,8BAAT,GAA0C;AACtCrK,MAAAA,OAAO,CAACn8B,gBAAR,CAAyB,2BAAzB,EAAsDinC,aAAtD;AACH;;AACD,aAASG,qCAAT,GAAiD;AAC7CjL,MAAAA,OAAO,CAACvwB,mBAAR,CAA4B,2BAA5B,EAAyDq7B,aAAzD;AACH;;AACD,aAASI,2BAAT,GAAuC;AACnCD,MAAAA,qCAAqC;AACrCN,MAAAA,mCAAmC;AACtC;;AACD,aAASQ,KAAT,GAAiB;AACb59B,MAAAA,QAAQ,CAACO,UAAT;AACAk6B,MAAAA,qBAAqB,GAAG,IAAxB;AACAF,MAAAA,uBAAuB,IAAIA,uBAAuB,CAAC56B,IAAxB,EAA3B;AACA66B,MAAAA,wBAAwB,IAAIA,wBAAwB,CAAC76B,IAAzB,EAA5B;AACAg+B,MAAAA,2BAA2B;AAC9B;;AACD,aAASE,OAAT,GAAmB;AACfD,MAAAA,KAAK;AACLr/B,MAAAA,UAAU,CAAC87B,QAAD,CAAV;AACA97B,MAAAA,UAAU,CAAC+7B,SAAD,CAAV;AACAJ,MAAAA,UAAU;;AACV,UAAIL,wBAAwB,CAAC52B,GAAzB,CAA6By4B,aAA7B,CAAJ,EAAiD;AAC7C,YAAIprC,MAAM,GAAGupC,wBAAwB,CAACjiC,GAAzB,CAA6B8jC,aAA7B,CAAb;AACA7B,QAAAA,wBAAwB,CAACl4B,MAAzB,CAAgC+5B,aAAhC;AACAprC,QAAAA,MAAM,IAAIA,MAAM,EAAhB;AACH;AACJ;;AACD,aAASwtC,KAAT,GAAiB;AACb99B,MAAAA,QAAQ,CAACI,OAAT,CAAiBqyB,OAAjB,EAA0BmI,eAA1B;;AACA,UAAInI,OAAO,YAAYwG,gBAAvB,EAAyC;AACrC4D,QAAAA,oBAAoB;AACvB;AACJ;;AACD,QAAIkB,YAAY,GAAG,EAAnB;AACA,QAAIC,SAAS,GAAG,CAAhB;;AACA,aAASz+B,OAAT,GAAmB;AACf,UAAI,CAAC+6B,SAAL,EAAgB;AACZ;AACH;;AACD0D,MAAAA,SAAS;;AACT,UAAIA,SAAS,GAAGD,YAAhB,EAA8B;AAC1B9gC,QAAAA,OAAO,CAAC,sCAAD,EAAyCw1B,OAAzC,CAAP;AACA;AACH;;AACDx1B,MAAAA,OAAO,CAAC,eAAD,EAAkBq9B,SAAlB,EAA6B7H,OAA7B,CAAP;AACA2I,MAAAA,WAAW;AACXb,MAAAA,uBAAuB,IAAIA,uBAAuB,CAAC/5B,IAAxB,EAA3B;AACAg6B,MAAAA,wBAAwB,IAAIA,wBAAwB,CAACh6B,IAAzB,EAA5B;;AACA,UAAI,CAACk6B,eAAL,EAAsB;AAClB8B,QAAAA,gBAAgB,GAAG,IAAnB;AACAxC,QAAAA,MAAM;AACT;AACJ;;AACD,WAAO;AACHsC,MAAAA,OAAO,EAAEA,OADN;AAEHG,MAAAA,MAAM,EAAEA,MAFL;AAGHmB,MAAAA,KAAK,EAAEA,KAHJ;AAIHC,MAAAA,OAAO,EAAEA,OAJN;AAKHC,MAAAA,KAAK,EAAEA,KALJ;AAMHv+B,MAAAA,OAAO,EAAEA;AANN,KAAP;AAQH;;AACD,WAAS28B,WAAT,CAAqB+B,IAArB,EAA2BC,SAA3B,EAAsC;AAClC,WAAOruC,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,eAAO,CAAC,CAAD,EAAI,IAAIhH,OAAJ,CAAY,UAAUD,OAAV,EAAmBE,MAAnB,EAA2B;AAC1C,cAAI6tC,OAAO,GAAG,YAAY;AACtBF,YAAAA,IAAI,CAAC/7B,mBAAL,CAAyB,MAAzB,EAAiCk8B,MAAjC;AACAH,YAAAA,IAAI,CAAC/7B,mBAAL,CAAyB,OAAzB,EAAkCm8B,OAAlC;AACAxE,YAAAA,wBAAwB,CAACl4B,MAAzB,CAAgCu8B,SAAhC;AACH,WAJD;;AAKA,cAAIE,MAAM,GAAG,YAAY;AACrBD,YAAAA,OAAO;AACPnhC,YAAAA,OAAO,CAAC,iBAAiBkhC,SAAjB,GAA6B,kBAA9B,CAAP;AACA9tC,YAAAA,OAAO;AACV,WAJD;;AAKA,cAAIiuC,OAAO,GAAG,YAAY;AACtBF,YAAAA,OAAO;AACP7tC,YAAAA,MAAM,CAAC,iBAAiB4tC,SAAjB,GAA6B,uBAA7B,GAAuDD,IAAI,CAACz5B,IAA7D,CAAN;AACH,WAHD;;AAIAq1B,UAAAA,wBAAwB,CAAC51B,GAAzB,CAA6Bi6B,SAA7B,EAAwC,YAAY;AAChDC,YAAAA,OAAO;AACP7tC,YAAAA,MAAM;AACT,WAHD;AAIA2tC,UAAAA,IAAI,CAAC3nC,gBAAL,CAAsB,MAAtB,EAA8B8nC,MAA9B;AACAH,UAAAA,IAAI,CAAC3nC,gBAAL,CAAsB,OAAtB,EAA+B+nC,OAA/B;;AACA,cAAI,CAACJ,IAAI,CAACz5B,IAAV,EAAgB;AACZ65B,YAAAA,OAAO;AACV;AACJ,SAxBM,CAAJ,CAAP;AAyBH,OA1BiB,CAAlB;AA2BH,KA5Be,CAAhB;AA6BH;;AACD,WAASC,eAAT,CAAyBC,iBAAzB,EAA4C;AACxC,WAAOp3B,cAAc,CAACo3B,iBAAiB,CAAC90B,SAAlB,CAA4B,CAA5B,EAA+B3C,IAA/B,GAAsCO,OAAtC,CAA8C,IAA9C,EAAoD,EAApD,CAAD,CAArB;AACH;;AACD,WAAS80B,QAAT,CAAkBllC,GAAlB,EAAuB;AACnB,WAAOpH,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AACI,gBAAI,CAAC+F,GAAG,CAACjB,UAAJ,CAAe,OAAf,CAAL,EAA8B,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AAC9B,mBAAO,CAAC,CAAD,EAAIsB,KAAK,CAACL,GAAD,CAAT,CAAP;;AACJ,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAKI,EAAE,CAAClG,IAAH,EAAD,CAAYyI,IAAZ,EAAJ,CAAP;;AACR,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIvC,EAAE,CAAClG,IAAH,EAAJ,CAAP;;AACR,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIotB,OAAO,CAAC;AAAEtnB,cAAAA,GAAG,EAAEA,GAAP;AAAYoC,cAAAA,YAAY,EAAE,MAA1B;AAAkCnC,cAAAA,QAAQ,EAAE,UAA5C;AAAwDC,cAAAA,MAAM,EAAE2B,MAAM,CAACoM,QAAP,CAAgB/N;AAAhF,aAAD,CAAX,CAAP;;AACR,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIE,EAAE,CAAClG,IAAH,EAAJ,CAAP;AAPZ;AASH,OAViB,CAAlB;AAWH,KAZe,CAAhB;AAaH;;AACD,WAASirC,iBAAT,CAA2Br1B,OAA3B,EAAoCy3B,QAApC,EAA8CjnC,KAA9C,EAAqD;AACjD,QAAIA,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,MAAAA,KAAK,GAAG,IAAI6L,GAAJ,EAAR;AAAoB;;AAC5C,WAAOvT,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAI4uC,aAAJ,EAAmBC,eAAnB,EAAoCC,iBAApC,EAAuDpoC,KAAvD,EAA8DqoC,SAA9D,EAAyEC,WAAzE,EAAsFC,WAAtF,EAAmGC,KAAnG,EAA0GtiC,KAA1G;;AACA,UAAIL,GAAJ,EAAS/E,EAAT;;AACA,aAAOtG,WAAW,CAAC,IAAD,EAAO,UAAUyI,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACtI,KAAX;AACI,eAAK,CAAL;AACI6V,YAAAA,OAAO,GAAGc,iBAAiB,CAACd,OAAD,CAA3B;AACAA,YAAAA,OAAO,GAAGgB,kBAAkB,CAAChB,OAAD,CAA5B;AACAA,YAAAA,OAAO,GAAGS,kCAAkC,CAACT,OAAD,EAAUy3B,QAAV,CAA5C;AACAC,YAAAA,aAAa,GAAGtmB,UAAU,CAACjR,cAAD,EAAiBH,OAAjB,CAA1B;AACAvN,YAAAA,EAAE,CAACtI,KAAH,GAAW,CAAX;;AACJ,eAAK,CAAL;AACIsI,YAAAA,EAAE,CAACpI,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,EAAJ,EAAQ,EAAR,EAAY,EAAZ,CAAb;;AACA0sC,YAAAA,eAAe,GAAGzsC,QAAQ,CAACwsC,aAAD,CAA1B,EAA2CE,iBAAiB,GAAGD,eAAe,CAACjuC,IAAhB,EAA/D;AACA+I,YAAAA,EAAE,CAACtI,KAAH,GAAW,CAAX;;AACJ,eAAK,CAAL;AACI,gBAAI,CAAC,CAACytC,iBAAiB,CAAC9tC,IAAxB,EAA8B,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AAC9B0F,YAAAA,KAAK,GAAGooC,iBAAiB,CAACxuC,KAA1B;AACAyuC,YAAAA,SAAS,GAAGN,eAAe,CAAC/nC,KAAD,CAA3B;AACAsoC,YAAAA,WAAW,GAAG95B,cAAc,CAACy5B,QAAD,EAAWI,SAAX,CAA5B;AACAE,YAAAA,WAAW,GAAG,KAAK,CAAnB;AACA,gBAAI,CAACvnC,KAAK,CAAC0L,GAAN,CAAU47B,WAAV,CAAL,EAA6B,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AAC7BC,YAAAA,WAAW,GAAGvnC,KAAK,CAACK,GAAN,CAAUinC,WAAV,CAAd;AACA,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,eAAK,CAAL;AACIrlC,YAAAA,EAAE,CAACpI,IAAH,CAAQY,IAAR,CAAa,CAAC,CAAD,EAAI,CAAJ,GAAS,CAAT,CAAb;;AACA,mBAAO,CAAC,CAAD,EAAImqC,QAAQ,CAAC0C,WAAD,CAAZ,CAAP;;AACJ,eAAK,CAAL;AACIC,YAAAA,WAAW,GAAGtlC,EAAE,CAACrI,IAAH,EAAd;AACAoG,YAAAA,KAAK,CAAC0M,GAAN,CAAU46B,WAAV,EAAuBC,WAAvB;AACA,mBAAO,CAAC,CAAD,EAAI1C,iBAAiB,CAAC0C,WAAD,EAAcx3B,cAAc,CAACu3B,WAAD,CAA5B,EAA2CtnC,KAA3C,CAArB,CAAP;;AACJ,eAAK,CAAL;AACIunC,YAAAA,WAAW,GAAGtlC,EAAE,CAACrI,IAAH,EAAd;AACA,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,eAAK,CAAL;AACI4tC,YAAAA,KAAK,GAAGvlC,EAAE,CAACrI,IAAH,EAAR;AACA8L,YAAAA,OAAO,CAAC8hC,KAAD,CAAP;AACAD,YAAAA,WAAW,GAAG,EAAd;AACA,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,eAAK,CAAL;AACI/3B,YAAAA,OAAO,GAAGA,OAAO,CAACiS,KAAR,CAAcziB,KAAd,EAAqBmC,IAArB,CAA0BomC,WAA1B,CAAV;AACAtlC,YAAAA,EAAE,CAACtI,KAAH,GAAW,CAAX;;AACJ,eAAK,CAAL;AACIytC,YAAAA,iBAAiB,GAAGD,eAAe,CAACjuC,IAAhB,EAApB;AACA,mBAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;;AACJ,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAI,EAAJ,CAAP;;AACR,eAAK,EAAL;AACIgM,YAAAA,KAAK,GAAGjD,EAAE,CAACrI,IAAH,EAAR;AACAiL,YAAAA,GAAG,GAAG;AAAE7J,cAAAA,KAAK,EAAEkK;AAAT,aAAN;AACA,mBAAO,CAAC,CAAD,EAAI,EAAJ,CAAP;;AACJ,eAAK,EAAL;AACI,gBAAI;AACA,kBAAIkiC,iBAAiB,IAAI,CAACA,iBAAiB,CAAC9tC,IAAxC,KAAiDwG,EAAE,GAAGqnC,eAAe,CAAChiC,MAAtE,CAAJ,EAAmFrF,EAAE,CAAC1H,IAAH,CAAQ+uC,eAAR;AACtF,aAFD,SAGQ;AAAE,kBAAItiC,GAAJ,EAAS,MAAMA,GAAG,CAAC7J,KAAV;AAAkB;;AACrC,mBAAO,CAAC,CAAD,CAAP;;AACJ,eAAK,EAAL;AACIwU,YAAAA,OAAO,GAAGA,OAAO,CAACD,IAAR,EAAV;AACA,mBAAO,CAAC,CAAD,EAAIC,OAAJ,CAAP;AAtDR;AAwDH,OAzDiB,CAAlB;AA0DH,KA7De,CAAhB;AA8DH;;AACD,WAASs1B,cAAT,CAAwB2C,UAAxB,EAAoCj4B,OAApC,EAA6C;AACzC,QAAI,CAACA,OAAL,EAAc;AACV,aAAO,IAAP;AACH;;AACD,QAAIk4B,IAAI,GAAGxoC,QAAQ,CAAC8N,aAAT,CAAuB,OAAvB,CAAX;AACA06B,IAAAA,IAAI,CAAC5F,SAAL,CAAen/B,GAAf,CAAmB,YAAnB;AACA+kC,IAAAA,IAAI,CAAC5F,SAAL,CAAen/B,GAAf,CAAmB,kBAAnB;AACA+kC,IAAAA,IAAI,CAACp5B,KAAL,GAAa,QAAb;AACAo5B,IAAAA,IAAI,CAAClE,WAAL,GAAmBh0B,OAAnB;AACAi4B,IAAAA,UAAU,CAACvgC,UAAX,CAAsBoB,YAAtB,CAAmCo/B,IAAnC,EAAyCD,UAAU,CAACl/B,WAApD;AACAm/B,IAAAA,IAAI,CAAC7Q,KAAL,CAAWgL,QAAX,GAAsB,IAAtB;AACAM,IAAAA,YAAY,CAACx/B,GAAb,CAAiB+kC,IAAjB;AACA,WAAOA,IAAP;AACH;;AAED,MAAIC,SAAS,GAAG,EAAhB;AACA,MAAIC,aAAJ;AACA,MAAIC,eAAe,GAAG,IAAIh8B,GAAJ,EAAtB;AACA,MAAIi8B,0BAAJ;;AACA,WAASC,wBAAT,CAAkC5+B,IAAlC,EAAwC;AACpC,QAAI,CAAClK,0BAAL,EAAiC;AAC7B;AACH;;AACDqD,IAAAA,OAAO,CAAC6G,IAAI,CAACmwB,gBAAL,CAAsB,gBAAtB,CAAD,EAA0C,UAAUW,EAAV,EAAc;AAC3D,UAAI+N,GAAG,GAAG/N,EAAE,CAACgO,OAAH,CAAWhqC,WAAX,EAAV;;AACA,UAAI,CAAC+pC,GAAG,CAAC5pC,QAAJ,CAAa,GAAb,CAAL,EAAwB;AACpB,YAAI8pC,WAAW,GAAGjO,EAAE,CAACe,YAAH,CAAgB,IAAhB,CAAlB;;AACA,YAAIkN,WAAJ,EAAiB;AACbF,UAAAA,GAAG,GAAGE,WAAN;AACH,SAFD,MAGK;AACD;AACH;AACJ;;AACD,UAAI,CAACL,eAAe,CAACn8B,GAAhB,CAAoBs8B,GAApB,CAAL,EAA+B;AAC3BH,QAAAA,eAAe,CAACn7B,GAAhB,CAAoBs7B,GAApB,EAAyB,IAAIvmC,GAAJ,EAAzB;AACA0mC,QAAAA,yBAAyB,CAACH,GAAD,CAAzB,CAA+BzuC,IAA/B,CAAoC,YAAY;AAC5C,cAAIuuC,0BAAJ,EAAgC;AAC5B,gBAAIM,QAAQ,GAAGP,eAAe,CAACxnC,GAAhB,CAAoB2nC,GAApB,CAAf;AACAH,YAAAA,eAAe,CAACz9B,MAAhB,CAAuB49B,GAAvB;AACAF,YAAAA,0BAA0B,CAACxsC,KAAK,CAACH,IAAN,CAAWitC,QAAX,CAAD,CAA1B;AACH;AACJ,SAND;AAOH;;AACDP,MAAAA,eAAe,CAACxnC,GAAhB,CAAoB2nC,GAApB,EAAyBrlC,GAAzB,CAA6Bs3B,EAA7B;AACH,KAtBM,CAAP;AAuBH;;AACD,MAAIoO,qBAAqB,GAAG,KAA5B;AACAnpC,EAAAA,QAAQ,CAACH,gBAAT,CAA0B,oCAA1B,EAAgE,YAAY;AACxEspC,IAAAA,qBAAqB,GAAG,IAAxB;AACH,GAFD;AAGA,MAAIC,SAAS,GAAG,IAAIz8B,GAAJ,EAAhB;;AACA,WAAS08B,eAAT,CAAyBpvC,CAAzB,EAA4B;AACxBkvC,IAAAA,qBAAqB,GAAG,IAAxB;;AACA,QAAIC,SAAS,CAAC58B,GAAV,CAAcvS,CAAC,CAACqvC,MAAF,CAASR,GAAvB,CAAJ,EAAiC;AAC7B,UAAInvC,OAAO,GAAGyvC,SAAS,CAACjoC,GAAV,CAAclH,CAAC,CAACqvC,MAAF,CAASR,GAAvB,CAAd;AACAnvC,MAAAA,OAAO;AACV;AACJ;;AACD,WAASsvC,yBAAT,CAAmCH,GAAnC,EAAwC;AACpC,WAAO1vC,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,eAAO,CAAC,CAAD,EAAI,IAAIhH,OAAJ,CAAY,UAAUD,OAAV,EAAmB;AAClC,cAAI0I,MAAM,CAACknC,cAAP,IAAyB,OAAOA,cAAc,CAACC,WAAtB,KAAsC,UAAnE,EAA+E;AAC3ED,YAAAA,cAAc,CAACC,WAAf,CAA2BV,GAA3B,EAAgCzuC,IAAhC,CAAqCV,OAArC;AACH,WAFD,MAGK,IAAIwvC,qBAAJ,EAA2B;AAC5BC,YAAAA,SAAS,CAAC57B,GAAV,CAAcs7B,GAAd,EAAmBnvC,OAAnB;AACAqG,YAAAA,QAAQ,CAACypC,aAAT,CAAuB,IAAIC,WAAJ,CAAgB,oCAAhB,EAAsD;AAAEJ,cAAAA,MAAM,EAAE;AAAER,gBAAAA,GAAG,EAAEA;AAAP;AAAV,aAAtD,CAAvB;AACH,WAHI,MAIA;AACD,gBAAIa,gBAAgB,GAAG,YAAY;AAC/B,kBAAIT,QAAQ,GAAGP,eAAe,CAACxnC,GAAhB,CAAoB2nC,GAApB,CAAf;;AACA,kBAAII,QAAQ,IAAIA,QAAQ,CAACz7B,IAAT,GAAgB,CAAhC,EAAmC;AAC/B,oBAAIy7B,QAAQ,CAAClT,MAAT,GAAkBh8B,IAAlB,GAAyBN,KAAzB,CAA+BooB,OAA/B,CAAuC,UAAvC,CAAJ,EAAwD;AACpDnoB,kBAAAA,OAAO;AACV,iBAFD,MAGK;AACDmN,kBAAAA,qBAAqB,CAAC6iC,gBAAD,CAArB;AACH;AACJ;AACJ,aAVD;;AAWA7iC,YAAAA,qBAAqB,CAAC6iC,gBAAD,CAArB;AACH;AACJ,SAtBM,CAAJ,CAAP;AAuBH,OAxBiB,CAAlB;AAyBH,KA1Be,CAAhB;AA2BH;;AACD,WAASC,8BAAT,CAAwCpmC,QAAxC,EAAkD;AAC9ColC,IAAAA,0BAA0B,GAAGplC,QAA7B;AACH;;AACD,WAASqmC,mCAAT,GAA+C;AAC3CjB,IAAAA,0BAA0B,GAAG,IAA7B;AACAD,IAAAA,eAAe,CAACp9B,KAAhB;AACAvL,IAAAA,QAAQ,CAACyL,mBAAT,CAA6B,yBAA7B,EAAwD49B,eAAxD;AACH;;AACD,WAASS,oBAAT,CAA8BC,aAA9B,EAA6CxG,MAA7C,EAAqD9I,oBAArD,EAA2E;AACvEuP,IAAAA,2BAA2B;AAC3B,QAAItG,UAAU,GAAG,IAAInhC,GAAJ,CAAQwnC,aAAR,CAAjB;AACA,QAAIE,iBAAiB,GAAG,IAAIp9B,OAAJ,EAAxB;AACA,QAAIq9B,iBAAiB,GAAG,IAAIr9B,OAAJ,EAAxB;;AACA,aAASs9B,iBAAT,CAA2Bj6B,KAA3B,EAAkC;AAC9B+5B,MAAAA,iBAAiB,CAACz8B,GAAlB,CAAsB0C,KAAtB,EAA6BA,KAAK,CAACk6B,sBAAnC;AACAF,MAAAA,iBAAiB,CAAC18B,GAAlB,CAAsB0C,KAAtB,EAA6BA,KAAK,CAACyzB,kBAAnC;AACH;;AACD,aAAS0G,mBAAT,CAA6Bn6B,KAA7B,EAAoC;AAChC+5B,MAAAA,iBAAiB,CAAC/+B,MAAlB,CAAyBgF,KAAzB;AACAg6B,MAAAA,iBAAiB,CAACh/B,MAAlB,CAAyBgF,KAAzB;AACH;;AACD,aAASo6B,sBAAT,CAAgCp6B,KAAhC,EAAuC;AACnC,aAAQA,KAAK,CAACk6B,sBAAN,KAAiCH,iBAAiB,CAAC9oC,GAAlB,CAAsB+O,KAAtB,CAAjC,IACJA,KAAK,CAACyzB,kBAAN,KAA6BuG,iBAAiB,CAAC/oC,GAAlB,CAAsB+O,KAAtB,CADjC;AAEH;;AACD65B,IAAAA,aAAa,CAAC3mC,OAAd,CAAsB+mC,iBAAtB;;AACA,aAASI,qBAAT,CAA+BC,UAA/B,EAA2C;AACvC,UAAIC,aAAa,GAAGD,UAAU,CAACC,aAA/B;AAAA,UAA8CC,aAAa,GAAGF,UAAU,CAACE,aAAzE;AAAA,UAAwFC,WAAW,GAAGH,UAAU,CAACG,WAAjH;AACAF,MAAAA,aAAa,CAACrnC,OAAd,CAAsB,UAAU1K,CAAV,EAAa;AAAE,eAAOyxC,iBAAiB,CAACzxC,CAAD,CAAxB;AAA8B,OAAnE;AACAiyC,MAAAA,WAAW,CAACvnC,OAAZ,CAAoB,UAAU1K,CAAV,EAAa;AAAE,eAAOyxC,iBAAiB,CAACzxC,CAAD,CAAxB;AAA8B,OAAjE;AACAgyC,MAAAA,aAAa,CAACtnC,OAAd,CAAsB,UAAU1K,CAAV,EAAa;AAAE,eAAO2xC,mBAAmB,CAAC3xC,CAAD,CAA1B;AAAgC,OAArE;AACA+xC,MAAAA,aAAa,CAACrnC,OAAd,CAAsB,UAAU1K,CAAV,EAAa;AAAE,eAAOgrC,UAAU,CAACjgC,GAAX,CAAe/K,CAAf,CAAP;AAA2B,OAAhE;AACAgyC,MAAAA,aAAa,CAACtnC,OAAd,CAAsB,UAAU1K,CAAV,EAAa;AAAE,eAAOgrC,UAAU,CAACx4B,MAAX,CAAkBxS,CAAlB,CAAP;AAA8B,OAAnE;;AACA,UAAI+xC,aAAa,CAACh9B,IAAd,GAAqBi9B,aAAa,CAACj9B,IAAnC,GAA0Ck9B,WAAW,CAACl9B,IAAtD,GAA6D,CAAjE,EAAoE;AAChE81B,QAAAA,MAAM,CAAC;AACHqH,UAAAA,OAAO,EAAExuC,KAAK,CAACH,IAAN,CAAWwuC,aAAX,CADN;AAEHI,UAAAA,OAAO,EAAEzuC,KAAK,CAACH,IAAN,CAAWyuC,aAAX,CAFN;AAGHI,UAAAA,KAAK,EAAE1uC,KAAK,CAACH,IAAN,CAAW0uC,WAAX,CAHJ;AAIHI,UAAAA,OAAO,EAAE;AAJN,SAAD,CAAN;AAMH;AACJ;;AACD,aAASC,wBAAT,CAAkCpqC,EAAlC,EAAsC;AAClC,UAAIoL,SAAS,GAAGpL,EAAE,CAACoL,SAAnB;AAAA,UAA8BE,KAAK,GAAGtL,EAAE,CAACsL,KAAzC;AAAA,UAAgDD,SAAS,GAAGrL,EAAE,CAACqL,SAA/D;AACA,UAAIw+B,aAAa,GAAG,IAAIloC,GAAJ,EAApB;AACA,UAAImoC,aAAa,GAAG,IAAInoC,GAAJ,EAApB;AACA,UAAIooC,WAAW,GAAG,IAAIpoC,GAAJ,EAAlB;AACAyJ,MAAAA,SAAS,CAAC5I,OAAV,CAAkB,UAAU2E,IAAV,EAAgB;AAAE,eAAO+6B,mBAAmB,CAAC/6B,IAAD,CAAnB,CAA0B3E,OAA1B,CAAkC,UAAU8M,KAAV,EAAiB;AAAE,iBAAOu6B,aAAa,CAAChnC,GAAd,CAAkByM,KAAlB,CAAP;AAAkC,SAAvF,CAAP;AAAkG,OAAtI;AACAjE,MAAAA,SAAS,CAAC7I,OAAV,CAAkB,UAAU2E,IAAV,EAAgB;AAAE,eAAO+6B,mBAAmB,CAAC/6B,IAAD,CAAnB,CAA0B3E,OAA1B,CAAkC,UAAU8M,KAAV,EAAiB;AAAE,iBAAOw6B,aAAa,CAACjnC,GAAd,CAAkByM,KAAlB,CAAP;AAAkC,SAAvF,CAAP;AAAkG,OAAtI;AACAhE,MAAAA,KAAK,CAAC9I,OAAN,CAAc,UAAU2E,IAAV,EAAgB;AAAE,eAAO+6B,mBAAmB,CAAC/6B,IAAD,CAAnB,CAA0B3E,OAA1B,CAAkC,UAAU8M,KAAV,EAAiB;AAAE,iBAAOy6B,WAAW,CAAClnC,GAAZ,CAAgByM,KAAhB,CAAP;AAAgC,SAArF,CAAP;AAAgG,OAAhI;AACAq6B,MAAAA,qBAAqB,CAAC;AAAEE,QAAAA,aAAa,EAAEA,aAAjB;AAAgCC,QAAAA,aAAa,EAAEA,aAA/C;AAA8DC,QAAAA,WAAW,EAAEA;AAA3E,OAAD,CAArB;AACA3+B,MAAAA,SAAS,CAAC5I,OAAV,CAAkB,UAAUxK,CAAV,EAAa;AAC3BoR,QAAAA,kBAAkB,CAACpR,CAAD,EAAIqyC,6BAAJ,CAAlB;AACApC,QAAAA,wBAAwB,CAACjwC,CAAD,CAAxB;AACH,OAHD;AAIH;;AACD,aAASsyC,uBAAT,CAAiCjhC,IAAjC,EAAuC;AACnC,UAAIkhC,MAAM,GAAG,IAAI5oC,GAAJ,CAAQugC,mBAAmB,CAAC74B,IAAD,CAA3B,CAAb;AACA,UAAIwgC,aAAa,GAAG,IAAIloC,GAAJ,EAApB;AACA,UAAImoC,aAAa,GAAG,IAAInoC,GAAJ,EAApB;AACA,UAAIooC,WAAW,GAAG,IAAIpoC,GAAJ,EAAlB;AACA4oC,MAAAA,MAAM,CAAC/nC,OAAP,CAAe,UAAU1K,CAAV,EAAa;AACxB,YAAI,CAACgrC,UAAU,CAACl3B,GAAX,CAAe9T,CAAf,CAAL,EAAwB;AACpB+xC,UAAAA,aAAa,CAAChnC,GAAd,CAAkB/K,CAAlB;AACH;AACJ,OAJD;AAKAgrC,MAAAA,UAAU,CAACtgC,OAAX,CAAmB,UAAU1K,CAAV,EAAa;AAC5B,YAAI,CAACyyC,MAAM,CAAC3+B,GAAP,CAAW9T,CAAX,CAAL,EAAoB;AAChBgyC,UAAAA,aAAa,CAACjnC,GAAd,CAAkB/K,CAAlB;AACH;AACJ,OAJD;AAKAyyC,MAAAA,MAAM,CAAC/nC,OAAP,CAAe,UAAU1K,CAAV,EAAa;AACxB,YAAI,CAAC+xC,aAAa,CAACj+B,GAAd,CAAkB9T,CAAlB,CAAD,IAAyB,CAACgyC,aAAa,CAACl+B,GAAd,CAAkB9T,CAAlB,CAA1B,IAAkD4xC,sBAAsB,CAAC5xC,CAAD,CAA5E,EAAiF;AAC7EiyC,UAAAA,WAAW,CAAClnC,GAAZ,CAAgB/K,CAAhB;AACH;AACJ,OAJD;AAKA6xC,MAAAA,qBAAqB,CAAC;AAAEE,QAAAA,aAAa,EAAEA,aAAjB;AAAgCC,QAAAA,aAAa,EAAEA,aAA/C;AAA8DC,QAAAA,WAAW,EAAEA;AAA3E,OAAD,CAArB;AACA3gC,MAAAA,kBAAkB,CAACC,IAAD,EAAOghC,6BAAP,CAAlB;AACApC,MAAAA,wBAAwB,CAAC5+B,IAAD,CAAxB;AACH;;AACD,aAASkxB,wBAAT,CAAkCvvB,SAAlC,EAA6C;AACzC,UAAIw/B,aAAa,GAAG,IAAI7oC,GAAJ,EAApB;AACA,UAAImoC,aAAa,GAAG,IAAInoC,GAAJ,EAApB;AACAqJ,MAAAA,SAAS,CAACxI,OAAV,CAAkB,UAAU1H,CAAV,EAAa;AAC3B,YAAI2/B,MAAM,GAAG3/B,CAAC,CAAC2/B,MAAf;;AACA,YAAIA,MAAM,CAACjvB,WAAX,EAAwB;AACpB,cAAIm2B,iBAAiB,CAAClH,MAAD,CAArB,EAA+B;AAC3B+P,YAAAA,aAAa,CAAC3nC,GAAd,CAAkB43B,MAAlB;AACH,WAFD,MAGK,IAAIA,MAAM,YAAYqH,eAAlB,IAAqCrH,MAAM,CAACsH,QAAhD,EAA0D;AAC3D+H,YAAAA,aAAa,CAACjnC,GAAd,CAAkB43B,MAAlB;AACH;AACJ;AACJ,OAVD;;AAWA,UAAI+P,aAAa,CAAC39B,IAAd,GAAqBi9B,aAAa,CAACj9B,IAAnC,GAA0C,CAA9C,EAAiD;AAC7C81B,QAAAA,MAAM,CAAC;AACHwH,UAAAA,OAAO,EAAE3uC,KAAK,CAACH,IAAN,CAAWmvC,aAAX,CADN;AAEHR,UAAAA,OAAO,EAAE,EAFN;AAGHC,UAAAA,OAAO,EAAEzuC,KAAK,CAACH,IAAN,CAAWyuC,aAAX,CAHN;AAIHI,UAAAA,KAAK,EAAE;AAJJ,SAAD,CAAN;AAMH;AACJ;;AACD,aAASnhC,OAAT,CAAiBM,IAAjB,EAAuB;AACnB,UAAI+wB,YAAY,GAAGluB,2BAA2B,CAAC7C,IAAD,EAAO;AACjDqD,QAAAA,gBAAgB,EAAE09B,wBAD+B;AAEjD59B,QAAAA,eAAe,EAAE89B;AAFgC,OAAP,CAA9C;AAIA,UAAI5P,YAAY,GAAG,IAAI7xB,gBAAJ,CAAqB0xB,wBAArB,CAAnB;AACAG,MAAAA,YAAY,CAAC3xB,OAAb,CAAqBM,IAArB,EAA2B;AAAEuxB,QAAAA,UAAU,EAAE,IAAd;AAAoBC,QAAAA,eAAe,EAAE,CAAC,KAAD,EAAQ,UAAR,EAAoB,OAApB,CAArC;AAAmEluB,QAAAA,OAAO,EAAE;AAA5E,OAA3B;AACAk7B,MAAAA,SAAS,CAACltC,IAAV,CAAey/B,YAAf,EAA6BM,YAA7B;AACAoN,MAAAA,aAAa,CAACjlC,GAAd,CAAkBwG,IAAlB;AACH;;AACD,aAASghC,6BAAT,CAAuCljC,IAAvC,EAA6C;AACzC,UAAIwC,UAAU,GAAGxC,IAAI,CAACwC,UAAtB;;AACA,UAAIA,UAAU,IAAI,IAAd,IAAsBm+B,aAAa,CAACl8B,GAAd,CAAkBjC,UAAlB,CAA1B,EAAyD;AACrD;AACH;;AACDZ,MAAAA,OAAO,CAACY,UAAD,CAAP;AACAkwB,MAAAA,oBAAoB,CAAClwB,UAAD,CAApB;AACH;;AACDZ,IAAAA,OAAO,CAAC3J,QAAD,CAAP;AACAgK,IAAAA,kBAAkB,CAAChK,QAAQ,CAAC02B,eAAV,EAA2BuU,6BAA3B,CAAlB;AACArB,IAAAA,8BAA8B,CAAC,UAAUyB,KAAV,EAAiB;AAC5C,UAAIC,SAAS,GAAG,EAAhB;AACAD,MAAAA,KAAK,CAACjoC,OAAN,CAAc,UAAUu3B,IAAV,EAAgB;AAAE,eAAOp/B,IAAI,CAAC+vC,SAAD,EAAYxI,mBAAmB,CAACnI,IAAI,CAACpwB,UAAN,CAA/B,CAAX;AAA+D,OAA/F;AACAg5B,MAAAA,MAAM,CAAC;AAAEqH,QAAAA,OAAO,EAAEU,SAAX;AAAsBP,QAAAA,OAAO,EAAE,EAA/B;AAAmCF,QAAAA,OAAO,EAAE,EAA5C;AAAgDC,QAAAA,KAAK,EAAE;AAAvD,OAAD,CAAN;AACAO,MAAAA,KAAK,CAACjoC,OAAN,CAAc,UAAUu3B,IAAV,EAAgB;AAC1B,YAAIpwB,UAAU,GAAGowB,IAAI,CAACpwB,UAAtB;;AACA,YAAIA,UAAU,IAAI,IAAlB,EAAwB;AACpB;AACH;;AACD0gC,QAAAA,6BAA6B,CAACtQ,IAAD,CAA7B;AACA3wB,QAAAA,kBAAkB,CAACO,UAAD,EAAa0gC,6BAAb,CAAlB;AACApC,QAAAA,wBAAwB,CAACt+B,UAAD,CAAxB;AACH,OARD;AASH,KAb6B,CAA9B;AAcAvK,IAAAA,QAAQ,CAACH,gBAAT,CAA0B,yBAA1B,EAAqDwpC,eAArD;AACAR,IAAAA,wBAAwB,CAAC7oC,QAAD,CAAxB;AACH;;AACD,WAASurC,cAAT,GAA0B;AACtB9C,IAAAA,SAAS,CAACrlC,OAAV,CAAkB,UAAU3H,CAAV,EAAa;AAAE,aAAOA,CAAC,CAACqO,UAAF,EAAP;AAAwB,KAAzD;AACA2+B,IAAAA,SAAS,CAACnhC,MAAV,CAAiB,CAAjB,EAAoBmhC,SAAS,CAAC3vC,MAA9B;AACA4vC,IAAAA,aAAa,GAAG,IAAI7N,OAAJ,EAAhB;AACH;;AACD,WAASmP,2BAAT,GAAuC;AACnCuB,IAAAA,cAAc;AACd1B,IAAAA,mCAAmC;AACtC;;AAED,WAAS2B,MAAT,CAAgBC,MAAhB,EAAwB;AACpB,WAAQ,CAACA,MAAM,GAAG,EAAT,GAAc,GAAd,GAAoB,EAArB,IAA2BA,MAAM,CAACr4B,QAAP,CAAgB,EAAhB,CAAnC;AACH;;AACD,WAASs4B,WAAT,GAAuB;AACnB,QAAI,gBAAgBC,MAApB,EAA4B;AACxB,UAAIC,IAAI,GAAGD,MAAM,CAACE,UAAP,EAAX;AACA,aAAOD,IAAI,CAAC54B,SAAL,CAAe,CAAf,EAAkB,CAAlB,IAAuB44B,IAAI,CAAC54B,SAAL,CAAe,CAAf,EAAkB,EAAlB,CAAvB,GAA+C44B,IAAI,CAAC54B,SAAL,CAAe,EAAf,EAAmB,EAAnB,CAA/C,GAAwE44B,IAAI,CAAC54B,SAAL,CAAe,EAAf,EAAmB,EAAnB,CAAxE,GAAiG44B,IAAI,CAAC54B,SAAL,CAAe,EAAf,CAAxG;AACH;;AACD,WAAO5W,KAAK,CAACH,IAAN,CAAW0vC,MAAM,CAACG,eAAP,CAAuB,IAAIC,UAAJ,CAAe,EAAf,CAAvB,CAAX,EAAuDl8B,GAAvD,CAA2D,UAAU6B,CAAV,EAAa;AAAE,aAAO85B,MAAM,CAAC95B,CAAD,CAAb;AAAmB,KAA7F,EAA+FzP,IAA/F,CAAoG,EAApG,CAAP;AACH;;AAED,MAAI+pC,qBAAqB,GAAG,IAAIn/B,OAAJ,EAA5B;AACA,MAAIo/B,YAAY,GAAG,IAAIpR,OAAJ,EAAnB;;AACA,WAASqR,+BAAT,CAAyCnkC,IAAzC,EAA+C;AAC3C,QAAIi8B,qBAAqB,GAAG,KAA5B;;AACA,aAASmI,WAAT,CAAqBxU,KAArB,EAA4ByU,QAA5B,EAAsC;AAClC,UAAIC,SAAS,GAAGtwC,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACoM,IAAI,CAACukC,kBAAN,CAAX,CAA7B;;AACA,UAAIC,UAAU,GAAGF,SAAS,CAACx5B,OAAV,CAAkB8kB,KAAlB,CAAjB;AACA,UAAI6U,aAAa,GAAGH,SAAS,CAACx5B,OAAV,CAAkBu5B,QAAlB,CAApB;;AACA,UAAIG,UAAU,KAAKC,aAAa,GAAG,CAAnC,EAAsC;AAClC;AACH;;AACD,UAAIA,aAAa,IAAI,CAArB,EAAwB;AACpBH,QAAAA,SAAS,CAAC/kC,MAAV,CAAiBklC,aAAjB,EAAgC,CAAhC;AACH;;AACDH,MAAAA,SAAS,CAAC/kC,MAAV,CAAiBilC,UAAU,GAAG,CAA9B,EAAiC,CAAjC,EAAoCH,QAApC;AACArkC,MAAAA,IAAI,CAACukC,kBAAL,GAA0BD,SAA1B;AACH;;AACD,aAASjF,OAAT,GAAmB;AACfpD,MAAAA,qBAAqB,GAAG,IAAxB;;AACA,UAAIqI,SAAS,GAAGtwC,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACoM,IAAI,CAACukC,kBAAN,CAAX,CAA7B;;AACAvkC,MAAAA,IAAI,CAACukC,kBAAL,CAAwBlpC,OAAxB,CAAgC,UAAUqpC,iBAAV,EAA6B;AACzD,YAAIR,YAAY,CAACz/B,GAAb,CAAiBigC,iBAAjB,CAAJ,EAAyC;AACrC,cAAID,aAAa,GAAGH,SAAS,CAACx5B,OAAV,CAAkB45B,iBAAlB,CAApB;;AACA,cAAID,aAAa,IAAI,CAArB,EAAwB;AACpBH,YAAAA,SAAS,CAAC/kC,MAAV,CAAiBklC,aAAjB,EAAgC,CAAhC;AACH;;AACDR,UAAAA,qBAAqB,CAAC9gC,MAAtB,CAA6BuhC,iBAA7B;AACAR,UAAAA,YAAY,CAAC/gC,MAAb,CAAoBuhC,iBAApB;AACH;AACJ,OATD;AAUA1kC,MAAAA,IAAI,CAACukC,kBAAL,GAA0BD,SAA1B;AACH;;AACD,aAASrG,MAAT,CAAgBxiB,KAAhB,EAAuB2b,mBAAvB,EAA4C;AACxCp3B,MAAAA,IAAI,CAACukC,kBAAL,CAAwBlpC,OAAxB,CAAgC,UAAUu0B,KAAV,EAAiB;AAC7C,YAAIsU,YAAY,CAACz/B,GAAb,CAAiBmrB,KAAjB,CAAJ,EAA6B;AACzB;AACH;;AACD,YAAI9oB,KAAK,GAAG8oB,KAAK,CAAC9oB,KAAlB;AACA,YAAIu9B,QAAQ,GAAG,IAAIM,aAAJ,EAAf;;AACA,iBAASzG,qBAAT,GAAiC;AAC7B,eAAK,IAAIttC,CAAC,GAAGyzC,QAAQ,CAACj9B,QAAT,CAAkBrW,MAAlB,GAA2B,CAAxC,EAA2CH,CAAC,IAAI,CAAhD,EAAmDA,CAAC,EAApD,EAAwD;AACpDyzC,YAAAA,QAAQ,CAACxU,UAAT,CAAoBj/B,CAApB;AACH;;AACDwzC,UAAAA,WAAW,CAACxU,KAAD,EAAQyU,QAAR,CAAX;AACAJ,UAAAA,qBAAqB,CAACx+B,GAAtB,CAA0BmqB,KAA1B,EAAiCyU,QAAjC;AACAH,UAAAA,YAAY,CAACxoC,GAAb,CAAiB2oC,QAAjB;AACA,iBAAOA,QAAP;AACH;;AACD,YAAIlI,aAAa,GAAG1F,wBAAwB,EAA5C;AACA0F,QAAAA,aAAa,CAACjF,WAAd,CAA0B;AACtBI,UAAAA,YAAY,EAAE4G,qBADQ;AAEtB/G,UAAAA,cAAc,EAAErwB,KAFM;AAGtB2U,UAAAA,KAAK,EAAEA,KAHe;AAItB2b,UAAAA,mBAAmB,EAAEA,mBAJC;AAKtBC,UAAAA,KAAK,EAAE,KALe;AAMtBE,UAAAA,gBAAgB,EAAE,YAAY;AAAE,mBAAO0E,qBAAP;AAA+B;AANzC,SAA1B;AAQH,OAxBD;AAyBH;;AACD,WAAO;AACHgC,MAAAA,MAAM,EAAEA,MADL;AAEHoB,MAAAA,OAAO,EAAEA;AAFN,KAAP;AAIH;;AAED,WAASuF,WAAT,GAAuB;AACnB3sC,IAAAA,QAAQ,CAACypC,aAAT,CAAuB,IAAIC,WAAJ,CAAgB,oCAAhB,CAAvB;AACA,QAAIkD,iBAAiB,GAAGr0C,MAAM,CAACs0C,wBAAP,CAAgCH,aAAa,CAAC1zC,SAA9C,EAAyD,SAAzD,CAAxB;AACA,QAAI8zC,oBAAoB,GAAGv0C,MAAM,CAACs0C,wBAAP,CAAgCH,aAAa,CAAC1zC,SAA9C,EAAyD,YAAzD,CAA3B;AACA,QAAI+zC,oBAAoB,GAAGx0C,MAAM,CAACs0C,wBAAP,CAAgCH,aAAa,CAAC1zC,SAA9C,EAAyD,YAAzD,CAA3B;AACA,QAAIg0C,oBAAoB,GAAGz0C,MAAM,CAACs0C,wBAAP,CAAgCH,aAAa,CAAC1zC,SAA9C,EAAyD,YAAzD,CAA3B;AACA,QAAIi0C,6BAA6B,GAAG10C,MAAM,CAACs0C,wBAAP,CAAgC1S,QAAQ,CAACnhC,SAAzC,EAAoD,aAApD,CAApC;AACA,QAAIk0C,qBAAqB,GAAGz+B,QAAQ,CAAC0+B,QAAT,CAAkBlsC,QAAlB,CAA2B,WAA3B,CAA5B;AACA,QAAImsC,8BAA8B,GAAGF,qBAAqB,GACtD30C,MAAM,CAACs0C,wBAAP,CAAgC1gC,OAAO,CAACnT,SAAxC,EAAmD,sBAAnD,CADsD,GACuB,IADjF;;AAEA,QAAI0uC,OAAO,GAAG,YAAY;AACtBnvC,MAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,SAA/C,EAA0D4zC,iBAA1D;AACAr0C,MAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,YAA/C,EAA6D8zC,oBAA7D;AACAv0C,MAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,YAA/C,EAA6D+zC,oBAA7D;AACAx0C,MAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,YAA/C,EAA6Dg0C,oBAA7D;AACAhtC,MAAAA,QAAQ,CAACyL,mBAAT,CAA6B,uBAA7B,EAAsDi8B,OAAtD;AACA1nC,MAAAA,QAAQ,CAACyL,mBAAT,CAA6B,oCAA7B,EAAmE6hC,oBAAnE;AACA/0C,MAAAA,MAAM,CAAC80C,cAAP,CAAsBlT,QAAQ,CAACnhC,SAA/B,EAA0C,aAA1C,EAAyDi0C,6BAAzD;;AACA,UAAIC,qBAAJ,EAA2B;AACvB30C,QAAAA,MAAM,CAAC80C,cAAP,CAAsBlhC,OAAO,CAACnT,SAA9B,EAAyC,sBAAzC,EAAiEo0C,8BAAjE;AACH;AACJ,KAXD;;AAYA,QAAIE,oBAAoB,GAAG,UAAUrzC,CAAV,EAAa;AACpCsvC,MAAAA,cAAc,CAACC,WAAf,CAA2BvvC,CAAC,CAACqvC,MAAF,CAASR,GAApC,EAAyCzuC,IAAzC,CAA8C,YAAY;AACtD2F,QAAAA,QAAQ,CAACypC,aAAT,CAAuB,IAAIC,WAAJ,CAAgB,yBAAhB,EAA2C;AAAEJ,UAAAA,MAAM,EAAE;AAAER,YAAAA,GAAG,EAAE7uC,CAAC,CAACqvC,MAAF,CAASR;AAAhB;AAAV,SAA3C,CAAvB;AACH,OAFD;AAGH,KAJD;;AAKA9oC,IAAAA,QAAQ,CAACH,gBAAT,CAA0B,uBAA1B,EAAmD6nC,OAAnD;AACA1nC,IAAAA,QAAQ,CAACH,gBAAT,CAA0B,oCAA1B,EAAgEytC,oBAAhE;AACA,QAAIC,gBAAgB,GAAG,IAAIC,KAAJ,CAAU,2BAAV,CAAvB;;AACA,aAASC,YAAT,CAAsBvN,QAAtB,EAAgChwB,KAAhC,EAAuC6C,KAAvC,EAA8C;AAC1C65B,MAAAA,iBAAiB,CAAClzC,KAAlB,CAAwBR,IAAxB,CAA6B,IAA7B,EAAmCgnC,QAAnC,EAA6ChwB,KAA7C,EAAoD6C,KAApD;;AACA,UAAI,KAAKyd,SAAL,IAAkB,CAAC,KAAKA,SAAL,CAAeoS,SAAf,CAAyBC,QAAzB,CAAkC,YAAlC,CAAvB,EAAwE;AACpE,aAAKrS,SAAL,CAAeiZ,aAAf,CAA6B8D,gBAA7B;AACH;;AACD,aAAO,CAAC,CAAR;AACH;;AACD,aAASG,eAAT,CAAyB1+B,IAAzB,EAA+B+D,KAA/B,EAAsC;AAClC,UAAI46B,WAAW,GAAGb,oBAAoB,CAACpzC,KAArB,CAA2BR,IAA3B,CAAgC,IAAhC,EAAsC8V,IAAtC,EAA4C+D,KAA5C,CAAlB;;AACA,UAAI,KAAKyd,SAAL,IAAkB,CAAC,KAAKA,SAAL,CAAeoS,SAAf,CAAyBC,QAAzB,CAAkC,YAAlC,CAAvB,EAAwE;AACpE,aAAKrS,SAAL,CAAeiZ,aAAf,CAA6B8D,gBAA7B;AACH;;AACD,aAAOI,WAAP;AACH;;AACD,aAASC,eAAT,CAAyB76B,KAAzB,EAAgC;AAC5Bg6B,MAAAA,oBAAoB,CAACrzC,KAArB,CAA2BR,IAA3B,CAAgC,IAAhC,EAAsC6Z,KAAtC;;AACA,UAAI,KAAKyd,SAAL,IAAkB,CAAC,KAAKA,SAAL,CAAeoS,SAAf,CAAyBC,QAAzB,CAAkC,YAAlC,CAAvB,EAAwE;AACpE,aAAKrS,SAAL,CAAeiZ,aAAf,CAA6B8D,gBAA7B;AACH;AACJ;;AACD,aAASM,eAAT,CAAyB96B,KAAzB,EAAgC;AAC5Bi6B,MAAAA,oBAAoB,CAACtzC,KAArB,CAA2BR,IAA3B,CAAgC,IAAhC,EAAsC6Z,KAAtC;;AACA,UAAI,KAAKyd,SAAL,IAAkB,CAAC,KAAKA,SAAL,CAAeoS,SAAf,CAAyBC,QAAzB,CAAkC,YAAlC,CAAvB,EAAwE;AACpE,aAAKrS,SAAL,CAAeiZ,aAAf,CAA6B8D,gBAA7B;AACH;AACJ;;AACD,aAASO,wBAAT,GAAoC;AAChC,UAAIC,SAAS,GAAGd,6BAA6B,CAAC9rC,GAA9B,CAAkCjI,IAAlC,CAAuC,IAAvC,CAAhB;;AACA,UAAIg4B,QAAQ,GAAGn1B,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACoyC,SAAD,CAAX,CAAb,CAAqC9mB,MAArC,CAA4C,UAAU/X,UAAV,EAAsB;AAC7E,eAAO,CAACA,UAAU,CAACshB,SAAX,CAAqBoS,SAArB,CAA+BC,QAA/B,CAAwC,YAAxC,CAAR;AACH,OAFc,CAAf;;AAGA,aAAOtqC,MAAM,CAACy1C,cAAP,CAAsB9c,QAAtB,EAAgC+c,cAAc,CAACj1C,SAA/C,CAAP;AACH;;AACD,aAASk1C,yBAAT,CAAmCnF,OAAnC,EAA4C;AACxC,UAAIvgB,KAAK,GAAG,IAAZ;;AACA,UAAI2lB,sBAAsB,GAAG,YAAY;AACrC,YAAIjF,QAAQ,GAAGkE,8BAA8B,CAAC1zC,KAA/B,CAAqCR,IAArC,CAA0CsvB,KAA1C,EAAiDugB,OAAjD,CAAf;;AACA,YAAIA,OAAO,KAAK,OAAhB,EAAyB;AACrBG,UAAAA,QAAQ,GAAG3wC,MAAM,CAACy1C,cAAP,CAAsBjyC,aAAa,CAAC,EAAD,EAAKJ,MAAM,CAACutC,QAAD,CAAX,CAAb,CAAoCjiB,MAApC,CAA2C,UAAU+U,OAAV,EAAmB;AAC3F,mBAAO,CAACA,OAAO,CAAC4G,SAAR,CAAkBC,QAAlB,CAA2B,YAA3B,CAAR;AACH,WAFgC,CAAtB,EAEPuL,QAAQ,CAACp1C,SAFF,CAAX;AAGH;;AACD,eAAOkwC,QAAP;AACH,OARD;;AASA,UAAIA,QAAQ,GAAGiF,sBAAsB,EAArC;AACA,UAAIE,gBAAgB,GAAG;AACnBltC,QAAAA,GAAG,EAAE,UAAU3G,CAAV,EAAa2V,QAAb,EAAuB;AACxB,iBAAOg+B,sBAAsB,GAAGh+B,QAAH,CAA7B;AACH;AAHkB,OAAvB;AAKA+4B,MAAAA,QAAQ,GAAG,IAAIoF,KAAJ,CAAUpF,QAAV,EAAoBmF,gBAApB,CAAX;AACA,aAAOnF,QAAP;AACH;;AACD3wC,IAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,SAA/C,EAA0DT,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBo0C,iBAAlB,EAAqC;AAAElzC,MAAAA,KAAK,EAAE+zC;AAAT,KAArC,CAA1D;AACAl1C,IAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,YAA/C,EAA6DT,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBs0C,oBAAlB,EAAwC;AAAEpzC,MAAAA,KAAK,EAAEg0C;AAAT,KAAxC,CAA7D;AACAn1C,IAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,YAA/C,EAA6DT,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBu0C,oBAAlB,EAAwC;AAAErzC,MAAAA,KAAK,EAAEk0C;AAAT,KAAxC,CAA7D;AACAr1C,IAAAA,MAAM,CAAC80C,cAAP,CAAsBX,aAAa,CAAC1zC,SAApC,EAA+C,YAA/C,EAA6DT,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBw0C,oBAAlB,EAAwC;AAAEtzC,MAAAA,KAAK,EAAEm0C;AAAT,KAAxC,CAA7D;AACAt1C,IAAAA,MAAM,CAAC80C,cAAP,CAAsBlT,QAAQ,CAACnhC,SAA/B,EAA0C,aAA1C,EAAyDT,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBy0C,6BAAlB,EAAiD;AAAE9rC,MAAAA,GAAG,EAAE2sC;AAAP,KAAjD,CAAzD;;AACA,QAAIZ,qBAAJ,EAA2B;AACvB30C,MAAAA,MAAM,CAAC80C,cAAP,CAAsBlhC,OAAO,CAACnT,SAA9B,EAAyC,sBAAzC,EAAiET,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB40C,8BAAlB,EAAkD;AAAE1zC,QAAAA,KAAK,EAAEw0C;AAAT,OAAlD,CAAjE;AACH;AACJ;;AAED,MAAIK,WAAW,GAAG7C,WAAW,EAA7B;AACA,MAAI8C,aAAa,GAAG,IAAI7hC,GAAJ,EAApB;AACA,MAAI8hC,oBAAoB,GAAG,EAA3B;AACA,MAAIxnB,MAAM,GAAG,IAAb;AACA,MAAIynB,KAAK,GAAG,IAAZ;AACA,MAAIC,UAAU,GAAG,IAAjB;AACA,MAAIC,6BAA6B,GAAG,IAApC;AACA,MAAIC,sBAAsB,GAAG,IAA7B;;AACA,WAASC,mBAAT,CAA6BC,SAA7B,EAAwC9kC,IAAxC,EAA8C;AAC1C,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAEA,MAAAA,IAAI,GAAGjK,QAAQ,CAACm+B,IAAT,IAAiBn+B,QAAxB;AAAmC;;AAC1D,QAAIg8B,OAAO,GAAG/xB,IAAI,CAAChK,aAAL,CAAmB,MAAM8uC,SAAzB,CAAd;;AACA,QAAI,CAAC/S,OAAL,EAAc;AACVA,MAAAA,OAAO,GAAGh8B,QAAQ,CAAC8N,aAAT,CAAuB,OAAvB,CAAV;AACAkuB,MAAAA,OAAO,CAAC4G,SAAR,CAAkBn/B,GAAlB,CAAsB,YAAtB;AACAu4B,MAAAA,OAAO,CAAC4G,SAAR,CAAkBn/B,GAAlB,CAAsBsrC,SAAtB;AACA/S,MAAAA,OAAO,CAAC5sB,KAAR,GAAgB,QAAhB;AACA4sB,MAAAA,OAAO,CAACsI,WAAR,GAAsB,EAAtB;AACH;;AACD,WAAOtI,OAAP;AACH;;AACD,WAASgT,oBAAT,CAA8BD,SAA9B,EAAyC9kC,IAAzC,EAA+C;AAC3C,QAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAEA,MAAAA,IAAI,GAAGjK,QAAQ,CAACm+B,IAAT,IAAiBn+B,QAAxB;AAAmC;;AAC1D,QAAIg8B,OAAO,GAAG/xB,IAAI,CAAChK,aAAL,CAAmB,MAAM8uC,SAAzB,CAAd;;AACA,QAAI,CAAC/S,OAAL,EAAc;AACVA,MAAAA,OAAO,GAAGh8B,QAAQ,CAAC8N,aAAT,CAAuB,QAAvB,CAAV;AACAkuB,MAAAA,OAAO,CAAC4G,SAAR,CAAkBn/B,GAAlB,CAAsB,YAAtB;AACAu4B,MAAAA,OAAO,CAAC4G,SAAR,CAAkBn/B,GAAlB,CAAsBsrC,SAAtB;AACH;;AACD,WAAO/S,OAAP;AACH;;AACD,MAAIiT,oBAAoB,GAAG,IAAItiC,GAAJ,EAA3B;;AACA,WAASuiC,wBAAT,CAAkCnnC,IAAlC,EAAwConC,KAAxC,EAA+C;AAC3CF,IAAAA,oBAAoB,CAACziC,GAArB,CAAyB2iC,KAAzB,KAAmCF,oBAAoB,CAAC9tC,GAArB,CAAyBguC,KAAzB,EAAgCjmC,IAAhC,EAAnC;AACA+lC,IAAAA,oBAAoB,CAACzhC,GAArB,CAAyB2hC,KAAzB,EAAgCjnC,oBAAoB,CAACH,IAAD,EAAO,QAAP,CAApD;AACH;;AACD,WAASqnC,yBAAT,GAAqC;AACjChsC,IAAAA,OAAO,CAAC6rC,oBAAoB,CAACjZ,MAArB,EAAD,EAAgC,UAAUqZ,OAAV,EAAmB;AAAE,aAAOA,OAAO,CAACnmC,IAAR,EAAP;AAAwB,KAA7E,CAAP;AACA+lC,IAAAA,oBAAoB,CAAC1jC,KAArB;AACH;;AACD,WAAS+jC,0BAAT,GAAsC;AAClC,QAAIC,aAAa,GAAGT,mBAAmB,CAAC,sBAAD,EAAyB9uC,QAAzB,CAAvC;AACAuvC,IAAAA,aAAa,CAACjL,WAAd,GAA4BnW,wBAAwB,CAAClH,MAAD,EAAS;AAAEmH,MAAAA,MAAM,EAAE;AAAV,KAAT,CAApD;AACApuB,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2BmmC,aAA3B,EAA0CvvC,QAAQ,CAACm+B,IAAT,CAAc70B,UAAxD;AACA4lC,IAAAA,wBAAwB,CAACK,aAAD,EAAgB,UAAhB,CAAxB;AACA,QAAIC,cAAc,GAAGV,mBAAmB,CAAC,wBAAD,CAAxC;AACAU,IAAAA,cAAc,CAAClL,WAAf,GAA6BvX,yBAAyB,CAAC9F,MAAD,EAAS0nB,UAAT,EAAqB1nB,MAAM,CAACzhB,mBAA5B,CAAtD;AACAxF,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2BomC,cAA3B,EAA2CD,aAAa,CAAClmC,WAAzD;AACA6lC,IAAAA,wBAAwB,CAACM,cAAD,EAAiB,YAAjB,CAAxB;AACA,QAAIC,SAAS,GAAGX,mBAAmB,CAAC,kBAAD,CAAnC;;AACA,QAAI7nB,MAAM,CAACpiB,OAAP,IAAkBoiB,MAAM,CAACliB,UAAP,GAAoB,CAA1C,EAA6C;AACzC0qC,MAAAA,SAAS,CAACnL,WAAV,GAAwBnd,eAAe,CAACF,MAAD,CAAvC;AACH,KAFD,MAGK;AACDwoB,MAAAA,SAAS,CAACnL,WAAV,GAAwB,EAAxB;AACH;;AACDtkC,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2BqmC,SAA3B,EAAsCF,aAAa,CAAClmC,WAApD;AACA6lC,IAAAA,wBAAwB,CAACO,SAAD,EAAY,MAAZ,CAAxB;AACA,QAAIC,WAAW,GAAGZ,mBAAmB,CAAC,oBAAD,CAArC;;AACA,QAAIJ,KAAK,IAAItyC,KAAK,CAACuzC,OAAN,CAAcjB,KAAK,CAACkB,MAApB,CAAT,IAAwClB,KAAK,CAACkB,MAAN,CAAa92C,MAAb,GAAsB,CAAlE,EAAqE;AACjE42C,MAAAA,WAAW,CAACpL,WAAZ,GAA0B,CACtBoK,KAAK,CAACkB,MAAN,CAAa3tC,IAAb,CAAkB,IAAlB,IAA0B,IADJ,EAEtB,iBAAiBqlB,iBAAiB,CAAChvB,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2uB,MAAL,CAAT,EAAuB;AAAEviB,QAAAA,QAAQ,EAAEuiB,MAAM,CAACziB,IAAP,KAAgB,CAAhB,GAAoByiB,MAAM,CAACviB,QAA3B,GAAsCuc,KAAK,CAACgG,MAAM,CAACviB,QAAP,GAAkB,EAAnB,EAAuB,CAAvB,EAA0B,GAA1B;AAAvD,OAAvB,CAAT,CAAlC,GAA8J,cAFxI,EAGtB,GAHsB,EAIxBzC,IAJwB,CAInB,IAJmB,CAA1B;AAKH,KAND,MAOK;AACDytC,MAAAA,WAAW,CAACpL,WAAZ,GAA0B,EAA1B;AACH;;AACDtkC,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2BsmC,WAA3B,EAAwCD,SAAS,CAACpmC,WAAlD;AACA6lC,IAAAA,wBAAwB,CAACQ,WAAD,EAAc,QAAd,CAAxB;AACA,QAAIG,WAAW,GAAGf,mBAAmB,CAAC,oBAAD,CAArC;AACAe,IAAAA,WAAW,CAACvL,WAAZ,GAA0BrK,sBAAsB,EAAhD;AACAj6B,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2BymC,WAA3B,EAAwCH,WAAW,CAACrmC,WAApD;AACA6lC,IAAAA,wBAAwB,CAACW,WAAD,EAAc,QAAd,CAAxB;AACA,QAAIC,aAAa,GAAGhB,mBAAmB,CAAC,sBAAD,CAAvC;AACAgB,IAAAA,aAAa,CAACxL,WAAd,GAA4BoK,KAAK,IAAIA,KAAK,CAACpsB,GAAf,GAAqBytB,mBAAmB,CAACrB,KAAK,CAACpsB,GAAP,CAAxC,GAAsD,EAAlF;AACAtiB,IAAAA,QAAQ,CAACm+B,IAAT,CAAc6R,WAAd,CAA0BF,aAA1B;AACAZ,IAAAA,wBAAwB,CAACY,aAAD,EAAgB,UAAhB,CAAxB;AACA,QAAIG,aAAa,GAAGnB,mBAAmB,CAAC,uBAAD,CAAvC;AACA,QAAIoB,eAAe,GAAG/iB,iBAAiB,CAAClG,MAAD,CAAvC;AACA,QAAI/hB,yBAAyB,GAAG+hB,MAAM,CAAC/hB,yBAAvC;AAAA,QAAkEC,mBAAmB,GAAG8hB,MAAM,CAAC9hB,mBAA/F;AAAA,QAAoHC,0BAA0B,GAAG6hB,MAAM,CAAC7hB,0BAAxJ;AAAA,QAAoLC,oBAAoB,GAAG4hB,MAAM,CAAC5hB,oBAAlN;AAAA,QAAwOb,IAAI,GAAGyiB,MAAM,CAACziB,IAAtP;AACA,QAAI2rC,qBAAqB,GAAG3rC,IAAI,KAAK,CAAT,GAAaY,0BAAb,GAA0CF,yBAAtE;AACA,QAAIkrC,eAAe,GAAG5rC,IAAI,KAAK,CAAT,GAAaa,oBAAb,GAAoCF,mBAA1D;AACAgrC,IAAAA,qBAAqB,GAAGjqB,qBAAqB,CAACxS,KAAK,CAACy8B,qBAAD,CAAN,EAA+BlpB,MAA/B,CAA7C;AACAmpB,IAAAA,eAAe,GAAGvpB,qBAAqB,CAACnT,KAAK,CAAC08B,eAAD,CAAN,EAAyBnpB,MAAzB,CAAvC;AACAgpB,IAAAA,aAAa,CAAC3L,WAAd,GAA4B,CACxB,SADwB,EAExB,yCAAyC6L,qBAAzC,GAAiE,GAFzC,EAGxB,mCAAmCC,eAAnC,GAAqD,GAH7B,EAIxB,2CAA2CF,eAAe,CAAC9iB,wBAA3D,GAAsF,GAJ9D,EAKxB,qCAAqC8iB,eAAe,CAAC7iB,wBAArD,GAAgF,GALxD,EAMxB,GANwB,EAO1BprB,IAP0B,CAOrB,IAPqB,CAA5B;AAQAjC,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2B6mC,aAA3B,EAA0CJ,WAAW,CAACxmC,WAAtD;AACA6lC,IAAAA,wBAAwB,CAACe,aAAD,EAAgB,WAAhB,CAAxB;AACA,QAAII,aAAa,GAAGvB,mBAAmB,CAAC,uBAAD,CAAvC;AACA9uC,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2BinC,aAA3B,EAA0CJ,aAAa,CAAC5mC,WAAxD;AACA,QAAIinC,WAAW,GAAGtB,oBAAoB,CAAC,mBAAD,CAAtC;AACAsB,IAAAA,WAAW,CAACC,MAAZ,CAAmB,MAAM5D,WAAN,GAAoB,KAAvC;AACA3sC,IAAAA,QAAQ,CAACm+B,IAAT,CAAc/0B,YAAd,CAA2BknC,WAA3B,EAAwCD,aAAa,CAAChnC,WAAtD;AACAinC,IAAAA,WAAW,CAACE,MAAZ;AACH;;AACD,MAAIC,wBAAwB,GAAG,IAAIluC,GAAJ,EAA/B;;AACA,WAASmuC,gCAAT,CAA0CzmC,IAA1C,EAAgD;AAC5C,QAAI4lC,WAAW,GAAGf,mBAAmB,CAAC,oBAAD,EAAuB7kC,IAAvB,CAArC;AACA4lC,IAAAA,WAAW,CAACvL,WAAZ,GAA0BrK,sBAAsB,EAAhD;AACAhwB,IAAAA,IAAI,CAACb,YAAL,CAAkBymC,WAAlB,EAA+B5lC,IAAI,CAACX,UAApC;AACA,QAAIwmC,aAAa,GAAGhB,mBAAmB,CAAC,sBAAD,EAAyB7kC,IAAzB,CAAvC;AACA6lC,IAAAA,aAAa,CAACxL,WAAd,GAA4BoK,KAAK,IAAIA,KAAK,CAACpsB,GAAf,GAAqBytB,mBAAmB,CAACrB,KAAK,CAACpsB,GAAP,CAAxC,GAAsD,EAAlF;AACArY,IAAAA,IAAI,CAACb,YAAL,CAAkB0mC,aAAlB,EAAiCD,WAAW,CAACxmC,WAA7C;AACA,QAAIqmC,WAAW,GAAGZ,mBAAmB,CAAC,oBAAD,EAAuB7kC,IAAvB,CAArC;;AACA,QAAIykC,KAAK,IAAItyC,KAAK,CAACuzC,OAAN,CAAcjB,KAAK,CAACkB,MAApB,CAAT,IAAwClB,KAAK,CAACkB,MAAN,CAAa92C,MAAb,GAAsB,CAAlE,EAAqE;AACjE42C,MAAAA,WAAW,CAACpL,WAAZ,GAA0B,CACtBoK,KAAK,CAACkB,MAAN,CAAa3tC,IAAb,CAAkB,IAAlB,IAA0B,IADJ,EAEtB,iBAAiBqlB,iBAAiB,CAAChvB,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK2uB,MAAL,CAAT,EAAuB;AAAEviB,QAAAA,QAAQ,EAAEuiB,MAAM,CAACziB,IAAP,KAAgB,CAAhB,GAAoByiB,MAAM,CAACviB,QAA3B,GAAsCuc,KAAK,CAACgG,MAAM,CAACviB,QAAP,GAAkB,EAAnB,EAAuB,CAAvB,EAA0B,GAA1B;AAAvD,OAAvB,CAAT,CAAlC,GAA8J,cAFxI,EAGtB,GAHsB,EAIxBzC,IAJwB,CAInB,IAJmB,CAA1B;AAKH,KAND,MAOK;AACDytC,MAAAA,WAAW,CAACpL,WAAZ,GAA0B,EAA1B;AACH;;AACDr6B,IAAAA,IAAI,CAACb,YAAL,CAAkBsmC,WAAlB,EAA+BI,aAAa,CAACzmC,WAA7C;AACAonC,IAAAA,wBAAwB,CAAChtC,GAAzB,CAA6BwG,IAA7B;AACH;;AACD,WAAS8lC,mBAAT,CAA6BY,QAA7B,EAAuC;AACnC,WAAOA,QAAQ,CAAC//B,OAAT,CAAiB,YAAjB,EAA+B,UAAUpW,CAAV,EAAamZ,MAAb,EAAqB;AACvD,UAAImQ,KAAK,GAAG0K,aAAa,CAAC7a,MAAD,CAAzB;;AACA,UAAImQ,KAAJ,EAAW;AACP,eAAOkB,WAAW,CAAClB,KAAD,EAAQmD,MAAR,CAAlB;AACH;;AACDzgB,MAAAA,OAAO,CAAC,qCAAD,CAAP;AACA,aAAOmN,MAAP;AACH,KAPM,CAAP;AAQH;;AACD,WAASi9B,kBAAT,GAA8B;AAC1B,QAAIhc,QAAQ,GAAG50B,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAf;;AACA,QAAI20B,QAAJ,EAAc;AACVA,MAAAA,QAAQ,CAAC0P,WAAT,GAAuB,EAAvB;AACH;AACJ;;AACD,WAASuM,2BAAT,GAAuC;AACnCC,IAAAA,eAAe;AACf,QAAIC,SAAS,GAAGjO,mBAAmB,CAAC9iC,QAAD,CAAnC;AACA,QAAIgxC,WAAW,GAAGD,SAAS,CACtB9pB,MADa,CACN,UAAU/W,KAAV,EAAiB;AAAE,aAAO,CAACs+B,aAAa,CAAChiC,GAAd,CAAkB0D,KAAlB,CAAR;AAAmC,KADhD,EAEbL,GAFa,CAET,UAAUK,KAAV,EAAiB;AAAE,aAAO+gC,aAAa,CAAC/gC,KAAD,CAApB;AAA8B,KAFxC,CAAlB;AAGA8gC,IAAAA,WAAW,CACNnhC,GADL,CACS,UAAUqhC,OAAV,EAAmB;AAAE,aAAOA,OAAO,CAACrL,OAAR,EAAP;AAA2B,KADzD,EAEK5e,MAFL,CAEY,UAAUqiB,MAAV,EAAkB;AAAE,aAAOA,MAAM,IAAIA,MAAM,CAACz6B,KAAP,CAAa/V,MAAb,GAAsB,CAAvC;AAA2C,KAF3E,EAGKsK,OAHL,CAGa,UAAUkmC,MAAV,EAAkB;AAC3Bld,MAAAA,cAAc,CAACkH,mBAAf,CAAmCgW,MAAM,CAACz6B,KAA1C;AACH,KALD;AAMAud,IAAAA,cAAc,CAACmH,2BAAf;AACAnH,IAAAA,cAAc,CAACkL,uBAAf,CAAuC,YAAY;AAC/ClL,MAAAA,cAAc,CAACoL,WAAf,CAA2Bx3B,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,wBAA5B,CAA3B,EAAkFgnB,MAAlF;AACH,KAFD;AAGAmF,IAAAA,cAAc,CAACoL,WAAf,CAA2Bx3B,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,wBAA5B,CAA3B,EAAkFgnB,MAAlF;AACAunB,IAAAA,aAAa,CAACprC,OAAd,CAAsB,UAAU8tC,OAAV,EAAmB;AAAE,aAAOA,OAAO,CAAClL,MAAR,CAAe/e,MAAf,EAAuB2nB,6BAAvB,CAAP;AAA+D,KAA1G;;AACA,QAAIuC,aAAa,CAAC1jC,IAAd,KAAuB,CAA3B,EAA8B;AAC1BmjC,MAAAA,kBAAkB;AACrB;;AACDI,IAAAA,WAAW,CAAC5tC,OAAZ,CAAoB,UAAU8tC,OAAV,EAAmB;AAAE,aAAOA,OAAO,CAAC7J,KAAR,EAAP;AAAyB,KAAlE;AACA,QAAI+J,mBAAmB,GAAG/qC,OAAO,CAACrG,QAAQ,CAACo6B,gBAAT,CAA0BL,qBAA1B,CAAD,CAAjC;AACA/vB,IAAAA,kBAAkB,CAAChK,QAAQ,CAAC02B,eAAV,EAA2B,UAAUiE,IAAV,EAAgB;AACzD+V,MAAAA,gCAAgC,CAAC/V,IAAI,CAACpwB,UAAN,CAAhC;AACA,UAAI2+B,QAAQ,GAAGvO,IAAI,CAACpwB,UAAL,CAAgB6vB,gBAAhB,CAAiCL,qBAAjC,CAAf;;AACA,UAAImP,QAAQ,CAACpwC,MAAT,GAAkB,CAAtB,EAAyB;AACrByC,QAAAA,IAAI,CAAC61C,mBAAD,EAAsBlI,QAAtB,CAAJ;AACH;AACJ,KANiB,CAAlB;AAOAkI,IAAAA,mBAAmB,CAAChuC,OAApB,CAA4B,UAAU23B,EAAV,EAAc;AAAE,aAAOmB,mBAAmB,CAACnB,EAAD,EAAK9T,MAAL,EAAa4nB,sBAAb,EAAqCD,6BAArC,CAA1B;AAAgG,KAA5I;AACAyC,IAAAA,wBAAwB,CAACrxC,QAAD,CAAxB;AACH;;AACD,MAAIsxC,oBAAoB,GAAG,CAA3B;AACA,MAAIH,aAAa,GAAG,IAAI5uC,GAAJ,EAApB;;AACA,WAAS0uC,aAAT,CAAuBjV,OAAvB,EAAgC;AAC5B,QAAIuV,cAAc,GAAG,EAAED,oBAAvB;AACA/qC,IAAAA,OAAO,CAAC,kDAAkDgrC,cAAnD,EAAmEvV,OAAnE,CAAP;;AACA,aAASwH,YAAT,GAAwB;AACpB,UAAI,CAAC54B,UAAU,EAAX,IAAiB,CAAC4mC,iBAAtB,EAAyC;AACrCL,QAAAA,aAAa,CAAC1tC,GAAd,CAAkB8tC,cAAlB;AACAhrC,QAAAA,OAAO,CAAC,uCAAuC4qC,aAAa,CAAC1jC,IAAtD,CAAP;AACA,YAAI8hC,aAAa,GAAGvvC,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAApB;;AACA,YAAI,CAACsvC,aAAa,CAACjL,WAAnB,EAAgC;AAC5BiL,UAAAA,aAAa,CAACjL,WAAd,GAA4BnW,wBAAwB,CAAClH,MAAD,EAAS;AAAEmH,YAAAA,MAAM,EAAE;AAAV,WAAT,CAApD;AACH;AACJ;AACJ;;AACD,aAASqV,UAAT,GAAsB;AAClB0N,MAAAA,aAAa,CAACjmC,MAAd,CAAqBqmC,cAArB;AACAhrC,MAAAA,OAAO,CAAC,0BAA0BgrC,cAA1B,GAA2C,kBAA3C,GAAgEJ,aAAa,CAAC1jC,IAA/E,CAAP;AACAlH,MAAAA,OAAO,CAAC,oBAAD,EAAuB4qC,aAAvB,CAAP;;AACA,UAAIA,aAAa,CAAC1jC,IAAd,KAAuB,CAAvB,IAA4B7C,UAAU,EAA1C,EAA8C;AAC1CgmC,QAAAA,kBAAkB;AACrB;AACJ;;AACD,aAASrN,MAAT,GAAkB;AACd,UAAIsC,OAAO,GAAGqL,OAAO,CAACrL,OAAR,EAAd;;AACA,UAAI,CAACA,OAAL,EAAc;AACV;AACH;;AACDzZ,MAAAA,cAAc,CAACkH,mBAAf,CAAmCuS,OAAO,CAACh3B,KAA3C;AACAud,MAAAA,cAAc,CAACmH,2BAAf;AACA2d,MAAAA,OAAO,CAAClL,MAAR,CAAe/e,MAAf,EAAuB2nB,6BAAvB;AACH;;AACD,QAAIsC,OAAO,GAAG5N,WAAW,CAACtH,OAAD,EAAU;AAAEuH,MAAAA,MAAM,EAAEA,MAAV;AAAkBC,MAAAA,YAAY,EAAEA,YAAhC;AAA8CC,MAAAA,UAAU,EAAEA;AAA1D,KAAV,CAAzB;AACA+K,IAAAA,aAAa,CAAChhC,GAAd,CAAkBwuB,OAAlB,EAA2BkV,OAA3B;AACA,WAAOA,OAAP;AACH;;AACD,WAASO,aAAT,CAAuBzV,OAAvB,EAAgC;AAC5B,QAAIkV,OAAO,GAAG1C,aAAa,CAACrtC,GAAd,CAAkB66B,OAAlB,CAAd;;AACA,QAAIkV,OAAJ,EAAa;AACTA,MAAAA,OAAO,CAAC9J,OAAR;AACAoH,MAAAA,aAAa,CAACtjC,MAAd,CAAqB8wB,OAArB;AACH;AACJ;;AACD,MAAI0V,wBAAwB,GAAGjrC,QAAQ,CAAC,UAAUjD,QAAV,EAAoB;AACxDgrC,IAAAA,aAAa,CAACprC,OAAd,CAAsB,UAAU8tC,OAAV,EAAmB;AAAE,aAAOA,OAAO,CAAClL,MAAR,CAAe/e,MAAf,EAAuB2nB,6BAAvB,CAAP;AAA+D,KAA1G;AACAH,IAAAA,oBAAoB,CAACrrC,OAArB,CAA6B,UAAU8tC,OAAV,EAAmB;AAAE,aAAOA,OAAO,CAAClL,MAAR,CAAe/e,MAAf,EAAuB2nB,6BAAvB,CAAP;AAA+D,KAAjH;AACAprC,IAAAA,QAAQ,IAAIA,QAAQ,EAApB;AACH,GAJsC,CAAvC;;AAKA,MAAIstC,eAAe,GAAG,YAAY;AAC9BY,IAAAA,wBAAwB,CAAC3qC,MAAzB;AACH,GAFD;;AAGA,WAAS4qC,UAAT,GAAsB;AAClB,QAAIR,aAAa,CAAC1jC,IAAd,KAAuB,CAA3B,EAA8B;AAC1BmjC,MAAAA,kBAAkB;AAClB;AACH;;AACDpqC,IAAAA,OAAO,CAAC,mDAAD,EAAsD2qC,aAAtD,CAAP;AACH;;AACD,MAAIS,0BAA0B,GAAG,IAAjC;AACA,MAAIJ,iBAAiB,GAAG,CAACxxC,QAAQ,CAAC6xC,MAAlC;;AACA,WAASC,0BAAT,CAAoCtuC,QAApC,EAA8C;AAC1C,QAAIuuC,eAAe,GAAG9lB,OAAO,CAAC2lB,0BAAD,CAA7B;;AACAA,IAAAA,0BAA0B,GAAG,YAAY;AACrC,UAAI,CAAC5xC,QAAQ,CAAC6xC,MAAd,EAAsB;AAClBG,QAAAA,iCAAiC;AACjCxuC,QAAAA,QAAQ;AACRguC,QAAAA,iBAAiB,GAAG,IAApB;AACH;AACJ,KAND;;AAOA,QAAI,CAACO,eAAL,EAAsB;AAClB/xC,MAAAA,QAAQ,CAACH,gBAAT,CAA0B,kBAA1B,EAA8C+xC,0BAA9C;AACH;AACJ;;AACD,WAASI,iCAAT,GAA6C;AACzChyC,IAAAA,QAAQ,CAACyL,mBAAT,CAA6B,kBAA7B,EAAiDmmC,0BAAjD;AACAA,IAAAA,0BAA0B,GAAG,IAA7B;AACH;;AACD,WAASK,6BAAT,GAAyC;AACrC3C,IAAAA,0BAA0B;;AAC1B,aAAS4C,eAAT,GAA2B;AACvBrB,MAAAA,2BAA2B;AAC3BsB,MAAAA,eAAe;AAClB;;AACD,QAAInyC,QAAQ,CAAC6xC,MAAb,EAAqB;AACjBC,MAAAA,0BAA0B,CAACI,eAAD,CAA1B;AACH,KAFD,MAGK;AACDA,MAAAA,eAAe;AAClB;;AACDlU,IAAAA,iCAAiC,CAAC/W,MAAD,CAAjC;AACH;;AACD,WAASoqB,wBAAT,CAAkCtpC,IAAlC,EAAwC;AACpC,QAAI3L,KAAK,CAACuzC,OAAN,CAAc5nC,IAAI,CAACukC,kBAAnB,CAAJ,EAA4C;AACxC,UAAIvkC,IAAI,CAACukC,kBAAL,CAAwBxzC,MAAxB,GAAiC,CAArC,EAAwC;AACpC,YAAIs5C,SAAS,GAAGlG,+BAA+B,CAACnkC,IAAD,CAA/C;AACA0mC,QAAAA,oBAAoB,CAAClzC,IAArB,CAA0B62C,SAA1B;AACAA,QAAAA,SAAS,CAACpM,MAAV,CAAiB/e,MAAjB,EAAyB2nB,6BAAzB;AACH;AACJ;AACJ;;AACD,WAASuD,eAAT,GAA2B;AACvB,QAAIE,aAAa,GAAGj2C,KAAK,CAACH,IAAN,CAAWuyC,aAAa,CAAClS,IAAd,EAAX,CAApB;AACAwN,IAAAA,oBAAoB,CAACuI,aAAD,EAAgB,UAAUzxC,EAAV,EAAc;AAC9C,UAAIgqC,OAAO,GAAGhqC,EAAE,CAACgqC,OAAjB;AAAA,UAA0BG,OAAO,GAAGnqC,EAAE,CAACmqC,OAAvC;AAAA,UAAgDF,OAAO,GAAGjqC,EAAE,CAACiqC,OAA7D;AAAA,UAAsEC,KAAK,GAAGlqC,EAAE,CAACkqC,KAAjF;AACA,UAAIwH,cAAc,GAAGzH,OAArB;AACA,UAAI0H,cAAc,GAAG3H,OAAO,CAACtuC,MAAR,CAAeyuC,OAAf,EAAwBzuC,MAAxB,CAA+BwuC,KAA/B,EAChB7jB,MADgB,CACT,UAAU/W,KAAV,EAAiB;AAAE,eAAO,CAACs+B,aAAa,CAAChiC,GAAd,CAAkB0D,KAAlB,CAAR;AAAmC,OAD7C,CAArB;AAEA,UAAIsiC,eAAe,GAAG1H,KAAK,CACtB7jB,MADiB,CACV,UAAU/W,KAAV,EAAiB;AAAE,eAAOs+B,aAAa,CAAChiC,GAAd,CAAkB0D,KAAlB,CAAP;AAAkC,OAD3C,CAAtB;AAEA3J,MAAAA,OAAO,CAAC,uBAAD,EAA0B+rC,cAA1B,CAAP;AACAA,MAAAA,cAAc,CAAClvC,OAAf,CAAuB,UAAU8M,KAAV,EAAiB;AAAE,eAAOuhC,aAAa,CAACvhC,KAAD,CAApB;AAA8B,OAAxE;AACA,UAAI8gC,WAAW,GAAGuB,cAAc,CAC3B1iC,GADa,CACT,UAAUK,KAAV,EAAiB;AAAE,eAAO+gC,aAAa,CAAC/gC,KAAD,CAApB;AAA8B,OADxC,CAAlB;AAEA8gC,MAAAA,WAAW,CACNnhC,GADL,CACS,UAAUqhC,OAAV,EAAmB;AAAE,eAAOA,OAAO,CAACrL,OAAR,EAAP;AAA2B,OADzD,EAEK5e,MAFL,CAEY,UAAUqiB,MAAV,EAAkB;AAAE,eAAOA,MAAM,IAAIA,MAAM,CAACz6B,KAAP,CAAa/V,MAAb,GAAsB,CAAvC;AAA2C,OAF3E,EAGKsK,OAHL,CAGa,UAAUkmC,MAAV,EAAkB;AAC3Bld,QAAAA,cAAc,CAACkH,mBAAf,CAAmCgW,MAAM,CAACz6B,KAA1C;AACH,OALD;AAMAud,MAAAA,cAAc,CAACmH,2BAAf;AACAyd,MAAAA,WAAW,CAAC5tC,OAAZ,CAAoB,UAAU8tC,OAAV,EAAmB;AAAE,eAAOA,OAAO,CAAClL,MAAR,CAAe/e,MAAf,EAAuB2nB,6BAAvB,CAAP;AAA+D,OAAxG;AACAoC,MAAAA,WAAW,CAAC5tC,OAAZ,CAAoB,UAAU8tC,OAAV,EAAmB;AAAE,eAAOA,OAAO,CAAC7J,KAAR,EAAP;AAAyB,OAAlE;AACAmL,MAAAA,eAAe,CAACpvC,OAAhB,CAAwB,UAAU8M,KAAV,EAAiB;AAAE,eAAOs+B,aAAa,CAACrtC,GAAd,CAAkB+O,KAAlB,EAAyBpH,OAAzB,EAAP;AAA4C,OAAvF;AACH,KArBmB,EAqBjB,UAAUyB,UAAV,EAAsB;AACrBmmC,MAAAA,gCAAgC,CAACnmC,UAAD,CAAhC;AACA8mC,MAAAA,wBAAwB,CAAC9mC,UAAD,CAAxB;AACH,KAxBmB,CAApB;AAyBAgwB,IAAAA,oBAAoB,CAAC,UAAUyB,OAAV,EAAmB;AACpCE,MAAAA,mBAAmB,CAACF,OAAD,EAAU/U,MAAV,EAAkB4nB,sBAAlB,EAA0CD,6BAA1C,CAAnB;;AACA,UAAI5S,OAAO,KAAKh8B,QAAQ,CAAC02B,eAAzB,EAA0C;AACtC,YAAI+b,SAAS,GAAGzW,OAAO,CAACF,YAAR,CAAqB,OAArB,CAAhB;;AACA,YAAI2W,SAAS,CAACvzC,QAAV,CAAmB,IAAnB,CAAJ,EAA8B;AAC1BktB,UAAAA,cAAc,CAACmH,2BAAf;AACAnH,UAAAA,cAAc,CAACoL,WAAf,CAA2Bx3B,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,wBAA5B,CAA3B,EAAkFgnB,MAAlF;AACH;AACJ;AACJ,KATmB,EASjB,UAAUhd,IAAV,EAAgB;AACfymC,MAAAA,gCAAgC,CAACzmC,IAAD,CAAhC;AACA,UAAImnC,mBAAmB,GAAGnnC,IAAI,CAACmwB,gBAAL,CAAsBL,qBAAtB,CAA1B;;AACA,UAAIqX,mBAAmB,CAACt4C,MAApB,GAA6B,CAAjC,EAAoC;AAChCsK,QAAAA,OAAO,CAACguC,mBAAD,EAAsB,UAAUrW,EAAV,EAAc;AAAE,iBAAOmB,mBAAmB,CAACnB,EAAD,EAAK9T,MAAL,EAAa4nB,sBAAb,EAAqCD,6BAArC,CAA1B;AAAgG,SAAtI,CAAP;AACH;AACJ,KAfmB,CAApB;AAgBA7jC,IAAAA,mBAAmB,CAAC4mC,UAAD,CAAnB;AACH;;AACD,WAASe,sBAAT,GAAkC;AAC9BlE,IAAAA,aAAa,CAACprC,OAAd,CAAsB,UAAU8tC,OAAV,EAAmB;AAAE,aAAOA,OAAO,CAAC/J,KAAR,EAAP;AAAyB,KAApE;AACAiI,IAAAA,yBAAyB;AACzBpF,IAAAA,2BAA2B;AAC3BtO,IAAAA,2BAA2B;AAC3BzwB,IAAAA,sBAAsB,CAAC0mC,UAAD,CAAtB;AACArmC,IAAAA,gCAAgC;AACnC;;AACD,WAASqnC,8BAAT,GAA0C;AACtC,QAAIC,WAAW,GAAG5yC,QAAQ,CAAC8N,aAAT,CAAuB,MAAvB,CAAlB;AACA8kC,IAAAA,WAAW,CAAC/Z,IAAZ,GAAmB,YAAnB;AACA+Z,IAAAA,WAAW,CAACjjB,OAAZ,GAAsB4e,WAAtB;AACAvuC,IAAAA,QAAQ,CAACm+B,IAAT,CAAc6R,WAAd,CAA0B4C,WAA1B;AACH;;AACD,WAASC,iCAAT,GAA6C;AACzC,QAAI9U,IAAI,GAAG/9B,QAAQ,CAACC,aAAT,CAAuB,yBAAvB,CAAX;;AACA,QAAI89B,IAAJ,EAAU;AACN,UAAIA,IAAI,CAACpO,OAAL,KAAiB4e,WAArB,EAAkC;AAC9B,eAAO,IAAP;AACH;;AACD,aAAO,KAAP;AACH;;AACDoE,IAAAA,8BAA8B;AAC9B,WAAO,KAAP;AACH;;AACD,WAASG,0BAAT,CAAoCC,YAApC,EAAkDC,iBAAlD,EAAqEC,MAArE,EAA6E;AACzEhsB,IAAAA,MAAM,GAAG8rB,YAAT;AACArE,IAAAA,KAAK,GAAGsE,iBAAR;;AACA,QAAItE,KAAJ,EAAW;AACPE,MAAAA,6BAA6B,GAAGxyC,KAAK,CAACuzC,OAAN,CAAcjB,KAAK,CAACvP,mBAApB,IAA2CuP,KAAK,CAACvP,mBAAjD,GAAuE,EAAvG;AACA0P,MAAAA,sBAAsB,GAAGzyC,KAAK,CAACuzC,OAAN,CAAcjB,KAAK,CAACwE,iBAApB,IAAyCxE,KAAK,CAACwE,iBAA/C,GAAmE,EAA5F;AACH,KAHD,MAIK;AACDtE,MAAAA,6BAA6B,GAAG,EAAhC;AACAC,MAAAA,sBAAsB,GAAG,EAAzB;AACH;;AACDF,IAAAA,UAAU,GAAGsE,MAAb;;AACA,QAAIjzC,QAAQ,CAACm+B,IAAb,EAAmB;AACf,UAAI0U,iCAAiC,EAArC,EAAyC;AACrC;AACH;;AACD7yC,MAAAA,QAAQ,CAAC02B,eAAT,CAAyBoG,YAAzB,CAAsC,sBAAtC,EAA8D,SAA9D;AACA98B,MAAAA,QAAQ,CAAC02B,eAAT,CAAyBoG,YAAzB,CAAsC,wBAAtC,EAAgE7V,MAAM,CAACziB,IAAP,GAAc,MAAd,GAAuB,QAAvF;AACAytC,MAAAA,6BAA6B;AAChC,KAPD,MAQK;AACD,UAAI,CAAC7yC,SAAL,EAAgB;AACZ,YAAImwC,aAAa,GAAGT,mBAAmB,CAAC,sBAAD,CAAvC;AACA9uC,QAAAA,QAAQ,CAAC02B,eAAT,CAAyBsZ,WAAzB,CAAqCT,aAArC;AACAA,QAAAA,aAAa,CAACjL,WAAd,GAA4BnW,wBAAwB,CAAClH,MAAD,EAAS;AAAEmH,UAAAA,MAAM,EAAE;AAAV,SAAT,CAApD;AACH;;AACD,UAAI+kB,cAAc,GAAG,IAAI1pC,gBAAJ,CAAqB,YAAY;AAClD,YAAIzJ,QAAQ,CAACm+B,IAAb,EAAmB;AACfgV,UAAAA,cAAc,CAACrpC,UAAf;;AACA,cAAI+oC,iCAAiC,EAArC,EAAyC;AACrCO,YAAAA,kBAAkB;AAClB;AACH;;AACDnB,UAAAA,6BAA6B;AAChC;AACJ,OAToB,CAArB;AAUAkB,MAAAA,cAAc,CAACxpC,OAAf,CAAuB3J,QAAvB,EAAiC;AAAE4J,QAAAA,SAAS,EAAE,IAAb;AAAmB2D,QAAAA,OAAO,EAAE;AAA5B,OAAjC;AACH;AACJ;;AACD,WAAS8lC,WAAT,GAAuB;AACnBrzC,IAAAA,QAAQ,CAACypC,aAAT,CAAuB,IAAIC,WAAJ,CAAgB,uBAAhB,CAAvB;AACA5hC,IAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,oBAA5B,CAAD,CAAV;AACH;;AACD,WAASmzC,kBAAT,GAA8B;AAC1BpzC,IAAAA,QAAQ,CAAC02B,eAAT,CAAyBqG,eAAzB,CAAyC,sBAAzC;AACA/8B,IAAAA,QAAQ,CAAC02B,eAAT,CAAyBqG,eAAzB,CAAyC,wBAAzC;AACAuW,IAAAA,sBAAsB;AACtBxrC,IAAAA,UAAU,CAAC9H,QAAQ,CAACC,aAAT,CAAuB,uBAAvB,CAAD,CAAV;;AACA,QAAID,QAAQ,CAACm+B,IAAb,EAAmB;AACfC,MAAAA,qBAAqB;AACrBt2B,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,yBAA5B,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,mBAA5B,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,qBAA5B,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,qBAA5B,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,uBAA5B,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,wBAA5B,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,wBAA5B,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAAC9H,QAAQ,CAACm+B,IAAT,CAAcl+B,aAAd,CAA4B,yBAA5B,CAAD,CAAV;AACAozC,MAAAA,WAAW;AACd;;AACD5C,IAAAA,wBAAwB,CAACrtC,OAAzB,CAAiC,UAAU6G,IAAV,EAAgB;AAC7CnC,MAAAA,UAAU,CAACmC,IAAI,CAAChK,aAAL,CAAmB,qBAAnB,CAAD,CAAV;AACA6H,MAAAA,UAAU,CAACmC,IAAI,CAAChK,aAAL,CAAmB,uBAAnB,CAAD,CAAV;AACH,KAHD;AAIAwwC,IAAAA,wBAAwB,CAACllC,KAAzB;AACAnI,IAAAA,OAAO,CAACorC,aAAa,CAAClS,IAAd,EAAD,EAAuB,UAAUvB,EAAV,EAAc;AAAE,aAAO0W,aAAa,CAAC1W,EAAD,CAApB;AAA2B,KAAlE,CAAP;AACAoW,IAAAA,aAAa,CAAC5lC,KAAd;AACA83B,IAAAA,iBAAiB;AACjBjgC,IAAAA,OAAO,CAACpD,QAAQ,CAACo6B,gBAAT,CAA0B,aAA1B,CAAD,EAA2CtyB,UAA3C,CAAP;AACA2mC,IAAAA,oBAAoB,CAACrrC,OAArB,CAA6B,UAAU8tC,OAAV,EAAmB;AAC5CA,MAAAA,OAAO,CAAC9J,OAAR;AACH,KAFD;AAGAqH,IAAAA,oBAAoB,CAACnnC,MAArB,CAA4B,CAA5B;AACH;;AACD,WAASgsC,sBAAT,GAAkC;AAC9BlnB,IAAAA,cAAc,CAAC7gB,KAAf;AACAoC,IAAAA,cAAc,CAACpC,KAAf;AACAymC,IAAAA,iCAAiC;AACjClB,IAAAA,eAAe;AACf4B,IAAAA,sBAAsB;AACtBvgB,IAAAA,sBAAsB;AACzB;;AAED,MAAIohB,SAAS,GAAG,yBAAhB;;AACA,WAASC,YAAT,CAAsBrwC,IAAtB,EAA4B;AACxB,WAAO/J,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,UAAIq6C,QAAJ,EAAcvwC,IAAd;AACA,aAAO5I,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AACIg5C,YAAAA,QAAQ,GAAG,EAAX;AACA/xB,YAAAA,UAAU,CAAC6xB,SAAD,EAAYpwC,IAAZ,EAAkB,CAAlB,CAAV,CAA+BC,OAA/B,CAAuC,UAAU5C,GAAV,EAAe;AAClD,kBAAIkzC,OAAO,GAAGlyC,aAAa,CAAChB,GAAD,CAA3B;AACAizC,cAAAA,QAAQ,CAACl4C,IAAT,CAAcm4C,OAAd;AACH,aAHD;AAIA,mBAAO,CAAC,CAAD,EAAI95C,OAAO,CAAC43B,GAAR,CAAYiiB,QAAZ,CAAJ,CAAP;;AACJ,eAAK,CAAL;AACIvwC,YAAAA,IAAI,GAAGtC,EAAE,CAAClG,IAAH,EAAP;AACA,mBAAO,CAAC,CAAD,EAAIyI,IAAI,CAACyN,OAAL,CAAa2iC,SAAb,EAAwB,YAAY;AAAE,qBAAO,WAAWrwC,IAAI,CAACmE,KAAL,EAAX,GAA0B,KAAjC;AAAyC,aAA/E,CAAJ,CAAP;AAVR;AAYH,OAbiB,CAAlB;AAcH,KAhBe,CAAhB;AAiBH;;AACD,MAAIssC,MAAM,GAAG,+/BAAb;;AACA,WAASC,UAAT,GAAsB;AAClB,WAAOx6C,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,eAASy6C,YAAT,CAAsB3T,QAAtB,EAAgC4T,OAAhC,EAAyC;AACrC,YAAIC,WAAW,GAAG/zC,QAAQ,CAACC,aAAT,CAAuBigC,QAAvB,CAAlB;;AACA,YAAI6T,WAAW,IAAIA,WAAW,CAACzP,WAA/B,EAA4C;AACxChiB,UAAAA,GAAG,CAAC/mB,IAAJ,CAAS,QAAQu4C,OAAR,GAAkB,KAA3B;AACAxxB,UAAAA,GAAG,CAAC/mB,IAAJ,CAASw4C,WAAW,CAACzP,WAArB;AACAhiB,UAAAA,GAAG,CAAC/mB,IAAJ,CAAS,EAAT;AACH;AACJ;;AACD,UAAI+mB,GAAJ,EAAS0xB,WAAT,EAAsBC,YAAtB,EAAoCrzC,EAApC,EAAwCmC,EAAxC;;AACA,aAAOzI,WAAW,CAAC,IAAD,EAAO,UAAUmX,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAAChX,KAAX;AACI,eAAK,CAAL;AACI6nB,YAAAA,GAAG,GAAG,CAACqxB,MAAD,CAAN;AACAE,YAAAA,YAAY,CAAC,uBAAD,EAA0B,gBAA1B,CAAZ;AACAA,YAAAA,YAAY,CAAC,yBAAD,EAA4B,kBAA5B,CAAZ;AACAA,YAAAA,YAAY,CAAC,mBAAD,EAAsB,YAAtB,CAAZ;AACAA,YAAAA,YAAY,CAAC,qBAAD,EAAwB,cAAxB,CAAZ;AACAA,YAAAA,YAAY,CAAC,wBAAD,EAA2B,iBAA3B,CAAZ;AACAG,YAAAA,WAAW,GAAG,EAAd;AACAh0C,YAAAA,QAAQ,CAACo6B,gBAAT,CAA0B,mBAA1B,EAA+Ch3B,OAA/C,CAAuD,UAAU44B,OAAV,EAAmB;AACtE54B,cAAAA,OAAO,CAAC44B,OAAO,CAACrE,KAAR,CAAcxoB,QAAf,EAAyB,UAAUH,IAAV,EAAgB;AAC5CA,gBAAAA,IAAI,IAAIA,IAAI,CAACsB,OAAb,IAAwB0jC,WAAW,CAACz4C,IAAZ,CAAiByT,IAAI,CAACsB,OAAtB,CAAxB;AACH,eAFM,CAAP;AAGH,aAJD;AAKA,gBAAI,CAAC0jC,WAAW,CAACl7C,MAAjB,EAAyB,OAAO,CAAC,CAAD,EAAI,CAAJ,CAAP;AACzBm7C,YAAAA,YAAY,GAAGjyB,SAAS,CAACgyB,WAAW,CAAC/xC,IAAZ,CAAiB,IAAjB,CAAD,CAAxB;AACAqgB,YAAAA,GAAG,CAAC/mB,IAAJ,CAAS,oBAAT;AACAwH,YAAAA,EAAE,GAAG,CAACnC,EAAE,GAAG0hB,GAAN,EAAW/mB,IAAhB;AACA,mBAAO,CAAC,CAAD,EAAIi4C,YAAY,CAACS,YAAD,CAAhB,CAAP;;AACJ,eAAK,CAAL;AACIlxC,YAAAA,EAAE,CAAC5J,KAAH,CAASyH,EAAT,EAAa,CAAC6Q,EAAE,CAAC/W,IAAH,EAAD,CAAb;;AACA4nB,YAAAA,GAAG,CAAC/mB,IAAJ,CAAS,EAAT;AACAkW,YAAAA,EAAE,CAAChX,KAAH,GAAW,CAAX;;AACJ,eAAK,CAAL;AACIo5C,YAAAA,YAAY,CAAC,uBAAD,EAA0B,gBAA1B,CAAZ;AACA,mBAAO,CAAC,CAAD,EAAIvxB,GAAG,CAACrgB,IAAJ,CAAS,IAAT,CAAJ,CAAP;AAzBR;AA2BH,OA5BiB,CAAlB;AA6BH,KAvCe,CAAhB;AAwCH;;AAED,MAAIiyC,mBAAmB,GAAG,KAA1B;;AACA,MAAIlnB,QAAQ,GAAI,YAAY;AACxB,QAAI;AACA,aAAO3qB,MAAM,CAACjK,IAAP,KAAgBiK,MAAM,CAAC8xC,GAA9B;AACH,KAFD,CAGA,OAAOj0C,GAAP,EAAY;AACRoD,MAAAA,OAAO,CAAC8wC,IAAR,CAAal0C,GAAb;AACA,aAAO,IAAP;AACH;AACJ,GARc,EAAf;;AASA,WAASm0C,MAAT,CAAgBC,YAAhB,EAA8B5F,KAA9B,EAAqC;AACjC,QAAI4F,YAAY,KAAK,KAAK,CAA1B,EAA6B;AAAEA,MAAAA,YAAY,GAAG,EAAf;AAAoB;;AACnD,QAAI5F,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,MAAAA,KAAK,GAAG,IAAR;AAAe;;AACvC,QAAIlrB,KAAK,GAAGlrB,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKiM,aAAL,CAAT,EAA8B+vC,YAA9B,CAApB;;AACA,QAAI9wB,KAAK,CAACxe,MAAN,KAAiBlB,YAAY,CAACI,YAAlC,EAAgD;AAC5C,YAAM,IAAI9C,KAAJ,CAAU,gCAAV,CAAN;AACH;;AACD0xC,IAAAA,0BAA0B,CAACtvB,KAAD,EAAQkrB,KAAR,EAAe1hB,QAAf,CAA1B;AACAknB,IAAAA,mBAAmB,GAAG,IAAtB;AACH;;AACD,WAASK,SAAT,GAAqB;AACjB,WAAOL,mBAAP;AACH;;AACD,WAASM,OAAT,GAAmB;AACfpB,IAAAA,kBAAkB;AAClBc,IAAAA,mBAAmB,GAAG,KAAtB;AACH;;AACD,MAAI9vC,UAAU,GAAGqwC,UAAU,CAAC,8BAAD,CAA3B;AACA,MAAIC,KAAK,GAAG;AACRJ,IAAAA,YAAY,EAAE,IADN;AAER5F,IAAAA,KAAK,EAAE;AAFC,GAAZ;;AAIA,WAASiG,iBAAT,GAA6B;AACzB,QAAIvwC,UAAU,CAAC0d,OAAf,EAAwB;AACpBuyB,MAAAA,MAAM,CAACK,KAAK,CAACJ,YAAP,EAAqBI,KAAK,CAAChG,KAA3B,CAAN;AACH,KAFD,MAGK;AACD8F,MAAAA,OAAO;AACV;AACJ;;AACD,WAASI,IAAT,CAAcN,YAAd,EAA4B5F,KAA5B,EAAmC;AAC/B,QAAI4F,YAAY,KAAK,KAAK,CAA1B,EAA6B;AAAEA,MAAAA,YAAY,GAAG,EAAf;AAAoB;;AACnD,QAAI5F,KAAK,KAAK,KAAK,CAAnB,EAAsB;AAAEA,MAAAA,KAAK,GAAG,IAAR;AAAe;;AACvC,QAAI4F,YAAJ,EAAkB;AACdI,MAAAA,KAAK,GAAG;AAAEJ,QAAAA,YAAY,EAAEA,YAAhB;AAA8B5F,QAAAA,KAAK,EAAEA;AAArC,OAAR;AACAiG,MAAAA,iBAAiB;;AACjB,UAAIh1C,wCAAJ,EAA8C;AAC1CyE,QAAAA,UAAU,CAACvE,gBAAX,CAA4B,QAA5B,EAAsC80C,iBAAtC;AACH,OAFD,MAGK;AACDvwC,QAAAA,UAAU,CAACR,WAAX,CAAuB+wC,iBAAvB;AACH;AACJ,KATD,MAUK;AACD,UAAIh1C,wCAAJ,EAA8C;AAC1CyE,QAAAA,UAAU,CAACqH,mBAAX,CAA+B,QAA/B,EAAyCkpC,iBAAzC;AACH,OAFD,MAGK;AACDvwC,QAAAA,UAAU,CAACywC,cAAX,CAA0BF,iBAA1B;AACH;;AACDH,MAAAA,OAAO;AACV;AACJ;;AACD,WAASM,kBAAT,GAA8B;AAC1B,WAAO17C,SAAS,CAAC,IAAD,EAAO,KAAK,CAAZ,EAAe,KAAK,CAApB,EAAuB,YAAY;AAC/C,aAAOkB,WAAW,CAAC,IAAD,EAAO,UAAUsG,EAAV,EAAc;AACnC,gBAAQA,EAAE,CAACnG,KAAX;AACI,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIm5C,UAAU,EAAd,CAAP;;AACR,eAAK,CAAL;AAAQ,mBAAO,CAAC,CAAD,EAAIhzC,EAAE,CAAClG,IAAH,EAAJ,CAAP;AAFZ;AAIH,OALiB,CAAlB;AAMH,KAPe,CAAhB;AAQH;;AACD,MAAIq6C,cAAc,GAAG5yC,gBAArB;AAEApK,EAAAA,OAAO,CAAC68C,IAAR,GAAeA,IAAf;AACA78C,EAAAA,OAAO,CAACy8C,OAAR,GAAkBA,OAAlB;AACAz8C,EAAAA,OAAO,CAACs8C,MAAR,GAAiBA,MAAjB;AACAt8C,EAAAA,OAAO,CAAC+8C,kBAAR,GAA6BA,kBAA7B;AACA/8C,EAAAA,OAAO,CAACw8C,SAAR,GAAoBA,SAApB;AACAx8C,EAAAA,OAAO,CAACg9C,cAAR,GAAyBA,cAAzB;AAEAx8C,EAAAA,MAAM,CAAC80C,cAAP,CAAsBt1C,OAAtB,EAA+B,YAA/B,EAA6C;AAAE2B,IAAAA,KAAK,EAAE;AAAT,GAA7C;AAEH,CAniKA,CAAD","sourcesContent":["/**\n * Dark Reader v4.9.39\n * https://darkreader.org/\n */\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n    typeof define === 'function' && define.amd ? define(['exports'], factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.DarkReader = {}));\n}(this, (function (exports) { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation.\r\n\r\n    Permission to use, copy, modify, and/or distribute this software for any\r\n    purpose with or without fee is hereby granted.\r\n\r\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\n    PERFORMANCE OF THIS SOFTWARE.\r\n    ***************************************************************************** */\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\r\n\r\n    function __awaiter(thisArg, _arguments, P, generator) {\r\n        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n        return new (P || (P = Promise))(function (resolve, reject) {\r\n            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n            function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n            step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n        });\r\n    }\r\n\r\n    function __generator(thisArg, body) {\r\n        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n        return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n        function verb(n) { return function (v) { return step([n, v]); }; }\r\n        function step(op) {\r\n            if (f) throw new TypeError(\"Generator is already executing.\");\r\n            while (_) try {\r\n                if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n                if (y = 0, t) op = [op[0] & 2, t.value];\r\n                switch (op[0]) {\r\n                    case 0: case 1: t = op; break;\r\n                    case 4: _.label++; return { value: op[1], done: false };\r\n                    case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                    case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                    default:\r\n                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                        if (t[2]) _.ops.pop();\r\n                        _.trys.pop(); continue;\r\n                }\r\n                op = body.call(thisArg, _);\r\n            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n        }\r\n    }\r\n\r\n    function __values(o) {\r\n        var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n        if (m) return m.call(o);\r\n        if (o && typeof o.length === \"number\") return {\r\n            next: function () {\r\n                if (o && i >= o.length) o = void 0;\r\n                return { value: o && o[i++], done: !o };\r\n            }\r\n        };\r\n        throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n    }\r\n\r\n    function __read(o, n) {\r\n        var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n        if (!m) return o;\r\n        var i = m.call(o), r, ar = [], e;\r\n        try {\r\n            while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n        }\r\n        catch (error) { e = { error: error }; }\r\n        finally {\r\n            try {\r\n                if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n            }\r\n            finally { if (e) throw e.error; }\r\n        }\r\n        return ar;\r\n    }\r\n\r\n    function __spreadArray(to, from, pack) {\r\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n            if (ar || !(i in from)) {\r\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n                ar[i] = from[i];\r\n            }\r\n        }\r\n        return to.concat(ar || from);\r\n    }\n\n    var MessageType = {\r\n        UI_GET_DATA: 'ui-get-data',\r\n        UI_GET_ACTIVE_TAB_INFO: 'ui-get-active-tab-info',\r\n        UI_SUBSCRIBE_TO_CHANGES: 'ui-subscribe-to-changes',\r\n        UI_UNSUBSCRIBE_FROM_CHANGES: 'ui-unsubscribe-from-changes',\r\n        UI_CHANGE_SETTINGS: 'ui-change-settings',\r\n        UI_SET_THEME: 'ui-set-theme',\r\n        UI_SET_SHORTCUT: 'ui-set-shortcut',\r\n        UI_TOGGLE_URL: 'ui-toggle-url',\r\n        UI_MARK_NEWS_AS_READ: 'ui-mark-news-as-read',\r\n        UI_LOAD_CONFIG: 'ui-load-config',\r\n        UI_APPLY_DEV_DYNAMIC_THEME_FIXES: 'ui-apply-dev-dynamic-theme-fixes',\r\n        UI_RESET_DEV_DYNAMIC_THEME_FIXES: 'ui-reset-dev-dynamic-theme-fixes',\r\n        UI_APPLY_DEV_INVERSION_FIXES: 'ui-apply-dev-inversion-fixes',\r\n        UI_RESET_DEV_INVERSION_FIXES: 'ui-reset-dev-inversion-fixes',\r\n        UI_APPLY_DEV_STATIC_THEMES: 'ui-apply-dev-static-themes',\r\n        UI_RESET_DEV_STATIC_THEMES: 'ui-reset-dev-static-themes',\r\n        UI_SAVE_FILE: 'ui-save-file',\r\n        UI_REQUEST_EXPORT_CSS: 'ui-request-export-css',\r\n        BG_CHANGES: 'bg-changes',\r\n        BG_ADD_CSS_FILTER: 'bg-add-css-filter',\r\n        BG_ADD_STATIC_THEME: 'bg-add-static-theme',\r\n        BG_ADD_SVG_FILTER: 'bg-add-svg-filter',\r\n        BG_ADD_DYNAMIC_THEME: 'bg-add-dynamic-theme',\r\n        BG_EXPORT_CSS: 'bg-export-css',\r\n        BG_UNSUPPORTED_SENDER: 'bg-unsupported-sender',\r\n        BG_CLEAN_UP: 'bg-clean-up',\r\n        BG_RELOAD: 'bg-reload',\r\n        BG_FETCH_RESPONSE: 'bg-fetch-response',\r\n        BG_UI_UPDATE: 'bg-ui-update',\r\n        BG_CSS_UPDATE: 'bg-css-update',\r\n        CS_COLOR_SCHEME_CHANGE: 'cs-color-scheme-change',\r\n        CS_FRAME_CONNECT: 'cs-frame-connect',\r\n        CS_FRAME_FORGET: 'cs-frame-forget',\r\n        CS_FRAME_FREEZE: 'cs-frame-freeze',\r\n        CS_FRAME_RESUME: 'cs-frame-resume',\r\n        CS_EXPORT_CSS_RESPONSE: 'cs-export-css-response',\r\n        CS_FETCH: 'cs-fetch',\r\n    };\n\n    var userAgent = typeof navigator === 'undefined' ? 'some useragent' : navigator.userAgent.toLowerCase();\r\n    var platform = typeof navigator === 'undefined' ? 'some platform' : navigator.platform.toLowerCase();\r\n    var isChromium = userAgent.includes('chrome') || userAgent.includes('chromium');\r\n    var isThunderbird = userAgent.includes('thunderbird');\r\n    var isFirefox = userAgent.includes('firefox') || isThunderbird;\r\n    userAgent.includes('vivaldi');\r\n    userAgent.includes('yabrowser');\r\n    userAgent.includes('opr') || userAgent.includes('opera');\r\n    userAgent.includes('edg');\r\n    var isSafari = userAgent.includes('safari') && !isChromium;\r\n    var isWindows = platform.startsWith('win');\r\n    var isMacOS = platform.startsWith('mac');\r\n    userAgent.includes('mobile');\r\n    var isShadowDomSupported = typeof ShadowRoot === 'function';\r\n    var isMatchMediaChangeEventListenerSupported = (typeof MediaQueryList === 'function' &&\r\n        typeof MediaQueryList.prototype.addEventListener === 'function');\r\n    ((function () {\r\n        var m = userAgent.match(/chrom[e|ium]\\/([^ ]+)/);\r\n        if (m && m[1]) {\r\n            return m[1];\r\n        }\r\n        return '';\r\n    }))();\r\n    var isDefinedSelectorSupported = (function () {\r\n        try {\r\n            document.querySelector(':defined');\r\n            return true;\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    })();\r\n    globalThis.chrome && globalThis.chrome.runtime && globalThis.chrome.runtime.getManifest && globalThis.chrome.runtime.getManifest().manifest_version === 3;\n\n    function getOKResponse(url, mimeType, origin) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, fetch(url, {\r\n                            cache: 'force-cache',\r\n                            credentials: 'omit',\r\n                            referrer: origin\r\n                        })];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        if (isFirefox && mimeType === 'text/css' && url.startsWith('moz-extension://') && url.endsWith('.css')) {\r\n                            return [2, response];\r\n                        }\r\n                        if (mimeType && !response.headers.get('Content-Type').startsWith(mimeType)) {\r\n                            throw new Error(\"Mime type mismatch when loading \" + url);\r\n                        }\r\n                        if (!response.ok) {\r\n                            throw new Error(\"Unable to load \" + url + \" \" + response.status + \" \" + response.statusText);\r\n                        }\r\n                        return [2, response];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function loadAsDataURL(url, mimeType) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var response;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, getOKResponse(url, mimeType)];\r\n                    case 1:\r\n                        response = _a.sent();\r\n                        return [4, readResponseAsDataURL(response)];\r\n                    case 2: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function readResponseAsDataURL(response) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var blob, dataURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, response.blob()];\r\n                    case 1:\r\n                        blob = _a.sent();\r\n                        return [4, (new Promise(function (resolve) {\r\n                                var reader = new FileReader();\r\n                                reader.onloadend = function () { return resolve(reader.result); };\r\n                                reader.readAsDataURL(blob);\r\n                            }))];\r\n                    case 2:\r\n                        dataURL = _a.sent();\r\n                        return [2, dataURL];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    var throwCORSError = function (url) { return __awaiter(void 0, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2, Promise.reject(new Error([\r\n                    'Embedded Dark Reader cannot access a cross-origin resource',\r\n                    url,\r\n                    'Overview your URLs and CORS policies or use',\r\n                    '`DarkReader.setFetchMethod(fetch: (url) => Promise<Response>))`.',\r\n                    'See if using `DarkReader.setFetchMethod(window.fetch)`',\r\n                    'before `DarkReader.enable()` works.'\r\n                ].join(' ')))];\r\n        });\r\n    }); };\r\n    var fetcher = throwCORSError;\r\n    function setFetchMethod$1(fetch) {\r\n        if (fetch) {\r\n            fetcher = fetch;\r\n        }\r\n        else {\r\n            fetcher = throwCORSError;\r\n        }\r\n    }\r\n    function callFetchMethod(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, fetcher(url)];\r\n                    case 1: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    if (!window.chrome) {\r\n        window.chrome = {};\r\n    }\r\n    if (!chrome.runtime) {\r\n        chrome.runtime = {};\r\n    }\r\n    var messageListeners = new Set();\r\n    function sendMessage() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var id_1, _a, url, responseType, response, text_1, error_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!(args[0] && args[0].type === MessageType.CS_FETCH)) return [3, 8];\r\n                        id_1 = args[0].id;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 7, , 8]);\r\n                        _a = args[0].data, url = _a.url, responseType = _a.responseType;\r\n                        return [4, callFetchMethod(url)];\r\n                    case 2:\r\n                        response = _b.sent();\r\n                        if (!(responseType === 'data-url')) return [3, 4];\r\n                        return [4, readResponseAsDataURL(response)];\r\n                    case 3:\r\n                        text_1 = _b.sent();\r\n                        return [3, 6];\r\n                    case 4: return [4, response.text()];\r\n                    case 5:\r\n                        text_1 = _b.sent();\r\n                        _b.label = 6;\r\n                    case 6:\r\n                        messageListeners.forEach(function (cb) { return cb({ type: MessageType.BG_FETCH_RESPONSE, data: text_1, error: null, id: id_1 }); });\r\n                        return [3, 8];\r\n                    case 7:\r\n                        error_1 = _b.sent();\r\n                        console.error(error_1);\r\n                        messageListeners.forEach(function (cb) { return cb({ type: MessageType.BG_FETCH_RESPONSE, data: null, error: error_1, id: id_1 }); });\r\n                        return [3, 8];\r\n                    case 8: return [2];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function addMessageListener(callback) {\r\n        messageListeners.add(callback);\r\n    }\r\n    if (typeof chrome.runtime.sendMessage === 'function') {\r\n        var nativeSendMessage_1 = chrome.runtime.sendMessage;\r\n        chrome.runtime.sendMessage = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            sendMessage.apply(void 0, __spreadArray([], __read(args)));\r\n            nativeSendMessage_1.apply(chrome.runtime, args);\r\n        };\r\n    }\r\n    else {\r\n        chrome.runtime.sendMessage = sendMessage;\r\n    }\r\n    if (!chrome.runtime.onMessage) {\r\n        chrome.runtime.onMessage = {};\r\n    }\r\n    if (typeof chrome.runtime.onMessage.addListener === 'function') {\r\n        var nativeAddListener_1 = chrome.runtime.onMessage.addListener;\r\n        chrome.runtime.onMessage.addListener = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            addMessageListener.apply(void 0, __spreadArray([], __read(args)));\r\n            nativeAddListener_1.apply(chrome.runtime.onMessage, args);\r\n        };\r\n    }\r\n    else {\r\n        chrome.runtime.onMessage.addListener = addMessageListener;\r\n    }\n\n    var ThemeEngines = {\r\n        cssFilter: 'cssFilter',\r\n        svgFilter: 'svgFilter',\r\n        staticTheme: 'staticTheme',\r\n        dynamicTheme: 'dynamicTheme',\r\n    };\n\n    var DEFAULT_COLORS = {\r\n        darkScheme: {\r\n            background: '#181a1b',\r\n            text: '#e8e6e3',\r\n        },\r\n        lightScheme: {\r\n            background: '#dcdad7',\r\n            text: '#181a1b',\r\n        },\r\n    };\r\n    var DEFAULT_THEME = {\r\n        mode: 1,\r\n        brightness: 100,\r\n        contrast: 100,\r\n        grayscale: 0,\r\n        sepia: 0,\r\n        useFont: false,\r\n        fontFamily: isMacOS ? 'Helvetica Neue' : isWindows ? 'Segoe UI' : 'Open Sans',\r\n        textStroke: 0,\r\n        engine: ThemeEngines.dynamicTheme,\r\n        stylesheet: '',\r\n        darkSchemeBackgroundColor: DEFAULT_COLORS.darkScheme.background,\r\n        darkSchemeTextColor: DEFAULT_COLORS.darkScheme.text,\r\n        lightSchemeBackgroundColor: DEFAULT_COLORS.lightScheme.background,\r\n        lightSchemeTextColor: DEFAULT_COLORS.lightScheme.text,\r\n        scrollbarColor: isMacOS ? '' : 'auto',\r\n        selectionColor: 'auto',\r\n        styleSystemControls: true,\r\n    };\n\n    function isArrayLike(items) {\r\n        return items.length != null;\r\n    }\r\n    function forEach(items, iterator) {\r\n        var e_1, _a;\r\n        if (isArrayLike(items)) {\r\n            for (var i = 0, len = items.length; i < len; i++) {\r\n                iterator(items[i]);\r\n            }\r\n        }\r\n        else {\r\n            try {\r\n                for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\r\n                    var item = items_1_1.value;\r\n                    iterator(item);\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        }\r\n    }\r\n    function push(array, addition) {\r\n        forEach(addition, function (a) { return array.push(a); });\r\n    }\r\n    function toArray(items) {\r\n        var results = [];\r\n        for (var i = 0, len = items.length; i < len; i++) {\r\n            results.push(items[i]);\r\n        }\r\n        return results;\r\n    }\n\n    function logInfo() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n    }\r\n    function logWarn() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n    }\n\n    function throttle(callback) {\r\n        var pending = false;\r\n        var frameId = null;\r\n        var lastArgs;\r\n        var throttled = (function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            lastArgs = args;\r\n            if (frameId) {\r\n                pending = true;\r\n            }\r\n            else {\r\n                callback.apply(void 0, __spreadArray([], __read(lastArgs)));\r\n                frameId = requestAnimationFrame(function () {\r\n                    frameId = null;\r\n                    if (pending) {\r\n                        callback.apply(void 0, __spreadArray([], __read(lastArgs)));\r\n                        pending = false;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        var cancel = function () {\r\n            cancelAnimationFrame(frameId);\r\n            pending = false;\r\n            frameId = null;\r\n        };\r\n        return Object.assign(throttled, { cancel: cancel });\r\n    }\r\n    function createAsyncTasksQueue() {\r\n        var tasks = [];\r\n        var frameId = null;\r\n        function runTasks() {\r\n            var task;\r\n            while ((task = tasks.shift())) {\r\n                task();\r\n            }\r\n            frameId = null;\r\n        }\r\n        function add(task) {\r\n            tasks.push(task);\r\n            if (!frameId) {\r\n                frameId = requestAnimationFrame(runTasks);\r\n            }\r\n        }\r\n        function cancel() {\r\n            tasks.splice(0);\r\n            cancelAnimationFrame(frameId);\r\n            frameId = null;\r\n        }\r\n        return { add: add, cancel: cancel };\r\n    }\n\n    function getDuration(time) {\r\n        var duration = 0;\r\n        if (time.seconds) {\r\n            duration += time.seconds * 1000;\r\n        }\r\n        if (time.minutes) {\r\n            duration += time.minutes * 60 * 1000;\r\n        }\r\n        if (time.hours) {\r\n            duration += time.hours * 60 * 60 * 1000;\r\n        }\r\n        if (time.days) {\r\n            duration += time.days * 24 * 60 * 60 * 1000;\r\n        }\r\n        return duration;\r\n    }\n\n    function removeNode(node) {\r\n        node && node.parentNode && node.parentNode.removeChild(node);\r\n    }\r\n    function watchForNodePosition(node, mode, onRestore) {\r\n        if (onRestore === void 0) { onRestore = Function.prototype; }\r\n        var MAX_ATTEMPTS_COUNT = 10;\r\n        var RETRY_TIMEOUT = getDuration({ seconds: 2 });\r\n        var ATTEMPTS_INTERVAL = getDuration({ seconds: 10 });\r\n        var prevSibling = node.previousSibling;\r\n        var parent = node.parentNode;\r\n        if (!parent) {\r\n            throw new Error('Unable to watch for node position: parent element not found');\r\n        }\r\n        if (mode === 'prev-sibling' && !prevSibling) {\r\n            throw new Error('Unable to watch for node position: there is no previous sibling');\r\n        }\r\n        var attempts = 0;\r\n        var start = null;\r\n        var timeoutId = null;\r\n        var restore = throttle(function () {\r\n            if (timeoutId) {\r\n                return;\r\n            }\r\n            attempts++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            }\r\n            else if (attempts >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    logWarn(\"Node position watcher paused: retry in \" + RETRY_TIMEOUT + \"ms\", node, prevSibling);\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attempts = 0;\r\n                        timeoutId = null;\r\n                        restore();\r\n                    }, RETRY_TIMEOUT);\r\n                    return;\r\n                }\r\n                start = now;\r\n                attempts = 1;\r\n            }\r\n            if (mode === 'parent') {\r\n                if (prevSibling && prevSibling.parentNode !== parent) {\r\n                    logWarn('Unable to restore node position: sibling parent changed', node, prevSibling, parent);\r\n                    stop();\r\n                    return;\r\n                }\r\n            }\r\n            if (mode === 'prev-sibling') {\r\n                if (prevSibling.parentNode == null) {\r\n                    logWarn('Unable to restore node position: sibling was removed', node, prevSibling, parent);\r\n                    stop();\r\n                    return;\r\n                }\r\n                if (prevSibling.parentNode !== parent) {\r\n                    logWarn('Style was moved to another parent', node, prevSibling, parent);\r\n                    updateParent(prevSibling.parentNode);\r\n                }\r\n            }\r\n            logWarn('Restoring node position', node, prevSibling, parent);\r\n            parent.insertBefore(node, prevSibling ? prevSibling.nextSibling : parent.firstChild);\r\n            observer.takeRecords();\r\n            onRestore && onRestore();\r\n        });\r\n        var observer = new MutationObserver(function () {\r\n            if ((mode === 'parent' && node.parentNode !== parent) ||\r\n                (mode === 'prev-sibling' && node.previousSibling !== prevSibling)) {\r\n                restore();\r\n            }\r\n        });\r\n        var run = function () {\r\n            observer.observe(parent, { childList: true });\r\n        };\r\n        var stop = function () {\r\n            clearTimeout(timeoutId);\r\n            observer.disconnect();\r\n            restore.cancel();\r\n        };\r\n        var skip = function () {\r\n            observer.takeRecords();\r\n        };\r\n        var updateParent = function (parentNode) {\r\n            parent = parentNode;\r\n            stop();\r\n            run();\r\n        };\r\n        run();\r\n        return { run: run, stop: stop, skip: skip };\r\n    }\r\n    function iterateShadowHosts(root, iterator) {\r\n        if (root == null) {\r\n            return;\r\n        }\r\n        var walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {\r\n            acceptNode: function (node) {\r\n                return node.shadowRoot == null ? NodeFilter.FILTER_SKIP : NodeFilter.FILTER_ACCEPT;\r\n            }\r\n        });\r\n        for (var node = (root.shadowRoot ? walker.currentNode : walker.nextNode()); node != null; node = walker.nextNode()) {\r\n            iterator(node);\r\n            iterateShadowHosts(node.shadowRoot, iterator);\r\n        }\r\n    }\r\n    function isDOMReady() {\r\n        return document.readyState === 'complete' || document.readyState === 'interactive';\r\n    }\r\n    var readyStateListeners = new Set();\r\n    function addDOMReadyListener(listener) {\r\n        readyStateListeners.add(listener);\r\n    }\r\n    function removeDOMReadyListener(listener) {\r\n        readyStateListeners.delete(listener);\r\n    }\r\n    function isReadyStateComplete() {\r\n        return document.readyState === 'complete';\r\n    }\r\n    var readyStateCompleteListeners = new Set();\r\n    function addReadyStateCompleteListener(listener) {\r\n        readyStateCompleteListeners.add(listener);\r\n    }\r\n    function cleanReadyStateCompleteListeners() {\r\n        readyStateCompleteListeners.clear();\r\n    }\r\n    if (!isDOMReady()) {\r\n        var onReadyStateChange_1 = function () {\r\n            if (isDOMReady()) {\r\n                readyStateListeners.forEach(function (listener) { return listener(); });\r\n                readyStateListeners.clear();\r\n                if (isReadyStateComplete()) {\r\n                    document.removeEventListener('readystatechange', onReadyStateChange_1);\r\n                    readyStateCompleteListeners.forEach(function (listener) { return listener(); });\r\n                    readyStateCompleteListeners.clear();\r\n                }\r\n            }\r\n        };\r\n        document.addEventListener('readystatechange', onReadyStateChange_1);\r\n    }\r\n    var HUGE_MUTATIONS_COUNT = 1000;\r\n    function isHugeMutation(mutations) {\r\n        if (mutations.length > HUGE_MUTATIONS_COUNT) {\r\n            return true;\r\n        }\r\n        var addedNodesCount = 0;\r\n        for (var i = 0; i < mutations.length; i++) {\r\n            addedNodesCount += mutations[i].addedNodes.length;\r\n            if (addedNodesCount > HUGE_MUTATIONS_COUNT) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function getElementsTreeOperations(mutations) {\r\n        var additions = new Set();\r\n        var deletions = new Set();\r\n        var moves = new Set();\r\n        mutations.forEach(function (m) {\r\n            forEach(m.addedNodes, function (n) {\r\n                if (n instanceof Element && n.isConnected) {\r\n                    additions.add(n);\r\n                }\r\n            });\r\n            forEach(m.removedNodes, function (n) {\r\n                if (n instanceof Element) {\r\n                    if (n.isConnected) {\r\n                        moves.add(n);\r\n                    }\r\n                    else {\r\n                        deletions.add(n);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        moves.forEach(function (n) { return additions.delete(n); });\r\n        var duplicateAdditions = [];\r\n        var duplicateDeletions = [];\r\n        additions.forEach(function (node) {\r\n            if (additions.has(node.parentElement)) {\r\n                duplicateAdditions.push(node);\r\n            }\r\n        });\r\n        deletions.forEach(function (node) {\r\n            if (deletions.has(node.parentElement)) {\r\n                duplicateDeletions.push(node);\r\n            }\r\n        });\r\n        duplicateAdditions.forEach(function (node) { return additions.delete(node); });\r\n        duplicateDeletions.forEach(function (node) { return deletions.delete(node); });\r\n        return { additions: additions, moves: moves, deletions: deletions };\r\n    }\r\n    var optimizedTreeObservers = new Map();\r\n    var optimizedTreeCallbacks = new WeakMap();\r\n    function createOptimizedTreeObserver(root, callbacks) {\r\n        var observer;\r\n        var observerCallbacks;\r\n        var domReadyListener;\r\n        if (optimizedTreeObservers.has(root)) {\r\n            observer = optimizedTreeObservers.get(root);\r\n            observerCallbacks = optimizedTreeCallbacks.get(observer);\r\n        }\r\n        else {\r\n            var hadHugeMutationsBefore_1 = false;\r\n            var subscribedForReadyState_1 = false;\r\n            observer = new MutationObserver(function (mutations) {\r\n                if (isHugeMutation(mutations)) {\r\n                    if (!hadHugeMutationsBefore_1 || isDOMReady()) {\r\n                        observerCallbacks.forEach(function (_a) {\r\n                            var onHugeMutations = _a.onHugeMutations;\r\n                            return onHugeMutations(root);\r\n                        });\r\n                    }\r\n                    else if (!subscribedForReadyState_1) {\r\n                        domReadyListener = function () { return observerCallbacks.forEach(function (_a) {\r\n                            var onHugeMutations = _a.onHugeMutations;\r\n                            return onHugeMutations(root);\r\n                        }); };\r\n                        addDOMReadyListener(domReadyListener);\r\n                        subscribedForReadyState_1 = true;\r\n                    }\r\n                    hadHugeMutationsBefore_1 = true;\r\n                }\r\n                else {\r\n                    var elementsOperations_1 = getElementsTreeOperations(mutations);\r\n                    observerCallbacks.forEach(function (_a) {\r\n                        var onMinorMutations = _a.onMinorMutations;\r\n                        return onMinorMutations(elementsOperations_1);\r\n                    });\r\n                }\r\n            });\r\n            observer.observe(root, { childList: true, subtree: true });\r\n            optimizedTreeObservers.set(root, observer);\r\n            observerCallbacks = new Set();\r\n            optimizedTreeCallbacks.set(observer, observerCallbacks);\r\n        }\r\n        observerCallbacks.add(callbacks);\r\n        return {\r\n            disconnect: function () {\r\n                observerCallbacks.delete(callbacks);\r\n                if (domReadyListener) {\r\n                    removeDOMReadyListener(domReadyListener);\r\n                }\r\n                if (observerCallbacks.size === 0) {\r\n                    observer.disconnect();\r\n                    optimizedTreeCallbacks.delete(observer);\r\n                    optimizedTreeObservers.delete(root);\r\n                }\r\n            },\r\n        };\r\n    }\n\n    var anchor;\r\n    var parsedURLCache = new Map();\r\n    function fixBaseURL($url) {\r\n        if (!anchor) {\r\n            anchor = document.createElement('a');\r\n        }\r\n        anchor.href = $url;\r\n        return anchor.href;\r\n    }\r\n    function parseURL($url, $base) {\r\n        if ($base === void 0) { $base = null; }\r\n        var key = \"\" + $url + ($base ? \";\" + $base : '');\r\n        if (parsedURLCache.has(key)) {\r\n            return parsedURLCache.get(key);\r\n        }\r\n        if ($base) {\r\n            var parsedURL_1 = new URL($url, fixBaseURL($base));\r\n            parsedURLCache.set(key, parsedURL_1);\r\n            return parsedURL_1;\r\n        }\r\n        var parsedURL = new URL(fixBaseURL($url));\r\n        parsedURLCache.set($url, parsedURL);\r\n        return parsedURL;\r\n    }\r\n    function getAbsoluteURL($base, $relative) {\r\n        if ($relative.match(/^data\\\\?\\:/)) {\r\n            return $relative;\r\n        }\r\n        if (/^\\/\\//.test($relative)) {\r\n            return \"\" + location.protocol + $relative;\r\n        }\r\n        var b = parseURL($base);\r\n        var a = parseURL($relative, b.href);\r\n        return a.href;\r\n    }\n\n    function iterateCSSRules(rules, iterate, onMediaRuleError) {\r\n        forEach(rules, function (rule) {\r\n            if (rule.selectorText) {\r\n                iterate(rule);\r\n            }\r\n            else if (rule.href) {\r\n                try {\r\n                    iterateCSSRules(rule.styleSheet.cssRules, iterate, onMediaRuleError);\r\n                }\r\n                catch (err) {\r\n                    logInfo(\"Found a non-loaded link.\");\r\n                    onMediaRuleError && onMediaRuleError();\r\n                }\r\n            }\r\n            else if (rule.media) {\r\n                var media = Array.from(rule.media);\r\n                var isScreenOrAll = media.some(function (m) { return m.startsWith('screen') || m.startsWith('all'); });\r\n                var isPrintOrSpeech = media.some(function (m) { return m.startsWith('print') || m.startsWith('speech'); });\r\n                if (isScreenOrAll || !isPrintOrSpeech) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            }\r\n            else if (rule.conditionText) {\r\n                if (CSS.supports(rule.conditionText)) {\r\n                    iterateCSSRules(rule.cssRules, iterate, onMediaRuleError);\r\n                }\r\n            }\r\n            else {\r\n                logWarn(\"CSSRule type not supported\", rule);\r\n            }\r\n        });\r\n    }\r\n    var shorthandVarDependantProperties = [\r\n        'background',\r\n        'border',\r\n        'border-color',\r\n        'border-bottom',\r\n        'border-left',\r\n        'border-right',\r\n        'border-top',\r\n        'outline',\r\n        'outline-color',\r\n    ];\r\n    var shorthandVarDepPropRegexps = isSafari ? shorthandVarDependantProperties.map(function (prop) {\r\n        var regexp = new RegExp(prop + \":\\\\s*(.*?)\\\\s*;\");\r\n        return [prop, regexp];\r\n    }) : null;\r\n    function iterateCSSDeclarations(style, iterate) {\r\n        forEach(style, function (property) {\r\n            var value = style.getPropertyValue(property).trim();\r\n            if (!value) {\r\n                return;\r\n            }\r\n            iterate(property, value);\r\n        });\r\n        var cssText = style.cssText;\r\n        if (cssText.includes('var(')) {\r\n            if (isSafari) {\r\n                shorthandVarDepPropRegexps.forEach(function (_a) {\r\n                    var _b = __read(_a, 2), prop = _b[0], regexp = _b[1];\r\n                    var match = cssText.match(regexp);\r\n                    if (match && match[1]) {\r\n                        var val = match[1].trim();\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                shorthandVarDependantProperties.forEach(function (prop) {\r\n                    var val = style.getPropertyValue(prop);\r\n                    if (val && val.includes('var(')) {\r\n                        iterate(prop, val);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    var cssURLRegex = /url\\((('.+?')|(\".+?\")|([^\\)]*?))\\)/g;\r\n    var cssImportRegex = /@import\\s*(url\\()?(('.+?')|(\".+?\")|([^\\)]*?))\\)?;?/g;\r\n    function getCSSURLValue(cssURL) {\r\n        return cssURL.replace(/^url\\((.*)\\)$/, '$1').trim().replace(/^\"(.*)\"$/, '$1').replace(/^'(.*)'$/, '$1');\r\n    }\r\n    function getCSSBaseBath(url) {\r\n        var cssURL = parseURL(url);\r\n        return \"\" + cssURL.origin + cssURL.pathname.replace(/\\?.*$/, '').replace(/(\\/)([^\\/]+)$/i, '$1');\r\n    }\r\n    function replaceCSSRelativeURLsWithAbsolute($css, cssBasePath) {\r\n        return $css.replace(cssURLRegex, function (match) {\r\n            var pathValue = getCSSURLValue(match);\r\n            return \"url(\\\"\" + getAbsoluteURL(cssBasePath, pathValue) + \"\\\")\";\r\n        });\r\n    }\r\n    var cssCommentsRegex = /\\/\\*[\\s\\S]*?\\*\\//g;\r\n    function removeCSSComments($css) {\r\n        return $css.replace(cssCommentsRegex, '');\r\n    }\r\n    var fontFaceRegex = /@font-face\\s*{[^}]*}/g;\r\n    function replaceCSSFontFace($css) {\r\n        return $css.replace(fontFaceRegex, '');\r\n    }\n\n    function hslToRGB(_a) {\r\n        var h = _a.h, s = _a.s, l = _a.l, _b = _a.a, a = _b === void 0 ? 1 : _b;\r\n        if (s === 0) {\r\n            var _c = __read([l, l, l].map(function (x) { return Math.round(x * 255); }), 3), r_1 = _c[0], b_1 = _c[1], g_1 = _c[2];\r\n            return { r: r_1, g: g_1, b: b_1, a: a };\r\n        }\r\n        var c = (1 - Math.abs(2 * l - 1)) * s;\r\n        var x = c * (1 - Math.abs((h / 60) % 2 - 1));\r\n        var m = l - c / 2;\r\n        var _d = __read((h < 60 ? [c, x, 0] :\r\n            h < 120 ? [x, c, 0] :\r\n                h < 180 ? [0, c, x] :\r\n                    h < 240 ? [0, x, c] :\r\n                        h < 300 ? [x, 0, c] :\r\n                            [c, 0, x]).map(function (n) { return Math.round((n + m) * 255); }), 3), r = _d[0], g = _d[1], b = _d[2];\r\n        return { r: r, g: g, b: b, a: a };\r\n    }\r\n    function rgbToHSL(_a) {\r\n        var r255 = _a.r, g255 = _a.g, b255 = _a.b, _b = _a.a, a = _b === void 0 ? 1 : _b;\r\n        var r = r255 / 255;\r\n        var g = g255 / 255;\r\n        var b = b255 / 255;\r\n        var max = Math.max(r, g, b);\r\n        var min = Math.min(r, g, b);\r\n        var c = max - min;\r\n        var l = (max + min) / 2;\r\n        if (c === 0) {\r\n            return { h: 0, s: 0, l: l, a: a };\r\n        }\r\n        var h = (max === r ? (((g - b) / c) % 6) :\r\n            max === g ? ((b - r) / c + 2) :\r\n                ((r - g) / c + 4)) * 60;\r\n        if (h < 0) {\r\n            h += 360;\r\n        }\r\n        var s = c / (1 - Math.abs(2 * l - 1));\r\n        return { h: h, s: s, l: l, a: a };\r\n    }\r\n    function toFixed(n, digits) {\r\n        if (digits === void 0) { digits = 0; }\r\n        var fixed = n.toFixed(digits);\r\n        if (digits === 0) {\r\n            return fixed;\r\n        }\r\n        var dot = fixed.indexOf('.');\r\n        if (dot >= 0) {\r\n            var zerosMatch = fixed.match(/0+$/);\r\n            if (zerosMatch) {\r\n                if (zerosMatch.index === dot + 1) {\r\n                    return fixed.substring(0, dot);\r\n                }\r\n                return fixed.substring(0, zerosMatch.index);\r\n            }\r\n        }\r\n        return fixed;\r\n    }\r\n    function rgbToString(rgb) {\r\n        var r = rgb.r, g = rgb.g, b = rgb.b, a = rgb.a;\r\n        if (a != null && a < 1) {\r\n            return \"rgba(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \", \" + toFixed(a, 2) + \")\";\r\n        }\r\n        return \"rgb(\" + toFixed(r) + \", \" + toFixed(g) + \", \" + toFixed(b) + \")\";\r\n    }\r\n    function rgbToHexString(_a) {\r\n        var r = _a.r, g = _a.g, b = _a.b, a = _a.a;\r\n        return \"#\" + (a != null && a < 1 ? [r, g, b, Math.round(a * 255)] : [r, g, b]).map(function (x) {\r\n            return \"\" + (x < 16 ? '0' : '') + x.toString(16);\r\n        }).join('');\r\n    }\r\n    function hslToString(hsl) {\r\n        var h = hsl.h, s = hsl.s, l = hsl.l, a = hsl.a;\r\n        if (a != null && a < 1) {\r\n            return \"hsla(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%, \" + toFixed(a, 2) + \")\";\r\n        }\r\n        return \"hsl(\" + toFixed(h) + \", \" + toFixed(s * 100) + \"%, \" + toFixed(l * 100) + \"%)\";\r\n    }\r\n    var rgbMatch = /^rgba?\\([^\\(\\)]+\\)$/;\r\n    var hslMatch = /^hsla?\\([^\\(\\)]+\\)$/;\r\n    var hexMatch = /^#[0-9a-f]+$/i;\r\n    function parse($color) {\r\n        var c = $color.trim().toLowerCase();\r\n        if (c.match(rgbMatch)) {\r\n            return parseRGB(c);\r\n        }\r\n        if (c.match(hslMatch)) {\r\n            return parseHSL(c);\r\n        }\r\n        if (c.match(hexMatch)) {\r\n            return parseHex(c);\r\n        }\r\n        if (knownColors.has(c)) {\r\n            return getColorByName(c);\r\n        }\r\n        if (systemColors.has(c)) {\r\n            return getSystemColor(c);\r\n        }\r\n        if ($color === 'transparent') {\r\n            return { r: 0, g: 0, b: 0, a: 0 };\r\n        }\r\n        throw new Error(\"Unable to parse \" + $color);\r\n    }\r\n    function getNumbers($color) {\r\n        var numbers = [];\r\n        var prevPos = 0;\r\n        var isMining = false;\r\n        var startIndex = $color.indexOf('(');\r\n        $color = $color.substring(startIndex + 1, $color.length - 1);\r\n        for (var i = 0; i < $color.length; i++) {\r\n            var c = $color[i];\r\n            if (c >= '0' && c <= '9' || c === '.' || c === '+' || c === '-') {\r\n                isMining = true;\r\n            }\r\n            else if (isMining && (c === ' ' || c === ',')) {\r\n                numbers.push($color.substring(prevPos, i));\r\n                isMining = false;\r\n                prevPos = i + 1;\r\n            }\r\n            else if (!isMining) {\r\n                prevPos = i + 1;\r\n            }\r\n        }\r\n        if (isMining) {\r\n            numbers.push($color.substring(prevPos, $color.length));\r\n        }\r\n        return numbers;\r\n    }\r\n    function getNumbersFromString(str, range, units) {\r\n        var raw = getNumbers(str);\r\n        var unitsList = Object.entries(units);\r\n        var numbers = raw.map(function (r) { return r.trim(); }).map(function (r, i) {\r\n            var n;\r\n            var unit = unitsList.find(function (_a) {\r\n                var _b = __read(_a, 1), u = _b[0];\r\n                return r.endsWith(u);\r\n            });\r\n            if (unit) {\r\n                n = parseFloat(r.substring(0, r.length - unit[0].length)) / unit[1] * range[i];\r\n            }\r\n            else {\r\n                n = parseFloat(r);\r\n            }\r\n            if (range[i] > 1) {\r\n                return Math.round(n);\r\n            }\r\n            return n;\r\n        });\r\n        return numbers;\r\n    }\r\n    var rgbRange = [255, 255, 255, 1];\r\n    var rgbUnits = { '%': 100 };\r\n    function parseRGB($rgb) {\r\n        var _a = __read(getNumbersFromString($rgb, rgbRange, rgbUnits), 4), r = _a[0], g = _a[1], b = _a[2], _b = _a[3], a = _b === void 0 ? 1 : _b;\r\n        return { r: r, g: g, b: b, a: a };\r\n    }\r\n    var hslRange = [360, 1, 1, 1];\r\n    var hslUnits = { '%': 100, 'deg': 360, 'rad': 2 * Math.PI, 'turn': 1 };\r\n    function parseHSL($hsl) {\r\n        var _a = __read(getNumbersFromString($hsl, hslRange, hslUnits), 4), h = _a[0], s = _a[1], l = _a[2], _b = _a[3], a = _b === void 0 ? 1 : _b;\r\n        return hslToRGB({ h: h, s: s, l: l, a: a });\r\n    }\r\n    function parseHex($hex) {\r\n        var h = $hex.substring(1);\r\n        switch (h.length) {\r\n            case 3:\r\n            case 4: {\r\n                var _a = __read([0, 1, 2].map(function (i) { return parseInt(\"\" + h[i] + h[i], 16); }), 3), r = _a[0], g = _a[1], b = _a[2];\r\n                var a = h.length === 3 ? 1 : (parseInt(\"\" + h[3] + h[3], 16) / 255);\r\n                return { r: r, g: g, b: b, a: a };\r\n            }\r\n            case 6:\r\n            case 8: {\r\n                var _b = __read([0, 2, 4].map(function (i) { return parseInt(h.substring(i, i + 2), 16); }), 3), r = _b[0], g = _b[1], b = _b[2];\r\n                var a = h.length === 6 ? 1 : (parseInt(h.substring(6, 8), 16) / 255);\r\n                return { r: r, g: g, b: b, a: a };\r\n            }\r\n        }\r\n        throw new Error(\"Unable to parse \" + $hex);\r\n    }\r\n    function getColorByName($color) {\r\n        var n = knownColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    function getSystemColor($color) {\r\n        var n = systemColors.get($color);\r\n        return {\r\n            r: (n >> 16) & 255,\r\n            g: (n >> 8) & 255,\r\n            b: (n >> 0) & 255,\r\n            a: 1\r\n        };\r\n    }\r\n    var knownColors = new Map(Object.entries({\r\n        aliceblue: 0xf0f8ff,\r\n        antiquewhite: 0xfaebd7,\r\n        aqua: 0x00ffff,\r\n        aquamarine: 0x7fffd4,\r\n        azure: 0xf0ffff,\r\n        beige: 0xf5f5dc,\r\n        bisque: 0xffe4c4,\r\n        black: 0x000000,\r\n        blanchedalmond: 0xffebcd,\r\n        blue: 0x0000ff,\r\n        blueviolet: 0x8a2be2,\r\n        brown: 0xa52a2a,\r\n        burlywood: 0xdeb887,\r\n        cadetblue: 0x5f9ea0,\r\n        chartreuse: 0x7fff00,\r\n        chocolate: 0xd2691e,\r\n        coral: 0xff7f50,\r\n        cornflowerblue: 0x6495ed,\r\n        cornsilk: 0xfff8dc,\r\n        crimson: 0xdc143c,\r\n        cyan: 0x00ffff,\r\n        darkblue: 0x00008b,\r\n        darkcyan: 0x008b8b,\r\n        darkgoldenrod: 0xb8860b,\r\n        darkgray: 0xa9a9a9,\r\n        darkgrey: 0xa9a9a9,\r\n        darkgreen: 0x006400,\r\n        darkkhaki: 0xbdb76b,\r\n        darkmagenta: 0x8b008b,\r\n        darkolivegreen: 0x556b2f,\r\n        darkorange: 0xff8c00,\r\n        darkorchid: 0x9932cc,\r\n        darkred: 0x8b0000,\r\n        darksalmon: 0xe9967a,\r\n        darkseagreen: 0x8fbc8f,\r\n        darkslateblue: 0x483d8b,\r\n        darkslategray: 0x2f4f4f,\r\n        darkslategrey: 0x2f4f4f,\r\n        darkturquoise: 0x00ced1,\r\n        darkviolet: 0x9400d3,\r\n        deeppink: 0xff1493,\r\n        deepskyblue: 0x00bfff,\r\n        dimgray: 0x696969,\r\n        dimgrey: 0x696969,\r\n        dodgerblue: 0x1e90ff,\r\n        firebrick: 0xb22222,\r\n        floralwhite: 0xfffaf0,\r\n        forestgreen: 0x228b22,\r\n        fuchsia: 0xff00ff,\r\n        gainsboro: 0xdcdcdc,\r\n        ghostwhite: 0xf8f8ff,\r\n        gold: 0xffd700,\r\n        goldenrod: 0xdaa520,\r\n        gray: 0x808080,\r\n        grey: 0x808080,\r\n        green: 0x008000,\r\n        greenyellow: 0xadff2f,\r\n        honeydew: 0xf0fff0,\r\n        hotpink: 0xff69b4,\r\n        indianred: 0xcd5c5c,\r\n        indigo: 0x4b0082,\r\n        ivory: 0xfffff0,\r\n        khaki: 0xf0e68c,\r\n        lavender: 0xe6e6fa,\r\n        lavenderblush: 0xfff0f5,\r\n        lawngreen: 0x7cfc00,\r\n        lemonchiffon: 0xfffacd,\r\n        lightblue: 0xadd8e6,\r\n        lightcoral: 0xf08080,\r\n        lightcyan: 0xe0ffff,\r\n        lightgoldenrodyellow: 0xfafad2,\r\n        lightgray: 0xd3d3d3,\r\n        lightgrey: 0xd3d3d3,\r\n        lightgreen: 0x90ee90,\r\n        lightpink: 0xffb6c1,\r\n        lightsalmon: 0xffa07a,\r\n        lightseagreen: 0x20b2aa,\r\n        lightskyblue: 0x87cefa,\r\n        lightslategray: 0x778899,\r\n        lightslategrey: 0x778899,\r\n        lightsteelblue: 0xb0c4de,\r\n        lightyellow: 0xffffe0,\r\n        lime: 0x00ff00,\r\n        limegreen: 0x32cd32,\r\n        linen: 0xfaf0e6,\r\n        magenta: 0xff00ff,\r\n        maroon: 0x800000,\r\n        mediumaquamarine: 0x66cdaa,\r\n        mediumblue: 0x0000cd,\r\n        mediumorchid: 0xba55d3,\r\n        mediumpurple: 0x9370db,\r\n        mediumseagreen: 0x3cb371,\r\n        mediumslateblue: 0x7b68ee,\r\n        mediumspringgreen: 0x00fa9a,\r\n        mediumturquoise: 0x48d1cc,\r\n        mediumvioletred: 0xc71585,\r\n        midnightblue: 0x191970,\r\n        mintcream: 0xf5fffa,\r\n        mistyrose: 0xffe4e1,\r\n        moccasin: 0xffe4b5,\r\n        navajowhite: 0xffdead,\r\n        navy: 0x000080,\r\n        oldlace: 0xfdf5e6,\r\n        olive: 0x808000,\r\n        olivedrab: 0x6b8e23,\r\n        orange: 0xffa500,\r\n        orangered: 0xff4500,\r\n        orchid: 0xda70d6,\r\n        palegoldenrod: 0xeee8aa,\r\n        palegreen: 0x98fb98,\r\n        paleturquoise: 0xafeeee,\r\n        palevioletred: 0xdb7093,\r\n        papayawhip: 0xffefd5,\r\n        peachpuff: 0xffdab9,\r\n        peru: 0xcd853f,\r\n        pink: 0xffc0cb,\r\n        plum: 0xdda0dd,\r\n        powderblue: 0xb0e0e6,\r\n        purple: 0x800080,\r\n        rebeccapurple: 0x663399,\r\n        red: 0xff0000,\r\n        rosybrown: 0xbc8f8f,\r\n        royalblue: 0x4169e1,\r\n        saddlebrown: 0x8b4513,\r\n        salmon: 0xfa8072,\r\n        sandybrown: 0xf4a460,\r\n        seagreen: 0x2e8b57,\r\n        seashell: 0xfff5ee,\r\n        sienna: 0xa0522d,\r\n        silver: 0xc0c0c0,\r\n        skyblue: 0x87ceeb,\r\n        slateblue: 0x6a5acd,\r\n        slategray: 0x708090,\r\n        slategrey: 0x708090,\r\n        snow: 0xfffafa,\r\n        springgreen: 0x00ff7f,\r\n        steelblue: 0x4682b4,\r\n        tan: 0xd2b48c,\r\n        teal: 0x008080,\r\n        thistle: 0xd8bfd8,\r\n        tomato: 0xff6347,\r\n        turquoise: 0x40e0d0,\r\n        violet: 0xee82ee,\r\n        wheat: 0xf5deb3,\r\n        white: 0xffffff,\r\n        whitesmoke: 0xf5f5f5,\r\n        yellow: 0xffff00,\r\n        yellowgreen: 0x9acd32,\r\n    }));\r\n    var systemColors = new Map(Object.entries({\r\n        ActiveBorder: 0x3b99fc,\r\n        ActiveCaption: 0x000000,\r\n        AppWorkspace: 0xaaaaaa,\r\n        Background: 0x6363ce,\r\n        ButtonFace: 0xffffff,\r\n        ButtonHighlight: 0xe9e9e9,\r\n        ButtonShadow: 0x9fa09f,\r\n        ButtonText: 0x000000,\r\n        CaptionText: 0x000000,\r\n        GrayText: 0x7f7f7f,\r\n        Highlight: 0xb2d7ff,\r\n        HighlightText: 0x000000,\r\n        InactiveBorder: 0xffffff,\r\n        InactiveCaption: 0xffffff,\r\n        InactiveCaptionText: 0x000000,\r\n        InfoBackground: 0xfbfcc5,\r\n        InfoText: 0x000000,\r\n        Menu: 0xf6f6f6,\r\n        MenuText: 0xffffff,\r\n        Scrollbar: 0xaaaaaa,\r\n        ThreeDDarkShadow: 0x000000,\r\n        ThreeDFace: 0xc0c0c0,\r\n        ThreeDHighlight: 0xffffff,\r\n        ThreeDLightShadow: 0xffffff,\r\n        ThreeDShadow: 0x000000,\r\n        Window: 0xececec,\r\n        WindowFrame: 0xaaaaaa,\r\n        WindowText: 0x000000,\r\n        '-webkit-focus-ring-color': 0xe59700\r\n    }).map(function (_a) {\r\n        var _b = __read(_a, 2), key = _b[0], value = _b[1];\r\n        return [key.toLowerCase(), value];\r\n    }));\n\n    function scale(x, inLow, inHigh, outLow, outHigh) {\r\n        return (x - inLow) * (outHigh - outLow) / (inHigh - inLow) + outLow;\r\n    }\r\n    function clamp(x, min, max) {\r\n        return Math.min(max, Math.max(min, x));\r\n    }\r\n    function multiplyMatrices(m1, m2) {\r\n        var result = [];\r\n        for (var i = 0, len = m1.length; i < len; i++) {\r\n            result[i] = [];\r\n            for (var j = 0, len2 = m2[0].length; j < len2; j++) {\r\n                var sum = 0;\r\n                for (var k = 0, len3 = m1[0].length; k < len3; k++) {\r\n                    sum += m1[i][k] * m2[k][j];\r\n                }\r\n                result[i][j] = sum;\r\n            }\r\n        }\r\n        return result;\r\n    }\n\n    function getMatches(regex, input, group) {\r\n        if (group === void 0) { group = 0; }\r\n        var matches = [];\r\n        var m;\r\n        while ((m = regex.exec(input))) {\r\n            matches.push(m[group]);\r\n        }\r\n        return matches;\r\n    }\r\n    function formatCSS(text) {\r\n        function trimLeft(text) {\r\n            return text.replace(/^\\s+/, '');\r\n        }\r\n        function getIndent(depth) {\r\n            if (depth === 0) {\r\n                return '';\r\n            }\r\n            return ' '.repeat(4 * depth);\r\n        }\r\n        if (text.length < 50000) {\r\n            var emptyRuleRegexp = /[^{}]+{\\s*}/;\r\n            while (emptyRuleRegexp.test(text)) {\r\n                text = text.replace(emptyRuleRegexp, '');\r\n            }\r\n        }\r\n        var css = (text\r\n            .replace(/\\s{2,}/g, ' ')\r\n            .replace(/\\{/g, '{\\n')\r\n            .replace(/\\}/g, '\\n}\\n')\r\n            .replace(/\\;(?![^\\(|\\\"]*(\\)|\\\"))/g, ';\\n')\r\n            .replace(/\\,(?![^\\(|\\\"]*(\\)|\\\"))/g, ',\\n')\r\n            .replace(/\\n\\s*\\n/g, '\\n')\r\n            .split('\\n'));\r\n        var depth = 0;\r\n        var formatted = [];\r\n        for (var x = 0, len = css.length; x < len; x++) {\r\n            var line = css[x] + \"\\n\";\r\n            if (line.includes('{')) {\r\n                formatted.push(getIndent(depth++) + trimLeft(line));\r\n            }\r\n            else if (line.includes('\\}')) {\r\n                formatted.push(getIndent(--depth) + trimLeft(line));\r\n            }\r\n            else {\r\n                formatted.push(getIndent(depth) + trimLeft(line));\r\n            }\r\n        }\r\n        return formatted.join('').trim();\r\n    }\r\n    function getParenthesesRange(input, searchStartIndex) {\r\n        if (searchStartIndex === void 0) { searchStartIndex = 0; }\r\n        var length = input.length;\r\n        var depth = 0;\r\n        var firstOpenIndex = -1;\r\n        for (var i = searchStartIndex; i < length; i++) {\r\n            if (depth === 0) {\r\n                var openIndex = input.indexOf('(', i);\r\n                if (openIndex < 0) {\r\n                    break;\r\n                }\r\n                firstOpenIndex = openIndex;\r\n                depth++;\r\n                i = openIndex;\r\n            }\r\n            else {\r\n                var closingIndex = input.indexOf(')', i);\r\n                if (closingIndex < 0) {\r\n                    break;\r\n                }\r\n                var openIndex = input.indexOf('(', i);\r\n                if (openIndex < 0 || closingIndex < openIndex) {\r\n                    depth--;\r\n                    if (depth === 0) {\r\n                        return { start: firstOpenIndex, end: closingIndex + 1 };\r\n                    }\r\n                    i = closingIndex;\r\n                }\r\n                else {\r\n                    depth++;\r\n                    i = openIndex;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\n\n    function createFilterMatrix(config) {\r\n        var m = Matrix.identity();\r\n        if (config.sepia !== 0) {\r\n            m = multiplyMatrices(m, Matrix.sepia(config.sepia / 100));\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            m = multiplyMatrices(m, Matrix.grayscale(config.grayscale / 100));\r\n        }\r\n        if (config.contrast !== 100) {\r\n            m = multiplyMatrices(m, Matrix.contrast(config.contrast / 100));\r\n        }\r\n        if (config.brightness !== 100) {\r\n            m = multiplyMatrices(m, Matrix.brightness(config.brightness / 100));\r\n        }\r\n        if (config.mode === 1) {\r\n            m = multiplyMatrices(m, Matrix.invertNHue());\r\n        }\r\n        return m;\r\n    }\r\n    function applyColorMatrix(_a, matrix) {\r\n        var _b = __read(_a, 3), r = _b[0], g = _b[1], b = _b[2];\r\n        var rgb = [[r / 255], [g / 255], [b / 255], [1], [1]];\r\n        var result = multiplyMatrices(matrix, rgb);\r\n        return [0, 1, 2].map(function (i) { return clamp(Math.round(result[i][0] * 255), 0, 255); });\r\n    }\r\n    var Matrix = {\r\n        identity: function () {\r\n            return [\r\n                [1, 0, 0, 0, 0],\r\n                [0, 1, 0, 0, 0],\r\n                [0, 0, 1, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        invertNHue: function () {\r\n            return [\r\n                [0.333, -0.667, -0.667, 0, 1],\r\n                [-0.667, 0.333, -0.667, 0, 1],\r\n                [-0.667, -0.667, 0.333, 0, 1],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        brightness: function (v) {\r\n            return [\r\n                [v, 0, 0, 0, 0],\r\n                [0, v, 0, 0, 0],\r\n                [0, 0, v, 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        contrast: function (v) {\r\n            var t = (1 - v) / 2;\r\n            return [\r\n                [v, 0, 0, 0, t],\r\n                [0, v, 0, 0, t],\r\n                [0, 0, v, 0, t],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        sepia: function (v) {\r\n            return [\r\n                [(0.393 + 0.607 * (1 - v)), (0.769 - 0.769 * (1 - v)), (0.189 - 0.189 * (1 - v)), 0, 0],\r\n                [(0.349 - 0.349 * (1 - v)), (0.686 + 0.314 * (1 - v)), (0.168 - 0.168 * (1 - v)), 0, 0],\r\n                [(0.272 - 0.272 * (1 - v)), (0.534 - 0.534 * (1 - v)), (0.131 + 0.869 * (1 - v)), 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n        grayscale: function (v) {\r\n            return [\r\n                [(0.2126 + 0.7874 * (1 - v)), (0.7152 - 0.7152 * (1 - v)), (0.0722 - 0.0722 * (1 - v)), 0, 0],\r\n                [(0.2126 - 0.2126 * (1 - v)), (0.7152 + 0.2848 * (1 - v)), (0.0722 - 0.0722 * (1 - v)), 0, 0],\r\n                [(0.2126 - 0.2126 * (1 - v)), (0.7152 - 0.7152 * (1 - v)), (0.0722 + 0.9278 * (1 - v)), 0, 0],\r\n                [0, 0, 0, 1, 0],\r\n                [0, 0, 0, 0, 1]\r\n            ];\r\n        },\r\n    };\n\n    function getBgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme ? 'darkSchemeBackgroundColor' : 'lightSchemeBackgroundColor';\r\n        return theme[prop];\r\n    }\r\n    function getFgPole(theme) {\r\n        var isDarkScheme = theme.mode === 1;\r\n        var prop = isDarkScheme ? 'darkSchemeTextColor' : 'lightSchemeTextColor';\r\n        return theme[prop];\r\n    }\r\n    var colorModificationCache = new Map();\r\n    var colorParseCache$1 = new Map();\r\n    function parseToHSLWithCache(color) {\r\n        if (colorParseCache$1.has(color)) {\r\n            return colorParseCache$1.get(color);\r\n        }\r\n        var rgb = parse(color);\r\n        var hsl = rgbToHSL(rgb);\r\n        colorParseCache$1.set(color, hsl);\r\n        return hsl;\r\n    }\r\n    function clearColorModificationCache() {\r\n        colorModificationCache.clear();\r\n        colorParseCache$1.clear();\r\n    }\r\n    var rgbCacheKeys = ['r', 'g', 'b', 'a'];\r\n    var themeCacheKeys$1 = ['mode', 'brightness', 'contrast', 'grayscale', 'sepia', 'darkSchemeBackgroundColor', 'darkSchemeTextColor', 'lightSchemeBackgroundColor', 'lightSchemeTextColor'];\r\n    function getCacheId(rgb, theme) {\r\n        var resultId = '';\r\n        rgbCacheKeys.forEach(function (key) {\r\n            resultId += rgb[key] + \";\";\r\n        });\r\n        themeCacheKeys$1.forEach(function (key) {\r\n            resultId += theme[key] + \";\";\r\n        });\r\n        return resultId;\r\n    }\r\n    function modifyColorWithCache(rgb, theme, modifyHSL, poleColor, anotherPoleColor) {\r\n        var fnCache;\r\n        if (colorModificationCache.has(modifyHSL)) {\r\n            fnCache = colorModificationCache.get(modifyHSL);\r\n        }\r\n        else {\r\n            fnCache = new Map();\r\n            colorModificationCache.set(modifyHSL, fnCache);\r\n        }\r\n        var id = getCacheId(rgb, theme);\r\n        if (fnCache.has(id)) {\r\n            return fnCache.get(id);\r\n        }\r\n        var hsl = rgbToHSL(rgb);\r\n        var pole = poleColor == null ? null : parseToHSLWithCache(poleColor);\r\n        var anotherPole = anotherPoleColor == null ? null : parseToHSLWithCache(anotherPoleColor);\r\n        var modified = modifyHSL(hsl, pole, anotherPole);\r\n        var _a = hslToRGB(modified), r = _a.r, g = _a.g, b = _a.b, a = _a.a;\r\n        var matrix = createFilterMatrix(theme);\r\n        var _b = __read(applyColorMatrix([r, g, b], matrix), 3), rf = _b[0], gf = _b[1], bf = _b[2];\r\n        var color = (a === 1 ?\r\n            rgbToHexString({ r: rf, g: gf, b: bf }) :\r\n            rgbToString({ r: rf, g: gf, b: bf, a: a }));\r\n        fnCache.set(id, color);\r\n        return color;\r\n    }\r\n    function noopHSL(hsl) {\r\n        return hsl;\r\n    }\r\n    function modifyColor(rgb, theme) {\r\n        return modifyColorWithCache(rgb, theme, noopHSL);\r\n    }\r\n    function modifyLightSchemeColor(rgb, theme) {\r\n        var poleBg = getBgPole(theme);\r\n        var poleFg = getFgPole(theme);\r\n        return modifyColorWithCache(rgb, theme, modifyLightModeHSL, poleFg, poleBg);\r\n    }\r\n    function modifyLightModeHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral;\r\n        if (isDark) {\r\n            isNeutral = l < 0.2 || s < 0.12;\r\n        }\r\n        else {\r\n            var isBlue = h > 200 && h < 280;\r\n            isNeutral = s < 0.24 || (l > 0.8 && isBlue);\r\n        }\r\n        var hx = h;\r\n        var sx = l;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            }\r\n            else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, poleFg.l, poleBg.l);\r\n        return { h: hx, s: sx, l: lx, a: a };\r\n    }\r\n    var MAX_BG_LIGHTNESS = 0.4;\r\n    function modifyBgHSL(_a, pole) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isBlue = h > 200 && h < 280;\r\n        var isNeutral = s < 0.12 || (l > 0.8 && isBlue);\r\n        if (isDark) {\r\n            var lx_1 = scale(l, 0, 0.5, 0, MAX_BG_LIGHTNESS);\r\n            if (isNeutral) {\r\n                var hx_1 = pole.h;\r\n                var sx = pole.s;\r\n                return { h: hx_1, s: sx, l: lx_1, a: a };\r\n            }\r\n            return { h: h, s: s, l: lx_1, a: a };\r\n        }\r\n        var lx = scale(l, 0.5, 1, MAX_BG_LIGHTNESS, pole.l);\r\n        if (isNeutral) {\r\n            var hx_2 = pole.h;\r\n            var sx = pole.s;\r\n            return { h: hx_2, s: sx, l: lx, a: a };\r\n        }\r\n        var hx = h;\r\n        var isYellow = h > 60 && h < 180;\r\n        if (isYellow) {\r\n            var isCloserToGreen = h > 120;\r\n            if (isCloserToGreen) {\r\n                hx = scale(h, 120, 180, 135, 180);\r\n            }\r\n            else {\r\n                hx = scale(h, 60, 120, 60, 105);\r\n            }\r\n        }\r\n        return { h: hx, s: s, l: lx, a: a };\r\n    }\r\n    function modifyBackgroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getBgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyBgHSL, pole);\r\n    }\r\n    var MIN_FG_LIGHTNESS = 0.55;\r\n    function modifyBlueFgHue(hue) {\r\n        return scale(hue, 205, 245, 205, 220);\r\n    }\r\n    function modifyFgHSL(_a, pole) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isLight = l > 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var isBlue = !isNeutral && h > 205 && h < 245;\r\n        if (isLight) {\r\n            var lx_2 = scale(l, 0.5, 1, MIN_FG_LIGHTNESS, pole.l);\r\n            if (isNeutral) {\r\n                var hx_3 = pole.h;\r\n                var sx = pole.s;\r\n                return { h: hx_3, s: sx, l: lx_2, a: a };\r\n            }\r\n            var hx_4 = h;\r\n            if (isBlue) {\r\n                hx_4 = modifyBlueFgHue(h);\r\n            }\r\n            return { h: hx_4, s: s, l: lx_2, a: a };\r\n        }\r\n        if (isNeutral) {\r\n            var hx_5 = pole.h;\r\n            var sx = pole.s;\r\n            var lx_3 = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n            return { h: hx_5, s: sx, l: lx_3, a: a };\r\n        }\r\n        var hx = h;\r\n        var lx;\r\n        if (isBlue) {\r\n            hx = modifyBlueFgHue(h);\r\n            lx = scale(l, 0, 0.5, pole.l, Math.min(1, MIN_FG_LIGHTNESS + 0.05));\r\n        }\r\n        else {\r\n            lx = scale(l, 0, 0.5, pole.l, MIN_FG_LIGHTNESS);\r\n        }\r\n        return { h: hx, s: s, l: lx, a: a };\r\n    }\r\n    function modifyForegroundColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var pole = getFgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyFgHSL, pole);\r\n    }\r\n    function modifyBorderHSL(_a, poleFg, poleBg) {\r\n        var h = _a.h, s = _a.s, l = _a.l, a = _a.a;\r\n        var isDark = l < 0.5;\r\n        var isNeutral = l < 0.2 || s < 0.24;\r\n        var hx = h;\r\n        var sx = s;\r\n        if (isNeutral) {\r\n            if (isDark) {\r\n                hx = poleFg.h;\r\n                sx = poleFg.s;\r\n            }\r\n            else {\r\n                hx = poleBg.h;\r\n                sx = poleBg.s;\r\n            }\r\n        }\r\n        var lx = scale(l, 0, 1, 0.5, 0.2);\r\n        return { h: hx, s: sx, l: lx, a: a };\r\n    }\r\n    function modifyBorderColor(rgb, theme) {\r\n        if (theme.mode === 0) {\r\n            return modifyLightSchemeColor(rgb, theme);\r\n        }\r\n        var poleFg = getFgPole(theme);\r\n        var poleBg = getBgPole(theme);\r\n        return modifyColorWithCache(rgb, __assign(__assign({}, theme), { mode: 0 }), modifyBorderHSL, poleFg, poleBg);\r\n    }\r\n    function modifyShadowColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\r\n    function modifyGradientColor(rgb, filter) {\r\n        return modifyBackgroundColor(rgb, filter);\r\n    }\n\n    function createTextStyle(config) {\r\n        var lines = [];\r\n        lines.push('*:not(pre, pre *, code, .far, .fa, .glyphicon, [class*=\"vjs-\"], .fab, .fa-github, .fas, .material-icons, .icofont, .typcn, mu, [class*=\"mu-\"], .glyphicon, .icon) {');\r\n        if (config.useFont && config.fontFamily) {\r\n            lines.push(\"  font-family: \" + config.fontFamily + \" !important;\");\r\n        }\r\n        if (config.textStroke > 0) {\r\n            lines.push(\"  -webkit-text-stroke: \" + config.textStroke + \"px !important;\");\r\n            lines.push(\"  text-stroke: \" + config.textStroke + \"px !important;\");\r\n        }\r\n        lines.push('}');\r\n        return lines.join('\\n');\r\n    }\n\n    var FilterMode;\r\n    (function (FilterMode) {\r\n        FilterMode[FilterMode[\"light\"] = 0] = \"light\";\r\n        FilterMode[FilterMode[\"dark\"] = 1] = \"dark\";\r\n    })(FilterMode || (FilterMode = {}));\r\n    function getCSSFilterValue(config) {\r\n        var filters = [];\r\n        if (config.mode === FilterMode.dark) {\r\n            filters.push('invert(100%) hue-rotate(180deg)');\r\n        }\r\n        if (config.brightness !== 100) {\r\n            filters.push(\"brightness(\" + config.brightness + \"%)\");\r\n        }\r\n        if (config.contrast !== 100) {\r\n            filters.push(\"contrast(\" + config.contrast + \"%)\");\r\n        }\r\n        if (config.grayscale !== 0) {\r\n            filters.push(\"grayscale(\" + config.grayscale + \"%)\");\r\n        }\r\n        if (config.sepia !== 0) {\r\n            filters.push(\"sepia(\" + config.sepia + \"%)\");\r\n        }\r\n        if (filters.length === 0) {\r\n            return null;\r\n        }\r\n        return filters.join(' ');\r\n    }\n\n    function toSVGMatrix(matrix) {\r\n        return matrix.slice(0, 4).map(function (m) { return m.map(function (m) { return m.toFixed(3); }).join(' '); }).join(' ');\r\n    }\r\n    function getSVGFilterMatrixValue(config) {\r\n        return toSVGMatrix(createFilterMatrix(config));\r\n    }\n\n    var counter = 0;\r\n    var resolvers$1 = new Map();\r\n    var rejectors = new Map();\r\n    function bgFetch(request) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var id = ++counter;\r\n                        resolvers$1.set(id, resolve);\r\n                        rejectors.set(id, reject);\r\n                        chrome.runtime.sendMessage({ type: MessageType.CS_FETCH, data: request, id: id });\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    chrome.runtime.onMessage.addListener(function (_a) {\r\n        var type = _a.type, data = _a.data, error = _a.error, id = _a.id;\r\n        if (type === MessageType.BG_FETCH_RESPONSE) {\r\n            var resolve = resolvers$1.get(id);\r\n            var reject = rejectors.get(id);\r\n            resolvers$1.delete(id);\r\n            rejectors.delete(id);\r\n            if (error) {\r\n                reject && reject(error);\r\n            }\r\n            else {\r\n                resolve && resolve(data);\r\n            }\r\n        }\r\n    });\n\n    var AsyncQueue = (function () {\r\n        function AsyncQueue() {\r\n            this.queue = [];\r\n            this.timerId = null;\r\n            this.frameDuration = 1000 / 60;\r\n        }\r\n        AsyncQueue.prototype.addToQueue = function (entry) {\r\n            this.queue.push(entry);\r\n            this.startQueue();\r\n        };\r\n        AsyncQueue.prototype.stopQueue = function () {\r\n            if (this.timerId !== null) {\r\n                cancelAnimationFrame(this.timerId);\r\n                this.timerId = null;\r\n            }\r\n            this.queue = [];\r\n        };\r\n        AsyncQueue.prototype.startQueue = function () {\r\n            var _this = this;\r\n            if (this.timerId) {\r\n                return;\r\n            }\r\n            this.timerId = requestAnimationFrame(function () {\r\n                _this.timerId = null;\r\n                var start = Date.now();\r\n                var cb;\r\n                while ((cb = _this.queue.shift())) {\r\n                    cb();\r\n                    if (Date.now() - start >= _this.frameDuration) {\r\n                        _this.startQueue();\r\n                        break;\r\n                    }\r\n                }\r\n            });\r\n        };\r\n        return AsyncQueue;\r\n    }());\n\n    var imageManager = new AsyncQueue();\r\n    function getImageDetails(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {\r\n                        var dataURL, error_1, image_1, error_2;\r\n                        return __generator(this, function (_a) {\r\n                            switch (_a.label) {\r\n                                case 0:\r\n                                    if (!url.startsWith('data:')) return [3, 1];\r\n                                    dataURL = url;\r\n                                    return [3, 4];\r\n                                case 1:\r\n                                    _a.trys.push([1, 3, , 4]);\r\n                                    return [4, getImageDataURL(url)];\r\n                                case 2:\r\n                                    dataURL = _a.sent();\r\n                                    return [3, 4];\r\n                                case 3:\r\n                                    error_1 = _a.sent();\r\n                                    reject(error_1);\r\n                                    return [3, 4];\r\n                                case 4:\r\n                                    _a.trys.push([4, 6, , 7]);\r\n                                    return [4, urlToImage(dataURL)];\r\n                                case 5:\r\n                                    image_1 = _a.sent();\r\n                                    imageManager.addToQueue(function () {\r\n                                        resolve(__assign({ src: url, dataURL: dataURL, width: image_1.naturalWidth, height: image_1.naturalHeight }, analyzeImage(image_1)));\r\n                                    });\r\n                                    return [3, 7];\r\n                                case 6:\r\n                                    error_2 = _a.sent();\r\n                                    reject(error_2);\r\n                                    return [3, 7];\r\n                                case 7: return [2];\r\n                            }\r\n                        });\r\n                    }); })];\r\n            });\r\n        });\r\n    }\r\n    function getImageDataURL(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var parsedURL;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        parsedURL = new URL(url);\r\n                        if (!(parsedURL.origin === location.origin)) return [3, 2];\r\n                        return [4, loadAsDataURL(url)];\r\n                    case 1: return [2, _a.sent()];\r\n                    case 2: return [4, bgFetch({ url: url, responseType: 'data-url' })];\r\n                    case 3: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function urlToImage(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var image = new Image();\r\n                        image.onload = function () { return resolve(image); };\r\n                        image.onerror = function () { return reject(\"Unable to load image \" + url); };\r\n                        image.src = url;\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    var MAX_ANALIZE_PIXELS_COUNT = 32 * 32;\r\n    var canvas;\r\n    var context;\r\n    function createCanvas() {\r\n        var maxWidth = MAX_ANALIZE_PIXELS_COUNT;\r\n        var maxHeight = MAX_ANALIZE_PIXELS_COUNT;\r\n        canvas = document.createElement('canvas');\r\n        canvas.width = maxWidth;\r\n        canvas.height = maxHeight;\r\n        context = canvas.getContext('2d');\r\n        context.imageSmoothingEnabled = false;\r\n    }\r\n    function removeCanvas() {\r\n        canvas = null;\r\n        context = null;\r\n    }\r\n    var MAX_IMAGE_SIZE = 5 * 1024 * 1024;\r\n    function analyzeImage(image) {\r\n        if (!canvas) {\r\n            createCanvas();\r\n        }\r\n        var naturalWidth = image.naturalWidth, naturalHeight = image.naturalHeight;\r\n        if (naturalHeight === 0 || naturalWidth === 0) {\r\n            logWarn(\"logWarn(Image is empty \" + image.currentSrc + \")\");\r\n            return null;\r\n        }\r\n        var size = naturalWidth * naturalHeight * 4;\r\n        if (size > MAX_IMAGE_SIZE) {\r\n            logInfo('Skipped large image analyzing(Larger than 5mb in memory)');\r\n            return {\r\n                isDark: false,\r\n                isLight: false,\r\n                isTransparent: false,\r\n                isLarge: false,\r\n                isTooLarge: true,\r\n            };\r\n        }\r\n        var naturalPixelsCount = naturalWidth * naturalHeight;\r\n        var k = Math.min(1, Math.sqrt(MAX_ANALIZE_PIXELS_COUNT / naturalPixelsCount));\r\n        var width = Math.ceil(naturalWidth * k);\r\n        var height = Math.ceil(naturalHeight * k);\r\n        context.clearRect(0, 0, width, height);\r\n        context.drawImage(image, 0, 0, naturalWidth, naturalHeight, 0, 0, width, height);\r\n        var imageData = context.getImageData(0, 0, width, height);\r\n        var d = imageData.data;\r\n        var TRANSPARENT_ALPHA_THRESHOLD = 0.05;\r\n        var DARK_LIGHTNESS_THRESHOLD = 0.4;\r\n        var LIGHT_LIGHTNESS_THRESHOLD = 0.7;\r\n        var transparentPixelsCount = 0;\r\n        var darkPixelsCount = 0;\r\n        var lightPixelsCount = 0;\r\n        var i, x, y;\r\n        var r, g, b, a;\r\n        var l;\r\n        for (y = 0; y < height; y++) {\r\n            for (x = 0; x < width; x++) {\r\n                i = 4 * (y * width + x);\r\n                r = d[i + 0] / 255;\r\n                g = d[i + 1] / 255;\r\n                b = d[i + 2] / 255;\r\n                a = d[i + 3] / 255;\r\n                if (a < TRANSPARENT_ALPHA_THRESHOLD) {\r\n                    transparentPixelsCount++;\r\n                }\r\n                else {\r\n                    l = 0.2126 * r + 0.7152 * g + 0.0722 * b;\r\n                    if (l < DARK_LIGHTNESS_THRESHOLD) {\r\n                        darkPixelsCount++;\r\n                    }\r\n                    if (l > LIGHT_LIGHTNESS_THRESHOLD) {\r\n                        lightPixelsCount++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var totalPixelsCount = width * height;\r\n        var opaquePixelsCount = totalPixelsCount - transparentPixelsCount;\r\n        var DARK_IMAGE_THRESHOLD = 0.7;\r\n        var LIGHT_IMAGE_THRESHOLD = 0.7;\r\n        var TRANSPARENT_IMAGE_THRESHOLD = 0.1;\r\n        var LARGE_IMAGE_PIXELS_COUNT = 800 * 600;\r\n        return {\r\n            isDark: ((darkPixelsCount / opaquePixelsCount) >= DARK_IMAGE_THRESHOLD),\r\n            isLight: ((lightPixelsCount / opaquePixelsCount) >= LIGHT_IMAGE_THRESHOLD),\r\n            isTransparent: ((transparentPixelsCount / totalPixelsCount) >= TRANSPARENT_IMAGE_THRESHOLD),\r\n            isLarge: (naturalPixelsCount >= LARGE_IMAGE_PIXELS_COUNT),\r\n            isTooLarge: false,\r\n        };\r\n    }\r\n    function getFilteredImageDataURL(_a, theme) {\r\n        var dataURL = _a.dataURL, width = _a.width, height = _a.height;\r\n        var matrix = getSVGFilterMatrixValue(theme);\r\n        var svg = [\r\n            \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\">\",\r\n            '<defs>',\r\n            '<filter id=\"darkreader-image-filter\">',\r\n            \"<feColorMatrix type=\\\"matrix\\\" values=\\\"\" + matrix + \"\\\" />\",\r\n            '</filter>',\r\n            '</defs>',\r\n            \"<image width=\\\"\" + width + \"\\\" height=\\\"\" + height + \"\\\" filter=\\\"url(#darkreader-image-filter)\\\" xlink:href=\\\"\" + dataURL + \"\\\" />\",\r\n            '</svg>',\r\n        ].join('');\r\n        return \"data:image/svg+xml;base64,\" + btoa(svg);\r\n    }\r\n    function cleanImageProcessingCache() {\r\n        imageManager && imageManager.stopQueue();\r\n        removeCanvas();\r\n    }\n\n    function getPriority(ruleStyle, property) {\r\n        return Boolean(ruleStyle && ruleStyle.getPropertyPriority(property));\r\n    }\r\n    function getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageSelectors, isCancelled) {\r\n        if (property.startsWith('--')) {\r\n            var modifier = getVariableModifier(variablesStore, property, value, rule, ignoreImageSelectors, isCancelled);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (value.includes('var(')) {\r\n            var modifier = getVariableDependantModifier(variablesStore, property, value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if ((property.includes('color') && property !== '-webkit-print-color-adjust') ||\r\n            property === 'fill' ||\r\n            property === 'stroke' ||\r\n            property === 'stop-color') {\r\n            var modifier = getColorModifier(property, value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (property === 'background-image' || property === 'list-style-image') {\r\n            var modifier = getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        else if (property.includes('shadow')) {\r\n            var modifier = getShadowModifier(value);\r\n            if (modifier) {\r\n                return { property: property, value: modifier, important: getPriority(rule.style, property), sourceValue: value };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    function getModifiedUserAgentStyle(theme, isIFrame, styleSystemControls) {\r\n        var lines = [];\r\n        if (!isIFrame) {\r\n            lines.push('html {');\r\n            lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme) + \" !important;\");\r\n            lines.push('}');\r\n        }\r\n        lines.push(\"\" + (isIFrame ? '' : 'html, body, ') + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push(\"html, body, \" + (styleSystemControls ? 'input, textarea, select, button' : '') + \" {\");\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 76, g: 76, b: 76 }, theme) + \";\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('a {');\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 64, b: 255 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('table {');\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 128, g: 128, b: 128 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('::placeholder {');\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 169, g: 169, b: 169 }, theme) + \";\");\r\n        lines.push('}');\r\n        lines.push('input:-webkit-autofill,');\r\n        lines.push('textarea:-webkit-autofill,');\r\n        lines.push('select:-webkit-autofill {');\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 250, g: 255, b: 189 }, theme) + \" !important;\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, theme) + \" !important;\");\r\n        lines.push('}');\r\n        if (theme.scrollbarColor) {\r\n            lines.push(getModifiedScrollbarStyle(theme));\r\n        }\r\n        if (theme.selectionColor) {\r\n            lines.push(getModifiedSelectionStyle(theme));\r\n        }\r\n        return lines.join('\\n');\r\n    }\r\n    function getSelectionColor(theme) {\r\n        var backgroundColorSelection;\r\n        var foregroundColorSelection;\r\n        if (theme.selectionColor === 'auto') {\r\n            backgroundColorSelection = modifyBackgroundColor({ r: 0, g: 96, b: 212 }, __assign(__assign({}, theme), { grayscale: 0 }));\r\n            foregroundColorSelection = modifyForegroundColor({ r: 255, g: 255, b: 255 }, __assign(__assign({}, theme), { grayscale: 0 }));\r\n        }\r\n        else {\r\n            var rgb = parse(theme.selectionColor);\r\n            var hsl = rgbToHSL(rgb);\r\n            backgroundColorSelection = theme.selectionColor;\r\n            if (hsl.l < 0.5) {\r\n                foregroundColorSelection = '#FFF';\r\n            }\r\n            else {\r\n                foregroundColorSelection = '#000';\r\n            }\r\n        }\r\n        return { backgroundColorSelection: backgroundColorSelection, foregroundColorSelection: foregroundColorSelection };\r\n    }\r\n    function getModifiedSelectionStyle(theme) {\r\n        var lines = [];\r\n        var modifiedSelectionColor = getSelectionColor(theme);\r\n        var backgroundColorSelection = modifiedSelectionColor.backgroundColorSelection;\r\n        var foregroundColorSelection = modifiedSelectionColor.foregroundColorSelection;\r\n        ['::selection', '::-moz-selection'].forEach(function (selection) {\r\n            lines.push(selection + \" {\");\r\n            lines.push(\"    background-color: \" + backgroundColorSelection + \" !important;\");\r\n            lines.push(\"    color: \" + foregroundColorSelection + \" !important;\");\r\n            lines.push('}');\r\n        });\r\n        return lines.join('\\n');\r\n    }\r\n    function getModifiedScrollbarStyle(theme) {\r\n        var lines = [];\r\n        var colorTrack;\r\n        var colorIcons;\r\n        var colorThumb;\r\n        var colorThumbHover;\r\n        var colorThumbActive;\r\n        var colorCorner;\r\n        if (theme.scrollbarColor === 'auto') {\r\n            colorTrack = modifyBackgroundColor({ r: 241, g: 241, b: 241 }, theme);\r\n            colorIcons = modifyForegroundColor({ r: 96, g: 96, b: 96 }, theme);\r\n            colorThumb = modifyBackgroundColor({ r: 176, g: 176, b: 176 }, theme);\r\n            colorThumbHover = modifyBackgroundColor({ r: 144, g: 144, b: 144 }, theme);\r\n            colorThumbActive = modifyBackgroundColor({ r: 96, g: 96, b: 96 }, theme);\r\n            colorCorner = modifyBackgroundColor({ r: 255, g: 255, b: 255 }, theme);\r\n        }\r\n        else {\r\n            var rgb = parse(theme.scrollbarColor);\r\n            var hsl_1 = rgbToHSL(rgb);\r\n            var isLight = hsl_1.l > 0.5;\r\n            var lighten = function (lighter) { return (__assign(__assign({}, hsl_1), { l: clamp(hsl_1.l + lighter, 0, 1) })); };\r\n            var darken = function (darker) { return (__assign(__assign({}, hsl_1), { l: clamp(hsl_1.l - darker, 0, 1) })); };\r\n            colorTrack = hslToString(darken(0.4));\r\n            colorIcons = hslToString(isLight ? darken(0.4) : lighten(0.4));\r\n            colorThumb = hslToString(hsl_1);\r\n            colorThumbHover = hslToString(lighten(0.1));\r\n            colorThumbActive = hslToString(lighten(0.2));\r\n        }\r\n        lines.push('::-webkit-scrollbar {');\r\n        lines.push(\"    background-color: \" + colorTrack + \";\");\r\n        lines.push(\"    color: \" + colorIcons + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb {');\r\n        lines.push(\"    background-color: \" + colorThumb + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb:hover {');\r\n        lines.push(\"    background-color: \" + colorThumbHover + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-thumb:active {');\r\n        lines.push(\"    background-color: \" + colorThumbActive + \";\");\r\n        lines.push('}');\r\n        lines.push('::-webkit-scrollbar-corner {');\r\n        lines.push(\"    background-color: \" + colorCorner + \";\");\r\n        lines.push('}');\r\n        if (isFirefox) {\r\n            lines.push('* {');\r\n            lines.push(\"    scrollbar-color: \" + colorThumb + \" \" + colorTrack + \";\");\r\n            lines.push('}');\r\n        }\r\n        return lines.join('\\n');\r\n    }\r\n    function getModifiedFallbackStyle(filter, _a) {\r\n        var strict = _a.strict;\r\n        var lines = [];\r\n        lines.push(\"html, body, \" + (strict ? 'body :not(iframe)' : 'body > :not(iframe)') + \" {\");\r\n        lines.push(\"    background-color: \" + modifyBackgroundColor({ r: 255, g: 255, b: 255 }, filter) + \" !important;\");\r\n        lines.push(\"    border-color: \" + modifyBorderColor({ r: 64, g: 64, b: 64 }, filter) + \" !important;\");\r\n        lines.push(\"    color: \" + modifyForegroundColor({ r: 0, g: 0, b: 0 }, filter) + \" !important;\");\r\n        lines.push('}');\r\n        return lines.join('\\n');\r\n    }\r\n    var unparsableColors = new Set([\r\n        'inherit',\r\n        'transparent',\r\n        'initial',\r\n        'currentcolor',\r\n        'none',\r\n        'unset',\r\n    ]);\r\n    var colorParseCache = new Map();\r\n    function parseColorWithCache($color) {\r\n        $color = $color.trim();\r\n        if (colorParseCache.has($color)) {\r\n            return colorParseCache.get($color);\r\n        }\r\n        var color = parse($color);\r\n        colorParseCache.set($color, color);\r\n        return color;\r\n    }\r\n    function tryParseColor($color) {\r\n        try {\r\n            return parseColorWithCache($color);\r\n        }\r\n        catch (err) {\r\n            return null;\r\n        }\r\n    }\r\n    function getColorModifier(prop, value) {\r\n        if (unparsableColors.has(value.toLowerCase())) {\r\n            return value;\r\n        }\r\n        try {\r\n            var rgb_1 = parseColorWithCache(value);\r\n            if (prop.includes('background')) {\r\n                return function (filter) { return modifyBackgroundColor(rgb_1, filter); };\r\n            }\r\n            if (prop.includes('border') || prop.includes('outline')) {\r\n                return function (filter) { return modifyBorderColor(rgb_1, filter); };\r\n            }\r\n            return function (filter) { return modifyForegroundColor(rgb_1, filter); };\r\n        }\r\n        catch (err) {\r\n            logWarn('Color parse error', err);\r\n            return null;\r\n        }\r\n    }\r\n    var gradientRegex = /[\\-a-z]+gradient\\(([^\\(\\)]*(\\(([^\\(\\)]*(\\(.*?\\)))*[^\\(\\)]*\\))){0,15}[^\\(\\)]*\\)/g;\r\n    var imageDetailsCache = new Map();\r\n    var awaitingForImageLoading = new Map();\r\n    function shouldIgnoreImage(selectorText, selectors) {\r\n        if (!selectorText || selectors.length === 0) {\r\n            return false;\r\n        }\r\n        if (selectors.some(function (s) { return s === '*'; })) {\r\n            return true;\r\n        }\r\n        var ruleSelectors = selectorText.split(/,\\s*/g);\r\n        var _loop_1 = function (i) {\r\n            var ignoredSelector = selectors[i];\r\n            if (ruleSelectors.some(function (s) { return s === ignoredSelector; })) {\r\n                return { value: true };\r\n            }\r\n        };\r\n        for (var i = 0; i < selectors.length; i++) {\r\n            var state_1 = _loop_1(i);\r\n            if (typeof state_1 === \"object\")\r\n                return state_1.value;\r\n        }\r\n        return false;\r\n    }\r\n    function getBgImageModifier(value, rule, ignoreImageSelectors, isCancelled) {\r\n        var _this = this;\r\n        try {\r\n            var gradients = getMatches(gradientRegex, value);\r\n            var urls = getMatches(cssURLRegex, value);\r\n            if (urls.length === 0 && gradients.length === 0) {\r\n                return value;\r\n            }\r\n            var getIndices = function (matches) {\r\n                var index = 0;\r\n                return matches.map(function (match) {\r\n                    var valueIndex = value.indexOf(match, index);\r\n                    index = valueIndex + match.length;\r\n                    return { match: match, index: valueIndex };\r\n                });\r\n            };\r\n            var matches_1 = getIndices(urls).map(function (i) { return (__assign({ type: 'url' }, i)); })\r\n                .concat(getIndices(gradients).map(function (i) { return (__assign({ type: 'gradient' }, i)); }))\r\n                .sort(function (a, b) { return a.index - b.index; });\r\n            var getGradientModifier_1 = function (gradient) {\r\n                var match = gradient.match(/^(.*-gradient)\\((.*)\\)$/);\r\n                var type = match[1];\r\n                var content = match[2];\r\n                var partsRegex = /([^\\(\\),]+(\\([^\\(\\)]*(\\([^\\(\\)]*\\)*[^\\(\\)]*)?\\))?[^\\(\\),]*),?/g;\r\n                var colorStopRegex = /^(from|color-stop|to)\\(([^\\(\\)]*?,\\s*)?(.*?)\\)$/;\r\n                var parts = getMatches(partsRegex, content, 1).map(function (part) {\r\n                    part = part.trim();\r\n                    var rgb = tryParseColor(part);\r\n                    if (rgb) {\r\n                        return function (filter) { return modifyGradientColor(rgb, filter); };\r\n                    }\r\n                    var space = part.lastIndexOf(' ');\r\n                    rgb = tryParseColor(part.substring(0, space));\r\n                    if (rgb) {\r\n                        return function (filter) { return modifyGradientColor(rgb, filter) + \" \" + part.substring(space + 1); };\r\n                    }\r\n                    var colorStopMatch = part.match(colorStopRegex);\r\n                    if (colorStopMatch) {\r\n                        rgb = tryParseColor(colorStopMatch[3]);\r\n                        if (rgb) {\r\n                            return function (filter) { return colorStopMatch[1] + \"(\" + (colorStopMatch[2] ? colorStopMatch[2] + \", \" : '') + modifyGradientColor(rgb, filter) + \")\"; };\r\n                        }\r\n                    }\r\n                    return function () { return part; };\r\n                });\r\n                return function (filter) {\r\n                    return type + \"(\" + parts.map(function (modify) { return modify(filter); }).join(', ') + \")\";\r\n                };\r\n            };\r\n            var getURLModifier_1 = function (urlValue) {\r\n                var _a;\r\n                if (shouldIgnoreImage(rule.selectorText, ignoreImageSelectors)) {\r\n                    return null;\r\n                }\r\n                var url = getCSSURLValue(urlValue);\r\n                var parentStyleSheet = rule.parentStyleSheet;\r\n                var baseURL = (parentStyleSheet && parentStyleSheet.href) ?\r\n                    getCSSBaseBath(parentStyleSheet.href) :\r\n                    ((_a = parentStyleSheet.ownerNode) === null || _a === void 0 ? void 0 : _a.baseURI) || location.origin;\r\n                url = getAbsoluteURL(baseURL, url);\r\n                var absoluteValue = \"url(\\\"\" + url + \"\\\")\";\r\n                return function (filter) { return __awaiter(_this, void 0, void 0, function () {\r\n                    var imageDetails, awaiters_1, err_1, bgImageValue;\r\n                    return __generator(this, function (_a) {\r\n                        switch (_a.label) {\r\n                            case 0:\r\n                                if (!imageDetailsCache.has(url)) return [3, 1];\r\n                                imageDetails = imageDetailsCache.get(url);\r\n                                return [3, 7];\r\n                            case 1:\r\n                                _a.trys.push([1, 6, , 7]);\r\n                                if (!awaitingForImageLoading.has(url)) return [3, 3];\r\n                                awaiters_1 = awaitingForImageLoading.get(url);\r\n                                return [4, new Promise(function (resolve) { return awaiters_1.push(resolve); })];\r\n                            case 2:\r\n                                imageDetails = _a.sent();\r\n                                if (!imageDetails) {\r\n                                    return [2, null];\r\n                                }\r\n                                return [3, 5];\r\n                            case 3:\r\n                                awaitingForImageLoading.set(url, []);\r\n                                return [4, getImageDetails(url)];\r\n                            case 4:\r\n                                imageDetails = _a.sent();\r\n                                imageDetailsCache.set(url, imageDetails);\r\n                                awaitingForImageLoading.get(url).forEach(function (resolve) { return resolve(imageDetails); });\r\n                                awaitingForImageLoading.delete(url);\r\n                                _a.label = 5;\r\n                            case 5:\r\n                                if (isCancelled()) {\r\n                                    return [2, null];\r\n                                }\r\n                                return [3, 7];\r\n                            case 6:\r\n                                err_1 = _a.sent();\r\n                                logWarn(err_1);\r\n                                if (awaitingForImageLoading.has(url)) {\r\n                                    awaitingForImageLoading.get(url).forEach(function (resolve) { return resolve(null); });\r\n                                    awaitingForImageLoading.delete(url);\r\n                                }\r\n                                return [2, absoluteValue];\r\n                            case 7:\r\n                                bgImageValue = getBgImageValue_1(imageDetails, filter) || absoluteValue;\r\n                                return [2, bgImageValue];\r\n                        }\r\n                    });\r\n                }); };\r\n            };\r\n            var getBgImageValue_1 = function (imageDetails, filter) {\r\n                var isDark = imageDetails.isDark, isLight = imageDetails.isLight, isTransparent = imageDetails.isTransparent, isLarge = imageDetails.isLarge, isTooLarge = imageDetails.isTooLarge, width = imageDetails.width;\r\n                var result;\r\n                if (isTooLarge) {\r\n                    result = \"url(\\\"\" + imageDetails.src + \"\\\")\";\r\n                }\r\n                else if (isDark && isTransparent && filter.mode === 1 && !isLarge && width > 2) {\r\n                    logInfo(\"Inverting dark image \" + imageDetails.src);\r\n                    var inverted = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), { sepia: clamp(filter.sepia + 10, 0, 100) }));\r\n                    result = \"url(\\\"\" + inverted + \"\\\")\";\r\n                }\r\n                else if (isLight && !isTransparent && filter.mode === 1) {\r\n                    if (isLarge) {\r\n                        result = 'none';\r\n                    }\r\n                    else {\r\n                        logInfo(\"Dimming light image \" + imageDetails.src);\r\n                        var dimmed = getFilteredImageDataURL(imageDetails, filter);\r\n                        result = \"url(\\\"\" + dimmed + \"\\\")\";\r\n                    }\r\n                }\r\n                else if (filter.mode === 0 && isLight && !isLarge) {\r\n                    logInfo(\"Applying filter to image \" + imageDetails.src);\r\n                    var filtered = getFilteredImageDataURL(imageDetails, __assign(__assign({}, filter), { brightness: clamp(filter.brightness - 10, 5, 200), sepia: clamp(filter.sepia + 10, 0, 100) }));\r\n                    result = \"url(\\\"\" + filtered + \"\\\")\";\r\n                }\r\n                else {\r\n                    result = null;\r\n                }\r\n                return result;\r\n            };\r\n            var modifiers_1 = [];\r\n            var index_1 = 0;\r\n            matches_1.forEach(function (_a, i) {\r\n                var match = _a.match, type = _a.type, matchStart = _a.index;\r\n                var prefixStart = index_1;\r\n                var matchEnd = matchStart + match.length;\r\n                index_1 = matchEnd;\r\n                modifiers_1.push(function () { return value.substring(prefixStart, matchStart); });\r\n                modifiers_1.push(type === 'url' ? getURLModifier_1(match) : getGradientModifier_1(match));\r\n                if (i === matches_1.length - 1) {\r\n                    modifiers_1.push(function () { return value.substring(matchEnd); });\r\n                }\r\n            });\r\n            return function (filter) {\r\n                var results = modifiers_1.filter(Boolean).map(function (modify) { return modify(filter); });\r\n                if (results.some(function (r) { return r instanceof Promise; })) {\r\n                    return Promise.all(results)\r\n                        .then(function (asyncResults) {\r\n                        return asyncResults.join('');\r\n                    });\r\n                }\r\n                return results.join('');\r\n            };\r\n        }\r\n        catch (err) {\r\n            logWarn(\"Unable to parse gradient \" + value, err);\r\n            return null;\r\n        }\r\n    }\r\n    function getShadowModifier(value) {\r\n        try {\r\n            var index_2 = 0;\r\n            var colorMatches_1 = getMatches(/(^|\\s)(?!calc)([a-z]+\\(.+?\\)|#[0-9a-f]+|[a-z]+)(.*?(inset|outset)?($|,))/ig, value, 2);\r\n            var modifiers_2 = colorMatches_1.map(function (match, i) {\r\n                var prefixIndex = index_2;\r\n                var matchIndex = value.indexOf(match, index_2);\r\n                var matchEnd = matchIndex + match.length;\r\n                index_2 = matchEnd;\r\n                var rgb = tryParseColor(match);\r\n                if (!rgb) {\r\n                    return function () { return value.substring(prefixIndex, matchEnd); };\r\n                }\r\n                return function (filter) { return \"\" + value.substring(prefixIndex, matchIndex) + modifyShadowColor(rgb, filter) + (i === colorMatches_1.length - 1 ? value.substring(matchEnd) : ''); };\r\n            });\r\n            return function (filter) { return modifiers_2.map(function (modify) { return modify(filter); }).join(''); };\r\n        }\r\n        catch (err) {\r\n            logWarn(\"Unable to parse shadow \" + value, err);\r\n            return null;\r\n        }\r\n    }\r\n    function getVariableModifier(variablesStore, prop, value, rule, ignoredImgSelectors, isCancelled) {\r\n        return variablesStore.getModifierForVariable({\r\n            varName: prop,\r\n            sourceValue: value,\r\n            rule: rule,\r\n            ignoredImgSelectors: ignoredImgSelectors,\r\n            isCancelled: isCancelled,\r\n        });\r\n    }\r\n    function getVariableDependantModifier(variablesStore, prop, value) {\r\n        return variablesStore.getModifierForVarDependant(prop, value);\r\n    }\r\n    function cleanModificationCache() {\r\n        colorParseCache.clear();\r\n        clearColorModificationCache();\r\n        imageDetailsCache.clear();\r\n        cleanImageProcessingCache();\r\n        awaitingForImageLoading.clear();\r\n    }\n\n    var VAR_TYPE_BGCOLOR = 1 << 0;\r\n    var VAR_TYPE_TEXTCOLOR = 1 << 1;\r\n    var VAR_TYPE_BORDERCOLOR = 1 << 2;\r\n    var VAR_TYPE_BGIMG = 1 << 3;\r\n    var VariablesStore = (function () {\r\n        function VariablesStore() {\r\n            this.varTypes = new Map();\r\n            this.rulesQueue = [];\r\n            this.definedVars = new Set();\r\n            this.varRefs = new Map();\r\n            this.unknownColorVars = new Set();\r\n            this.unknownBgVars = new Set();\r\n            this.undefinedVars = new Set();\r\n            this.initialVarTypes = new Map();\r\n            this.changedTypeVars = new Set();\r\n            this.typeChangeSubscriptions = new Map();\r\n            this.unstableVarValues = new Map();\r\n        }\r\n        VariablesStore.prototype.clear = function () {\r\n            this.varTypes.clear();\r\n            this.rulesQueue.splice(0);\r\n            this.definedVars.clear();\r\n            this.varRefs.clear();\r\n            this.unknownColorVars.clear();\r\n            this.unknownBgVars.clear();\r\n            this.undefinedVars.clear();\r\n            this.initialVarTypes.clear();\r\n            this.changedTypeVars.clear();\r\n            this.typeChangeSubscriptions.clear();\r\n            this.unstableVarValues.clear();\r\n        };\r\n        VariablesStore.prototype.isVarType = function (varName, typeNum) {\r\n            return (this.varTypes.has(varName) &&\r\n                (this.varTypes.get(varName) & typeNum) > 0);\r\n        };\r\n        VariablesStore.prototype.addRulesForMatching = function (rules) {\r\n            this.rulesQueue.push(rules);\r\n        };\r\n        VariablesStore.prototype.matchVariablesAndDependants = function () {\r\n            var _this = this;\r\n            this.changedTypeVars.clear();\r\n            this.initialVarTypes = new Map(this.varTypes);\r\n            this.collectRootVariables();\r\n            this.collectVariablesAndVarDep(this.rulesQueue);\r\n            this.rulesQueue.splice(0);\r\n            this.collectRootVarDependants();\r\n            this.varRefs.forEach(function (refs, v) {\r\n                refs.forEach(function (r) {\r\n                    if (_this.varTypes.has(v)) {\r\n                        _this.resolveVariableType(r, _this.varTypes.get(v));\r\n                    }\r\n                });\r\n            });\r\n            this.unknownColorVars.forEach(function (v) {\r\n                if (_this.unknownBgVars.has(v)) {\r\n                    _this.unknownColorVars.delete(v);\r\n                    _this.unknownBgVars.delete(v);\r\n                    _this.resolveVariableType(v, VAR_TYPE_BGCOLOR);\r\n                }\r\n                else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR)) {\r\n                    _this.unknownColorVars.delete(v);\r\n                }\r\n                else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.unknownBgVars.forEach(function (v) {\r\n                var hasColor = _this.findVarRef(v, function (ref) {\r\n                    return (_this.unknownColorVars.has(ref) ||\r\n                        _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR));\r\n                }) != null;\r\n                if (hasColor) {\r\n                    _this.itarateVarRefs(v, function (ref) {\r\n                        _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                    });\r\n                }\r\n                else if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                    _this.unknownBgVars.delete(v);\r\n                }\r\n                else {\r\n                    _this.undefinedVars.add(v);\r\n                }\r\n            });\r\n            this.changedTypeVars.forEach(function (varName) {\r\n                if (_this.typeChangeSubscriptions.has(varName)) {\r\n                    _this.typeChangeSubscriptions\r\n                        .get(varName)\r\n                        .forEach(function (callback) {\r\n                        callback();\r\n                    });\r\n                }\r\n            });\r\n            this.changedTypeVars.clear();\r\n        };\r\n        VariablesStore.prototype.getModifierForVariable = function (options) {\r\n            var _this = this;\r\n            return function (theme) {\r\n                var varName = options.varName, sourceValue = options.sourceValue, rule = options.rule, ignoredImgSelectors = options.ignoredImgSelectors, isCancelled = options.isCancelled;\r\n                var getDeclarations = function () {\r\n                    var declarations = [];\r\n                    var addModifiedValue = function (typeNum, varNameWrapper, colorModifier) {\r\n                        if (!_this.isVarType(varName, typeNum)) {\r\n                            return;\r\n                        }\r\n                        var property = varNameWrapper(varName);\r\n                        var modifiedValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            if (isConstructedColorVar(sourceValue)) {\r\n                                var value = insertVarValues(sourceValue, _this.unstableVarValues);\r\n                                if (!value) {\r\n                                    value = typeNum === VAR_TYPE_BGCOLOR ? '#ffffff' : '#000000';\r\n                                }\r\n                                modifiedValue = colorModifier(value, theme);\r\n                            }\r\n                            else {\r\n                                modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) { return varNameWrapper(v); }, function (fallback) { return colorModifier(fallback, theme); });\r\n                            }\r\n                        }\r\n                        else {\r\n                            modifiedValue = colorModifier(sourceValue, theme);\r\n                        }\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue,\r\n                        });\r\n                    };\r\n                    addModifiedValue(VAR_TYPE_BGCOLOR, wrapBgColorVariableName, tryModifyBgColor);\r\n                    addModifiedValue(VAR_TYPE_TEXTCOLOR, wrapTextColorVariableName, tryModifyTextColor);\r\n                    addModifiedValue(VAR_TYPE_BORDERCOLOR, wrapBorderColorVariableName, tryModifyBorderColor);\r\n                    if (_this.isVarType(varName, VAR_TYPE_BGIMG)) {\r\n                        var property = wrapBgImgVariableName(varName);\r\n                        var modifiedValue = sourceValue;\r\n                        if (isVarDependant(sourceValue)) {\r\n                            modifiedValue = replaceCSSVariablesNames(sourceValue, function (v) { return wrapBgColorVariableName(v); }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                        }\r\n                        var bgModifier = getBgImageModifier(modifiedValue, rule, ignoredImgSelectors, isCancelled);\r\n                        modifiedValue = typeof bgModifier === 'function' ? bgModifier(theme) : bgModifier;\r\n                        declarations.push({\r\n                            property: property,\r\n                            value: modifiedValue,\r\n                        });\r\n                    }\r\n                    return declarations;\r\n                };\r\n                var callbacks = new Set();\r\n                var addListener = function (onTypeChange) {\r\n                    var callback = function () {\r\n                        var decs = getDeclarations();\r\n                        onTypeChange(decs);\r\n                    };\r\n                    callbacks.add(callback);\r\n                    _this.subscribeForVarTypeChange(varName, callback);\r\n                };\r\n                var removeListeners = function () {\r\n                    callbacks.forEach(function (callback) {\r\n                        _this.unsubscribeFromVariableTypeChanges(varName, callback);\r\n                    });\r\n                };\r\n                return {\r\n                    declarations: getDeclarations(),\r\n                    onTypeChange: { addListener: addListener, removeListeners: removeListeners },\r\n                };\r\n            };\r\n        };\r\n        VariablesStore.prototype.getModifierForVarDependant = function (property, sourceValue) {\r\n            var _this = this;\r\n            if (sourceValue.match(/^\\s*(rgb|hsl)a?\\(/)) {\r\n                var isBg_1 = property.startsWith('background');\r\n                var isText_1 = (property === 'color' || property === 'caret-color');\r\n                return function (theme) {\r\n                    var value = insertVarValues(sourceValue, _this.unstableVarValues);\r\n                    if (!value) {\r\n                        value = isBg_1 ? '#ffffff' : '#000000';\r\n                    }\r\n                    var modifier = isBg_1 ? tryModifyBgColor : isText_1 ? tryModifyTextColor : tryModifyBorderColor;\r\n                    return modifier(value, theme);\r\n                };\r\n            }\r\n            if (property === 'background-color') {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapBgColorVariableName(v); }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                };\r\n            }\r\n            if (property === 'color' || property === 'caret-color') {\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapTextColorVariableName(v); }, function (fallback) { return tryModifyTextColor(fallback, theme); });\r\n                };\r\n            }\r\n            if (property === 'background' || property === 'background-image' || property === 'box-shadow') {\r\n                return function (theme) {\r\n                    var unknownVars = new Set();\r\n                    var modify = function () {\r\n                        var variableReplaced = replaceCSSVariablesNames(sourceValue, function (v) {\r\n                            if (_this.isVarType(v, VAR_TYPE_BGCOLOR)) {\r\n                                return wrapBgColorVariableName(v);\r\n                            }\r\n                            if (_this.isVarType(v, VAR_TYPE_BGIMG)) {\r\n                                return wrapBgImgVariableName(v);\r\n                            }\r\n                            unknownVars.add(v);\r\n                            return v;\r\n                        }, function (fallback) { return tryModifyBgColor(fallback, theme); });\r\n                        if (property === 'box-shadow') {\r\n                            var shadowModifier = getShadowModifier(variableReplaced);\r\n                            return shadowModifier(theme) || variableReplaced;\r\n                        }\r\n                        return variableReplaced;\r\n                    };\r\n                    var modified = modify();\r\n                    if (unknownVars.size > 0) {\r\n                        return new Promise(function (resolve) {\r\n                            var firstUnknownVar = unknownVars.values().next().value;\r\n                            var callback = function () {\r\n                                _this.unsubscribeFromVariableTypeChanges(firstUnknownVar, callback);\r\n                                var newValue = modify();\r\n                                resolve(newValue);\r\n                            };\r\n                            _this.subscribeForVarTypeChange(firstUnknownVar, callback);\r\n                        });\r\n                    }\r\n                    return modified;\r\n                };\r\n            }\r\n            if (property.startsWith('border') || property.startsWith('outline')) {\r\n                if (sourceValue.endsWith(')')) {\r\n                    var colorTypeMatch = sourceValue.match(/((rgb|hsl)a?)\\(/);\r\n                    if (colorTypeMatch) {\r\n                        var index_1 = colorTypeMatch.index;\r\n                        return function (theme) {\r\n                            var value = insertVarValues(sourceValue, _this.unstableVarValues);\r\n                            if (!value) {\r\n                                return sourceValue;\r\n                            }\r\n                            var beginning = sourceValue.substring(0, index_1);\r\n                            var color = sourceValue.substring(index_1, sourceValue.length);\r\n                            var inserted = insertVarValues(color, _this.unstableVarValues);\r\n                            var modified = tryModifyBorderColor(inserted, theme);\r\n                            return \"\" + beginning + modified;\r\n                        };\r\n                    }\r\n                }\r\n                return function (theme) {\r\n                    return replaceCSSVariablesNames(sourceValue, function (v) { return wrapBorderColorVariableName(v); }, function (fallback) { return tryModifyTextColor(fallback, theme); });\r\n                };\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.subscribeForVarTypeChange = function (varName, callback) {\r\n            if (!this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.set(varName, new Set());\r\n            }\r\n            var rootStore = this.typeChangeSubscriptions.get(varName);\r\n            if (!rootStore.has(callback)) {\r\n                rootStore.add(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.unsubscribeFromVariableTypeChanges = function (varName, callback) {\r\n            if (this.typeChangeSubscriptions.has(varName)) {\r\n                this.typeChangeSubscriptions.get(varName).delete(callback);\r\n            }\r\n        };\r\n        VariablesStore.prototype.collectVariablesAndVarDep = function (ruleList) {\r\n            var _this = this;\r\n            ruleList.forEach(function (rules) {\r\n                iterateCSSRules(rules, function (rule) {\r\n                    rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\r\n                        if (isVariable(property)) {\r\n                            _this.inspectVariable(property, value);\r\n                        }\r\n                        if (isVarDependant(value)) {\r\n                            _this.inspectVarDependant(property, value);\r\n                        }\r\n                    });\r\n                });\r\n            });\r\n        };\r\n        VariablesStore.prototype.collectRootVariables = function () {\r\n            var _this = this;\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVariable(property)) {\r\n                    _this.inspectVariable(property, value);\r\n                }\r\n            });\r\n        };\r\n        VariablesStore.prototype.inspectVariable = function (varName, value) {\r\n            this.unstableVarValues.set(varName, value);\r\n            if (isVarDependant(value) && isConstructedColorVar(value)) {\r\n                this.unknownColorVars.add(varName);\r\n                this.definedVars.add(varName);\r\n            }\r\n            if (this.definedVars.has(varName)) {\r\n                return;\r\n            }\r\n            this.definedVars.add(varName);\r\n            var color = tryParseColor(value);\r\n            if (color) {\r\n                this.unknownColorVars.add(varName);\r\n            }\r\n            else if (value.includes('url(') ||\r\n                value.includes('linear-gradient(') ||\r\n                value.includes('radial-gradient(')) {\r\n                this.resolveVariableType(varName, VAR_TYPE_BGIMG);\r\n            }\r\n        };\r\n        VariablesStore.prototype.resolveVariableType = function (varName, typeNum) {\r\n            var initialType = this.initialVarTypes.get(varName) || 0;\r\n            var currentType = this.varTypes.get(varName) || 0;\r\n            var newType = currentType | typeNum;\r\n            this.varTypes.set(varName, newType);\r\n            if (newType !== initialType || this.undefinedVars.has(varName)) {\r\n                this.changedTypeVars.add(varName);\r\n                this.undefinedVars.delete(varName);\r\n            }\r\n            this.unknownColorVars.delete(varName);\r\n            this.unknownBgVars.delete(varName);\r\n        };\r\n        VariablesStore.prototype.collectRootVarDependants = function () {\r\n            var _this = this;\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVarDependant(value)) {\r\n                    _this.inspectVarDependant(property, value);\r\n                }\r\n            });\r\n        };\r\n        VariablesStore.prototype.inspectVarDependant = function (property, value) {\r\n            var _this = this;\r\n            if (isVariable(property)) {\r\n                this.iterateVarDeps(value, function (ref) {\r\n                    if (!_this.varRefs.has(property)) {\r\n                        _this.varRefs.set(property, new Set());\r\n                    }\r\n                    _this.varRefs.get(property).add(ref);\r\n                });\r\n            }\r\n            else if (property === 'background-color' || property === 'box-shadow') {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_BGCOLOR); });\r\n            }\r\n            else if (property === 'color' || property === 'caret-color') {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_TEXTCOLOR); });\r\n            }\r\n            else if (property.startsWith('border') || property.startsWith('outline')) {\r\n                this.iterateVarDeps(value, function (v) { return _this.resolveVariableType(v, VAR_TYPE_BORDERCOLOR); });\r\n            }\r\n            else if (property === 'background' || property === 'background-image') {\r\n                this.iterateVarDeps(value, function (v) {\r\n                    if (_this.isVarType(v, VAR_TYPE_BGCOLOR | VAR_TYPE_BGIMG)) {\r\n                        return;\r\n                    }\r\n                    var isBgColor = _this.findVarRef(v, function (ref) {\r\n                        return (_this.unknownColorVars.has(ref) ||\r\n                            _this.isVarType(ref, VAR_TYPE_TEXTCOLOR | VAR_TYPE_BORDERCOLOR));\r\n                    }) != null;\r\n                    _this.itarateVarRefs(v, function (ref) {\r\n                        if (isBgColor) {\r\n                            _this.resolveVariableType(ref, VAR_TYPE_BGCOLOR);\r\n                        }\r\n                        else {\r\n                            _this.unknownBgVars.add(ref);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        };\r\n        VariablesStore.prototype.iterateVarDeps = function (value, iterator) {\r\n            var varDeps = new Set();\r\n            iterateVarDependencies(value, function (v) { return varDeps.add(v); });\r\n            varDeps.forEach(function (v) { return iterator(v); });\r\n        };\r\n        VariablesStore.prototype.findVarRef = function (varName, iterator, stack) {\r\n            var e_1, _a;\r\n            if (stack === void 0) { stack = new Set(); }\r\n            if (stack.has(varName)) {\r\n                return null;\r\n            }\r\n            stack.add(varName);\r\n            var result = iterator(varName);\r\n            if (result) {\r\n                return varName;\r\n            }\r\n            var refs = this.varRefs.get(varName);\r\n            if (!refs || refs.size === 0) {\r\n                return null;\r\n            }\r\n            try {\r\n                for (var refs_1 = __values(refs), refs_1_1 = refs_1.next(); !refs_1_1.done; refs_1_1 = refs_1.next()) {\r\n                    var ref = refs_1_1.value;\r\n                    var found = this.findVarRef(ref, iterator, stack);\r\n                    if (found) {\r\n                        return found;\r\n                    }\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (refs_1_1 && !refs_1_1.done && (_a = refs_1.return)) _a.call(refs_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n            return null;\r\n        };\r\n        VariablesStore.prototype.itarateVarRefs = function (varName, iterator) {\r\n            this.findVarRef(varName, function (ref) {\r\n                iterator(ref);\r\n                return false;\r\n            });\r\n        };\r\n        VariablesStore.prototype.setOnRootVariableChange = function (callback) {\r\n            this.onRootVariableDefined = callback;\r\n        };\r\n        VariablesStore.prototype.putRootVars = function (styleElement, theme) {\r\n            var e_2, _a;\r\n            var _this = this;\r\n            var sheet = styleElement.sheet;\r\n            if (sheet.cssRules.length > 0) {\r\n                sheet.deleteRule(0);\r\n            }\r\n            var declarations = new Map();\r\n            iterateCSSDeclarations(document.documentElement.style, function (property, value) {\r\n                if (isVariable(property)) {\r\n                    if (_this.isVarType(property, VAR_TYPE_BGCOLOR)) {\r\n                        declarations.set(wrapBgColorVariableName(property), tryModifyBgColor(value, theme));\r\n                    }\r\n                    if (_this.isVarType(property, VAR_TYPE_TEXTCOLOR)) {\r\n                        declarations.set(wrapTextColorVariableName(property), tryModifyTextColor(value, theme));\r\n                    }\r\n                    if (_this.isVarType(property, VAR_TYPE_BORDERCOLOR)) {\r\n                        declarations.set(wrapBorderColorVariableName(property), tryModifyBorderColor(value, theme));\r\n                    }\r\n                    _this.subscribeForVarTypeChange(property, _this.onRootVariableDefined);\r\n                }\r\n            });\r\n            var cssLines = [];\r\n            cssLines.push(':root {');\r\n            try {\r\n                for (var declarations_1 = __values(declarations), declarations_1_1 = declarations_1.next(); !declarations_1_1.done; declarations_1_1 = declarations_1.next()) {\r\n                    var _b = __read(declarations_1_1.value, 2), property = _b[0], value = _b[1];\r\n                    cssLines.push(\"    \" + property + \": \" + value + \";\");\r\n                }\r\n            }\r\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\r\n            finally {\r\n                try {\r\n                    if (declarations_1_1 && !declarations_1_1.done && (_a = declarations_1.return)) _a.call(declarations_1);\r\n                }\r\n                finally { if (e_2) throw e_2.error; }\r\n            }\r\n            cssLines.push('}');\r\n            var cssText = cssLines.join('\\n');\r\n            sheet.insertRule(cssText);\r\n        };\r\n        return VariablesStore;\r\n    }());\r\n    var variablesStore = new VariablesStore();\r\n    function getVariableRange(input, searchStart) {\r\n        if (searchStart === void 0) { searchStart = 0; }\r\n        var start = input.indexOf('var(', searchStart);\r\n        if (start >= 0) {\r\n            var range = getParenthesesRange(input, start + 3);\r\n            if (range) {\r\n                return { start: start, end: range.end };\r\n            }\r\n            return null;\r\n        }\r\n    }\r\n    function getVariablesMatches(input) {\r\n        var ranges = [];\r\n        var i = 0;\r\n        var range;\r\n        while ((range = getVariableRange(input, i))) {\r\n            var start = range.start, end = range.end;\r\n            ranges.push({ start: start, end: end, value: input.substring(start, end) });\r\n            i = range.end + 1;\r\n        }\r\n        return ranges;\r\n    }\r\n    function replaceVariablesMatches(input, replacer) {\r\n        var matches = getVariablesMatches(input);\r\n        var matchesCount = matches.length;\r\n        if (matchesCount === 0) {\r\n            return input;\r\n        }\r\n        var inputLength = input.length;\r\n        var replacements = matches.map(function (m) { return replacer(m.value); });\r\n        var parts = [];\r\n        parts.push(input.substring(0, matches[0].start));\r\n        for (var i = 0; i < matchesCount; i++) {\r\n            parts.push(replacements[i]);\r\n            var start = matches[i].end;\r\n            var end = i < matchesCount - 1 ? matches[i + 1].start : inputLength;\r\n            parts.push(input.substring(start, end));\r\n        }\r\n        return parts.join('');\r\n    }\r\n    function getVariableNameAndFallback(match) {\r\n        var commaIndex = match.indexOf(',');\r\n        var name;\r\n        var fallback;\r\n        if (commaIndex >= 0) {\r\n            name = match.substring(4, commaIndex).trim();\r\n            fallback = match.substring(commaIndex + 1, match.length - 1).trim();\r\n        }\r\n        else {\r\n            name = match.substring(4, match.length - 1).trim();\r\n            fallback = '';\r\n        }\r\n        return { name: name, fallback: fallback };\r\n    }\r\n    function replaceCSSVariablesNames(value, nameReplacer, fallbackReplacer) {\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match), name = _a.name, fallback = _a.fallback;\r\n            var newName = nameReplacer(name);\r\n            if (!fallback) {\r\n                return \"var(\" + newName + \")\";\r\n            }\r\n            var newFallback;\r\n            if (isVarDependant(fallback)) {\r\n                newFallback = replaceCSSVariablesNames(fallback, nameReplacer, fallbackReplacer);\r\n            }\r\n            else if (fallbackReplacer) {\r\n                newFallback = fallbackReplacer(fallback);\r\n            }\r\n            else {\r\n                newFallback = fallback;\r\n            }\r\n            return \"var(\" + newName + \", \" + newFallback + \")\";\r\n        };\r\n        return replaceVariablesMatches(value, matchReplacer);\r\n    }\r\n    function iterateVarDependencies(value, iterator) {\r\n        replaceCSSVariablesNames(value, function (varName) {\r\n            iterator(varName);\r\n            return varName;\r\n        });\r\n    }\r\n    function wrapBgColorVariableName(name) {\r\n        return \"--darkreader-bg\" + name;\r\n    }\r\n    function wrapTextColorVariableName(name) {\r\n        return \"--darkreader-text\" + name;\r\n    }\r\n    function wrapBorderColorVariableName(name) {\r\n        return \"--darkreader-border\" + name;\r\n    }\r\n    function wrapBgImgVariableName(name) {\r\n        return \"--darkreader-bgimg\" + name;\r\n    }\r\n    function isVariable(property) {\r\n        return property.startsWith('--');\r\n    }\r\n    function isVarDependant(value) {\r\n        return value.includes('var(');\r\n    }\r\n    function isConstructedColorVar(value) {\r\n        return value.match(/^\\s*(rgb|hsl)a?\\(/);\r\n    }\r\n    function tryModifyBgColor(color, theme) {\r\n        var rgb = tryParseColor(color);\r\n        return rgb ? modifyBackgroundColor(rgb, theme) : color;\r\n    }\r\n    function tryModifyTextColor(color, theme) {\r\n        var rgb = tryParseColor(color);\r\n        return rgb ? modifyForegroundColor(rgb, theme) : color;\r\n    }\r\n    function tryModifyBorderColor(color, theme) {\r\n        var rgb = tryParseColor(color);\r\n        return rgb ? modifyBorderColor(rgb, theme) : color;\r\n    }\r\n    function insertVarValues(source, varValues, stack) {\r\n        if (stack === void 0) { stack = new Set(); }\r\n        var containsUnresolvedVar = false;\r\n        var matchReplacer = function (match) {\r\n            var _a = getVariableNameAndFallback(match), name = _a.name, fallback = _a.fallback;\r\n            if (stack.has(name)) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            stack.add(name);\r\n            var varValue = varValues.get(name) || fallback;\r\n            var inserted = null;\r\n            if (varValue) {\r\n                if (isVarDependant(varValue)) {\r\n                    inserted = insertVarValues(varValue, varValues, stack);\r\n                }\r\n                else {\r\n                    inserted = varValue;\r\n                }\r\n            }\r\n            if (!inserted) {\r\n                containsUnresolvedVar = true;\r\n                return null;\r\n            }\r\n            return inserted;\r\n        };\r\n        var replaced = replaceVariablesMatches(source, matchReplacer);\r\n        if (containsUnresolvedVar) {\r\n            return null;\r\n        }\r\n        return replaced;\r\n    }\n\n    var overrides = {\r\n        'background-color': {\r\n            customProp: '--darkreader-inline-bgcolor',\r\n            cssProp: 'background-color',\r\n            dataAttr: 'data-darkreader-inline-bgcolor',\r\n        },\r\n        'background-image': {\r\n            customProp: '--darkreader-inline-bgimage',\r\n            cssProp: 'background-image',\r\n            dataAttr: 'data-darkreader-inline-bgimage',\r\n        },\r\n        'border-color': {\r\n            customProp: '--darkreader-inline-border',\r\n            cssProp: 'border-color',\r\n            dataAttr: 'data-darkreader-inline-border',\r\n        },\r\n        'border-bottom-color': {\r\n            customProp: '--darkreader-inline-border-bottom',\r\n            cssProp: 'border-bottom-color',\r\n            dataAttr: 'data-darkreader-inline-border-bottom',\r\n        },\r\n        'border-left-color': {\r\n            customProp: '--darkreader-inline-border-left',\r\n            cssProp: 'border-left-color',\r\n            dataAttr: 'data-darkreader-inline-border-left',\r\n        },\r\n        'border-right-color': {\r\n            customProp: '--darkreader-inline-border-right',\r\n            cssProp: 'border-right-color',\r\n            dataAttr: 'data-darkreader-inline-border-right',\r\n        },\r\n        'border-top-color': {\r\n            customProp: '--darkreader-inline-border-top',\r\n            cssProp: 'border-top-color',\r\n            dataAttr: 'data-darkreader-inline-border-top',\r\n        },\r\n        'box-shadow': {\r\n            customProp: '--darkreader-inline-boxshadow',\r\n            cssProp: 'box-shadow',\r\n            dataAttr: 'data-darkreader-inline-boxshadow',\r\n        },\r\n        'color': {\r\n            customProp: '--darkreader-inline-color',\r\n            cssProp: 'color',\r\n            dataAttr: 'data-darkreader-inline-color',\r\n        },\r\n        'fill': {\r\n            customProp: '--darkreader-inline-fill',\r\n            cssProp: 'fill',\r\n            dataAttr: 'data-darkreader-inline-fill',\r\n        },\r\n        'stroke': {\r\n            customProp: '--darkreader-inline-stroke',\r\n            cssProp: 'stroke',\r\n            dataAttr: 'data-darkreader-inline-stroke',\r\n        },\r\n        'outline-color': {\r\n            customProp: '--darkreader-inline-outline',\r\n            cssProp: 'outline-color',\r\n            dataAttr: 'data-darkreader-inline-outline',\r\n        },\r\n        'stop-color': {\r\n            customProp: '--darkreader-inline-stopcolor',\r\n            cssProp: 'stop-color',\r\n            dataAttr: 'data-darkreader-inline-stopcolor',\r\n        },\r\n    };\r\n    var overridesList = Object.values(overrides);\r\n    var normalizedPropList = {};\r\n    overridesList.forEach(function (_a) {\r\n        var cssProp = _a.cssProp, customProp = _a.customProp;\r\n        return normalizedPropList[customProp] = cssProp;\r\n    });\r\n    var INLINE_STYLE_ATTRS = ['style', 'fill', 'stop-color', 'stroke', 'bgcolor', 'color'];\r\n    var INLINE_STYLE_SELECTOR = INLINE_STYLE_ATTRS.map(function (attr) { return \"[\" + attr + \"]\"; }).join(', ');\r\n    function getInlineOverrideStyle() {\r\n        return overridesList.map(function (_a) {\r\n            var dataAttr = _a.dataAttr, customProp = _a.customProp, cssProp = _a.cssProp;\r\n            return [\r\n                \"[\" + dataAttr + \"] {\",\r\n                \"  \" + cssProp + \": var(\" + customProp + \") !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }).join('\\n');\r\n    }\r\n    function getInlineStyleElements(root) {\r\n        var results = [];\r\n        if (root instanceof Element && root.matches(INLINE_STYLE_SELECTOR)) {\r\n            results.push(root);\r\n        }\r\n        if (root instanceof Element || (isShadowDomSupported && root instanceof ShadowRoot) || root instanceof Document) {\r\n            push(results, root.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        }\r\n        return results;\r\n    }\r\n    var treeObservers = new Map();\r\n    var attrObservers = new Map();\r\n    function watchForInlineStyles(elementStyleDidChange, shadowRootDiscovered) {\r\n        deepWatchForInlineStyles(document, elementStyleDidChange, shadowRootDiscovered);\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            deepWatchForInlineStyles(host.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\r\n        });\r\n    }\r\n    function deepWatchForInlineStyles(root, elementStyleDidChange, shadowRootDiscovered) {\r\n        if (treeObservers.has(root)) {\r\n            treeObservers.get(root).disconnect();\r\n            attrObservers.get(root).disconnect();\r\n        }\r\n        var discoveredNodes = new WeakSet();\r\n        function discoverNodes(node) {\r\n            getInlineStyleElements(node).forEach(function (el) {\r\n                if (discoveredNodes.has(el)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(el);\r\n                elementStyleDidChange(el);\r\n            });\r\n            iterateShadowHosts(node, function (n) {\r\n                if (discoveredNodes.has(node)) {\r\n                    return;\r\n                }\r\n                discoveredNodes.add(node);\r\n                shadowRootDiscovered(n.shadowRoot);\r\n                deepWatchForInlineStyles(n.shadowRoot, elementStyleDidChange, shadowRootDiscovered);\r\n            });\r\n        }\r\n        var treeObserver = createOptimizedTreeObserver(root, {\r\n            onMinorMutations: function (_a) {\r\n                var additions = _a.additions;\r\n                additions.forEach(function (added) { return discoverNodes(added); });\r\n            },\r\n            onHugeMutations: function () {\r\n                discoverNodes(root);\r\n            },\r\n        });\r\n        treeObservers.set(root, treeObserver);\r\n        var attemptCount = 0;\r\n        var start = null;\r\n        var ATTEMPTS_INTERVAL = getDuration({ seconds: 10 });\r\n        var RETRY_TIMEOUT = getDuration({ seconds: 2 });\r\n        var MAX_ATTEMPTS_COUNT = 50;\r\n        var cache = [];\r\n        var timeoutId = null;\r\n        var handleAttributeMutations = throttle(function (mutations) {\r\n            mutations.forEach(function (m) {\r\n                if (INLINE_STYLE_ATTRS.includes(m.attributeName)) {\r\n                    elementStyleDidChange(m.target);\r\n                }\r\n            });\r\n        });\r\n        var attrObserver = new MutationObserver(function (mutations) {\r\n            if (timeoutId) {\r\n                cache.push.apply(cache, __spreadArray([], __read(mutations)));\r\n                return;\r\n            }\r\n            attemptCount++;\r\n            var now = Date.now();\r\n            if (start == null) {\r\n                start = now;\r\n            }\r\n            else if (attemptCount >= MAX_ATTEMPTS_COUNT) {\r\n                if (now - start < ATTEMPTS_INTERVAL) {\r\n                    timeoutId = setTimeout(function () {\r\n                        start = null;\r\n                        attemptCount = 0;\r\n                        timeoutId = null;\r\n                        var attributeCache = cache;\r\n                        cache = [];\r\n                        handleAttributeMutations(attributeCache);\r\n                    }, RETRY_TIMEOUT);\r\n                    cache.push.apply(cache, __spreadArray([], __read(mutations)));\r\n                    return;\r\n                }\r\n                start = now;\r\n                attemptCount = 1;\r\n            }\r\n            handleAttributeMutations(mutations);\r\n        });\r\n        attrObserver.observe(root, {\r\n            attributes: true,\r\n            attributeFilter: INLINE_STYLE_ATTRS.concat(overridesList.map(function (_a) {\r\n                var dataAttr = _a.dataAttr;\r\n                return dataAttr;\r\n            })),\r\n            subtree: true,\r\n        });\r\n        attrObservers.set(root, attrObserver);\r\n    }\r\n    function stopWatchingForInlineStyles() {\r\n        treeObservers.forEach(function (o) { return o.disconnect(); });\r\n        attrObservers.forEach(function (o) { return o.disconnect(); });\r\n        treeObservers.clear();\r\n        attrObservers.clear();\r\n    }\r\n    var inlineStyleCache = new WeakMap();\r\n    var filterProps = ['brightness', 'contrast', 'grayscale', 'sepia', 'mode'];\r\n    function getInlineStyleCacheKey(el, theme) {\r\n        return INLINE_STYLE_ATTRS\r\n            .map(function (attr) { return attr + \"=\\\"\" + el.getAttribute(attr) + \"\\\"\"; })\r\n            .concat(filterProps.map(function (prop) { return prop + \"=\\\"\" + theme[prop] + \"\\\"\"; }))\r\n            .join(' ');\r\n    }\r\n    function shouldIgnoreInlineStyle(element, selectors) {\r\n        for (var i = 0, len = selectors.length; i < len; i++) {\r\n            var ingnoredSelector = selectors[i];\r\n            if (element.matches(ingnoredSelector)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    function overrideInlineStyle(element, theme, ignoreInlineSelectors, ignoreImageSelectors) {\r\n        var cacheKey = getInlineStyleCacheKey(element, theme);\r\n        if (cacheKey === inlineStyleCache.get(element)) {\r\n            return;\r\n        }\r\n        var unsetProps = new Set(Object.keys(overrides));\r\n        function setCustomProp(targetCSSProp, modifierCSSProp, cssVal) {\r\n            var _a = overrides[targetCSSProp], customProp = _a.customProp, dataAttr = _a.dataAttr;\r\n            var mod = getModifiableCSSDeclaration(modifierCSSProp, cssVal, {}, variablesStore, ignoreImageSelectors, null);\r\n            if (!mod) {\r\n                return;\r\n            }\r\n            var value = mod.value;\r\n            if (typeof value === 'function') {\r\n                value = value(theme);\r\n            }\r\n            element.style.setProperty(customProp, value);\r\n            if (!element.hasAttribute(dataAttr)) {\r\n                element.setAttribute(dataAttr, '');\r\n            }\r\n            unsetProps.delete(targetCSSProp);\r\n        }\r\n        if (ignoreInlineSelectors.length > 0) {\r\n            if (shouldIgnoreInlineStyle(element, ignoreInlineSelectors)) {\r\n                unsetProps.forEach(function (cssProp) {\r\n                    element.removeAttribute(overrides[cssProp].dataAttr);\r\n                });\r\n                return;\r\n            }\r\n        }\r\n        if (element.hasAttribute('bgcolor')) {\r\n            var value = element.getAttribute('bgcolor');\r\n            if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\r\n                value = \"#\" + value;\r\n            }\r\n            setCustomProp('background-color', 'background-color', value);\r\n        }\r\n        if (element.hasAttribute('color') && element.rel !== 'mask-icon') {\r\n            var value = element.getAttribute('color');\r\n            if (value.match(/^[0-9a-f]{3}$/i) || value.match(/^[0-9a-f]{6}$/i)) {\r\n                value = \"#\" + value;\r\n            }\r\n            setCustomProp('color', 'color', value);\r\n        }\r\n        if (element instanceof SVGElement) {\r\n            if (element.hasAttribute('fill')) {\r\n                var SMALL_SVG_LIMIT_1 = 32;\r\n                var value_1 = element.getAttribute('fill');\r\n                if (value_1 !== 'none') {\r\n                    if (!(element instanceof SVGTextElement)) {\r\n                        var handleSVGElement = function () {\r\n                            var _a = element.getBoundingClientRect(), width = _a.width, height = _a.height;\r\n                            var isBg = (width > SMALL_SVG_LIMIT_1 || height > SMALL_SVG_LIMIT_1);\r\n                            setCustomProp('fill', isBg ? 'background-color' : 'color', value_1);\r\n                        };\r\n                        if (isReadyStateComplete()) {\r\n                            handleSVGElement();\r\n                        }\r\n                        else {\r\n                            addReadyStateCompleteListener(handleSVGElement);\r\n                        }\r\n                    }\r\n                    else {\r\n                        setCustomProp('fill', 'color', value_1);\r\n                    }\r\n                }\r\n            }\r\n            if (element.hasAttribute('stop-color')) {\r\n                setCustomProp('stop-color', 'background-color', element.getAttribute('stop-color'));\r\n            }\r\n        }\r\n        if (element.hasAttribute('stroke')) {\r\n            var value = element.getAttribute('stroke');\r\n            setCustomProp('stroke', element instanceof SVGLineElement || element instanceof SVGTextElement ? 'border-color' : 'color', value);\r\n        }\r\n        element.style && iterateCSSDeclarations(element.style, function (property, value) {\r\n            if (property === 'background-image' && value.includes('url')) {\r\n                return;\r\n            }\r\n            if (overrides.hasOwnProperty(property)) {\r\n                setCustomProp(property, property, value);\r\n            }\r\n            else {\r\n                var overridenProp = normalizedPropList[property];\r\n                if (overridenProp && (!element.style.getPropertyValue(overridenProp) && !element.hasAttribute(overridenProp))) {\r\n                    element.style.setProperty(property, '');\r\n                }\r\n            }\r\n        });\r\n        if (element.style && element instanceof SVGTextElement && element.style.fill) {\r\n            setCustomProp('fill', 'color', element.style.getPropertyValue('fill'));\r\n        }\r\n        forEach(unsetProps, function (cssProp) {\r\n            element.removeAttribute(overrides[cssProp].dataAttr);\r\n        });\r\n        inlineStyleCache.set(element, getInlineStyleCacheKey(element, theme));\r\n    }\n\n    var metaThemeColorName = 'theme-color';\r\n    var metaThemeColorSelector = \"meta[name=\\\"\" + metaThemeColorName + \"\\\"]\";\r\n    var srcMetaThemeColor = null;\r\n    var observer = null;\r\n    function changeMetaThemeColor(meta, theme) {\r\n        srcMetaThemeColor = srcMetaThemeColor || meta.content;\r\n        try {\r\n            var color = parse(srcMetaThemeColor);\r\n            meta.content = modifyBackgroundColor(color, theme);\r\n        }\r\n        catch (err) {\r\n            logWarn(err);\r\n        }\r\n    }\r\n    function changeMetaThemeColorWhenAvailable(theme) {\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta) {\r\n            changeMetaThemeColor(meta, theme);\r\n        }\r\n        else {\r\n            if (observer) {\r\n                observer.disconnect();\r\n            }\r\n            observer = new MutationObserver(function (mutations) {\r\n                loop: for (var i = 0; i < mutations.length; i++) {\r\n                    var addedNodes = mutations[i].addedNodes;\r\n                    for (var j = 0; j < addedNodes.length; j++) {\r\n                        var node = addedNodes[j];\r\n                        if (node instanceof HTMLMetaElement && node.name === metaThemeColorName) {\r\n                            observer.disconnect();\r\n                            observer = null;\r\n                            changeMetaThemeColor(node, theme);\r\n                            break loop;\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            observer.observe(document.head, { childList: true });\r\n        }\r\n    }\r\n    function restoreMetaThemeColor() {\r\n        if (observer) {\r\n            observer.disconnect();\r\n            observer = null;\r\n        }\r\n        var meta = document.querySelector(metaThemeColorSelector);\r\n        if (meta && srcMetaThemeColor) {\r\n            meta.content = srcMetaThemeColor;\r\n        }\r\n    }\n\n    var themeCacheKeys = [\r\n        'mode',\r\n        'brightness',\r\n        'contrast',\r\n        'grayscale',\r\n        'sepia',\r\n        'darkSchemeBackgroundColor',\r\n        'darkSchemeTextColor',\r\n        'lightSchemeBackgroundColor',\r\n        'lightSchemeTextColor',\r\n    ];\r\n    function getThemeKey(theme) {\r\n        return themeCacheKeys.map(function (p) { return p + \":\" + theme[p]; }).join(';');\r\n    }\r\n    var asyncQueue = createAsyncTasksQueue();\r\n    function createStyleSheetModifier() {\r\n        var renderId = 0;\r\n        var rulesTextCache = new Set();\r\n        var rulesModCache = new Map();\r\n        var varTypeChangeCleaners = new Set();\r\n        var prevFilterKey = null;\r\n        var hasNonLoadedLink = false;\r\n        var wasRebuilt = false;\r\n        function shouldRebuildStyle() {\r\n            return hasNonLoadedLink && !wasRebuilt;\r\n        }\r\n        function modifySheet(options) {\r\n            var rules = options.sourceCSSRules;\r\n            var theme = options.theme, ignoreImageAnalysis = options.ignoreImageAnalysis, force = options.force, prepareSheet = options.prepareSheet, isAsyncCancelled = options.isAsyncCancelled;\r\n            var rulesChanged = (rulesModCache.size === 0);\r\n            var notFoundCacheKeys = new Set(rulesModCache.keys());\r\n            var themeKey = getThemeKey(theme);\r\n            var themeChanged = (themeKey !== prevFilterKey);\r\n            if (hasNonLoadedLink) {\r\n                wasRebuilt = true;\r\n            }\r\n            var modRules = [];\r\n            iterateCSSRules(rules, function (rule) {\r\n                var cssText = rule.cssText;\r\n                var textDiffersFromPrev = false;\r\n                notFoundCacheKeys.delete(cssText);\r\n                if (rule.parentRule instanceof CSSMediaRule) {\r\n                    cssText += \";\" + rule.parentRule.media.mediaText;\r\n                }\r\n                if (!rulesTextCache.has(cssText)) {\r\n                    rulesTextCache.add(cssText);\r\n                    textDiffersFromPrev = true;\r\n                }\r\n                if (textDiffersFromPrev) {\r\n                    rulesChanged = true;\r\n                }\r\n                else {\r\n                    modRules.push(rulesModCache.get(cssText));\r\n                    return;\r\n                }\r\n                var modDecs = [];\r\n                rule.style && iterateCSSDeclarations(rule.style, function (property, value) {\r\n                    var mod = getModifiableCSSDeclaration(property, value, rule, variablesStore, ignoreImageAnalysis, isAsyncCancelled);\r\n                    if (mod) {\r\n                        modDecs.push(mod);\r\n                    }\r\n                });\r\n                var modRule = null;\r\n                if (modDecs.length > 0) {\r\n                    var parentRule = rule.parentRule;\r\n                    modRule = { selector: rule.selectorText, declarations: modDecs, parentRule: parentRule };\r\n                    modRules.push(modRule);\r\n                }\r\n                rulesModCache.set(cssText, modRule);\r\n            }, function () {\r\n                hasNonLoadedLink = true;\r\n            });\r\n            notFoundCacheKeys.forEach(function (key) {\r\n                rulesTextCache.delete(key);\r\n                rulesModCache.delete(key);\r\n            });\r\n            prevFilterKey = themeKey;\r\n            if (!force && !rulesChanged && !themeChanged) {\r\n                return;\r\n            }\r\n            renderId++;\r\n            function setRule(target, index, rule) {\r\n                var selector = rule.selector, declarations = rule.declarations;\r\n                var getDeclarationText = function (dec) {\r\n                    var property = dec.property, value = dec.value, important = dec.important, sourceValue = dec.sourceValue;\r\n                    return property + \": \" + (value == null ? sourceValue : value) + (important ? ' !important' : '') + \";\";\r\n                };\r\n                var ruleText = selector + \" { \" + declarations.map(getDeclarationText).join(' ') + \" }\";\r\n                target.insertRule(ruleText, index);\r\n            }\r\n            var asyncDeclarations = new Map();\r\n            var varDeclarations = new Map();\r\n            var asyncDeclarationCounter = 0;\r\n            var varDeclarationCounter = 0;\r\n            var rootReadyGroup = { rule: null, rules: [], isGroup: true };\r\n            var groupRefs = new WeakMap();\r\n            function getGroup(rule) {\r\n                if (rule == null) {\r\n                    return rootReadyGroup;\r\n                }\r\n                if (groupRefs.has(rule)) {\r\n                    return groupRefs.get(rule);\r\n                }\r\n                var group = { rule: rule, rules: [], isGroup: true };\r\n                groupRefs.set(rule, group);\r\n                var parentGroup = getGroup(rule.parentRule);\r\n                parentGroup.rules.push(group);\r\n                return group;\r\n            }\r\n            varTypeChangeCleaners.forEach(function (clear) { return clear(); });\r\n            varTypeChangeCleaners.clear();\r\n            modRules.filter(function (r) { return r; }).forEach(function (_a) {\r\n                var selector = _a.selector, declarations = _a.declarations, parentRule = _a.parentRule;\r\n                var group = getGroup(parentRule);\r\n                var readyStyleRule = { selector: selector, declarations: [], isGroup: false };\r\n                var readyDeclarations = readyStyleRule.declarations;\r\n                group.rules.push(readyStyleRule);\r\n                function handleAsyncDeclaration(property, modified, important, sourceValue) {\r\n                    var asyncKey = ++asyncDeclarationCounter;\r\n                    var asyncDeclaration = { property: property, value: null, important: important, asyncKey: asyncKey, sourceValue: sourceValue };\r\n                    readyDeclarations.push(asyncDeclaration);\r\n                    var currentRenderId = renderId;\r\n                    modified.then(function (asyncValue) {\r\n                        if (!asyncValue || isAsyncCancelled() || currentRenderId !== renderId) {\r\n                            return;\r\n                        }\r\n                        asyncDeclaration.value = asyncValue;\r\n                        asyncQueue.add(function () {\r\n                            if (isAsyncCancelled() || currentRenderId !== renderId) {\r\n                                return;\r\n                            }\r\n                            rebuildAsyncRule(asyncKey);\r\n                        });\r\n                    });\r\n                }\r\n                function handleVarDeclarations(property, modified, important, sourceValue) {\r\n                    var _a = modified, varDecs = _a.declarations, onTypeChange = _a.onTypeChange;\r\n                    var varKey = ++varDeclarationCounter;\r\n                    var currentRenderId = renderId;\r\n                    var initialIndex = readyDeclarations.length;\r\n                    var oldDecs = [];\r\n                    if (varDecs.length === 0) {\r\n                        var tempDec = { property: property, value: sourceValue, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                        readyDeclarations.push(tempDec);\r\n                        oldDecs = [tempDec];\r\n                    }\r\n                    varDecs.forEach(function (mod) {\r\n                        if (mod.value instanceof Promise) {\r\n                            handleAsyncDeclaration(mod.property, mod.value, important, sourceValue);\r\n                        }\r\n                        else {\r\n                            var readyDec = { property: mod.property, value: mod.value, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                            readyDeclarations.push(readyDec);\r\n                            oldDecs.push(readyDec);\r\n                        }\r\n                    });\r\n                    onTypeChange.addListener(function (newDecs) {\r\n                        if (isAsyncCancelled() || currentRenderId !== renderId) {\r\n                            return;\r\n                        }\r\n                        var readyVarDecs = newDecs.map(function (mod) {\r\n                            return { property: mod.property, value: mod.value, important: important, sourceValue: sourceValue, varKey: varKey };\r\n                        });\r\n                        var index = readyDeclarations.indexOf(oldDecs[0], initialIndex);\r\n                        readyDeclarations.splice.apply(readyDeclarations, __spreadArray([index, oldDecs.length], __read(readyVarDecs)));\r\n                        oldDecs = readyVarDecs;\r\n                        rebuildVarRule(varKey);\r\n                    });\r\n                    varTypeChangeCleaners.add(function () { return onTypeChange.removeListeners(); });\r\n                }\r\n                declarations.forEach(function (_a) {\r\n                    var property = _a.property, value = _a.value, important = _a.important, sourceValue = _a.sourceValue;\r\n                    if (typeof value === 'function') {\r\n                        var modified = value(theme);\r\n                        if (modified instanceof Promise) {\r\n                            handleAsyncDeclaration(property, modified, important, sourceValue);\r\n                        }\r\n                        else if (property.startsWith('--')) {\r\n                            handleVarDeclarations(property, modified, important, sourceValue);\r\n                        }\r\n                        else {\r\n                            readyDeclarations.push({ property: property, value: modified, important: important, sourceValue: sourceValue });\r\n                        }\r\n                    }\r\n                    else {\r\n                        readyDeclarations.push({ property: property, value: value, important: important, sourceValue: sourceValue });\r\n                    }\r\n                });\r\n            });\r\n            var sheet = prepareSheet();\r\n            function buildStyleSheet() {\r\n                function createTarget(group, parent) {\r\n                    var rule = group.rule;\r\n                    if (rule instanceof CSSMediaRule) {\r\n                        var media = rule.media;\r\n                        var index = parent.cssRules.length;\r\n                        parent.insertRule(\"@media \" + media.mediaText + \" {}\", index);\r\n                        return parent.cssRules[index];\r\n                    }\r\n                    return parent;\r\n                }\r\n                function iterateReadyRules(group, target, styleIterator) {\r\n                    group.rules.forEach(function (r) {\r\n                        if (r.isGroup) {\r\n                            var t = createTarget(r, target);\r\n                            iterateReadyRules(r, t, styleIterator);\r\n                        }\r\n                        else {\r\n                            styleIterator(r, target);\r\n                        }\r\n                    });\r\n                }\r\n                iterateReadyRules(rootReadyGroup, sheet, function (rule, target) {\r\n                    var index = target.cssRules.length;\r\n                    rule.declarations.forEach(function (_a) {\r\n                        var asyncKey = _a.asyncKey, varKey = _a.varKey;\r\n                        if (asyncKey != null) {\r\n                            asyncDeclarations.set(asyncKey, { rule: rule, target: target, index: index });\r\n                        }\r\n                        if (varKey != null) {\r\n                            varDeclarations.set(varKey, { rule: rule, target: target, index: index });\r\n                        }\r\n                    });\r\n                    setRule(target, index, rule);\r\n                });\r\n            }\r\n            function rebuildAsyncRule(key) {\r\n                var _a = asyncDeclarations.get(key), rule = _a.rule, target = _a.target, index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n                asyncDeclarations.delete(key);\r\n            }\r\n            function rebuildVarRule(key) {\r\n                var _a = varDeclarations.get(key), rule = _a.rule, target = _a.target, index = _a.index;\r\n                target.deleteRule(index);\r\n                setRule(target, index, rule);\r\n            }\r\n            buildStyleSheet();\r\n        }\r\n        return { modifySheet: modifySheet, shouldRebuildStyle: shouldRebuildStyle };\r\n    }\n\n    var STYLE_SELECTOR = 'style, link[rel*=\"stylesheet\" i]:not([disabled])';\r\n    function shouldManageStyle(element) {\r\n        return (((element instanceof HTMLStyleElement) ||\r\n            (element instanceof SVGStyleElement) ||\r\n            (element instanceof HTMLLinkElement &&\r\n                element.rel &&\r\n                element.rel.toLowerCase().includes('stylesheet') &&\r\n                !element.disabled)) &&\r\n            !element.classList.contains('darkreader') &&\r\n            element.media.toLowerCase() !== 'print' &&\r\n            !element.classList.contains('stylus'));\r\n    }\r\n    function getManageableStyles(node, results, deep) {\r\n        if (results === void 0) { results = []; }\r\n        if (deep === void 0) { deep = true; }\r\n        if (shouldManageStyle(node)) {\r\n            results.push(node);\r\n        }\r\n        else if (node instanceof Element || (isShadowDomSupported && node instanceof ShadowRoot) || node === document) {\r\n            forEach(node.querySelectorAll(STYLE_SELECTOR), function (style) { return getManageableStyles(style, results, false); });\r\n            if (deep) {\r\n                iterateShadowHosts(node, function (host) { return getManageableStyles(host.shadowRoot, results, false); });\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    var syncStyleSet = new WeakSet();\r\n    var corsStyleSet = new WeakSet();\r\n    var canOptimizeUsingProxy$1 = false;\r\n    document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\r\n        canOptimizeUsingProxy$1 = true;\r\n    });\r\n    var loadingLinkCounter = 0;\r\n    var rejectorsForLoadingLinks = new Map();\r\n    function cleanLoadingLinks() {\r\n        rejectorsForLoadingLinks.clear();\r\n    }\r\n    function manageStyle(element, _a) {\r\n        var update = _a.update, loadingStart = _a.loadingStart, loadingEnd = _a.loadingEnd;\r\n        var prevStyles = [];\r\n        var next = element;\r\n        while ((next = next.nextElementSibling) && next.matches('.darkreader')) {\r\n            prevStyles.push(next);\r\n        }\r\n        var corsCopy = prevStyles.find(function (el) { return el.matches('.darkreader--cors') && !corsStyleSet.has(el); }) || null;\r\n        var syncStyle = prevStyles.find(function (el) { return el.matches('.darkreader--sync') && !syncStyleSet.has(el); }) || null;\r\n        var corsCopyPositionWatcher = null;\r\n        var syncStylePositionWatcher = null;\r\n        var cancelAsyncOperations = false;\r\n        var isOverrideEmpty = true;\r\n        var sheetModifier = createStyleSheetModifier();\r\n        var observer = new MutationObserver(function () {\r\n            update();\r\n        });\r\n        var observerOptions = { attributes: true, childList: true, subtree: true, characterData: true };\r\n        function containsCSSImport() {\r\n            return element instanceof HTMLStyleElement && element.textContent.trim().match(cssImportRegex);\r\n        }\r\n        function hasCrossOriginImports(cssRules) {\r\n            var result = false;\r\n            if (cssRules) {\r\n                var rule = void 0;\r\n                cssRulesLoop: for (var i = 0, len = cssRules.length; i < len; i++) {\r\n                    rule = cssRules[i];\r\n                    if (rule.href) {\r\n                        if (rule.href.startsWith('http') && !rule.href.startsWith(location.origin)) {\r\n                            result = true;\r\n                            break cssRulesLoop;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        function getRulesSync() {\r\n            if (corsCopy) {\r\n                return corsCopy.sheet.cssRules;\r\n            }\r\n            if (containsCSSImport()) {\r\n                return null;\r\n            }\r\n            var cssRules = safeGetSheetRules();\r\n            if (hasCrossOriginImports(cssRules)) {\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        function insertStyle() {\r\n            if (corsCopy) {\r\n                if (element.nextSibling !== corsCopy) {\r\n                    element.parentNode.insertBefore(corsCopy, element.nextSibling);\r\n                }\r\n                if (corsCopy.nextSibling !== syncStyle) {\r\n                    element.parentNode.insertBefore(syncStyle, corsCopy.nextSibling);\r\n                }\r\n            }\r\n            else if (element.nextSibling !== syncStyle) {\r\n                element.parentNode.insertBefore(syncStyle, element.nextSibling);\r\n            }\r\n        }\r\n        function createSyncStyle() {\r\n            syncStyle = element instanceof SVGStyleElement ?\r\n                document.createElementNS('http://www.w3.org/2000/svg', 'style') :\r\n                document.createElement('style');\r\n            syncStyle.classList.add('darkreader');\r\n            syncStyle.classList.add('darkreader--sync');\r\n            syncStyle.media = 'screen';\r\n            if (!isChromium && element.title) {\r\n                syncStyle.title = element.title;\r\n            }\r\n            syncStyleSet.add(syncStyle);\r\n        }\r\n        var isLoadingRules = false;\r\n        var wasLoadingError = false;\r\n        var loadingLinkId = ++loadingLinkCounter;\r\n        function getRulesAsync() {\r\n            return __awaiter(this, void 0, void 0, function () {\r\n                var cssText, cssBasePath, _a, cssRules, accessError, err_1, crossOriginImport, fullCSSText, err_2;\r\n                var _b;\r\n                return __generator(this, function (_c) {\r\n                    switch (_c.label) {\r\n                        case 0:\r\n                            if (!(element instanceof HTMLLinkElement)) return [3, 7];\r\n                            _a = __read(getRulesOrError(), 2), cssRules = _a[0], accessError = _a[1];\r\n                            if (accessError) {\r\n                                logWarn(accessError);\r\n                            }\r\n                            if (!((!cssRules && !accessError && !isSafari) ||\r\n                                (isSafari && !element.sheet) ||\r\n                                isStillLoadingError(accessError))) return [3, 5];\r\n                            _c.label = 1;\r\n                        case 1:\r\n                            _c.trys.push([1, 3, , 4]);\r\n                            logInfo(\"Linkelement \" + loadingLinkId + \" is not loaded yet and thus will be await for\", element);\r\n                            return [4, linkLoading(element, loadingLinkId)];\r\n                        case 2:\r\n                            _c.sent();\r\n                            return [3, 4];\r\n                        case 3:\r\n                            err_1 = _c.sent();\r\n                            logWarn(err_1);\r\n                            wasLoadingError = true;\r\n                            return [3, 4];\r\n                        case 4:\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            _b = __read(getRulesOrError(), 2), cssRules = _b[0], accessError = _b[1];\r\n                            if (accessError) {\r\n                                logWarn(accessError);\r\n                            }\r\n                            _c.label = 5;\r\n                        case 5:\r\n                            crossOriginImport = hasCrossOriginImports(cssRules);\r\n                            if (cssRules != null && !crossOriginImport) {\r\n                                return [2, cssRules];\r\n                            }\r\n                            return [4, loadText(element.href)];\r\n                        case 6:\r\n                            cssText = _c.sent();\r\n                            cssBasePath = getCSSBaseBath(element.href);\r\n                            if (cancelAsyncOperations) {\r\n                                return [2, null];\r\n                            }\r\n                            return [3, 8];\r\n                        case 7:\r\n                            if (containsCSSImport()) {\r\n                                cssText = element.textContent.trim();\r\n                                cssBasePath = getCSSBaseBath(location.href);\r\n                            }\r\n                            else {\r\n                                return [2, null];\r\n                            }\r\n                            _c.label = 8;\r\n                        case 8:\r\n                            if (!cssText) return [3, 13];\r\n                            _c.label = 9;\r\n                        case 9:\r\n                            _c.trys.push([9, 11, , 12]);\r\n                            return [4, replaceCSSImports(cssText, cssBasePath)];\r\n                        case 10:\r\n                            fullCSSText = _c.sent();\r\n                            corsCopy = createCORSCopy(element, fullCSSText);\r\n                            return [3, 12];\r\n                        case 11:\r\n                            err_2 = _c.sent();\r\n                            logWarn(err_2);\r\n                            return [3, 12];\r\n                        case 12:\r\n                            if (corsCopy) {\r\n                                corsCopyPositionWatcher = watchForNodePosition(corsCopy, 'prev-sibling');\r\n                                return [2, corsCopy.sheet.cssRules];\r\n                            }\r\n                            _c.label = 13;\r\n                        case 13: return [2, null];\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function details() {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                if (isLoadingRules || wasLoadingError) {\r\n                    return null;\r\n                }\r\n                isLoadingRules = true;\r\n                loadingStart();\r\n                getRulesAsync().then(function (results) {\r\n                    isLoadingRules = false;\r\n                    loadingEnd();\r\n                    if (results) {\r\n                        update();\r\n                    }\r\n                }).catch(function (err) {\r\n                    logWarn(err);\r\n                    isLoadingRules = false;\r\n                    loadingEnd();\r\n                });\r\n                return null;\r\n            }\r\n            return { rules: rules };\r\n        }\r\n        var forceRenderStyle = false;\r\n        function render(theme, ignoreImageAnalysis) {\r\n            var rules = getRulesSync();\r\n            if (!rules) {\r\n                return;\r\n            }\r\n            cancelAsyncOperations = false;\r\n            function prepareOverridesSheet() {\r\n                if (!syncStyle) {\r\n                    createSyncStyle();\r\n                }\r\n                syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n                insertStyle();\r\n                if (syncStyle.sheet == null) {\r\n                    syncStyle.textContent = '';\r\n                }\r\n                var sheet = syncStyle.sheet;\r\n                for (var i = sheet.cssRules.length - 1; i >= 0; i--) {\r\n                    sheet.deleteRule(i);\r\n                }\r\n                if (syncStylePositionWatcher) {\r\n                    syncStylePositionWatcher.run();\r\n                }\r\n                else {\r\n                    syncStylePositionWatcher = watchForNodePosition(syncStyle, 'prev-sibling', function () {\r\n                        forceRenderStyle = true;\r\n                        buildOverrides();\r\n                    });\r\n                }\r\n                return syncStyle.sheet;\r\n            }\r\n            function buildOverrides() {\r\n                var force = forceRenderStyle;\r\n                forceRenderStyle = false;\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: force,\r\n                    isAsyncCancelled: function () { return cancelAsyncOperations; },\r\n                });\r\n                isOverrideEmpty = syncStyle.sheet.cssRules.length === 0;\r\n                if (sheetModifier.shouldRebuildStyle()) {\r\n                    addReadyStateCompleteListener(function () { return update(); });\r\n                }\r\n            }\r\n            buildOverrides();\r\n        }\r\n        function getRulesOrError() {\r\n            try {\r\n                if (element.sheet == null) {\r\n                    return [null, null];\r\n                }\r\n                return [element.sheet.cssRules, null];\r\n            }\r\n            catch (err) {\r\n                return [null, err];\r\n            }\r\n        }\r\n        function isStillLoadingError(error) {\r\n            return error && error.message && error.message.includes('loading');\r\n        }\r\n        function safeGetSheetRules() {\r\n            var _a = __read(getRulesOrError(), 2), cssRules = _a[0], err = _a[1];\r\n            if (err) {\r\n                logWarn(err);\r\n                return null;\r\n            }\r\n            return cssRules;\r\n        }\r\n        function watchForSheetChanges() {\r\n            watchForSheetChangesUsingProxy();\r\n            if (!isThunderbird && !(canOptimizeUsingProxy$1 && element.sheet)) {\r\n                watchForSheetChangesUsingRAF();\r\n            }\r\n        }\r\n        var rulesChangeKey = null;\r\n        var rulesCheckFrameId = null;\r\n        function getRulesChangeKey() {\r\n            var rules = safeGetSheetRules();\r\n            return rules ? rules.length : null;\r\n        }\r\n        function didRulesKeyChange() {\r\n            return getRulesChangeKey() !== rulesChangeKey;\r\n        }\r\n        function watchForSheetChangesUsingRAF() {\r\n            rulesChangeKey = getRulesChangeKey();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            var checkForUpdate = function () {\r\n                if (didRulesKeyChange()) {\r\n                    rulesChangeKey = getRulesChangeKey();\r\n                    update();\r\n                }\r\n                if (canOptimizeUsingProxy$1 && element.sheet) {\r\n                    stopWatchingForSheetChangesUsingRAF();\r\n                    return;\r\n                }\r\n                rulesCheckFrameId = requestAnimationFrame(checkForUpdate);\r\n            };\r\n            checkForUpdate();\r\n        }\r\n        function stopWatchingForSheetChangesUsingRAF() {\r\n            cancelAnimationFrame(rulesCheckFrameId);\r\n        }\r\n        var areSheetChangesPending = false;\r\n        function onSheetChange() {\r\n            canOptimizeUsingProxy$1 = true;\r\n            stopWatchingForSheetChangesUsingRAF();\r\n            if (areSheetChangesPending) {\r\n                return;\r\n            }\r\n            function handleSheetChanges() {\r\n                areSheetChangesPending = false;\r\n                if (cancelAsyncOperations) {\r\n                    return;\r\n                }\r\n                update();\r\n            }\r\n            areSheetChangesPending = true;\r\n            if (typeof queueMicrotask === 'function') {\r\n                queueMicrotask(handleSheetChanges);\r\n            }\r\n            else {\r\n                requestAnimationFrame(handleSheetChanges);\r\n            }\r\n        }\r\n        function watchForSheetChangesUsingProxy() {\r\n            element.addEventListener('__darkreader__updateSheet', onSheetChange);\r\n        }\r\n        function stopWatchingForSheetChangesUsingProxy() {\r\n            element.removeEventListener('__darkreader__updateSheet', onSheetChange);\r\n        }\r\n        function stopWatchingForSheetChanges() {\r\n            stopWatchingForSheetChangesUsingProxy();\r\n            stopWatchingForSheetChangesUsingRAF();\r\n        }\r\n        function pause() {\r\n            observer.disconnect();\r\n            cancelAsyncOperations = true;\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.stop();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.stop();\r\n            stopWatchingForSheetChanges();\r\n        }\r\n        function destroy() {\r\n            pause();\r\n            removeNode(corsCopy);\r\n            removeNode(syncStyle);\r\n            loadingEnd();\r\n            if (rejectorsForLoadingLinks.has(loadingLinkId)) {\r\n                var reject = rejectorsForLoadingLinks.get(loadingLinkId);\r\n                rejectorsForLoadingLinks.delete(loadingLinkId);\r\n                reject && reject();\r\n            }\r\n        }\r\n        function watch() {\r\n            observer.observe(element, observerOptions);\r\n            if (element instanceof HTMLStyleElement) {\r\n                watchForSheetChanges();\r\n            }\r\n        }\r\n        var maxMoveCount = 10;\r\n        var moveCount = 0;\r\n        function restore() {\r\n            if (!syncStyle) {\r\n                return;\r\n            }\r\n            moveCount++;\r\n            if (moveCount > maxMoveCount) {\r\n                logWarn('Style sheet was moved multiple times', element);\r\n                return;\r\n            }\r\n            logWarn('Restore style', syncStyle, element);\r\n            insertStyle();\r\n            corsCopyPositionWatcher && corsCopyPositionWatcher.skip();\r\n            syncStylePositionWatcher && syncStylePositionWatcher.skip();\r\n            if (!isOverrideEmpty) {\r\n                forceRenderStyle = true;\r\n                update();\r\n            }\r\n        }\r\n        return {\r\n            details: details,\r\n            render: render,\r\n            pause: pause,\r\n            destroy: destroy,\r\n            watch: watch,\r\n            restore: restore,\r\n        };\r\n    }\r\n    function linkLoading(link, loadingId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve, reject) {\r\n                        var cleanUp = function () {\r\n                            link.removeEventListener('load', onLoad);\r\n                            link.removeEventListener('error', onError);\r\n                            rejectorsForLoadingLinks.delete(loadingId);\r\n                        };\r\n                        var onLoad = function () {\r\n                            cleanUp();\r\n                            logInfo(\"Linkelement \" + loadingId + \" has been loaded\");\r\n                            resolve();\r\n                        };\r\n                        var onError = function () {\r\n                            cleanUp();\r\n                            reject(\"Linkelement \" + loadingId + \" couldn't be loaded. \" + link.href);\r\n                        };\r\n                        rejectorsForLoadingLinks.set(loadingId, function () {\r\n                            cleanUp();\r\n                            reject();\r\n                        });\r\n                        link.addEventListener('load', onLoad);\r\n                        link.addEventListener('error', onError);\r\n                        if (!link.href) {\r\n                            onError();\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    function getCSSImportURL(importDeclaration) {\r\n        return getCSSURLValue(importDeclaration.substring(7).trim().replace(/;$/, ''));\r\n    }\r\n    function loadText(url) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!url.startsWith('data:')) return [3, 3];\r\n                        return [4, fetch(url)];\r\n                    case 1: return [4, (_a.sent()).text()];\r\n                    case 2: return [2, _a.sent()];\r\n                    case 3: return [4, bgFetch({ url: url, responseType: 'text', mimeType: 'text/css', origin: window.location.origin })];\r\n                    case 4: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function replaceCSSImports(cssText, basePath, cache) {\r\n        if (cache === void 0) { cache = new Map(); }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var importMatches, importMatches_1, importMatches_1_1, match, importURL, absoluteURL, importedCSS, err_3, e_1_1;\r\n            var e_1, _a;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        cssText = removeCSSComments(cssText);\r\n                        cssText = replaceCSSFontFace(cssText);\r\n                        cssText = replaceCSSRelativeURLsWithAbsolute(cssText, basePath);\r\n                        importMatches = getMatches(cssImportRegex, cssText);\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        _b.trys.push([1, 10, 11, 12]);\r\n                        importMatches_1 = __values(importMatches), importMatches_1_1 = importMatches_1.next();\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!!importMatches_1_1.done) return [3, 9];\r\n                        match = importMatches_1_1.value;\r\n                        importURL = getCSSImportURL(match);\r\n                        absoluteURL = getAbsoluteURL(basePath, importURL);\r\n                        importedCSS = void 0;\r\n                        if (!cache.has(absoluteURL)) return [3, 3];\r\n                        importedCSS = cache.get(absoluteURL);\r\n                        return [3, 7];\r\n                    case 3:\r\n                        _b.trys.push([3, 6, , 7]);\r\n                        return [4, loadText(absoluteURL)];\r\n                    case 4:\r\n                        importedCSS = _b.sent();\r\n                        cache.set(absoluteURL, importedCSS);\r\n                        return [4, replaceCSSImports(importedCSS, getCSSBaseBath(absoluteURL), cache)];\r\n                    case 5:\r\n                        importedCSS = _b.sent();\r\n                        return [3, 7];\r\n                    case 6:\r\n                        err_3 = _b.sent();\r\n                        logWarn(err_3);\r\n                        importedCSS = '';\r\n                        return [3, 7];\r\n                    case 7:\r\n                        cssText = cssText.split(match).join(importedCSS);\r\n                        _b.label = 8;\r\n                    case 8:\r\n                        importMatches_1_1 = importMatches_1.next();\r\n                        return [3, 2];\r\n                    case 9: return [3, 12];\r\n                    case 10:\r\n                        e_1_1 = _b.sent();\r\n                        e_1 = { error: e_1_1 };\r\n                        return [3, 12];\r\n                    case 11:\r\n                        try {\r\n                            if (importMatches_1_1 && !importMatches_1_1.done && (_a = importMatches_1.return)) _a.call(importMatches_1);\r\n                        }\r\n                        finally { if (e_1) throw e_1.error; }\r\n                        return [7];\r\n                    case 12:\r\n                        cssText = cssText.trim();\r\n                        return [2, cssText];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    function createCORSCopy(srcElement, cssText) {\r\n        if (!cssText) {\r\n            return null;\r\n        }\r\n        var cors = document.createElement('style');\r\n        cors.classList.add('darkreader');\r\n        cors.classList.add('darkreader--cors');\r\n        cors.media = 'screen';\r\n        cors.textContent = cssText;\r\n        srcElement.parentNode.insertBefore(cors, srcElement.nextSibling);\r\n        cors.sheet.disabled = true;\r\n        corsStyleSet.add(cors);\r\n        return cors;\r\n    }\n\n    var observers = [];\r\n    var observedRoots;\r\n    var undefinedGroups = new Map();\r\n    var elementsDefinitionCallback;\r\n    function collectUndefinedElements(root) {\r\n        if (!isDefinedSelectorSupported) {\r\n            return;\r\n        }\r\n        forEach(root.querySelectorAll(':not(:defined)'), function (el) {\r\n            var tag = el.tagName.toLowerCase();\r\n            if (!tag.includes('-')) {\r\n                var extendedTag = el.getAttribute('is');\r\n                if (extendedTag) {\r\n                    tag = extendedTag;\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n            }\r\n            if (!undefinedGroups.has(tag)) {\r\n                undefinedGroups.set(tag, new Set());\r\n                customElementsWhenDefined(tag).then(function () {\r\n                    if (elementsDefinitionCallback) {\r\n                        var elements = undefinedGroups.get(tag);\r\n                        undefinedGroups.delete(tag);\r\n                        elementsDefinitionCallback(Array.from(elements));\r\n                    }\r\n                });\r\n            }\r\n            undefinedGroups.get(tag).add(el);\r\n        });\r\n    }\r\n    var canOptimizeUsingProxy = false;\r\n    document.addEventListener('__darkreader__inlineScriptsAllowed', function () {\r\n        canOptimizeUsingProxy = true;\r\n    });\r\n    var resolvers = new Map();\r\n    function handleIsDefined(e) {\r\n        canOptimizeUsingProxy = true;\r\n        if (resolvers.has(e.detail.tag)) {\r\n            var resolve = resolvers.get(e.detail.tag);\r\n            resolve();\r\n        }\r\n    }\r\n    function customElementsWhenDefined(tag) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2, new Promise(function (resolve) {\r\n                        if (window.customElements && typeof customElements.whenDefined === 'function') {\r\n                            customElements.whenDefined(tag).then(resolve);\r\n                        }\r\n                        else if (canOptimizeUsingProxy) {\r\n                            resolvers.set(tag, resolve);\r\n                            document.dispatchEvent(new CustomEvent('__darkreader__addUndefinedResolver', { detail: { tag: tag } }));\r\n                        }\r\n                        else {\r\n                            var checkIfDefined_1 = function () {\r\n                                var elements = undefinedGroups.get(tag);\r\n                                if (elements && elements.size > 0) {\r\n                                    if (elements.values().next().value.matches(':defined')) {\r\n                                        resolve();\r\n                                    }\r\n                                    else {\r\n                                        requestAnimationFrame(checkIfDefined_1);\r\n                                    }\r\n                                }\r\n                            };\r\n                            requestAnimationFrame(checkIfDefined_1);\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    }\r\n    function watchWhenCustomElementsDefined(callback) {\r\n        elementsDefinitionCallback = callback;\r\n    }\r\n    function unsubscribeFromDefineCustomElements() {\r\n        elementsDefinitionCallback = null;\r\n        undefinedGroups.clear();\r\n        document.removeEventListener('__darkreader__isDefined', handleIsDefined);\r\n    }\r\n    function watchForStyleChanges(currentStyles, update, shadowRootDiscovered) {\r\n        stopWatchingForStyleChanges();\r\n        var prevStyles = new Set(currentStyles);\r\n        var prevStyleSiblings = new WeakMap();\r\n        var nextStyleSiblings = new WeakMap();\r\n        function saveStylePosition(style) {\r\n            prevStyleSiblings.set(style, style.previousElementSibling);\r\n            nextStyleSiblings.set(style, style.nextElementSibling);\r\n        }\r\n        function forgetStylePosition(style) {\r\n            prevStyleSiblings.delete(style);\r\n            nextStyleSiblings.delete(style);\r\n        }\r\n        function didStylePositionChange(style) {\r\n            return (style.previousElementSibling !== prevStyleSiblings.get(style) ||\r\n                style.nextElementSibling !== nextStyleSiblings.get(style));\r\n        }\r\n        currentStyles.forEach(saveStylePosition);\r\n        function handleStyleOperations(operations) {\r\n            var createdStyles = operations.createdStyles, removedStyles = operations.removedStyles, movedStyles = operations.movedStyles;\r\n            createdStyles.forEach(function (s) { return saveStylePosition(s); });\r\n            movedStyles.forEach(function (s) { return saveStylePosition(s); });\r\n            removedStyles.forEach(function (s) { return forgetStylePosition(s); });\r\n            createdStyles.forEach(function (s) { return prevStyles.add(s); });\r\n            removedStyles.forEach(function (s) { return prevStyles.delete(s); });\r\n            if (createdStyles.size + removedStyles.size + movedStyles.size > 0) {\r\n                update({\r\n                    created: Array.from(createdStyles),\r\n                    removed: Array.from(removedStyles),\r\n                    moved: Array.from(movedStyles),\r\n                    updated: [],\r\n                });\r\n            }\r\n        }\r\n        function handleMinorTreeMutations(_a) {\r\n            var additions = _a.additions, moves = _a.moves, deletions = _a.deletions;\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            additions.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return createdStyles.add(style); }); });\r\n            deletions.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return removedStyles.add(style); }); });\r\n            moves.forEach(function (node) { return getManageableStyles(node).forEach(function (style) { return movedStyles.add(style); }); });\r\n            handleStyleOperations({ createdStyles: createdStyles, removedStyles: removedStyles, movedStyles: movedStyles });\r\n            additions.forEach(function (n) {\r\n                iterateShadowHosts(n, subscribeForShadowRootChanges);\r\n                collectUndefinedElements(n);\r\n            });\r\n        }\r\n        function handleHugeTreeMutations(root) {\r\n            var styles = new Set(getManageableStyles(root));\r\n            var createdStyles = new Set();\r\n            var removedStyles = new Set();\r\n            var movedStyles = new Set();\r\n            styles.forEach(function (s) {\r\n                if (!prevStyles.has(s)) {\r\n                    createdStyles.add(s);\r\n                }\r\n            });\r\n            prevStyles.forEach(function (s) {\r\n                if (!styles.has(s)) {\r\n                    removedStyles.add(s);\r\n                }\r\n            });\r\n            styles.forEach(function (s) {\r\n                if (!createdStyles.has(s) && !removedStyles.has(s) && didStylePositionChange(s)) {\r\n                    movedStyles.add(s);\r\n                }\r\n            });\r\n            handleStyleOperations({ createdStyles: createdStyles, removedStyles: removedStyles, movedStyles: movedStyles });\r\n            iterateShadowHosts(root, subscribeForShadowRootChanges);\r\n            collectUndefinedElements(root);\r\n        }\r\n        function handleAttributeMutations(mutations) {\r\n            var updatedStyles = new Set();\r\n            var removedStyles = new Set();\r\n            mutations.forEach(function (m) {\r\n                var target = m.target;\r\n                if (target.isConnected) {\r\n                    if (shouldManageStyle(target)) {\r\n                        updatedStyles.add(target);\r\n                    }\r\n                    else if (target instanceof HTMLLinkElement && target.disabled) {\r\n                        removedStyles.add(target);\r\n                    }\r\n                }\r\n            });\r\n            if (updatedStyles.size + removedStyles.size > 0) {\r\n                update({\r\n                    updated: Array.from(updatedStyles),\r\n                    created: [],\r\n                    removed: Array.from(removedStyles),\r\n                    moved: [],\r\n                });\r\n            }\r\n        }\r\n        function observe(root) {\r\n            var treeObserver = createOptimizedTreeObserver(root, {\r\n                onMinorMutations: handleMinorTreeMutations,\r\n                onHugeMutations: handleHugeTreeMutations,\r\n            });\r\n            var attrObserver = new MutationObserver(handleAttributeMutations);\r\n            attrObserver.observe(root, { attributes: true, attributeFilter: ['rel', 'disabled', 'media'], subtree: true });\r\n            observers.push(treeObserver, attrObserver);\r\n            observedRoots.add(root);\r\n        }\r\n        function subscribeForShadowRootChanges(node) {\r\n            var shadowRoot = node.shadowRoot;\r\n            if (shadowRoot == null || observedRoots.has(shadowRoot)) {\r\n                return;\r\n            }\r\n            observe(shadowRoot);\r\n            shadowRootDiscovered(shadowRoot);\r\n        }\r\n        observe(document);\r\n        iterateShadowHosts(document.documentElement, subscribeForShadowRootChanges);\r\n        watchWhenCustomElementsDefined(function (hosts) {\r\n            var newStyles = [];\r\n            hosts.forEach(function (host) { return push(newStyles, getManageableStyles(host.shadowRoot)); });\r\n            update({ created: newStyles, updated: [], removed: [], moved: [] });\r\n            hosts.forEach(function (host) {\r\n                var shadowRoot = host.shadowRoot;\r\n                if (shadowRoot == null) {\r\n                    return;\r\n                }\r\n                subscribeForShadowRootChanges(host);\r\n                iterateShadowHosts(shadowRoot, subscribeForShadowRootChanges);\r\n                collectUndefinedElements(shadowRoot);\r\n            });\r\n        });\r\n        document.addEventListener('__darkreader__isDefined', handleIsDefined);\r\n        collectUndefinedElements(document);\r\n    }\r\n    function resetObservers() {\r\n        observers.forEach(function (o) { return o.disconnect(); });\r\n        observers.splice(0, observers.length);\r\n        observedRoots = new WeakSet();\r\n    }\r\n    function stopWatchingForStyleChanges() {\r\n        resetObservers();\r\n        unsubscribeFromDefineCustomElements();\r\n    }\n\n    function hexify(number) {\r\n        return ((number < 16 ? '0' : '') + number.toString(16));\r\n    }\r\n    function generateUID() {\r\n        if ('randomUUID' in crypto) {\r\n            var uuid = crypto.randomUUID();\r\n            return uuid.substring(0, 8) + uuid.substring(9, 13) + uuid.substring(14, 18) + uuid.substring(19, 23) + uuid.substring(24);\r\n        }\r\n        return Array.from(crypto.getRandomValues(new Uint8Array(16))).map(function (x) { return hexify(x); }).join('');\r\n    }\n\n    var adoptedStyleOverrides = new WeakMap();\r\n    var overrideList = new WeakSet();\r\n    function createAdoptedStyleSheetOverride(node) {\r\n        var cancelAsyncOperations = false;\r\n        function injectSheet(sheet, override) {\r\n            var newSheets = __spreadArray([], __read(node.adoptedStyleSheets));\r\n            var sheetIndex = newSheets.indexOf(sheet);\r\n            var existingIndex = newSheets.indexOf(override);\r\n            if (sheetIndex === existingIndex - 1) {\r\n                return;\r\n            }\r\n            if (existingIndex >= 0) {\r\n                newSheets.splice(existingIndex, 1);\r\n            }\r\n            newSheets.splice(sheetIndex + 1, 0, override);\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function destroy() {\r\n            cancelAsyncOperations = true;\r\n            var newSheets = __spreadArray([], __read(node.adoptedStyleSheets));\r\n            node.adoptedStyleSheets.forEach(function (adoptedStyleSheet) {\r\n                if (overrideList.has(adoptedStyleSheet)) {\r\n                    var existingIndex = newSheets.indexOf(adoptedStyleSheet);\r\n                    if (existingIndex >= 0) {\r\n                        newSheets.splice(existingIndex, 1);\r\n                    }\r\n                    adoptedStyleOverrides.delete(adoptedStyleSheet);\r\n                    overrideList.delete(adoptedStyleSheet);\r\n                }\r\n            });\r\n            node.adoptedStyleSheets = newSheets;\r\n        }\r\n        function render(theme, ignoreImageAnalysis) {\r\n            node.adoptedStyleSheets.forEach(function (sheet) {\r\n                if (overrideList.has(sheet)) {\r\n                    return;\r\n                }\r\n                var rules = sheet.rules;\r\n                var override = new CSSStyleSheet();\r\n                function prepareOverridesSheet() {\r\n                    for (var i = override.cssRules.length - 1; i >= 0; i--) {\r\n                        override.deleteRule(i);\r\n                    }\r\n                    injectSheet(sheet, override);\r\n                    adoptedStyleOverrides.set(sheet, override);\r\n                    overrideList.add(override);\r\n                    return override;\r\n                }\r\n                var sheetModifier = createStyleSheetModifier();\r\n                sheetModifier.modifySheet({\r\n                    prepareSheet: prepareOverridesSheet,\r\n                    sourceCSSRules: rules,\r\n                    theme: theme,\r\n                    ignoreImageAnalysis: ignoreImageAnalysis,\r\n                    force: false,\r\n                    isAsyncCancelled: function () { return cancelAsyncOperations; },\r\n                });\r\n            });\r\n        }\r\n        return {\r\n            render: render,\r\n            destroy: destroy\r\n        };\r\n    }\n\n    function injectProxy() {\r\n        document.dispatchEvent(new CustomEvent('__darkreader__inlineScriptsAllowed'));\r\n        var addRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'addRule');\r\n        var insertRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'insertRule');\r\n        var deleteRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'deleteRule');\r\n        var removeRuleDescriptor = Object.getOwnPropertyDescriptor(CSSStyleSheet.prototype, 'removeRule');\r\n        var documentStyleSheetsDescriptor = Object.getOwnPropertyDescriptor(Document.prototype, 'styleSheets');\r\n        var shouldWrapHTMLElement = location.hostname.endsWith('baidu.com');\r\n        var getElementsByTagNameDescriptor = shouldWrapHTMLElement ?\r\n            Object.getOwnPropertyDescriptor(Element.prototype, 'getElementsByTagName') : null;\r\n        var cleanUp = function () {\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'addRule', addRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', insertRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', deleteRuleDescriptor);\r\n            Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', removeRuleDescriptor);\r\n            document.removeEventListener('__darkreader__cleanUp', cleanUp);\r\n            document.removeEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\r\n            Object.defineProperty(Document.prototype, 'styleSheets', documentStyleSheetsDescriptor);\r\n            if (shouldWrapHTMLElement) {\r\n                Object.defineProperty(Element.prototype, 'getElementsByTagName', getElementsByTagNameDescriptor);\r\n            }\r\n        };\r\n        var addUndefinedResolver = function (e) {\r\n            customElements.whenDefined(e.detail.tag).then(function () {\r\n                document.dispatchEvent(new CustomEvent('__darkreader__isDefined', { detail: { tag: e.detail.tag } }));\r\n            });\r\n        };\r\n        document.addEventListener('__darkreader__cleanUp', cleanUp);\r\n        document.addEventListener('__darkreader__addUndefinedResolver', addUndefinedResolver);\r\n        var updateSheetEvent = new Event('__darkreader__updateSheet');\r\n        function proxyAddRule(selector, style, index) {\r\n            addRuleDescriptor.value.call(this, selector, style, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return -1;\r\n        }\r\n        function proxyInsertRule(rule, index) {\r\n            var returnValue = insertRuleDescriptor.value.call(this, rule, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n            return returnValue;\r\n        }\r\n        function proxyDeleteRule(index) {\r\n            deleteRuleDescriptor.value.call(this, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyRemoveRule(index) {\r\n            removeRuleDescriptor.value.call(this, index);\r\n            if (this.ownerNode && !this.ownerNode.classList.contains('darkreader')) {\r\n                this.ownerNode.dispatchEvent(updateSheetEvent);\r\n            }\r\n        }\r\n        function proxyDocumentStyleSheets() {\r\n            var docSheets = documentStyleSheetsDescriptor.get.call(this);\r\n            var filtered = __spreadArray([], __read(docSheets)).filter(function (styleSheet) {\r\n                return !styleSheet.ownerNode.classList.contains('darkreader');\r\n            });\r\n            return Object.setPrototypeOf(filtered, StyleSheetList.prototype);\r\n        }\r\n        function proxyGetElementsByTagName(tagName) {\r\n            var _this = this;\r\n            var getCurrentElementValue = function () {\r\n                var elements = getElementsByTagNameDescriptor.value.call(_this, tagName);\r\n                if (tagName === 'style') {\r\n                    elements = Object.setPrototypeOf(__spreadArray([], __read(elements)).filter(function (element) {\r\n                        return !element.classList.contains('darkreader');\r\n                    }), NodeList.prototype);\r\n                }\r\n                return elements;\r\n            };\r\n            var elements = getCurrentElementValue();\r\n            var NodeListBehavior = {\r\n                get: function (_, property) {\r\n                    return getCurrentElementValue()[property];\r\n                }\r\n            };\r\n            elements = new Proxy(elements, NodeListBehavior);\r\n            return elements;\r\n        }\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'addRule', Object.assign({}, addRuleDescriptor, { value: proxyAddRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'insertRule', Object.assign({}, insertRuleDescriptor, { value: proxyInsertRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'deleteRule', Object.assign({}, deleteRuleDescriptor, { value: proxyDeleteRule }));\r\n        Object.defineProperty(CSSStyleSheet.prototype, 'removeRule', Object.assign({}, removeRuleDescriptor, { value: proxyRemoveRule }));\r\n        Object.defineProperty(Document.prototype, 'styleSheets', Object.assign({}, documentStyleSheetsDescriptor, { get: proxyDocumentStyleSheets }));\r\n        if (shouldWrapHTMLElement) {\r\n            Object.defineProperty(Element.prototype, 'getElementsByTagName', Object.assign({}, getElementsByTagNameDescriptor, { value: proxyGetElementsByTagName }));\r\n        }\r\n    }\n\n    var INSTANCE_ID = generateUID();\r\n    var styleManagers = new Map();\r\n    var adoptedStyleManagers = [];\r\n    var filter = null;\r\n    var fixes = null;\r\n    var isIFrame$1 = null;\r\n    var ignoredImageAnalysisSelectors = null;\r\n    var ignoredInlineSelectors = null;\r\n    function createOrUpdateStyle(className, root) {\r\n        if (root === void 0) { root = document.head || document; }\r\n        var element = root.querySelector(\".\" + className);\r\n        if (!element) {\r\n            element = document.createElement('style');\r\n            element.classList.add('darkreader');\r\n            element.classList.add(className);\r\n            element.media = 'screen';\r\n            element.textContent = '';\r\n        }\r\n        return element;\r\n    }\r\n    function createOrUpdateScript(className, root) {\r\n        if (root === void 0) { root = document.head || document; }\r\n        var element = root.querySelector(\".\" + className);\r\n        if (!element) {\r\n            element = document.createElement('script');\r\n            element.classList.add('darkreader');\r\n            element.classList.add(className);\r\n        }\r\n        return element;\r\n    }\r\n    var nodePositionWatchers = new Map();\r\n    function setupNodePositionWatcher(node, alias) {\r\n        nodePositionWatchers.has(alias) && nodePositionWatchers.get(alias).stop();\r\n        nodePositionWatchers.set(alias, watchForNodePosition(node, 'parent'));\r\n    }\r\n    function stopStylePositionWatchers() {\r\n        forEach(nodePositionWatchers.values(), function (watcher) { return watcher.stop(); });\r\n        nodePositionWatchers.clear();\r\n    }\r\n    function createStaticStyleOverrides() {\r\n        var fallbackStyle = createOrUpdateStyle('darkreader--fallback', document);\r\n        fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: true });\r\n        document.head.insertBefore(fallbackStyle, document.head.firstChild);\r\n        setupNodePositionWatcher(fallbackStyle, 'fallback');\r\n        var userAgentStyle = createOrUpdateStyle('darkreader--user-agent');\r\n        userAgentStyle.textContent = getModifiedUserAgentStyle(filter, isIFrame$1, filter.styleSystemControls);\r\n        document.head.insertBefore(userAgentStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(userAgentStyle, 'user-agent');\r\n        var textStyle = createOrUpdateStyle('darkreader--text');\r\n        if (filter.useFont || filter.textStroke > 0) {\r\n            textStyle.textContent = createTextStyle(filter);\r\n        }\r\n        else {\r\n            textStyle.textContent = '';\r\n        }\r\n        document.head.insertBefore(textStyle, fallbackStyle.nextSibling);\r\n        setupNodePositionWatcher(textStyle, 'text');\r\n        var invertStyle = createOrUpdateStyle('darkreader--invert');\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                fixes.invert.join(', ') + \" {\",\r\n                \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), { contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100) })) + \" !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }\r\n        else {\r\n            invertStyle.textContent = '';\r\n        }\r\n        document.head.insertBefore(invertStyle, textStyle.nextSibling);\r\n        setupNodePositionWatcher(invertStyle, 'invert');\r\n        var inlineStyle = createOrUpdateStyle('darkreader--inline');\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        document.head.insertBefore(inlineStyle, invertStyle.nextSibling);\r\n        setupNodePositionWatcher(inlineStyle, 'inline');\r\n        var overrideStyle = createOrUpdateStyle('darkreader--override');\r\n        overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\r\n        document.head.appendChild(overrideStyle);\r\n        setupNodePositionWatcher(overrideStyle, 'override');\r\n        var variableStyle = createOrUpdateStyle('darkreader--variables');\r\n        var selectionColors = getSelectionColor(filter);\r\n        var darkSchemeBackgroundColor = filter.darkSchemeBackgroundColor, darkSchemeTextColor = filter.darkSchemeTextColor, lightSchemeBackgroundColor = filter.lightSchemeBackgroundColor, lightSchemeTextColor = filter.lightSchemeTextColor, mode = filter.mode;\r\n        var schemeBackgroundColor = mode === 0 ? lightSchemeBackgroundColor : darkSchemeBackgroundColor;\r\n        var schemeTextColor = mode === 0 ? lightSchemeTextColor : darkSchemeTextColor;\r\n        schemeBackgroundColor = modifyBackgroundColor(parse(schemeBackgroundColor), filter);\r\n        schemeTextColor = modifyForegroundColor(parse(schemeTextColor), filter);\r\n        variableStyle.textContent = [\r\n            \":root {\",\r\n            \"   --darkreader-neutral-background: \" + schemeBackgroundColor + \";\",\r\n            \"   --darkreader-neutral-text: \" + schemeTextColor + \";\",\r\n            \"   --darkreader-selection-background: \" + selectionColors.backgroundColorSelection + \";\",\r\n            \"   --darkreader-selection-text: \" + selectionColors.foregroundColorSelection + \";\",\r\n            \"}\"\r\n        ].join('\\n');\r\n        document.head.insertBefore(variableStyle, inlineStyle.nextSibling);\r\n        setupNodePositionWatcher(variableStyle, 'variables');\r\n        var rootVarsStyle = createOrUpdateStyle('darkreader--root-vars');\r\n        document.head.insertBefore(rootVarsStyle, variableStyle.nextSibling);\r\n        var proxyScript = createOrUpdateScript('darkreader--proxy');\r\n        proxyScript.append(\"(\" + injectProxy + \")()\");\r\n        document.head.insertBefore(proxyScript, rootVarsStyle.nextSibling);\r\n        proxyScript.remove();\r\n    }\r\n    var shadowRootsWithOverrides = new Set();\r\n    function createShadowStaticStyleOverrides(root) {\r\n        var inlineStyle = createOrUpdateStyle('darkreader--inline', root);\r\n        inlineStyle.textContent = getInlineOverrideStyle();\r\n        root.insertBefore(inlineStyle, root.firstChild);\r\n        var overrideStyle = createOrUpdateStyle('darkreader--override', root);\r\n        overrideStyle.textContent = fixes && fixes.css ? replaceCSSTemplates(fixes.css) : '';\r\n        root.insertBefore(overrideStyle, inlineStyle.nextSibling);\r\n        var invertStyle = createOrUpdateStyle('darkreader--invert', root);\r\n        if (fixes && Array.isArray(fixes.invert) && fixes.invert.length > 0) {\r\n            invertStyle.textContent = [\r\n                fixes.invert.join(', ') + \" {\",\r\n                \"    filter: \" + getCSSFilterValue(__assign(__assign({}, filter), { contrast: filter.mode === 0 ? filter.contrast : clamp(filter.contrast - 10, 0, 100) })) + \" !important;\",\r\n                '}',\r\n            ].join('\\n');\r\n        }\r\n        else {\r\n            invertStyle.textContent = '';\r\n        }\r\n        root.insertBefore(invertStyle, overrideStyle.nextSibling);\r\n        shadowRootsWithOverrides.add(root);\r\n    }\r\n    function replaceCSSTemplates($cssText) {\r\n        return $cssText.replace(/\\${(.+?)}/g, function (_, $color) {\r\n            var color = tryParseColor($color);\r\n            if (color) {\r\n                return modifyColor(color, filter);\r\n            }\r\n            logWarn(\"Couldn't parse CSSTemplate's color.\");\r\n            return $color;\r\n        });\r\n    }\r\n    function cleanFallbackStyle() {\r\n        var fallback = document.querySelector('.darkreader--fallback');\r\n        if (fallback) {\r\n            fallback.textContent = '';\r\n        }\r\n    }\r\n    function createDynamicStyleOverrides() {\r\n        cancelRendering();\r\n        var allStyles = getManageableStyles(document);\r\n        var newManagers = allStyles\r\n            .filter(function (style) { return !styleManagers.has(style); })\r\n            .map(function (style) { return createManager(style); });\r\n        newManagers\r\n            .map(function (manager) { return manager.details(); })\r\n            .filter(function (detail) { return detail && detail.rules.length > 0; })\r\n            .forEach(function (detail) {\r\n            variablesStore.addRulesForMatching(detail.rules);\r\n        });\r\n        variablesStore.matchVariablesAndDependants();\r\n        variablesStore.setOnRootVariableChange(function () {\r\n            variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n        });\r\n        variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n        styleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n        }\r\n        newManagers.forEach(function (manager) { return manager.watch(); });\r\n        var inlineStyleElements = toArray(document.querySelectorAll(INLINE_STYLE_SELECTOR));\r\n        iterateShadowHosts(document.documentElement, function (host) {\r\n            createShadowStaticStyleOverrides(host.shadowRoot);\r\n            var elements = host.shadowRoot.querySelectorAll(INLINE_STYLE_SELECTOR);\r\n            if (elements.length > 0) {\r\n                push(inlineStyleElements, elements);\r\n            }\r\n        });\r\n        inlineStyleElements.forEach(function (el) { return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors); });\r\n        handleAdoptedStyleSheets(document);\r\n    }\r\n    var loadingStylesCounter = 0;\r\n    var loadingStyles = new Set();\r\n    function createManager(element) {\r\n        var loadingStyleId = ++loadingStylesCounter;\r\n        logInfo(\"New manager for element, with loadingStyleID \" + loadingStyleId, element);\r\n        function loadingStart() {\r\n            if (!isDOMReady() || !didDocumentShowUp) {\r\n                loadingStyles.add(loadingStyleId);\r\n                logInfo(\"Current amount of styles loading: \" + loadingStyles.size);\r\n                var fallbackStyle = document.querySelector('.darkreader--fallback');\r\n                if (!fallbackStyle.textContent) {\r\n                    fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: false });\r\n                }\r\n            }\r\n        }\r\n        function loadingEnd() {\r\n            loadingStyles.delete(loadingStyleId);\r\n            logInfo(\"Removed loadingStyle \" + loadingStyleId + \", now awaiting: \" + loadingStyles.size);\r\n            logInfo(\"To-do to be loaded\", loadingStyles);\r\n            if (loadingStyles.size === 0 && isDOMReady()) {\r\n                cleanFallbackStyle();\r\n            }\r\n        }\r\n        function update() {\r\n            var details = manager.details();\r\n            if (!details) {\r\n                return;\r\n            }\r\n            variablesStore.addRulesForMatching(details.rules);\r\n            variablesStore.matchVariablesAndDependants();\r\n            manager.render(filter, ignoredImageAnalysisSelectors);\r\n        }\r\n        var manager = manageStyle(element, { update: update, loadingStart: loadingStart, loadingEnd: loadingEnd });\r\n        styleManagers.set(element, manager);\r\n        return manager;\r\n    }\r\n    function removeManager(element) {\r\n        var manager = styleManagers.get(element);\r\n        if (manager) {\r\n            manager.destroy();\r\n            styleManagers.delete(element);\r\n        }\r\n    }\r\n    var throttledRenderAllStyles = throttle(function (callback) {\r\n        styleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        adoptedStyleManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n        callback && callback();\r\n    });\r\n    var cancelRendering = function () {\r\n        throttledRenderAllStyles.cancel();\r\n    };\r\n    function onDOMReady() {\r\n        if (loadingStyles.size === 0) {\r\n            cleanFallbackStyle();\r\n            return;\r\n        }\r\n        logWarn(\"DOM is ready, but still have styles being loaded.\", loadingStyles);\r\n    }\r\n    var documentVisibilityListener = null;\r\n    var didDocumentShowUp = !document.hidden;\r\n    function watchForDocumentVisibility(callback) {\r\n        var alreadyWatching = Boolean(documentVisibilityListener);\r\n        documentVisibilityListener = function () {\r\n            if (!document.hidden) {\r\n                stopWatchingForDocumentVisibility();\r\n                callback();\r\n                didDocumentShowUp = true;\r\n            }\r\n        };\r\n        if (!alreadyWatching) {\r\n            document.addEventListener('visibilitychange', documentVisibilityListener);\r\n        }\r\n    }\r\n    function stopWatchingForDocumentVisibility() {\r\n        document.removeEventListener('visibilitychange', documentVisibilityListener);\r\n        documentVisibilityListener = null;\r\n    }\r\n    function createThemeAndWatchForUpdates() {\r\n        createStaticStyleOverrides();\r\n        function runDynamicStyle() {\r\n            createDynamicStyleOverrides();\r\n            watchForUpdates();\r\n        }\r\n        if (document.hidden) {\r\n            watchForDocumentVisibility(runDynamicStyle);\r\n        }\r\n        else {\r\n            runDynamicStyle();\r\n        }\r\n        changeMetaThemeColorWhenAvailable(filter);\r\n    }\r\n    function handleAdoptedStyleSheets(node) {\r\n        if (Array.isArray(node.adoptedStyleSheets)) {\r\n            if (node.adoptedStyleSheets.length > 0) {\r\n                var newManger = createAdoptedStyleSheetOverride(node);\r\n                adoptedStyleManagers.push(newManger);\r\n                newManger.render(filter, ignoredImageAnalysisSelectors);\r\n            }\r\n        }\r\n    }\r\n    function watchForUpdates() {\r\n        var managedStyles = Array.from(styleManagers.keys());\r\n        watchForStyleChanges(managedStyles, function (_a) {\r\n            var created = _a.created, updated = _a.updated, removed = _a.removed, moved = _a.moved;\r\n            var stylesToRemove = removed;\r\n            var stylesToManage = created.concat(updated).concat(moved)\r\n                .filter(function (style) { return !styleManagers.has(style); });\r\n            var stylesToRestore = moved\r\n                .filter(function (style) { return styleManagers.has(style); });\r\n            logInfo(\"Styles to be removed:\", stylesToRemove);\r\n            stylesToRemove.forEach(function (style) { return removeManager(style); });\r\n            var newManagers = stylesToManage\r\n                .map(function (style) { return createManager(style); });\r\n            newManagers\r\n                .map(function (manager) { return manager.details(); })\r\n                .filter(function (detail) { return detail && detail.rules.length > 0; })\r\n                .forEach(function (detail) {\r\n                variablesStore.addRulesForMatching(detail.rules);\r\n            });\r\n            variablesStore.matchVariablesAndDependants();\r\n            newManagers.forEach(function (manager) { return manager.render(filter, ignoredImageAnalysisSelectors); });\r\n            newManagers.forEach(function (manager) { return manager.watch(); });\r\n            stylesToRestore.forEach(function (style) { return styleManagers.get(style).restore(); });\r\n        }, function (shadowRoot) {\r\n            createShadowStaticStyleOverrides(shadowRoot);\r\n            handleAdoptedStyleSheets(shadowRoot);\r\n        });\r\n        watchForInlineStyles(function (element) {\r\n            overrideInlineStyle(element, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors);\r\n            if (element === document.documentElement) {\r\n                var styleAttr = element.getAttribute('style');\r\n                if (styleAttr.includes('--')) {\r\n                    variablesStore.matchVariablesAndDependants();\r\n                    variablesStore.putRootVars(document.head.querySelector('.darkreader--root-vars'), filter);\r\n                }\r\n            }\r\n        }, function (root) {\r\n            createShadowStaticStyleOverrides(root);\r\n            var inlineStyleElements = root.querySelectorAll(INLINE_STYLE_SELECTOR);\r\n            if (inlineStyleElements.length > 0) {\r\n                forEach(inlineStyleElements, function (el) { return overrideInlineStyle(el, filter, ignoredInlineSelectors, ignoredImageAnalysisSelectors); });\r\n            }\r\n        });\r\n        addDOMReadyListener(onDOMReady);\r\n    }\r\n    function stopWatchingForUpdates() {\r\n        styleManagers.forEach(function (manager) { return manager.pause(); });\r\n        stopStylePositionWatchers();\r\n        stopWatchingForStyleChanges();\r\n        stopWatchingForInlineStyles();\r\n        removeDOMReadyListener(onDOMReady);\r\n        cleanReadyStateCompleteListeners();\r\n    }\r\n    function createDarkReaderInstanceMarker() {\r\n        var metaElement = document.createElement('meta');\r\n        metaElement.name = 'darkreader';\r\n        metaElement.content = INSTANCE_ID;\r\n        document.head.appendChild(metaElement);\r\n    }\r\n    function isAnotherDarkReaderInstanceActive() {\r\n        var meta = document.querySelector('meta[name=\"darkreader\"]');\r\n        if (meta) {\r\n            if (meta.content !== INSTANCE_ID) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        createDarkReaderInstanceMarker();\r\n        return false;\r\n    }\r\n    function createOrUpdateDynamicTheme(filterConfig, dynamicThemeFixes, iframe) {\r\n        filter = filterConfig;\r\n        fixes = dynamicThemeFixes;\r\n        if (fixes) {\r\n            ignoredImageAnalysisSelectors = Array.isArray(fixes.ignoreImageAnalysis) ? fixes.ignoreImageAnalysis : [];\r\n            ignoredInlineSelectors = Array.isArray(fixes.ignoreInlineStyle) ? fixes.ignoreInlineStyle : [];\r\n        }\r\n        else {\r\n            ignoredImageAnalysisSelectors = [];\r\n            ignoredInlineSelectors = [];\r\n        }\r\n        isIFrame$1 = iframe;\r\n        if (document.head) {\r\n            if (isAnotherDarkReaderInstanceActive()) {\r\n                return;\r\n            }\r\n            document.documentElement.setAttribute('data-darkreader-mode', 'dynamic');\r\n            document.documentElement.setAttribute('data-darkreader-scheme', filter.mode ? 'dark' : 'dimmed');\r\n            createThemeAndWatchForUpdates();\r\n        }\r\n        else {\r\n            if (!isFirefox) {\r\n                var fallbackStyle = createOrUpdateStyle('darkreader--fallback');\r\n                document.documentElement.appendChild(fallbackStyle);\r\n                fallbackStyle.textContent = getModifiedFallbackStyle(filter, { strict: true });\r\n            }\r\n            var headObserver_1 = new MutationObserver(function () {\r\n                if (document.head) {\r\n                    headObserver_1.disconnect();\r\n                    if (isAnotherDarkReaderInstanceActive()) {\r\n                        removeDynamicTheme();\r\n                        return;\r\n                    }\r\n                    createThemeAndWatchForUpdates();\r\n                }\r\n            });\r\n            headObserver_1.observe(document, { childList: true, subtree: true });\r\n        }\r\n    }\r\n    function removeProxy() {\r\n        document.dispatchEvent(new CustomEvent('__darkreader__cleanUp'));\r\n        removeNode(document.head.querySelector('.darkreader--proxy'));\r\n    }\r\n    function removeDynamicTheme() {\r\n        document.documentElement.removeAttribute(\"data-darkreader-mode\");\r\n        document.documentElement.removeAttribute(\"data-darkreader-scheme\");\r\n        cleanDynamicThemeCache();\r\n        removeNode(document.querySelector('.darkreader--fallback'));\r\n        if (document.head) {\r\n            restoreMetaThemeColor();\r\n            removeNode(document.head.querySelector('.darkreader--user-agent'));\r\n            removeNode(document.head.querySelector('.darkreader--text'));\r\n            removeNode(document.head.querySelector('.darkreader--invert'));\r\n            removeNode(document.head.querySelector('.darkreader--inline'));\r\n            removeNode(document.head.querySelector('.darkreader--override'));\r\n            removeNode(document.head.querySelector('.darkreader--variables'));\r\n            removeNode(document.head.querySelector('.darkreader--root-vars'));\r\n            removeNode(document.head.querySelector('meta[name=\"darkreader\"]'));\r\n            removeProxy();\r\n        }\r\n        shadowRootsWithOverrides.forEach(function (root) {\r\n            removeNode(root.querySelector('.darkreader--inline'));\r\n            removeNode(root.querySelector('.darkreader--override'));\r\n        });\r\n        shadowRootsWithOverrides.clear();\r\n        forEach(styleManagers.keys(), function (el) { return removeManager(el); });\r\n        loadingStyles.clear();\r\n        cleanLoadingLinks();\r\n        forEach(document.querySelectorAll('.darkreader'), removeNode);\r\n        adoptedStyleManagers.forEach(function (manager) {\r\n            manager.destroy();\r\n        });\r\n        adoptedStyleManagers.splice(0);\r\n    }\r\n    function cleanDynamicThemeCache() {\r\n        variablesStore.clear();\r\n        parsedURLCache.clear();\r\n        stopWatchingForDocumentVisibility();\r\n        cancelRendering();\r\n        stopWatchingForUpdates();\r\n        cleanModificationCache();\r\n    }\n\n    var blobRegex = /url\\(\\\"(blob\\:.*?)\\\"\\)/g;\r\n    function replaceBlobs(text) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var promises, data;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        promises = [];\r\n                        getMatches(blobRegex, text, 1).forEach(function (url) {\r\n                            var promise = loadAsDataURL(url);\r\n                            promises.push(promise);\r\n                        });\r\n                        return [4, Promise.all(promises)];\r\n                    case 1:\r\n                        data = _a.sent();\r\n                        return [2, text.replace(blobRegex, function () { return \"url(\\\"\" + data.shift() + \"\\\")\"; })];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var banner = \"/*\\n                        _______\\n                       /       \\\\\\n                      .==.    .==.\\n                     ((  ))==((  ))\\n                    / \\\"==\\\"    \\\"==\\\"\\\\\\n                   /____|| || ||___\\\\\\n       ________     ____    ________  ___    ___\\n       |  ___  \\\\   /    \\\\   |  ___  \\\\ |  |  /  /\\n       |  |  \\\\  \\\\ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |_/  /\\n       |  |   )  /  /__\\\\  \\\\ |  |__/  /|  ___  \\\\\\n       |  |__/  /  ______  \\\\|  ____  \\\\|  |  \\\\  \\\\\\n_______|_______/__/ ____ \\\\__\\\\__|___\\\\__\\\\__|___\\\\__\\\\____\\n|  ___  \\\\ |  ____/ /    \\\\   |  ___  \\\\ |  ____|  ___  \\\\\\n|  |  \\\\  \\\\|  |___ /  /\\\\  \\\\  |  |  \\\\  \\\\|  |___|  |  \\\\  \\\\\\n|  |__/  /|  ____/  /__\\\\  \\\\ |  |   )  |  ____|  |__/  /\\n|  ____  \\\\|  |__/  ______  \\\\|  |__/  /|  |___|  ____  \\\\\\n|__|   \\\\__\\\\____/__/      \\\\__\\\\_______/ |______|__|   \\\\__\\\\\\n                https://darkreader.org\\n*/\\n\\n/*! Dark reader generated CSS | Licensed under MIT https://github.com/darkreader/darkreader/blob/master/LICENSE */\\n\";\r\n    function collectCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            function addStaticCSS(selector, comment) {\r\n                var staticStyle = document.querySelector(selector);\r\n                if (staticStyle && staticStyle.textContent) {\r\n                    css.push(\"/* \" + comment + \" */\");\r\n                    css.push(staticStyle.textContent);\r\n                    css.push('');\r\n                }\r\n            }\r\n            var css, modifiedCSS, formattedCSS, _a, _b;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        css = [banner];\r\n                        addStaticCSS('.darkreader--fallback', 'Fallback Style');\r\n                        addStaticCSS('.darkreader--user-agent', 'User-Agent Style');\r\n                        addStaticCSS('.darkreader--text', 'Text Style');\r\n                        addStaticCSS('.darkreader--invert', 'Invert Style');\r\n                        addStaticCSS('.darkreader--variables', 'Variables Style');\r\n                        modifiedCSS = [];\r\n                        document.querySelectorAll('.darkreader--sync').forEach(function (element) {\r\n                            forEach(element.sheet.cssRules, function (rule) {\r\n                                rule && rule.cssText && modifiedCSS.push(rule.cssText);\r\n                            });\r\n                        });\r\n                        if (!modifiedCSS.length) return [3, 2];\r\n                        formattedCSS = formatCSS(modifiedCSS.join('\\n'));\r\n                        css.push('/* Modified CSS */');\r\n                        _b = (_a = css).push;\r\n                        return [4, replaceBlobs(formattedCSS)];\r\n                    case 1:\r\n                        _b.apply(_a, [_c.sent()]);\r\n                        css.push('');\r\n                        _c.label = 2;\r\n                    case 2:\r\n                        addStaticCSS('.darkreader--override', 'Override Style');\r\n                        return [2, css.join('\\n')];\r\n                }\r\n            });\r\n        });\r\n    }\n\n    var isDarkReaderEnabled = false;\r\n    var isIFrame = (function () {\r\n        try {\r\n            return window.self !== window.top;\r\n        }\r\n        catch (err) {\r\n            console.warn(err);\r\n            return true;\r\n        }\r\n    })();\r\n    function enable(themeOptions, fixes) {\r\n        if (themeOptions === void 0) { themeOptions = {}; }\r\n        if (fixes === void 0) { fixes = null; }\r\n        var theme = __assign(__assign({}, DEFAULT_THEME), themeOptions);\r\n        if (theme.engine !== ThemeEngines.dynamicTheme) {\r\n            throw new Error('Theme engine is not supported.');\r\n        }\r\n        createOrUpdateDynamicTheme(theme, fixes, isIFrame);\r\n        isDarkReaderEnabled = true;\r\n    }\r\n    function isEnabled() {\r\n        return isDarkReaderEnabled;\r\n    }\r\n    function disable() {\r\n        removeDynamicTheme();\r\n        isDarkReaderEnabled = false;\r\n    }\r\n    var darkScheme = matchMedia('(prefers-color-scheme: dark)');\r\n    var store = {\r\n        themeOptions: null,\r\n        fixes: null,\r\n    };\r\n    function handleColorScheme() {\r\n        if (darkScheme.matches) {\r\n            enable(store.themeOptions, store.fixes);\r\n        }\r\n        else {\r\n            disable();\r\n        }\r\n    }\r\n    function auto(themeOptions, fixes) {\r\n        if (themeOptions === void 0) { themeOptions = {}; }\r\n        if (fixes === void 0) { fixes = null; }\r\n        if (themeOptions) {\r\n            store = { themeOptions: themeOptions, fixes: fixes };\r\n            handleColorScheme();\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.addEventListener('change', handleColorScheme);\r\n            }\r\n            else {\r\n                darkScheme.addListener(handleColorScheme);\r\n            }\r\n        }\r\n        else {\r\n            if (isMatchMediaChangeEventListenerSupported) {\r\n                darkScheme.removeEventListener('change', handleColorScheme);\r\n            }\r\n            else {\r\n                darkScheme.removeListener(handleColorScheme);\r\n            }\r\n            disable();\r\n        }\r\n    }\r\n    function exportGeneratedCSS() {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4, collectCSS()];\r\n                    case 1: return [2, _a.sent()];\r\n                }\r\n            });\r\n        });\r\n    }\r\n    var setFetchMethod = setFetchMethod$1;\n\n    exports.auto = auto;\n    exports.disable = disable;\n    exports.enable = enable;\n    exports.exportGeneratedCSS = exportGeneratedCSS;\n    exports.isEnabled = isEnabled;\n    exports.setFetchMethod = setFetchMethod;\n\n    Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n"]},"metadata":{},"sourceType":"script"}