{"ast":null,"code":"import _asyncToGenerator from \"/home/geri/Documents/angular-frontend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as Notifications from 'src/app/interfaces/globalNotifications/notifications';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/priority/priority.service\";\nimport * as i2 from \"src/app/services/project/project.service\";\nimport * as i3 from \"src/app/services/role/role.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"src/app/services/auth/auth.service\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i8 from \"@angular/common\";\n\nfunction AddProjectComponent_button_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function AddProjectComponent_button_31_Template_button_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const prio_r4 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.setPriority(prio_r4);\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const prio_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" Type: \", prio_r4.priorityType, \" | Importance: \", prio_r4.importance, \" (higher the more important) \");\n  }\n}\n\nexport let AddProjectComponent = /*#__PURE__*/(() => {\n  class AddProjectComponent {\n    constructor(priorityService, projectService, roleService, router, authService) {\n      this.priorityService = priorityService;\n      this.projectService = projectService;\n      this.roleService = roleService;\n      this.router = router;\n      this.authService = authService;\n      this.tickBoxDefault = true;\n    }\n\n    ngOnInit() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        _this.priorities = yield _this.priorityService.getPriorities().toPromise();\n        _this.roles = yield _this.roleService.getRolesByAcessLevel(3, 0).toPromise();\n      })();\n    }\n\n    setPriority(priority) {\n      this.selectedPriority = priority;\n    }\n\n    onAddProject(updateProjectForm) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        var _a, _b, _c;\n\n        const projectTitle = (_a = updateProjectForm.form.get('project_title')) === null || _a === void 0 ? void 0 : _a.value;\n        const projectDescription = (_b = updateProjectForm.form.get('project_description')) === null || _b === void 0 ? void 0 : _b.value;\n        const projectOpen = (_c = updateProjectForm.form.get('project_status')) === null || _c === void 0 ? void 0 : _c.value;\n        let userId = localStorage.getItem(\"user_id\") ? Number(localStorage.getItem(\"user_id\")) : 0;\n        let newProject = {\n          projectName: projectTitle,\n          projectDescription: projectDescription,\n          projectOpen: projectOpen,\n          dateStarted: new Date(),\n          id: 0,\n          projectPriority: _this2.selectedPriority,\n          tickets: {},\n          projestUserRoleLinks: {}\n        };\n        alert(`Project Name: ${newProject.projectName}\\n Project desc: ${newProject.projectDescription}\\n project open: ${newProject.projectOpen}\n    Date started: ${newProject.dateStarted}`); //if(userId!==0)\n\n        _this2.projectService.addProject(newProject.projectPriority.id, newProject, userId, _this2.roles[0].id).subscribe(response => {\n          //alert(\"Project Created\")\n          Notifications.addNewAlert(`Project Created: ${response.projectName} `, \"success\"); //the token has user access rights in it so we need to get a new one to save changes\n\n          _this2.authService.refreshToken('').subscribe(response => {\n            console.warn(\"In the {getting new access token using refresh token} process @creating project\");\n\n            if (response.access_token && response.refresh_token && response.access_token_expires && response.refresh_token_expires) {\n              localStorage.setItem('access_token', response.access_token);\n              localStorage.setItem('refresh_token', response.refresh_token);\n              localStorage.setItem('access_token_expires', response.access_token_expires);\n              localStorage.setItem('refresh_token_expires', response.refresh_token_expires);\n            }\n\n            console.warn(\"saved new token @createProject\");\n          });\n\n          _this2.router.navigateByUrl('projects');\n        }, error => {\n          alert(error.message);\n        });\n      })();\n    }\n\n  }\n\n  AddProjectComponent.ɵfac = function AddProjectComponent_Factory(t) {\n    return new (t || AddProjectComponent)(i0.ɵɵdirectiveInject(i1.PriorityService), i0.ɵɵdirectiveInject(i2.ProjectService), i0.ɵɵdirectiveInject(i3.RoleService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i5.AuthService));\n  };\n\n  AddProjectComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddProjectComponent,\n    selectors: [[\"app-add-project\"]],\n    decls: 47,\n    vars: 5,\n    consts: [[1, \"content\"], [1, \"container-fluid\"], [1, \"row\"], [1, \"col-md-12\"], [1, \"card\"], [1, \"card-header\", \"card-header-primary\"], [1, \"card-title\"], [1, \"card-body\"], [3, \"ngSubmit\"], [\"addProjectForm\", \"ngForm\"], [1, \"form-group\"], [1, \"bmd-label-floating\"], [\"type\", \"text\", \"ngModel\", \"\", \"name\", \"project_title\", \"required\", \"\", \"maxlength\", \"50\", 1, \"form-control\"], [\"input\", \"\"], [\"type\", \"text\", \"ngModel\", \"\", \"name\", \"project_description\", \"required\", \"\", \"maxlength\", \"2000\", 1, \"form-control\"], [1, \"col-md-2\"], [\"ngbDropdown\", \"\", 1, \"d-inline-block\"], [\"id\", \"priorityDropDown\", \"ngbDropdownToggle\", \"\", \"type\", \"button\", 1, \"btn\", \"btn-outline-primary\"], [\"ngbDropdownMenu\", \"\", \"aria-labelledby\", \"priorityDropDown\"], [\"ngbDropdownItem\", \"\", \"type\", \"button\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [\"align-items\", \"center\", 1, \"col-md-2\", \"center\"], [\"text-align\", \"center\", \"vertical-align\", \"middle\", 1, \"bmd-label-floating\", \"center\"], [1, \"form-check\"], [1, \"form-check-label\"], [\"type\", \"checkbox\", \"ngModel\", \"\", \"name\", \"project_status\", 1, \"form-check-input\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-check-sign\"], [1, \"check\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"pull-right\", 3, \"disabled\"], [1, \"clearfix\"], [\"ngbDropdownItem\", \"\", \"type\", \"button\", 3, \"click\"]],\n    template: function AddProjectComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r7 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelementStart(6, \"h4\", 6);\n        i0.ɵɵtext(7, \"Add Project\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelementStart(9, \"form\", 8, 9);\n        i0.ɵɵlistener(\"ngSubmit\", function AddProjectComponent_Template_form_ngSubmit_9_listener() {\n          i0.ɵɵrestoreView(_r7);\n\n          const _r0 = i0.ɵɵreference(10);\n\n          return ctx.onAddProject(_r0);\n        });\n        i0.ɵɵelementStart(11, \"div\", 2);\n        i0.ɵɵelementStart(12, \"div\", 3);\n        i0.ɵɵelementStart(13, \"div\", 10);\n        i0.ɵɵelementStart(14, \"label\", 11);\n        i0.ɵɵtext(15, \"Project Title\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"input\", 12, 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 2);\n        i0.ɵɵelementStart(19, \"div\", 3);\n        i0.ɵɵelementStart(20, \"div\", 10);\n        i0.ɵɵelementStart(21, \"label\", 11);\n        i0.ɵɵtext(22, \"Project Description\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(23, \"input\", 14, 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"div\", 2);\n        i0.ɵɵelementStart(26, \"div\", 15);\n        i0.ɵɵelementStart(27, \"div\", 16);\n        i0.ɵɵelementStart(28, \"button\", 17);\n        i0.ɵɵtext(29, \" Priority \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"div\", 18);\n        i0.ɵɵtemplate(31, AddProjectComponent_button_31_Template, 2, 2, \"button\", 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"div\", 20);\n        i0.ɵɵelementStart(33, \"label\", 21);\n        i0.ɵɵtext(34);\n        i0.ɵɵelement(35, \"br\");\n        i0.ɵɵtext(36);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(37, \"div\", 20);\n        i0.ɵɵelementStart(38, \"div\", 22);\n        i0.ɵɵelementStart(39, \"label\", 23);\n        i0.ɵɵtext(40, \" Project open \");\n        i0.ɵɵelementStart(41, \"input\", 24);\n        i0.ɵɵlistener(\"ngModelChange\", function AddProjectComponent_Template_input_ngModelChange_41_listener($event) {\n          return ctx.tickBoxDefault = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(42, \"span\", 25);\n        i0.ɵɵelement(43, \"span\", 26);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"button\", 27);\n        i0.ɵɵtext(45, \" Add Project \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(46, \"div\", 28);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r0 = i0.ɵɵreference(10);\n\n        i0.ɵɵadvance(31);\n        i0.ɵɵproperty(\"ngForOf\", ctx.priorities);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"Project Priority: \", ctx == null ? null : ctx.selectedPriority == null ? null : ctx.selectedPriority.priorityType, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" Importance level: \", ctx == null ? null : ctx.selectedPriority == null ? null : ctx.selectedPriority.importance, \" \");\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.tickBoxDefault);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", !_r0.valid);\n      }\n    },\n    directives: [i6.ɵNgNoValidate, i6.NgControlStatusGroup, i6.NgForm, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgModel, i6.RequiredValidator, i6.MaxLengthValidator, i7.NgbDropdown, i7.NgbDropdownToggle, i7.NgbDropdownMenu, i8.NgForOf, i6.CheckboxControlValueAccessor, i7.NgbDropdownItem],\n    styles: [\"\"]\n  });\n  return AddProjectComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}